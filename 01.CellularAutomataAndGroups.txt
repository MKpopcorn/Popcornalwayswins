Springer Monographs in Mathematics
For further volumes:
www.springer.com/series/3733
Tullio Ceccherini-Silberstein r Michel Coornaert




Cellular Automata
and Groups
Tullio Ceccherini-Silberstein                            Michel Coornaert
Dipartimento di Ingegneria                               Institut de Recherche Mathématique Avancée
Università del Sannio                                    Université de Strasbourg
C.so Garibaldi 107                                       7 rue René-Descartes
82100 Benevento                                          67084 Strasbourg Cedex
Italy                                                    France
tceccher@mat.uniroma1.it                                 coornaert@math.unistra.fr




ISSN 1439-7382
ISBN 978-3-642-14033-4                    e-ISBN 978-3-642-14034-1
DOI 10.1007/978-3-642-14034-1
Springer Heidelberg Dordrecht London New York

Library of Congress Control Number: 2010934641

Mathematics Subject Classification (2010): 37B15, 68Q80, 20F65, 43A07, 16S34, 20C07

© Springer-Verlag Berlin Heidelberg 2010
This work is subject to copyright. All rights are reserved, whether the whole or part of the material is
concerned, specifically the rights of translation, reprinting, reuse of illustrations, recitation, broadcasting,
reproduction on microfilm or in any other way, and storage in data banks. Duplication of this publication
or parts thereof is permitted only under the provisions of the German Copyright Law of September 9,
1965, in its current version, and permission for use must always be obtained from Springer. Violations
are liable to prosecution under the German Copyright Law.
The use of general descriptive names, registered names, trademarks, etc. in this publication does not
imply, even in the absence of a specific statement, that such names are exempt from the relevant protective
laws and regulations and therefore free for general use.

Cover design: deblik

Printed on acid-free paper

Springer is part of Springer Science+Business Media (www.springer.com)
To Katiuscia, Giacomo, and Tommaso

           To Martine and Nathalie
Preface




Two seemingly unrelated mathematical notions, namely that of an amenable
group and that of a cellular automaton, were both introduced by John von
Neumann in the ﬁrst half of the last century. Amenability, which originated
from the study of the Banach-Tarski paradox, is a property of groups gener-
alizing both commutativity and ﬁniteness. Nowadays, it plays an important
role in many areas of mathematics such as representation theory, harmonic
analysis, ergodic theory, geometric group theory, probability theory, and dy-
namical systems. Von Neumann used cellular automata to serve as theoretical
models for self-reproducing machines. About twenty years later, the famous
cellular automaton associated with the Game of Life was invented by John
Horton Conway and popularized by Martin Gardner. The theory of cellular
automata ﬂourished as one of the main branches of computer science. Deep
connections with complexity theory and logic emerged from the discovery
that some cellular automata are universal Turing machines.
   A group G is said to be amenable (as a discrete group) if the set of all
subsets of G admits a right-invariant ﬁnitely additive probability measure.
All ﬁnite groups, all solvable groups (and therefore all abelian groups), and
all ﬁnitely generated groups of subexponential growth are amenable. Von
Neumann observed that the class of amenable groups is closed under the
operation of taking subgroups and that the free group of rank two F2 is non-
amenable. It follows that a group which contains a subgroup isomorphic to
F2 is non-amenable. However, there are examples of groups which are non-
amenable and contain no subgroups isomorphic to F2 (the ﬁrst examples
of such groups were discovered by Alexander Y. Ol’shanskii and by Sergei
I. Adyan).
   Loosely speaking, a general cellular automaton can be described as fol-
lows. A conﬁguration is a map from a set called the universe into another
set called the alphabet. The elements of the universe are called cells and the
elements of the alphabet are called states. A cellular automaton is then a
map from the set of all conﬁgurations into itself satisfying the following local
property: the state of the image conﬁguration at a given cell only depends on


                                                                             vii
viii                                                                      Preface

the states of the initial conﬁguration on a ﬁnite neighborhood of the given
cell. In the classical setting, for instance in the cellular automata constructed
by von Neumann and the one associated with Conway’s Game of Life, the
alphabet is ﬁnite, the universe is the two dimensional inﬁnite square lattice,
and the neighborhood of a cell consists of the cell itself and its eight adjacent
cells. By iterating a cellular automaton one gets a discrete dynamical system.
Such dynamical systems have proved very useful to model complex systems
arising from natural sciences, in particular physics, biology, chemistry, and
population dynamics.
                                         ∗
                                     ∗       ∗
    In this book, the universe will always be a group G (in the classical setting
the corresponding group was G = Z2 ) and the alphabet may be ﬁnite or
inﬁnite. The left multiplication in G induces a natural action of G on the set
of conﬁgurations which is called the G-shift and all cellular automata will be
required to commute with the shift.
    It was soon realized that the question whether a given cellular automaton
is surjective or not needs a special attention. From the dynamical viewpoint,
surjectivity means that each conﬁguration may be reached at any time. The
ﬁrst important result in this direction is the celebrated theorem of Moore and
Myhill which gives a necessary and suﬃcient condition for the surjectivity of
a cellular automaton with ﬁnite alphabet over the group G = Z2 . Edward F.
Moore and John R. Myhill proved that such a cellular automaton is surjective
if and only if it is pre-injective. As the term suggests it, pre-injectivity is a
weaker notion than injectivity. More precisely, a cellular automaton is said to
be pre-injective if two conﬁgurations are equal whenever they have the same
image and coincide outside a ﬁnite subset of the group. Moore proved the
“surjective ⇒ pre-injective” part and Myhill proved the converse implication
shortly after. One often refers to this result as to the Garden of Eden theorem.
This biblical terminology is motivated by the fact that, regarding a cellular
automaton as a dynamical system with discrete time, a conﬁguration which
is not in the image of the cellular automaton may only appear as an initial
conﬁguration, that is, at time t = 0.
    The surprising connection between amenability and cellular automata was
established in 1997 when Antonio Machı̀, Fabio Scarabotti and the ﬁrst au-
thor proved the Garden of Eden theorem for cellular automata with ﬁnite
alphabets over amenable groups. At the same time, and completely inde-
pendently, Misha Gromov, using a notion of spacial entropy, presented a
more general form of the Garden of Eden theorem where the universe is
an amenable graph with a dense holonomy and cellular automata are called
maps of bounded propagation. Machı̀, Scarabotti and the ﬁrst author also
showed that both implications in the Garden of Eden theorem become false
if the underlying group contains a subgroup isomorphic to F2 . The question
whether the Garden of Eden theorem could be extended beyond the class of
Preface                                                                       ix

amenable groups remained open until 2008 when Laurent Bartholdi proved
that the Moore implication fails to hold for non-amenable groups. As a conse-
quence, the whole Garden of Eden theorem only holds for amenable groups.
This gives a new characterization of amenable groups in terms of cellular au-
tomata. Let us mention that, up to now, the validity of the Myhill implication
for non-amenable groups is still an open problem.
   Following Walter H. Gottschalk, a group G is said to be surjunctive if every
injective cellular automaton with ﬁnite alphabet over G is surjective. Wayne
Lawton proved that all residually ﬁnite groups are surjunctive and that ev-
ery subgroup of a surjunctive group is surjunctive. Since injectivity implies
pre-injectivity, an immediate consequence of the Garden of Eden theorem for
amenable groups is that every amenable group is surjunctive. Gromov and
Benjamin Weiss introduced a class of groups, called soﬁc groups, which in-
cludes all residually ﬁnite groups and all amenable groups, and proved that
every soﬁc group is surjunctive. Soﬁc groups can be deﬁned in three equivalent
ways: in terms of local approximation by ﬁnite symmetric groups equipped
with their Hamming distance, in terms of local approximation of their Cayley
graphs by ﬁnite labelled graphs, and, ﬁnally, as being the groups that can
be embedded into ultraproducts of ﬁnite symmetric groups (this last charac-
terization is due to Gábor Elek and Endre Szabó). The class of soﬁc groups
is the largest known class of surjunctive groups. It is not known, up to now,
whether all groups are surjunctive (resp. soﬁc) or not.
   Stimulated by Gromov ideas, we considered cellular automata whose al-
phabets are vector spaces. In this framework, the space of conﬁgurations has
a natural structure of a vector space and cellular automata are required to
be linear. An analogue of the Garden of Eden theorem was proved for linear
cellular automata with ﬁnite dimensional alphabets over amenable groups. In
the proof, the role of entropy, used in the ﬁnite alphabet case, is now played
by the mean dimension, a notion introduced by Gromov. Also, examples of
linear cellular automata with ﬁnite dimensional alphabets over groups con-
taining F2 showing that the linear version of the Garden of Eden theorem
may fail to hold in this case, were provided. It is not known, up to now, if
the Garden of Eden theorem for linear cellular automata with ﬁnite dimen-
sional alphabet only holds for amenable groups or not. We also introduced
the notion of linear surjunctivity: a group G is said to be L-surjunctive if ev-
ery injective linear cellular automaton with ﬁnite dimensional alphabet over
G is surjective. We proved that every soﬁc group is L-surjunctive. Linear
cellular automata over a group G with alphabet of ﬁnite dimension d over
a ﬁeld K may be represented by d × d matrices with entries in the group
ring K[G]. This leads to the following characterization of L-surjunctivity: a
group is L-surjunctive if and only if it satisﬁes Kaplansky’s conjecture on the
stable ﬁniteness of group rings (a ring is said to be stably ﬁnite if one-sided
invertible ﬁnite dimensional square matrices with coeﬃcients in that ring are
in fact two-sided invertible). As a corollary, one has that group rings of soﬁc
groups are stably ﬁnite, a result previously established by Elek and Szabó
x                                                                        Preface

using diﬀerent methods. Moreover, given a group G and a ﬁeld K, the pre-
injectivity of all nonzero linear cellular automata with alphabet K over G is
equivalent to the absence of zero-divisors in K[G]. As a consequence, another
important problem on the structure of group rings also formulated by Irving
Kaplansky may be expressed in terms of cellular automata. Is every nonzero
linear cellular automaton with one-dimensional alphabet over a torsion-free
group always pre-injective?
                                         ∗
                                     ∗       ∗
    The material presented in this book is entirely self-contained. In fact, its
reading only requires some acquaintance with undergraduate general topol-
ogy and abstract algebra. Each chapter begins with a brief overview of its
contents and ends with some historical notes and a list of exercises at various
diﬃculty levels. Some additional topics, such as subshifts and cellular au-
tomata over subshifts, are treated in these exercises. Hints are provided each
time help may be needed. In order to improve accessibility, a few appendices
are included to quickly introduce the reader to facts he might be not too
familiar with.
    In the ﬁrst chapter, we give the deﬁnition of a cellular automaton. We
present some basic examples and discuss general methods for constructing
cellular automata. We equip the set of conﬁgurations with its prodiscrete
uniform structure and prove the generalized Curtis-Hedlund theorem: a nec-
essary and suﬃcient condition for a self-mapping of the conﬁguration space
to be a cellular automaton is that it is uniformly continuous and commutes
with the shift.
    Chapter 2 is devoted to residually ﬁnite groups. We give several equiv-
alent characterizations of residual ﬁniteness and prove that the class of
residually ﬁnite groups is closed under taking subgroups and projective lim-
its. We establish in particular the theorems, respectively due to Anatoly I.
Mal’cev and Gilbert Baumslag, which assert that ﬁnitely generated residually
ﬁnite groups are Hopﬁan and that their automorphism group is residually ﬁ-
nite.
    Surjunctive groups are introduced in Chap. 3. We show that every sub-
group of a surjunctive group is surjunctive and that locally residually ﬁnite
groups are surjunctive. We also prove a theorem of Gromov which says that
limits of surjunctive marked groups are surjunctive.
    The theory of amenable groups is developed in Chap. 4. The class of
amenable groups is closed under taking subgroups, quotients, extensions, and
inductive limits. We prove the theorems due to Erling Følner and Alfred
Tarski which state the equivalence between amenability, the existence of a
Følner net, and the non-existence of a paradoxical decomposition.
    The Garden of Eden theorem is established in Chap. 5. It is proved by
showing that both surjectivity and pre-injectivity of the cellular automaton
are equivalent to the fact that the image of the conﬁguration space has maxi-
Preface                                                                       xi

mal entropy. We give an example of a cellular automaton with ﬁnite alphabet
over F2 which is pre-injective but not surjective. Following Bartholdi’s con-
struction, we also prove the existence of a surjective but not pre-injective
cellular automaton with ﬁnite alphabet over any non-amenable group.
   In Chap. 6 we present the basic elementary notions and results on growth
of ﬁnitely generated groups. We prove that ﬁnitely generated nilpotent groups
have polynomial growth. We then introduce the Grigorchuk group and show
that it is an inﬁnite ﬁnitely generated periodic group of intermediate growth.
We show that every ﬁnitely generated group of subexponential growth is
amenable. We also establish the Kesten-Day characterization of amenability
which asserts that a group with a ﬁnite (not necessarily symmetric) generat-
ing subset is amenable if and only if 0 is in the 2 -spectrum of the associated
Laplacian. Finally, we consider the notion of quasi-isometry for not neces-
sarily countable groups and we show that amenability is a quasi-isometry
invariant.
   In Chap. 7 we consider the notion of local embeddability of groups into
a class of groups. For the class of ﬁnite groups, this gives the class of LEF
groups introduced by Anatoly M. Vershik and Edward I. Gordon. We dis-
cuss several stability properties of local embeddability and show that locally
embeddable groups are closed in marked groups spaces. The remaining of
the chapter is devoted to the class of soﬁc groups. We show that the three
deﬁnitions, namely analytic, geometric, and algebraic, we alluded to before,
are equivalent. We then prove the Gromov-Weiss theorem which states that
every soﬁc group is surjunctive.
   The last chapter is devoted to linear cellular automata. We prove the linear
version of the Garden of Eden theorem and show that every soﬁc group is
L-surjunctive. We end the chapter with a discussion on the stable ﬁniteness
and the zero-divisors conjectures of Kaplansky and their reformulation in
terms of linear cellular automata.
   Appendix A gives a quick overview of a few fundamental notions and re-
sults of topology (nets, compactness, product topology, and the Tychonoﬀ
product theorem). Appendix B is devoted to André Weil’s theory of uniform
spaces. It includes also a detailed exposition of the Hausdorﬀ-Bourbaki uni-
form structure on subsets of a uniform space. In Appendix C, we establish
some basic properties of symmetric groups and prove the simplicity of the
alternating groups. The deﬁnition and the construction of free groups are
given in Appendix D. The proof of Klein’s ping-pong lemma is also included
there. In Appendix E we shortly describe the constructions of inductive and
projective limits of groups. Appendix F treats topological vector spaces, the
weak-∗ topology, and the Banach-Alaoglu theorem. The proof of the Markov-
Kakutani ﬁxed point theorem is presented in Appendix G. In the subsequent
appendix, of a pure graph-theoretical and combinatorial ﬂavour, we consider
bipartite graphs and their matchings. We prove Hall’s marriage theorem and
its harem version which plays a key role in the proof of Tarski’s theorem on
amenability. The Baire theorem, the open mapping theorem, as well as other
xii                                                                      Preface

complements of functional analysis including uniform convexity are treated
in Appendix I. The last appendix deals with the notions of ﬁlters and ultra-
ﬁlters.
   We would like to express our deep gratitude to Dr. Catriona Byrne, Dr.
Marina Reizakis and Annika Eling from Springer Verlag and to Donatas
Akmanavičius for their constant and kindest help at all stages of the editorial
process.

Rome and Strasbourg                               Tullio Ceccherini-Silberstein
                                                            Michel Coornaert
Contents




1   Cellular Automata . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    1
    1.1 The Conﬁguration Set and the Shift Action . . . . . . . . . . . . . . . .                                        1
    1.2 The Prodiscrete Topology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                           3
    1.3 Periodic Conﬁgurations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                         3
    1.4 Cellular Automata . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    6
    1.5 Minimal Memory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    14
    1.6 Cellular Automata over Quotient Groups . . . . . . . . . . . . . . . . . .                                      15
    1.7 Induction and Restriction of Cellular Automata . . . . . . . . . . . .                                          16
    1.8 Cellular Automata with Finite Alphabets . . . . . . . . . . . . . . . . . .                                     20
    1.9 The Prodiscrete Uniform Structure . . . . . . . . . . . . . . . . . . . . . . .                                 22
    1.10 Invertible Cellular Automata . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                         24
    Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   27
    Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       29

2   Residually Finite Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                          37
    2.1 Deﬁnition and First Examples . . . . . . . . . . . . . . . . . . . . . . . . . . .                              37
    2.2 Stability Properties of Residually Finite Groups . . . . . . . . . . . .                                        40
    2.3 Residual Finiteness of Free Groups . . . . . . . . . . . . . . . . . . . . . . .                                42
    2.4 Hopﬁan Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                   44
    2.5 Automorphism Groups of Residually Finite Groups . . . . . . . . .                                               45
    2.6 Examples of Finitely Generated Groups Which Are Not
        Residually Finite . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                 47
    2.7 Dynamical Characterization of Residual Finiteness . . . . . . . . . .                                           50
    Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   51
    Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       52

3   Surjunctive Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    57
    3.1 Deﬁnition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .             57
    3.2 Stability Properties of Surjunctive Groups . . . . . . . . . . . . . . . . .                                    58
    3.3 Surjunctivity of Locally Residually Finite Groups . . . . . . . . . . .                                         59


                                                                                                                        xiii
xiv                                                                                                              Contents

      3.4 Marked Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                   61
      3.5 Expansive Actions on Uniform Spaces . . . . . . . . . . . . . . . . . . . . .                                   64
      3.6 Gromov’s Injectivity Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                            65
      3.7 Closedness of Marked Surjunctive Groups . . . . . . . . . . . . . . . . .                                       67
      Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   68
      Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       68

4     Amenable Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                      77
      4.1 Measures and Means . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                       77
      4.2 Properties of the Set of Means . . . . . . . . . . . . . . . . . . . . . . . . . . .                             82
      4.3 Measures and Means on Groups . . . . . . . . . . . . . . . . . . . . . . . . . .                                 83
      4.4 Deﬁnition of Amenability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                         85
      4.5 Stability Properties of Amenable Groups . . . . . . . . . . . . . . . . . .                                      88
      4.6 Solvable Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                  92
      4.7 The Følner Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                        94
      4.8 Paradoxical Decompositions . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                             98
      4.9 The Theorems of Tarski and Følner . . . . . . . . . . . . . . . . . . . . . . .                                  99
      4.10 The Fixed Point Property . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                         103
      Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   105
      Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       106

5     The Garden of Eden Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                  111
      5.1 Garden of Eden Conﬁgurations and Garden of Eden Patterns                                                        111
      5.2 Pre-injective Maps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                  112
      5.3 Statement of the Garden of Eden Theorem . . . . . . . . . . . . . . . .                                         114
      5.4 Interiors, Closures, and Boundaries . . . . . . . . . . . . . . . . . . . . . . .                               115
      5.5 Mutually Erasable Patterns . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                          121
      5.6 Tilings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         122
      5.7 Entropy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .           125
      5.8 Proof of the Garden of Eden Theorem . . . . . . . . . . . . . . . . . . . .                                     128
      5.9 Surjunctivity of Locally Residually Amenable Groups . . . . . . .                                               131
      5.10 A Surjective but Not Pre-injective Cellular Automaton
           over F2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .        133
      5.11 A Pre-injective but Not Surjective Cellular Automaton
           over F2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .        133
      5.12 A Characterization of Amenability in Terms of Cellular
           Automata . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .             135
      5.13 Garden of Eden Patterns for Life . . . . . . . . . . . . . . . . . . . . . . . . .                             136
      Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   138
      Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       139

6     Finitely Generated Amenable Groups . . . . . . . . . . . . . . . . . . . .                                          151
      6.1 The Word Metric . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                   151
      6.2 Labeled Graphs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                  153
      6.3 Cayley Graphs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                 156
      6.4 Growth Functions and Growth Types . . . . . . . . . . . . . . . . . . . . .                                     160
Contents                                                                                                                 xv

    6.5 The Growth Rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                     168
    6.6 Growth of Subgroups and Quotients . . . . . . . . . . . . . . . . . . . . . .                                   170
    6.7 A Finitely Generated Metabelian Group with Exponential
         Growth . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .           173
    6.8 Growth of Finitely Generated Nilpotent Groups . . . . . . . . . . . .                                           175
    6.9 The Grigorchuk Group and Its Growth . . . . . . . . . . . . . . . . . . . .                                     178
    6.10 The Følner Condition for Finitely Generated Groups . . . . . . . .                                             191
    6.11 Amenability of Groups of Subexponential Growth . . . . . . . . . .                                             192
    6.12 The Theorems of Kesten and Day . . . . . . . . . . . . . . . . . . . . . . . .                                 193
    6.13 Quasi-Isometries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                 204
    Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   214
    Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       217
7   Local Embeddability and Soﬁc Groups . . . . . . . . . . . . . . . . . . . .                                         233
    7.1 Local Embeddability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                     234
    7.2 Local Embeddability and Ultraproducts . . . . . . . . . . . . . . . . . . .                                     243
    7.3 LEF-Groups and LEA-Groups . . . . . . . . . . . . . . . . . . . . . . . . . . .                                 246
    7.4 The Hamming Metric . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                        251
    7.5 Soﬁc Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .               254
    7.6 Soﬁc Groups and Metric Ultraproducts of Finite Symmetric
        Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .          260
    7.7 A Characterization of Finitely Generated Soﬁc Groups . . . . . .                                                265
    7.8 Surjunctivity of Soﬁc Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . .                            272
    Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   275
    Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       278
8   Linear Cellular Automata . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                            283
    8.1 The Algebra of Linear Cellular Automata . . . . . . . . . . . . . . . . .                                       284
    8.2 Conﬁgurations with Finite Support . . . . . . . . . . . . . . . . . . . . . . .                                 288
    8.3 Restriction and Induction of Linear Cellular Automata . . . . . .                                               289
    8.4 Group Rings and Group Algebras . . . . . . . . . . . . . . . . . . . . . . . .                                  291
    8.5 Group Ring Representation of Linear Cellular Automata . . . .                                                   294
    8.6 Modules over a Group Ring . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                           299
    8.7 Matrix Representation of Linear Cellular Automata . . . . . . . . .                                             301
    8.8 The Closed Image Property . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                           305
    8.9 The Garden of Eden Theorem for Linear Cellular Automata .                                                       308
    8.10 Pre-injective but not Surjective Linear Cellular Automata . . .                                                314
    8.11 Surjective but not Pre-injective Linear Cellular Automata . . .                                                315
    8.12 Invertible Linear Cellular Automata . . . . . . . . . . . . . . . . . . . . . .                                317
    8.13 Pre-injectivity and Surjectivity of the Discrete Laplacian . . . .                                             321
    8.14 Linear Surjunctivity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                   324
    8.15 Stable Finiteness of Group Algebras . . . . . . . . . . . . . . . . . . . . . .                                327
    8.16 Zero-Divisors in Group Algebras and Pre-injectivity
         of One-Dimensional Linear Cellular Automata . . . . . . . . . . . . .                                          330
    Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   335
    Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       338
xvi                                                                                                              Contents

A     Nets and the Tychonoﬀ Product Theorem . . . . . . . . . . . . . . . .                                               343
      A.1 Directed Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .               343
      A.2 Nets in Topological Spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                        343
      A.3 Initial Topology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                346
      A.4 Product Topology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    346
      A.5 The Tychonoﬀ Product Theorem . . . . . . . . . . . . . . . . . . . . . . . . .                                  347
      Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   349

B     Uniform Structures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    351
      B.1 Uniform Spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                  351
      B.2 Uniformly Continuous Maps . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                             353
      B.3 Product of Uniform Spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                           355
      B.4 The Hausdorﬀ-Bourbaki Uniform Structure on Subsets . . . . . .                                                  356
      Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   358

C     Symmetric Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                      359
      C.1 The Symmetric Group . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                         359
      C.2 Permutations with Finite Support . . . . . . . . . . . . . . . . . . . . . . . .                                360
      C.3 Conjugacy Classes in Sym0 (X) . . . . . . . . . . . . . . . . . . . . . . . . . . .                             362
      C.4 The Alternating Group . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                       363

D     Free Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .             367
      D.1 Concatenation of Words . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                        367
      D.2 Deﬁnition and Construction of Free Groups . . . . . . . . . . . . . . . .                                       367
      D.3 Reduced Forms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                   373
      D.4 Presentations of Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                       375
      D.5 The Klein Ping-Pong Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . .                               376

E     Inductive Limits and Projective Limits of Groups . . . . . . . . 379
      E.1 Inductive Limits of Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 379
      E.2 Projective Limits of Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 380

F     The Banach-Alaoglu Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                  383
      F.1 Topological Vector Spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                         383
      F.2 The Weak-∗ Topology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                       384
      F.3 The Banach-Alaoglu Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . .                              384

G     The Markov-Kakutani Fixed Point Theorem . . . . . . . . . . . . . .                                                 387
      G.1 Statement of the Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                          387
      G.2 Proof of the Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                      387
      Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   389

H     The Hall Harem Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 391
      H.1 Bipartite Graphs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 391
      H.2 Matchings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 393
Contents                                                                                                                   xvii

       H.3 The Hall Marriage Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 394
       H.4 The Hall Harem Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 399
       Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 401

I      Complements of Functional Analysis . . . . . . . . . . . . . . . . . . . . . .                                      403
       I.1 The Baire Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                     403
       I.2 The Open Mapping Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                404
       I.3 Spectra of Linear Maps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                        406
       I.4 Uniform Convexity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                     407

J      Ultraﬁlters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .           409
       J.1 Filters and Ultraﬁlters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                     409
       J.2 Limits Along Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    412
       Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   415

Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 417
   Comments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 418

References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421

List of Symbols . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 429

Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 433
Notation




Throughout this book, the following conventions are used:
• N is the set of nonnegative integers so that 0 ∈ N;
• the notation A ⊂ B means that each element in the set A is also in the
  set B so that A and B may coincide;
• a countable set is a set which admits a bijection onto a subset of N so that
  ﬁnite sets are countable;
• all group actions are left actions;
• all rings are assumed to be associative (but not necessarily commutative)
  with a unity element;
• a ﬁeld is a nonzero commutative ring in which each nonzero element is
  invertible.




                                                                           xix
Chapter 1
Cellular Automata




In this chapter we introduce the notion of a cellular automaton. We ﬁx a
group and an arbitrary set which will be called the alphabet. A conﬁgura-
tion is deﬁned as being a map from the group into the alphabet. Thus, a
conﬁguration is a way of attaching an element of the alphabet to each el-
ement of the group. There is a natural action of the group on the set of
conﬁgurations which is called the shift action (see Sect. 1.1). A cellular au-
tomaton is a self-mapping of the set of conﬁgurations deﬁned from a system
of local rules commuting with the shift (see Deﬁnition 1.4.1). We equip the
conﬁguration set with the prodiscrete topology, that is, the topology of point-
wise convergence associated with the discrete topology on the alphabet (see
Sect. 1.2). It turns out that every cellular automaton is continuous with re-
spect to the prodiscrete topology (Proposition 1.4.8) and commutes with the
shift (Proposition 1.4.4). Conversely, when the alphabet is ﬁnite, every con-
tinuous self-mapping of the conﬁguration space which commutes with the
shift is a cellular automaton (Theorem 1.8.1). Another important fact in the
ﬁnite alphabet case is that every bijective cellular automaton is invertible, in
the sense that its inverse map is also a cellular automaton (Theorem 1.10.2).
We give examples showing that, when the alphabet is inﬁnite, a continuous
self-mapping of the conﬁguration space which commutes with the shift may
fail to be a cellular automaton and a bijective cellular automaton may fail
to be invertible. In Sect. 1.9, we introduce the prodiscrete uniform structure
on the conﬁguration space. We show that a self-mapping of the conﬁguration
space is a cellular automaton if and only if it is uniformly continuous and
commutes with the shift (Theorem 1.9.1).



1.1 The Conﬁguration Set and the Shift Action

Let G be a group. For g ∈ G, denote by Lg the left multiplication by g in G,
that is, the map Lg : G → G given by

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,        1
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 1, © Springer-Verlag Berlin Heidelberg 2010
2                                                                              1 Cellular Automata

                                 Lg (g  ) = gg    for all g  ∈ G.

    Observe that for all g1 , g2 , g  ∈ G one has

        (Lg1 ◦ Lg2 ) (g  ) = Lg1 (Lg2 (g  )) = Lg1 (g2 g  ) = g1 g2 g  = Lg1 g2 (g  )

which shows that
                                       Lg 1 ◦ L g 2 = Lg 1 g 2 .                             (1.1)
    Let A be a set. Consider the set AG consisting of all maps from G to A:
                               
                         AG =      A = {x : G → A}.
                                         g∈G

   The set A is called the alphabet. The elements of A are called the letters, or
the states, or the symbols, or the colors. The group G is called the universe.
The set AG is called the set of conﬁgurations.
   Given an element g ∈ G and a conﬁguration x ∈ AG , we deﬁne the con-
ﬁguration gx ∈ AG by
                                 gx = x ◦ Lg−1 .                            (1.2)
Thus one has
                            gx(g  ) = x(g −1 g  )    for all g  ∈ G.
    The map

                                         G × AG → AG
                                           (g, x) → gx


is a left action of G on AG . Indeed, for all g1 , g2 ∈ G and x ∈ AG , one has

    g1 (g2 x) = g1 (x ◦ Lg−1 ) = x ◦ Lg−1 ◦ Lg−1 = x ◦ Lg−1 g−1 = x ◦ L(g1 g2 )−1
                             2                 2       1               2   1

             = (g1 g2 )x,

where the third equality follows from (1.1). Also, denoting by 1G the identity
element of G and by IdG : G → G the identity map, one has

                                 1G x = x ◦ L1G = x ◦ IdG = x.

This left action of G on AG is called the G-shift on AG .
  A pattern over the group G and the alphabet A is a map p : Ω → G deﬁned
on some ﬁnite subset Ω of G. The set Ω is then called the support of p.
1.3 Periodic Conﬁgurations                                                   3

1.2 The Prodiscrete Topology

Let G be a group and let A be a set.
   We equip each factor A of AG with the discrete topology (all subsets of
A are open) and AG with the associated product topology (see Sect. A.4).
This topology is called the prodiscrete topology on AG . This is the small-
est topology on AG for which the projection map πg : AG → A, given by
πg (x) = x(g), is continuous for every g ∈ G (cf. Sect. A.4). The elementary
cylinders

         C(g, a) = πg−1 ({a}) = {x ∈ AG : x(g) = a} (g ∈ G, a ∈ A)

are both open and closed in AG . A subset U ⊂ AG is open if and only if
U can be expressed as a (ﬁnite or inﬁnite) union of ﬁnite intersections of
elementary cylinders.
   For a subset Ω ⊂ G and a conﬁguration x ∈ AG let x|Ω ∈ AΩ denote the
restriction of x to Ω, that is, the map x|Ω : Ω → A deﬁned by x|Ω (g) = x(g)
for all g ∈ Ω.
   If x ∈ AG , a neighborhood base of x is given by the sets
                                                  
              V (x, Ω) = {y ∈ AG : x|Ω = y|Ω } =     C(g, x(g)),       (1.3)
                                                  g∈Ω

where Ω runs over all ﬁnite subsets of G.
Proposition 1.2.1. The space AG is Hausdorﬀ and totally disconnected.
Proof. The discrete topology on A is Hausdorﬀ and totally disconnected,
and, by Proposition A.4.1 and Proposition A.4.2, a product of Hausdorﬀ
(resp. totally disconnected) topological spaces is Hausdorﬀ (resp. totally dis-
connected).
   Recall that an action of a group G on a topological space X is said to be
continuous if the map ϕg : X → X given by ϕg (x) = gx is continuous on X
for each g ∈ G.
Proposition 1.2.2. The action of G on AG is continuous.
Proof. Let g ∈ G and consider the map ϕg : AG → AG deﬁned by ϕg (x) = gx.
The map πh ◦ϕg is equal to πg−1 h and is therefore continuous on AG for every
h ∈ G. Consequently, ϕg is continuous (cf. Sect. A.4).



1.3 Periodic Conﬁgurations

Let G be a group and let A be a set. Let H be a subgroup of G. A conﬁguration
x ∈ AG is called H-periodic if x is ﬁxed by H, that is, if one has
4                                                               1 Cellular Automata

                            hx = x      for all h ∈ H.

Let Fix(H) denote the subset of AG consisting of all H-periodic conﬁgura-
tions.
Examples 1.3.1. (a) One has Fix({1G }) = AG .
    (b) The set Fix(G) consists of all constant conﬁgurations and may be
therefore identiﬁed with A.
    (c) For G = Z and H = nZ, n ≥ 1, the set Fix(H) is the set of sequences
x : Z → A which admit n as a (not necessarily minimal) period, that is, such
that x(i + n) = x(i) for all i ∈ Z.
Proposition 1.3.2. Let H be a subgroup of G. Then the set Fix(H) is closed
in AG for the prodiscrete topology.
Proof. We have                     
                       Fix(H) =         {x ∈ AG : hx = x}.                    (1.4)
                                  h∈H

The space AG is Hausdorﬀ by Proposition 1.2.1 and the action of G on AG
is continuous by Proposition 1.2.2. Thus the set of ﬁxed points of the map
x → gx is closed in AG for each g ∈ G. Therefore Fix(H) is closed in AG
by (1.4).
   Consider the set H\G = {Hg : g ∈ G} consisting of all right cosets of H
in G and the canonical surjective map

                                  ρ : G → H\G
                                      g → Hg.

Given an element y ∈ AH\G , i.e., a map y : H\G → A, we can form the
composite map y ◦ ρ : G → A which is an element of AG . In fact, we have
y ◦ ρ ∈ Fix(H) since

        (h(y ◦ ρ))(g) = y ◦ ρ(h−1 g) = y(ρ(h−1 g)) = y(ρ(g)) = y ◦ ρ(g)

for all g ∈ G and h ∈ H.
Proposition 1.3.3. Let H be a subgroup of G and let denote by ρ : G →
H\G the canonical surjection. Then the map ρ∗ : AH\G → Fix(H) deﬁned by
ρ∗ (y) = y ◦ ρ for all y ∈ AH\G is bijective.
Proof. If y1 , y2 ∈ AH\G satisfy y1 ◦ρ = y2 ◦ρ, then y1 = y2 since ρ is surjective.
Thus ρ∗ is injective.
  If x ∈ Fix(H), then hx = x for all h ∈ H, that is,

                    x(h−1 g) = x(g)     for all h ∈ H, g ∈ G.

Thus, the conﬁguration x is constant on each right coset of G modulo H,
that is, x is in the image of ρ∗ . This shows that ρ∗ is surjective.
1.3 Periodic Conﬁgurations                                                5

Corollary 1.3.4. If the set A is ﬁnite and H is a subgroup of ﬁnite index
of G, then the set Fix(H) is ﬁnite and one has | Fix(H)| = |A|[G:H] , where
[G : H] denotes the index of H in G.

Example 1.3.5. Let G = Z and H = nZ, where n ≥ 1. If A is ﬁnite of
cardinality k, then | Fix(H)| = kn .

   Suppose now that N is a normal subgroup of G, that is, gN = N g for all
g ∈ G. Then, there is a natural group structure on G/N = N \G for which
the canonical surjection ρ : G → G/N is a homomorphism.

Proposition 1.3.6. Let N be a normal subgroup of G. Then Fix(N ) is a
G-invariant subset of AG .

Proof. Let x ∈ Fix(N ) and g ∈ G. Given h ∈ N , then there exists h ∈ N
such that hg = gh , since N is normal in G. Thus, we have

                               h(gx) = g(h x) = gx

which shows that gx ∈ Fix(N ).

Since every element of Fix(N ) is ﬁxed by N , the action of G on Fix(N )
induces an action of G/N on Fix(N ) which satisﬁes ρ(g)x = gx for all g ∈ G
and x ∈ Fix(N ).
   Suppose that a group Γ acts on two sets X and Y . A map ϕ : X → Y is
called Γ -equivariant if one has ϕ(γx) = γϕ(x) for all γ ∈ Γ and x ∈ X.

Proposition 1.3.7. Let N be a normal subgroup of G and let ρ : G → G/N
denote the canonical epimorphism. Then the map ρ∗ : AG/N → Fix(N ) de-
ﬁned by ρ∗ (y) = y ◦ ρ for all y ∈ AG/N is a G/N -equivariant bijection.

Proof. We already know that ρ∗ is bijective (Proposition 1.3.3).
  Let g ∈ G and y ∈ AG/N . For all g  ∈ G, we have

                        ρ(g)ρ∗ (y)(g  ) = gρ∗ (y)(g  )
                                        = ρ∗ (y)(g −1 g  )
                                        = (y ◦ ρ)(g −1 g  )
                                        = y(ρ(g −1 g  ))
                                        = y((ρ(g))−1 ρ(g  ))
                                        = ρ(g)y(ρ(g  ))
                                        = ρ∗ (ρ(g)y)(g  ).

Thus ρ(g)ρ∗ (y) = ρ∗ (ρ(g)y). This shows that ρ∗ is G/N -equivariant.
6                                                            1 Cellular Automata

1.4 Cellular Automata

Let G be a group and let A be a set.

Deﬁnition 1.4.1. A cellular automaton over the group G and the alphabet
A is a map τ : AG → AG satisfying the following property: there exist a ﬁnite
subset S ⊂ G and a map μ : AS → A such that

                            τ (x)(g) = μ((g −1 x)|S )                      (1.5)

for all x ∈ AG and g ∈ G, where (g −1 x)|S denotes the restriction of the
conﬁguration g −1 x to S.
   Such a set S is called a memory set and μ is called a local deﬁning map
for τ .

Observe that formula (1.5) says that the value of the conﬁguration τ (x) at an
element g ∈ G is the value taken by the local deﬁning map μ at the pattern
obtained by restricting to the memory set S the shifted conﬁguration g −1 x.

Remark 1.4.2. (a) Equality (1.5) may also be written

                           τ (x)(g) = μ((x ◦ Lg )|S )                      (1.6)

by (1.2).
  (b) For g = 1G , formula (1.5) gives us

                              τ (x)(1G ) = μ(x|S ).                        (1.7)

As the restriction map AG → AS , x → x|S , is surjective, this shows that if
S is a memory set for the cellular automaton τ , then there is a unique map
μ : AS → A which satisﬁes (1.5). Thus one says that this unique μ is the local
deﬁning map for τ associated with the memory set S.

Examples 1.4.3. (a) The cellular automaton associated with the Game
of Life. Consider an inﬁnite two-dimensional orthogonal grid of square cells,
each of which is in one of two possible states, live or dead. Every cell c
interacts with its eight neighboring cells, namely the North, North-East, East,
South-East, South, South-West, West and North-West cells (see Fig. 1.1).
   At each step in time, the following rules for the evolution of the states of
the cells are applied (in Figs. 1.2–1.5 we label with a “•” a live cell and with
a “◦” a dead cell):

• (birth): a cell that is dead at time t becomes alive at time t + 1 if and
  only if three of its neighbors are alive at time t (cf. Fig. 1.2);
• (survival): a cell that is alive at time t will remain alive at time t + 1
  if and only if it has exactly two or three live neighbors at time t (cf.
  Fig. 1.3);
1.4 Cellular Automata                                                                      7




Fig. 1.1 The cell c and its eight neighboring cells




Fig. 1.2 A cell that is dead at time t becomes alive at time t + 1 if and only if three of
its neighbors are alive at time t




Fig. 1.3 A cell that is alive at time t will remain alive at time t + 1 if and only if it has
exactly two or three live neighbors at time t
8                                                                     1 Cellular Automata




Fig. 1.4 A live cell that has at most one live neighbor at time t will be dead at time t + 1



• (death by loneliness): a live cell that has at most one live neighbor at
  time t will be dead at time t + 1 (cf. Fig. 1.4);
• (death by overcrowding): a cell that is alive at time t and has four or
  more live neighbors at time t, will be dead at time t + 1 (cf. Fig. 1.5).




Fig. 1.5 A cell that is alive at time t and has four or more live neighbors at time t, will
be dead at time t + 1



   Let us show that the map which transforms a conﬁguration of cells at time
t into the conﬁguration at time t + 1 according to the above rules is indeed
a cellular automaton.
   Consider the group G = Z2 and the ﬁnite set S = {−1, 0, 1}2 ⊂ G. Then
there is a one-to-one correspondence between the cells in the grid and the
elements in G in such a way that the following holds. If c is a given cell, then
c+(0, 1) is the neighboring North cell, c+(1, 1) is the neighboring North-East
cell, and so on; in other words, c and its eight neighboring cells correspond
to the group elements c + s with s ∈ S (see Fig. 1.6).
   Consider the alphabet A = {0, 1}. The state 0 (resp. 1) corresponds to
absence (resp. presence) of life. With each conﬁguration of the states of the
cells in the grid we associate a map x ∈ AG deﬁned as follows. Given a cell c
we set x(c) = 1 (resp. 0) if the cell c is alive (resp. dead).
1.4 Cellular Automata                                                               9




Fig. 1.6 The cell c and its eight neighboring cells c + s, s ∈ S = {−1, 0, 1}2



   Consider the map μ : AS → A given by
                  ⎧       ⎧
                  ⎪
                  ⎪       ⎪
                          ⎨ s∈S y(s) = 3
                  ⎪
                  ⎨1 if     or
           μ(y) =         ⎪
                          ⎩                                                     (1.8)
                  ⎪
                  ⎪           s∈S y(s) = 4 and y((0, 0)) = 1,
                  ⎪
                  ⎩
                    0 otherwise

for all y ∈ AS .
   A moment of thought tells us that μ just expresses the rules for the Game
of Life.
   The cellular automaton τ : AG → AG with memory set S and local deﬁning
map μ is called the cellular automaton associated with the Game of Life.
   (b) The Discrete Laplacian. Let G = Z and A = R. Consider the map
Δ : RZ → RZ deﬁned by

                     Δ(x)(n) = 2x(n) − x(n − 1) − x(n + 1).

Then Δ is the cellular automaton over Z with memory set S = {−1, 0, 1}
and local deﬁning map μ : RS → R given by

                  μ(y) = 2y(0) − y(−1) − y(1)          for all y ∈ RS .

  This may be generalized in the following way. Let G be an arbitrary group
and let S be a nonempty ﬁnite subset of G. Let K be a ﬁeld. Consider the
map ΔS = ΔG  S : K → K deﬁned by
                  G     G


                          ΔS (x)(g) = |S|x(g) −            x(gs).
                                                     s∈S
10                                                               1 Cellular Automata

Then ΔS is a cellular automaton over G with memory set S ∪ {1G } and local
deﬁning map μ : KS∪{1G } → K given by

              μ(y) = |S|y(1G ) −         y(s)   for all y ∈ KS∪{1G } .
                                   s∈S

This cellular automaton is called the discrete Laplacian over K associated
with G and S.
   (c) The Majority action cellular automaton. Let G be a group and let
S be a ﬁnite subset of G. Take A = {0, 1} and consider the map τ : AG → AG
deﬁned by                    ⎧           
                             ⎪
                             ⎨1       if       x(gs) > |S|
                                         s∈S            2
                                                        |S|
                  τ (x)(g) = 0        if       x(gs) <
                             ⎪
                             ⎩           s∈S            2
                                                        |S|
                               x(g) if     s∈S x(gs) = 2

for all x ∈ AG . Then τ is a cellular automaton over G with memory set
S ∪ {1G } and local deﬁning map μ : AS∪{1G } → A given by
                          ⎧             
                          ⎪
                          ⎨1         if      y(s) > |S|
                                        s∈S         2
                                                    |S|
                    μ(y) = 0         if      y(s) <
                          ⎪
                          ⎩             s∈S         2
                                                    |S|
                            y(1G ) if    s∈S y(s) = 2


for all y ∈ AS∪{1G } .
   The cellular automaton τ is called the majority action cellular automaton
associated with G and S (see Figs. 1.7–1.8).
   The terminology comes from the fact that given x ∈ AG and g ∈ G, the
value τ (x)(g) is equal to a ∈ {0, 1} if there is a strict majority of elements
of gS at which the conﬁguration x takes the value a, or to x(g) if no such
majority exists.
   (d) Let G be a group, A a set, and f : A → A a map from A into itself.
Then the map τ : AG → AG deﬁned by τ (x) = f ◦ x is a cellular automaton
with memory set S = {1G } and local deﬁning map μ : AS → A given by
μ(y) = f (y(1G )). Note that, if f is the identity map IdA on A, then τ equals
the identity map IdAG on AG .
   (e) Let G be a group, A a set, and s0 an element of G. Let Rs0 : G → G
denote the right multiplication by s0 in G, that is, the map Rs0 : G → G
deﬁned by Rs0 (g) = gs0 . Then the map τ : AG → AG deﬁned by τ (x) =
x ◦ Rs0 is a cellular automaton with memory set S = {s0 } and local deﬁning
map μ : AS → A given by μ(y) = y(s0 ).

Proposition 1.4.4. Let G be a group and let A be a set. Then every cellular
automaton τ : AG → AG is G-equivariant.
1.4 Cellular Automata                                                              11




Fig. 1.7 The local deﬁning map μ for the majority action on Z associated with
S = {+1, −1}




Fig. 1.8 The majority action τ on Z associated with S = {+1, −1}



Proof. Let S be a memory set for τ and let μ : AS → A be the associated
local deﬁning map. For all g, h ∈ G and x ∈ AG , we have

  τ (gx)(h) = μ((h−1 gx)|S ) = μ(((g −1 h)−1 x)|S ) = τ (x)(g −1 h) = gτ (x)(h).

Thus τ (gx) = gτ (x).

Corollary 1.4.5. Let τ : AG → AG be a cellular automaton and let H be a
subgroup of G. Then one has τ (Fix(H)) ⊂ Fix(H).

Proof. Let x ∈ Fix(H). By the previous Proposition, we have, for every
h ∈ H,
                        hτ (x) = τ (hx) = τ (x).
Thus τ (x) ∈ Fix(H).

   The following characterization of cellular automata will be useful in the
sequel.
12                                                               1 Cellular Automata

Proposition 1.4.6. Let G be a group and let A be a set. Consider a map
τ : AG → AG . Let S be a ﬁnite subset of G and let μ : AS → A. Then the
following conditions are equivalent:
(a) τ is a cellular automaton admitting S as a memory set and μ as the
    associated local deﬁning map;
(b) τ is G-equivariant and one has τ (x)(1G ) = μ(x|S ) for every x ∈ AG .

Proof. The fact that (a) implies (b) follows from Proposition 1.4.4 and for-
mula (1.7)
  Conversely, suppose (b). Then, by using the G-equivariance of τ , we get

                   τ (x)(g) = τ (g −1 x)(1G ) = μ((g −1 x)|S )

for all x ∈ AG and g ∈ G. Consequently, τ satisﬁes (a).

   An important feature of cellular automata is their continuity (with respect
to the prodiscrete topology). In the proof of this property, we shall use the
following.

Lemma 1.4.7. Let G be a group and let A be a set. Let τ : AG → AG be a
cellular automaton with memory set S and let g ∈ G. Then τ (x)(g) depends
only on the restriction of x to gS.

Proof. This is an immediate consequence of (1.5) since (g −1 x)(s) = x(gs) for
all s ∈ S.

Proposition 1.4.8. Let G be a group and let A be a set. Then every cellular
automaton τ : AG → AG is continuous.

Proof. Let S be a memory set for τ . Let x ∈ AG and let W be a neigh-
borhood of τ (x) in AG . Then we can ﬁnd a ﬁnite subset Ω ⊂ G such that
(cf. equation (1.3))
                             V (τ (x), Ω) ⊂ W.
Consider the ﬁnite set ΩS = {gs : g ∈ Ω, s ∈ S}. If y ∈ AG coincide with x
on ΩS, then τ (y) and τ (x) coincide on Ω by Lemma 1.4.7. Thus, we have

                      τ (V (x, ΩS)) ⊂ V (τ (x), Ω) ⊂ W.

This shows that τ is continuous.

Proposition 1.4.9. Let G be a group and let A be a set. Let σ : AG → AG
and τ : AG → AG be cellular automata. Then the composite map σ ◦ τ : AG →
AG is a cellular automaton. Moreover, if S (resp. T ) is a memory set for σ
(resp. τ ), then ST = {st : s ∈ S, t ∈ T } is a memory set for σ ◦ τ .

Proof. It is clear that the map σ ◦ τ is G-equivariant since σ and τ are
G-equivariant (by Proposition 1.4.4). Let S (resp. T ) be a memory set for
1.4 Cellular Automata                                                                        13

σ (resp. τ ). For every x ∈ AG , we have σ ◦ τ (x)(1G ) = σ(τ (x))(1G ). By
Lemma 1.4.7, σ(τ (x))(1G ) depends only on the restriction of τ (x) to S. By
using Lemma 1.4.7 again, we deduce that, for every s ∈ S, the element τ (x)(s)
depends only on the restriction of x to sT . Therefore, σ ◦ τ (x)(1G ) depends
only on the restriction of x to ST . By applying Proposition 1.4.6, we conclude
that σ ◦ τ is a cellular automaton admitting ST as a memory set.

Remark 1.4.10. With the hypotheses and notation of the previous proposi-
tion, denote by μ : AS → A and ν : AT → A the local deﬁning maps for σ
and τ , respectively. Then, the local deﬁning map κ : AST → A for σ ◦ τ may
be described in the following way.
   For y ∈ AST and s ∈ S deﬁne ys ∈ AT by setting ys (t) = y(st) for all
t ∈ T . Also, denote by y ∈ AS the map deﬁned by y(s) = ν(ys ) for all s ∈ S.
We ﬁnally deﬁne the map κ : AST → A by setting

                                     κ(y) = μ(y)                                           (1.9)

for all y ∈ AST .
   Let x ∈ AG , g ∈ G, s ∈ S, and t ∈ T . We then have

                        (s−1 g −1 x)|T (t) = s−1 g −1 x(t)
                                          = g −1 x(st)
                                          = (g −1 x)|ST (st)
                                          = (g −1 x)|ST      s
                                                                 (t).

This shows that
                           (s−1 g −1 x)|T = (g −1 x)|ST       s

and therefore

     τ (g −1 x)(s) = ν (s−1 g −1 x)|T = ν       (g −1 x)|ST       s
                                                                      = (g −1 x)|ST (s).

As a consequence,
                              τ (g −1 x)|S = (g −1 x)|ST .                            (1.10)
Finally, one has

                          (σ ◦ τ )(x)(g) = σ(τ (x))(g)
                                         = μ (g −1 τ (x))|S
                                         = μ(τ (g −1 x)|S )                           (1.11)
                          (by (1.10)) = μ((g −1 x)|ST )
                           (by (1.9)) = κ (g −1 x)|ST .

  Recall that a monoid is a set equipped with an associative binary operation
admitting an identity element. Denote by CA(G; A) the set consisting of all
14                                                              1 Cellular Automata

cellular automata τ : AG → AG . In Example 1.4.3(d) we have seen that the
identity map IdAG : AG → AG is a cellular automaton. Thus we have:

Corollary 1.4.11. The set CA(G; A) is a monoid for the composition of
maps.



1.5 Minimal Memory

Let G be a group and let A be a set. Let τ : AG → AG be a cellular automaton.
Let S be a memory set for τ and let μ : AS → A be the associated deﬁning
map. If S  is a ﬁnite subset of G such that S ⊂ S  , then S  is also a memory set
                                                                             
for τ and the local deﬁning map associated with S  is the map μ : AS → A
                                  
given by μ = μ◦p, where p : AS → AS is the canonical projection (restriction
map). This shows that the memory set of a cellular automaton is not unique
in general. However, we shall see that every cellular automaton admits a
unique memory set of minimal cardinality. Let us ﬁrst establish the following
result.

Lemma 1.5.1. Let τ : AG → AG be a cellular automaton. Let S1 and S2 be
memory sets for τ . Then S1 ∩ S2 is also a memory set for τ .

Proof. Let x ∈ AG . Let us show that τ (x)(1G ) depends only on the restriction
of x to S1 ∩ S2 . To see this, consider an element y ∈ AG such that x|S1 ∩S2 =
y|S1 ∩S2 . Let us choose an element z ∈ AG such that z|S1 = x|S1 and z|S2 =
y|S2 (we may take for instance the conﬁguration z ∈ AG which coincides with
x on S1 and with y on G \ S1 ). We have τ (x)(1G ) = τ (z)(1G ) since x and
z coincide on S1 , which is a memory set for τ . On the other hand, we have
τ (y)(1G ) = τ (z)(1G ) since y and z coincide on S2 , which is also a memory
set for τ . It follows that τ (x)(1G ) = τ (y)(1G ).
   Thus there exists a map μ : AS1 ∩S2 → A such that

                   τ (x)(1G ) = μ(x|S1 ∩S2 )   for all x ∈ AG .

As τ is G-equivariant (Proposition 1.4.4), we deduce that S1 ∩S2 is a memory
set for τ by using Proposition 1.4.6.

Proposition 1.5.2. Let τ : AG → AG be a cellular automaton. Then there
exists a unique memory set S0 ⊂ G for τ of minimal cardinality. Moreover,
if S is a ﬁnite subset of G, then S is a memory set for τ if and only if
S0 ⊂ S.

Proof. Let S0 be a memory set for τ of minimal cardinality. As we have seen
at the beginning of this section, every ﬁnite subset of G containing S0 is also
a memory set for τ . Conversely, let S be a memory set for τ . As S ∩ S0 is
a memory set for τ by Lemma 1.5.1, we have |S ∩ S0 | ≥ |S0 |. This implies
1.6 Cellular Automata over Quotient Groups                                 15

S ∩ S0 = S0 , that is, S0 ⊂ S. In particular, S0 is the unique memory set of
minimal cardinality.

   The memory set of minimal cardinality of a cellular automaton is called
its minimal memory set.

Remark 1.5.3. A map F : AG → AG is constant if there exists a conﬁguration
x0 ∈ AG such that F (x) = x0 for all x ∈ AG . By G-equivariance, a cellular
automaton τ : AG → AG is constant if and only if there exists a ∈ A such
that τ (x)(g) = a for all x ∈ AG and g ∈ G. Observe that a cellular automaton
τ : AG → AG is constant if and only if its minimal memory set is the empty
set.



1.6 Cellular Automata over Quotient Groups

Let G be a group and let A be a set. Let τ : AG → AG be a cellular au-
tomaton. Suppose that N is a normal subgroup of G and let ρ : G → G/N
denote the canonical epimorphism. It follows from Proposition 1.3.7 that the
map ρ∗ : AG/N → Fix(N ), deﬁned by ρ∗ (y) = y ◦ ρ for all y ∈ AG/N , is a
bijection from the set AG/N of conﬁgurations over the group G/N onto the
set Fix(N ) ⊂ AG of N -periodic conﬁgurations over G. On the other hand,
the set Fix(N ) satisﬁes τ (Fix(N )) ⊂ Fix(N ) by Corollary 1.4.5. Thus, we
can deﬁne a map τ : AG/N → AG/N by setting

                           τ = (ρ∗ )−1 ◦ τ |Fix(N ) ◦ ρ∗ .             (1.12)

In other words, the map τ is obtained by conjugating by ρ∗ the restriction of
τ to Fix(N ), so that the diagram
                                    ρ∗
                         AG/N −−−−→ Fix(N ) ⊂ AG
                          ⏐              ⏐
                          ⏐              ⏐τ |
                           τ                          Fix(N )


                         AG/N −−−∗−→           Fix(N )
                                    ρ

is commutative.
   Suppose that S ⊂ G is a memory set for τ and that μ : AS → A is the
associated local deﬁning map. Consider the ﬁnite subset S = ρ(S) ⊂ G/N
and the map μ : AS → A deﬁned by μ = μ ◦ π, where π : AS → AS is the
injective map induced by ρ.

Proposition 1.6.1. The map τ : AG/N → AG/N is a cellular automaton over
the group G/N admitting S as a memory set and μ : AS → A as the associated
local deﬁning map.
16                                                        1 Cellular Automata

Proof. Let y ∈ AG/N , g ∈ G, and g = ρ(g). We have

                        τ (y)(g) = τ (y ◦ ρ)(g)
                                = μ((g −1 (y ◦ ρ))|S )
                                = μ((g −1 y)|S ).

Thus τ is a cellular automaton with memory set S and local deﬁning map
μ : AS → A.

  Consider now the map Φ : CA(G; A) → CA(G/N ; A) given by Φ(τ ) = τ ,
where τ is deﬁned by (1.12). We have the following:

Proposition 1.6.2. The map Φ : CA(G; A) → CA(G/N ; A) is a monoid epi-
morphism.

Proof. Let σ : AG/N → AG/N be a cellular automaton over G/N with mem-
ory set T ⊂ G/N and local deﬁning map ν : AT → A. Let S ⊂ G be a ﬁnite
set such that ρ induces a bijection φ : S → T . Consider the map μ : AS → A
deﬁned by μ(y) = ν(y ◦ φ−1 ) for all y ∈ AS . Let τ : AG → AG be the cellular
automaton over G with memory set S and local deﬁning map μ. We have

                 μ(z) = (μ ◦ π)(z) = ν(π(z) ◦ φ−1 ) = ν(z)

for all z ∈ AS . It follows that μ = ν and τ = σ. This shows that Φ is
surjective.
   The fact that Φ is a monoid morphism immediately follows from (1.12).


Examples 1.6.3. Let G be a group, S ⊂ G a ﬁnite subset, and N a normal
subgroup of G. Denote by ρ : G → G/N the canonical epimorphism and
suppose that ρ induces a bijection between S and S = ρ(S) ⊂ G/N .
   (a) Consider the discrete laplacian ΔS : RG → RG associated with G and S
(cf. Example 1.4.3(b)). Then Φ(ΔS ) : RG/N → RG/N is the discrete laplacian
associated with G/N and S.
   (b) Consider the majority action cellular automaton τ : {0, 1}G → {0, 1}G
associated with G and S (cf. Example 1.4.3(c)). Then Φ(τ ) : {0, 1}G/N →
{0, 1}G/N is the majority action cellular automaton associated with G/N
and S.



1.7 Induction and Restriction of Cellular Automata

Let G be a group and let A be a set. Let H be a subgroup of G.
  Let CA(G, H; A) denote the set consisting of all cellular automata τ : AG →
A admitting a memory set S such that S ⊂ H. Thus, CA(G, H; A) is the
 G
1.7 Induction and Restriction of Cellular Automata                                  17

subset of CA(G; A) consisting of the cellular automata whose minimal mem-
ory set is contained in H.
   Recall that a subset N of a monoid M is called a submonoid if the identity
element 1M is in N and N is stable under the monoid operation (that is,
xy ∈ N for all x, y ∈ N ). If N is a submonoid of a monoid M , then the
monoid operation induces by restriction a monoid structure on N .

Proposition 1.7.1. The set CA(G, H; A) is a submonoid of CA(G; A).

Proof. The identity element of CA(G; A) is the identity map IdAG . We have
IdAG ∈ CA(G, H; A) since {1G } is a memory set for IdAG and {1G } ⊂ H.
Let σ, τ ∈ CA(G, H; A). Let S (resp. T ) be a memory set for σ (resp. τ ) such
that S ⊂ H (resp. T ⊂ H). It follows from Proposition 1.4.9 that ST is a
memory set for σ ◦ τ . Since ST ⊂ H, this implies that σ ◦ τ ∈ CA(G, H; A).
This shows that CA(G, H; A) is a submonoid of CA(G; A).

   Let τ ∈ CA(G, H; A). Let S be a memory set for τ such that S ⊂ H
and let μ : AS → A denote the associated local deﬁning map. Then, the map
τH : AH → AH deﬁned by

               τH (x)(h) = μ((h−1 x)|S )      for all x ∈ AH , h ∈ H,

is a cellular automaton over the group H with memory set S and local deﬁning
map μ. Observe that if x  ∈ AG is such that x
                                             |H = x, then

                      τH (x)(h) = τ (
                                     x)(h)      for all h ∈ H.                   (1.13)

This shows in particular that τH does not depend on the choice of the memory
set S ⊂ H. One says that τH is the restriction of the cellular automaton τ
to H.
   Conversely, let σ : AH → AH be a cellular automaton with memory set S
and local deﬁning map μ : AS → A. Then the map σ G : AG → AG deﬁned by

                    x)(g) = μ((g −1 x
               σ G (               )|S )             ∈ AG , g ∈ G,
                                              for all x

is a cellular automaton over G with memory set S and local deﬁning map
μ. If S0 is the minimal memory set of σ and μ0 : AS0 → A is the associated
local deﬁning map then μ = μ0 ◦ π, where π : AS → AS0 is the restriction
map (see Sect. 1.5). Thus, one has

              x)(g) = μ((g −1 x
         σ G (               )|S ) = μ0 ◦ π((g −1 x
                                                    )|S ) = μ0 ((g −1 x
                                                                       )|S0 )

         ∈ AG and g ∈ G. This shows in particular that σ G does not depend
for all x
on the choice of the memory set S ⊂ H. One says that σ G ∈ CA(G, H; A) is
the cellular automaton induced by σ ∈ CA(H; A).

Proposition 1.7.2. The map τ → τH is a monoid isomorphism from
CA(G, H; A) onto CA(H; A) whose inverse is the map σ → σ G .
18                                                           1 Cellular Automata

Proof. To simplify notation, denote by α : CA(G, H; A) → CA(H; A) and
β : CA(H; A) → CA(G, H; A) the maps deﬁned by α(τ ) = τH and β(σ) = σ G
respectively. It is clear from the deﬁnitions given above that β ◦ α and α ◦ β
are the identity maps. Therefore, α is bijective with inverse β.
   It remains to show that α is a monoid homomorphism.
   Let x ∈ AH and let x    ∈ AG extending x. By applying (1.13), we get

                 α(IdAG )(x)(h) = IdAG (       (h) = x(h)
                                        x)(h) = x

for all h ∈ H. This shows that α(IdAG )(x) = x for all x ∈ AH , that is,
α(IdAG ) = IdAH .
   Let σ, τ ∈ CA(G, H; A). Let x ∈ AH and let x
                                               ∈ AG extending x. By
applying (1.13) again, we have

                 α(σ ◦ τ )(x)(h) = (σ ◦ τ )(
                                            x)(h) = σ(τ (
                                                         x))(h)           (1.14)

for all h ∈ H. On the other hand, since τ (
                                           x) extends α(τ )(x), we have

                        α(σ)(α(τ )(x))(h) = σ(τ (
                                                 x))(h)

that is,
                      (α(σ) ◦ α(τ ))(x)(h) = σ(τ (
                                                  x))(h)                  (1.15)
for all h ∈ H. From (1.14) and (1.15), we deduce that α(σ ◦ τ )(x) = (α(σ) ◦
α(τ ))(x) for all x ∈ AH , that is, α(σ ◦ τ ) = α(σ) ◦ α(τ ).
   Let τ ∈ CA(G, H; A). In order to analyze the way τ transforms a conﬁgu-
ration x  ∈ AG , we now introduce the set G/H = {gH : g ∈ G} consisting of
all left cosets of H in G. Since the cosets
                                            c ∈ G/H form a partition of G, we
have a natural identiﬁcation AG = c∈G/H Ac . With this identiﬁcation, we
have
                                x = (
                                      x|c )c∈G/H
          ∈ AG , where x
for each x              |c ∈ Ac denotes the restriction of x
                                                             to c. Observe now
that if c ∈ G/H and g ∈ c, then τ (x)(g) depends only on x    |c (this directly
follows from Lemma 1.4.7 since if S is a memory set for τ with S ⊂ H, then
gS ⊂ c). This implies that τ may be written as a product
                                      
                                τ=         τc ,                            (1.16)
                                      c∈G/H


where τc : Ac → Ac is the unique map which satisﬁes τc (
                                                        x|c ) = (τ (
                                                                    x))|c for
     ∈ AG . Note that the notation is coherent when c = H, since, in this
all x
case, τc = τH : AH → AH is the cellular automaton obtained by restriction
of τ to H.
   Given a coset c ∈ G/H and an element g ∈ c, denote by φg : H → c
the bijective map deﬁned by φg (h) = gh for all h ∈ H. Then φg induces a
bijective map φ∗g : Ac → AH given by
1.7 Induction and Restriction of Cellular Automata                                 19

                                     φ∗g (x) = x ◦ φg                         (1.17)

for all x ∈ Ac . It turns out that the maps τc and τH are conjugate by φ∗g :

Proposition 1.7.3. With the above notation, we have,

                              τc = (φ∗g )−1 ◦ τH ◦ φ∗g .                      (1.18)

In other words, the following diagram
                                            τ
                                 Ac −−−c−→ Ac
                                   ⏐       ⏐
                                φ∗
                                   ⏐       ⏐φ∗
                                 g                      g


                                 AH −−−−→ AH
                                           τH

is commutative.

Proof. Let x ∈ Ac and let x
                           ∈ AG extending x. For all h ∈ H, we have

                        (φ∗g ◦ τc )(x)(h) = φ∗g (τc (x))(h)
                                            = (τc (x) ◦ φg )(h)
                                            = τc (x)(gh)
                                            = τ (
                                                 x)(gh)
                                            = g −1 τ (
                                                      x)(h)
                                            = τ (g −1 x
                                                      )(h),


where the last equality follows from the G-equivariance of τ (Proposition
1.4.4). Now observe that the conﬁguration g −1 x
                                                ∈ AG extends x ◦ φg ∈ AH .
Thus, we have

     (φ∗g ◦ τc )(x)(h) = τH (x ◦ φg )(h) = τH (φ∗g (x))(h) = (τH ◦ φ∗g )(x)(h).

This shows that φ∗g ◦ τc = τH ◦ φ∗g , which gives (1.18) since φ∗g is bijective.

   The following statement will be used in the proof of Proposition 3.2.1:

Proposition 1.7.4. Let G be a group and let A be a set. Let H be a sub-
group of G and let τ ∈ CA(G, H; A). Let τH : AH → AH denote the cellular
automaton obtained by restriction of τ to H. Then the following hold:
  (i) τ is injective if and only if τH is injective;
 (ii) τ is surjective if and only if τH is surjective;
(iii) τ is bijective if and only if τH is bijective.
20                                                              1 Cellular Automata

Proof. It immediately follows from (1.16) that τ is injective (resp. surjective,
resp. bijective) if and only if τc is injective (resp. surjective, resp. bijective)
for all c ∈ G/H.
   Now, (1.18) says that, given c ∈ G/H and g ∈ G, the map τc and τH are
conjugate by the bijection φg . We deduce that τc is injective (resp. surjective,
resp. bijective) if and only if τH is injective (resp. surjective, resp. bijective).
   Thus, τ is injective (resp. surjective, resp. bijective) if and only if τH is
injective (resp. surjective, resp. bijective).



1.8 Cellular Automata with Finite Alphabets

Let G be a group and let A be a ﬁnite alphabet. As a product of ﬁnite spaces
is compact by Tychonoﬀ theorem (see Corollary A.5.3), it follows that AG
is compact. This topological property is very useful in the study of cellular
automata over ﬁnite alphabets. In particular, it may be used to prove the
following:

Theorem 1.8.1 (Curtis-Hedlund theorem). Let G be a group and let A
be a ﬁnite set. Let τ : AG → AG be a map and equip AG with its prodiscrete
topology. Then the following conditions are equivalent:
(a) the map τ is a cellular automaton;
(b) the map τ is continuous and G-equivariant.

Proof. The fact that (a) implies (b) directly follows from Proposition 1.4.4
and Proposition 1.4.8 (this implication does not require the ﬁniteness as-
sumption on the alphabet A).
   Conversely, suppose (b). Let us show that τ is a cellular automaton. As
the map ϕ : AG → A deﬁned by ϕ(x) = τ (x)(1G ) is continuous, we can ﬁnd,
for each x ∈ AG , a ﬁnite subset Ωx ⊂ G such that if y ∈ AG coincide with x
on Ωx , that is, if y ∈ V (x, Ωx ), then τ (y)(1G ) = τ (x)(1G ). The sets V (x, Ωx )
form an open cover of AG . As AG is compact, there is a ﬁnite subset F ⊂ AG
such that the sets V (x, Ωx ), x ∈ F , cover AG . Let us set S = ∪x∈F Ωx and
suppose that two conﬁgurations y, z ∈ AG coincide on S. Let x0 ∈ F be
such that y ∈ V (x0 , Ωx0 ), that is, y|Ωx0 = x0 |Ωx0 . As S ⊃ Ωx0 we have
y|Ωx0 = z|Ωx0 and therefore τ (y)(1G ) = τ (x0 )(1G ) = τ (z)(1G ). Thus there
is a map μ : AS → A such that τ (x)(1G ) = μ(x|S ) for all x ∈ AG . As τ is
G-equivariant, it follows from Proposition 1.4.6 that τ is a cellular automaton
with memory set S and local deﬁning map μ.

    When the alphabet A is inﬁnite, a continuous and G-equivariant map
τ : AG → AG may fail to be a cellular automaton. In other words, the impli-
cation (b) ⇒ (a) in Theorem 1.8.1 becomes false if we suppress the ﬁniteness
hypothesis on A. This is shown by the following example.
1.8 Cellular Automata with Finite Alphabets                                 21

Example 1.8.2. Let G be an arbitrary inﬁnite group and take A = G as the
alphabet set. To avoid confusion, we denote by g · h the product of two
elements g and h in G. Consider the map τ : AG → AG deﬁned by

                               τ (x)(g) = x(g · x(g))

for all x ∈ AG and g ∈ G.
   Given x ∈ AG and g, h ∈ G we have

                       g(τ (x))(h) = τ (x)(g −1 · h)
                                   = x(g −1 · h · x(g −1 · h))
                                   = x(g −1 · h · [gx](h))
                                   = gx(h · [gx](h))
                                   = τ (gx)(h).

This shows that g(τ (x)) = τ (gx) for all x ∈ AG and g ∈ G. Therefore, τ is
G-equivariant.
    Moreover, τ is continuous. Indeed, given x ∈ AG and a ﬁnite set K ⊂ G,
let us show that there exists a ﬁnite set F ⊂ G such that, if y ∈ AG and
y ∈ V (x, F ), then τ (y) ∈ V (τ (x), K). Set F = K ∪ {k · x(k) : k ∈ K}. Then,
if y ∈ V (x, F ), then, for all k ∈ K one has

         τ (x)(k) = x(k · x(k)) = y(k · x(k)) = y(k · y(k)) = τ (y)(k).

This shows that τ (y) ∈ V (τ (x), K). Thus, τ is continuous.
   However, τ is not a cellular automaton. Indeed, ﬁx g0 ∈ G \ {1G } and, for
all g ∈ G, consider the conﬁgurations xg and yg in AG deﬁned by
                                   ⎧
                                   ⎪
                                   ⎨g     if h = 1G
                         xg (h) = g0      if h = g
                                   ⎪
                                   ⎩
                                     1G otherwise

and                                 
                                     g        if h = 1G
                           yg (h) =
                                     1G       otherwise
for all h ∈ G.
   Note that xg |G\{g} = yg |G\{g} . Let F ⊂ G be a ﬁnite set and choose
g ∈ G \ F (this is possible because G is inﬁnite). Then one has xg |F = yg |F
while
                    τ (xg )(1G ) = xg (xg (1G )) = xg (g) = g0
and
                     τ (yg )(1G ) = yg (yg (1G )) = yg (g) = 1G ,
22                                                           1 Cellular Automata

so that τ (xg )(1G ) = τ (yg )(1G ). It follows that there is no ﬁnite set F ⊂ G
such that, for all x ∈ AG , the value of τ (x) at 1G only depends on the values
of x|F . This shows that τ is not a cellular automaton (cf. Remark 1.4.2(b)).



1.9 The Prodiscrete Uniform Structure

Let G be a group and let A be a set. The prodiscrete uniform structure on
AG is the product uniform structure obtained by taking the discrete uniform
structure on each factor A of AG = g∈G A (see Appendix B for deﬁnition
and basic facts about uniform structures).
   A base of entourages for the prodiscrete uniform structure on AG is given
by the sets WΩ ⊂ AG × AG , where

                    WΩ = {(x, y) ∈ AG × AG : x|Ω = y|Ω }                  (1.19)

and Ω runs over all ﬁnite subsets of G.
  Observe that, using the notation introduced in (1.3), we have

                      V (x, Ω) = {y ∈ AG : (x, y) ∈ WΩ }

for all x ∈ AG .
   The following statement gives a global characterization of cellular au-
tomata in terms of the prodiscrete uniform structure and the G-shift on
AG .

Theorem 1.9.1. Let A be a set and let G be a group. Let τ : AG → AG be a
map and equip AG with its prodiscrete uniform structure. Then the following
conditions are equivalent:
(a) τ is a cellular automaton;
(b) τ is uniformly continuous and G-equivariant.

Proof. Suppose that τ : AG → AG is a cellular automaton. We already know
that τ is G-equivariant by Proposition 1.4.4. Let us show that τ is uniformly
continuous. Let S be a memory set for τ . It follows from Lemma 1.4.7 that if
two conﬁgurations x, y ∈ AG coincide on gS for some g ∈ G, then τ (x)(g) =
τ (y)(g). Consequently, if the conﬁgurations x and y coincide on ΩS = {gs :
g ∈ Ω, s ∈ S} for some subset Ω ⊂ G, then τ (x) and τ (y) coincide on Ω.
Observe that ΩS is ﬁnite whenever Ω is ﬁnite. Using the notation introduced
in (1.19), we deduce that

                             (τ × τ )(WΩS ) ⊂ WΩ

for every ﬁnite subset Ω of G. As the sets WΩ , where Ω runs over all ﬁnite
subsets of G, form a base of entourages for the prodiscrete uniform structure
1.9 The Prodiscrete Uniform Structure                                        23

on AG , it follows that τ is uniformly continuous. This shows that (a) implies
(b).
   Conversely, suppose that τ is uniformly continuous and G-equivariant. Let
us show that τ is a cellular automaton. Consider the subset Ω = {1G } ⊂ G.
Since τ is uniformly continuous, there exists a ﬁnite subset S ⊂ G such that
(τ ×τ )(WS ) ⊂ WΩ . This means that τ (x)(1G ) only depends on the restriction
of x to S. Thus, there is a map μ : AS → A such that

                               τ (x)(1G ) = μ(x|S )

for all x ∈ AG . Using the G-equivariance of τ , we get

           τ (x)(g) = [g −1 τ (x)](1G ) = τ (g −1 x)(1G ) = μ((g −1 x)|S )

for all x ∈ AG and g ∈ G. This shows that τ is a cellular automaton with
memory set S and local deﬁning map μ. Consequently, (b) implies (a).

   Every uniformly continuous map between uniform spaces is continuous
with respect to the associated topologies, and the converse is true when the
source space is compact (Theorem B.2.3). The topology deﬁned by the prodis-
crete uniform structure on AG is the prodiscrete topology (see Example (1)
in Sect. B.3). In the case when A is ﬁnite, the prodiscrete topology on AG
is compact by Tychonoﬀ theorem (Theorem A.5.2). Thus Theorem 1.9.1 re-
duces to the Curtis-Hedlund theorem (Theorem 1.8.1) in this case.

Remark 1.9.2. Suppose that G is countable and A is an arbitrary set. Then
the prodiscrete uniform structure (and hence the prodiscrete topology) on
AG is metrizable. To see this, choose an increasing sequence

                        ∅ = E0 ⊂ E1 ⊂ · · · ⊂ En ⊂ · · ·
                                
of ﬁnite subsets of G such that n≥0 En = G. Then the sets WEn , n ≥ 0, form
a base of entourages for the prodiscrete uniform structure on AG . Consider
now the metric d on AG deﬁned by
                          
                            0                         if x = y,
                d(x, y) =     − max{n≥0: x|En =y|En }
                            2                         if x = y.

for all x, y ∈ AG . Then we have

                 WEn = {(x, y) ∈ AG × AG : d(x, y) < 2−n+1 }

for every n ≥ 0. Consequently, d deﬁnes the prodiscrete uniform structure on
AG .

  Let G be a group and let A be a set. Let H be a subgroup of G. Let us
equip AH\G with its prodiscrete uniform structure and Fix(H) ⊂ AG with the
24                                                           1 Cellular Automata

uniform structure induced by the prodiscrete uniform structure on AG . Recall
from Proposition 1.3.7 that there is a natural bijection ρ∗ : AH\G → AG
deﬁned by ρ∗ (y) = y ◦ ρ, where ρ : G → H\G is the canonical surjection.

Proposition 1.9.3. The map ρ∗ : AH\G → Fix(H) is a uniform isomor-
phism.

Proof. For g ∈ G, let πg : AG → A and πg : AH\G → A denote the projec-
tion maps given by x → x(g) and y → y(ρ(g)) respectively. Observe that
πg ◦ ρ∗ = πg is uniformly continuous for all g ∈ G. This shows that ρ∗ is uni-
formly continuous. Similarly, the uniform continuity of (ρ∗ )−1 follows from
the fact that πg ◦ (ρ∗ )−1 = πg |Fix(H) is uniformly continuous for each g ∈ G.
Consequently, ρ∗ is a uniform isomorphism.



1.10 Invertible Cellular Automata

Let G be a group and let A be a set. One says that a cellular automaton
τ : AG → AG is invertible (or reversible) if τ is bijective and the inverse
map τ −1 : AG → AG is also a cellular automaton. This is equivalent to the
existence of a cellular automaton σ : AG → AG such that τ ◦ σ = σ ◦ τ =
IdAG . Thus, the set of invertible cellular automata over the group G and
the alphabet A is exactly the group ICA(G; A) consisting of all invertible
elements of the monoid CA(G; A).

Theorem 1.10.1. Let A be a set and let G be a group. Let τ : AG → AG be a
map and equip AG with its prodiscrete uniform structure. Then the following
conditions are equivalent:
(a) τ is an invertible cellular automaton;
(b) τ is a G-equivariant uniform automorphism of AG .

Proof. It is clear that the inverse map of a bijective G-equivariant map from
AG onto itself is also G-equivariant. Therefore, the equivalence of conditions
(a) and (b) follows from the characterization of cellular automata given in
Theorem 1.9.1.

     Bijective cellular automata over ﬁnite alphabets are always invertible:

Theorem 1.10.2. Let G be a group and let A be a ﬁnite set. Then every
bijective cellular automaton τ : AG → AG is invertible.

Proof. Let τ : AG → AG be a bijective cellular automaton. The map τ −1 is
G-equivariant since τ is G-equivariant. On the other hand, τ −1 is continuous
with respect to the prodiscrete topology by compactness of AG . Consequently,
τ −1 is a cellular automaton by Theorem 1.8.1.
1.10 Invertible Cellular Automata                                                   25

   The following example shows that Theorem 1.10.2 becomes false if we omit
the ﬁniteness hypothesis on the alphabet set A.

Example 1.10.3. Let K be a ﬁeld. Let us take as the alphabet set the ring
A = K[[t]] of all formal power series in one indeterminate t with coeﬃcients
in K. Thus, an element of A is just a sequence a = (ki )i∈N of elements of K
written in the form

                   a = k0 + k1 t + k2 t2 + k3 t3 + · · · =                ki ti ,
                                                                   i∈N
                                                                         i
and
 the addition    and multiplication of two     elements a = i∈N ki t    and b =
          i                                                   i                  i
  i∈N ki t are
              respectively   given  by  a+b  =   i∈N (ki +ki )t and ab =   i∈N ki t
with ki = i1 +i2 =i ki1 ki2 for all i ∈ N. We take G = Z. Thus, a conﬁguration
x ∈ AG is a map x : Z → K[[t]]. Consider the map τ : AG → AG deﬁned by

                           τ (x)(n) = x(n) − tx(n + 1)

for all x ∈ AG and n ∈ Z. Clearly τ is a cellular automaton admitting
S = {0, 1} as a memory set (the local deﬁning map associated with S is the
map μ : AS → A deﬁned by μ(x0 , x1 ) = x0 − tx1 for all x0 , x1 ∈ A).
   Let us show that τ is bijective. Consider the map σ : AG → AG given by

         σ(x)(n) = x(n) + tx(n + 1) + t2 x(n + 2) + t3 x(n + 3) + · · ·

for all x ∈ AG and n ∈ Z. Observe that σ(x)(n) ∈ K[[t]] is well deﬁned by
the preceding formula. In fact, if we develop x(n) ∈ K[[t]] in the form

                     x(n) =         xn,i ti        (n ∈ Z, xn,i ∈ K),
                              i∈N

then                                          ⎛                  ⎞
                                                   i
                        σ(x)(n) =             ⎝         xn+j,i−j ⎠ ti .
                                       i∈N        j=0

One immediately checks that σ ◦ τ = τ ◦ σ = IdAG . Therefore, τ is bijective
with inverse map τ −1 = σ.
   Let us show that the map σ : AG → AG is not a cellular automaton.
   Let F be a ﬁnite subset of Z and choose an integer M ≥ 0 such that
F ⊂ (−∞, M ]. Consider the conﬁguration y deﬁned by y(n) = 0 if n ≤ M
and y(n) = 1 if n ≥ M + 1, and the conﬁguration z deﬁned by z(n) = 0 for
all n ∈ Z. Then y and z coincide on F . However, the value at 0 of σ(y) is

                     σ(y)(0) = tM +1 + tM +2 + tM +3 + · · ·

while the value of σ(z) at 0 is σ(z)(0) = 0. It follows that there is no ﬁnite
subset F ⊂ Z such that σ(x)(0) only depends on the restriction of x ∈ AG
26                                                            1 Cellular Automata

to F . This shows that σ is not a cellular automaton. Consequently, τ is a
bijective cellular automaton which is not invertible.
  In the next proposition we show that invertibility is preserved under the
operations of induction and restriction.
Proposition 1.10.4. Let G be a group and let A be a set. Let H be a sub-
group of G and let τ ∈ CA(G, H; A). Let τH ∈ CA(H; A) denote the cellular
automaton obtained by restriction of τ to H. Then the following conditions
are equivalent:
(a) τ is invertible;
(b) τH is invertible.
Moreover, if τ is invertible, then τ −1 ∈ CA(G, H; A) and one has

                               (τ −1 )H = (τH )−1 .                        (1.20)

Proof. First recall from (1.16) the factorizations
                                                  
                    AG =         Ac and τ =          τc ,                  (1.21)
                           c∈G/H                      c∈G/H


where τc : Ac → Ac satisﬁes τc (
                                x|c ) = (τ (              ∈ AG .
                                            x))|c for all x
   Suppose that τ is invertible. Denote by σ ∈ CA(G; A) the inverse cellular
automaton τ −1 . It follows from (1.21) that the map τc : Ac → Ac is bijective
for each c ∈ G/H and that
                                      
                               σ=          (τc )−1 ,                    (1.22)
                                    c∈G/H


where (τc )−1 : Ac → Ac is the inverse map of τc . Let us show that σ ∈
CA(G, H; A). Let S ⊂ G be a memory set for σ. Let x   ∈ AG . It follows from
                             −1
(1.22) that (σ(x))|H = (τH ) (x|H ). Thus, we have

                σ(            x))|H (1G ) = (τH )−1 (
                  x)(1G ) = (σ(                      x|H )(1G ).

This shows that σ(  x)(1G ) only depends on x    |H . Arguing as in the proof of
Lemma 1.5.1, we deduce that S ∩ H is a memory set for σ. Indeed, sup-
pose that two conﬁgurations x     , y ∈ AG coincide on S ∩ H. Consider the
conﬁguration z ∈ A which coincide with x
                     G
                                                 on S and with y on G \ S. We
       x)(1G ) = σ(
have σ(             z )(1G ) since x  and z coincide on S. On the other hand,
we have σ(y )(1G ) = σ( z )(1G ) since y and z coincide on H. This implies
  x)(1G ) = σ(
σ(            y )(1G ). Thus, there is a map μ : AS∩H → A such that

                             σ(           x|S∩H )
                               x)(1G ) = μ(

         ∈ AG . By applying Proposition 1.4.6, it follows that S ∩ H is a
for all x
memory set for σ. Since S ∩ H ⊂ H, this shows that τ −1 = σ ∈ CA(G, H; A).
Notes                                                                        27

Moreover, it follows from (1.22) that

                           (τ −1 )H = σH = (τH )−1

which gives us (1.20).
   The equivalence (a) ⇔ (b) is then an immediate consequence of Proposi-
tion 1.7.2 which tells us that the restriction map CA(G, H; A) → CA(H; A)
is a monoid isomorphism.



Notes

Cellular automata were introduced by J. von Neumann (see [vNeu2]) who
used them to describe theoretical models of self-reproducing machines. He
ﬁrst attempted to get such models by means of partial diﬀerential equations
in R3 . Later he changed the perspective and tried to use ideas and methods
coming from robotics and electrical engineering. Eventually, in 1952, following
a suggestion of S. Ulam, his former colleague at the Los Alamos Laboratories,
he constructed a cellular automaton over the group Z2 with an alphabet con-
sisting of 29 states. He then outlined the construction of a pattern, containing
approximatively 200,000 cells, which would reproduce itself. The details were
later ﬁlled in by A.W. Burks in the 1960s [Bur].
   The branch of mathematics which is concerned with the study of the dy-
namical properties of the shift action is known as symbolic dynamics. Many
authors trace the birth of symbolic dynamics back to a paper published in
1898 by J. Hadamard [Had] in which words on two letters were used to code
geodesics on certain surfaces with negative curvature. However, as it was
pointed out by E.M. Coven and Z.W. Nitecki [CovN], Hadamard’s symbolic
description of geodesics is purely static and involves only ﬁnite words. Ac-
cording to the authors of [CovN], the beginning of symbolic dynamics should
be placed in a paper by G.A. Hedlund [Hed-1] published in 1944. Symbolic
dynamics has important applications in dynamical systems, especially in the
study of hyperbolic dynamical systems for which symbolic codings may be
obtained from Markov partitions. One of the ﬁrst examples of such an appli-
cation was the use of the properties of the Thue-Morse sequence (see Exer-
cise 3.41) by M. Morse [Mors] in 1921 to prove the existence of non-periodic
recurrent geodesics on surfaces with negative curvature. A detailed exposi-
tion of symbolic dynamics over Z may be found for example in the books by
B. Kitchens [Kit], by P. Kůrka [Kur], and by D. Lind and B. Marcus [LiM].
   In the mid-1950s, Hedlund studied the so-called shift-commuting block
maps which turn out to be exactly cellular automata over the group Z.
The Curtis-Hedlund theorem (Theorem 1.8.1), also called Curtis-Hedlund-
Lyndon’s theorem or Hedlund’s theorem, is named after Hedlund [Hed-3]
28                                                          1 Cellular Automata

who proved it in 1969. Its generalization to inﬁnite alphabets, as stated as in
Theorem 1.9.1, was proved by the authors in [CeC7].
   Cellular automata were intensely studied from the 1960s, both by pure and
applied mathematicians, under diﬀerent names such as tessellation automata,
parallel maps, cellular spaces, iterative automata, homogeneous structures,
universal spaces, and sliding block codes (cf. [LiM, Section 1.1]). In most
cases, these researches focused on cellular automata with ﬁnite alphabet over
the groups Z or Z2 (see the surveys [BanMS], [BKM], [Kar3], [Wolfr3]).
   The Game of Life was invented by the British mathematician J.H. Con-
way. This cellular automaton was described for the ﬁrst time by M. Gard-
ner [Gar-1] in the October 1970 issue of the Scientiﬁc American. From a
theoretical computer science point of view, it is important because it has the
power of a universal Turing machine, that is, anything that can be computed
algorithmically can be computed by using the Game of Life.
   In the 1980s, S. Wolfram [Wolfr1], [Wolfr2] started a systematic study and
empirical classiﬁcation of elementary cellular automata, that is, of cellular
automata over Z with alphabet A = {0, 1} and memory set S = {−1, 0, 1}.
              3
There are 2(2 ) = 256 such elementary cellular automata. Wolfram introduced
a naming scheme for them which is nowadays widely used. Each elementary
cellular automaton τ : AZ → AZ is uniquely determined by the eight bit
sequence

        μ(111)μ(110)μ(101)μ(100)μ(011)μ(010)μ(001)μ(000) ∈ A8 ,

where μ : AS → A is the associated local deﬁning map. This bit
sequence is the binary expansion of an integer in the interval [0, 255],
called the Wolfram number of τ . For example, the majority action
τ : AZ → AZ associated with S = {−1, 0, 1} (cf. Example 1.4.3(c)) is an
elementary cellular automaton. Its local deﬁning map μ gives
μ(111)μ(110)μ(101)μ(100)μ(011)μ(010)μ(001)μ(000) = 11101000 (cf. Fig.
1.7). It follows that the Wolfram number of τ is 232. Let us also mention
that the elementary cellular automaton with Wolfram number 110 was re-
cently proved computationally universal by M. Cook.
    Wolfram introduced an empirical classiﬁcation of elementary cellular au-
tomata into four classes according to the behavior of random initial conﬁgu-
rations under iterations. These are known as Wolfram classes and are deﬁned
as follows:
(W1) Almost all initial conﬁgurations lead to the same uniform ﬁxed-point
conﬁguration,
(W2) Almost all initial conﬁgurations lead to a periodic conﬁguration,
(W3) Almost all initial conﬁgurations lead to chaos,
(W4) Localized structures with complex interactions emerge.
    The survey paper [BKM] contains other dynamical classiﬁcations of cellu-
lar automata over Z with ﬁnite alphabet due to R. Gilman and to M. Hurley
and P. Kůrka.
Exercises                                                                    29

   Invertible cellular automata are used to model time-reversible processes
occurring in physics and biology. A group G is called periodic if every el-
ement g ∈ G has ﬁnite order. In [CeC11] it is shown that if G is a non-
periodic group, then for every inﬁnite set A there exists a bijective cellular
automaton τ : AG → AG which is not invertible (cf. Theorem 1.10.2 and
Example 1.10.3). It was shown by Amoroso and Patt in 1972 [Amo] that it
is decidable whether a given cellular automaton with ﬁnite alphabet over Z
is invertible. This means that there exists an algorithm which establishes,
after a ﬁnite number of steps, whether the cellular automaton correspond-
ing to a given local deﬁning map is invertible or not. On the other hand,
J. Kari [Kar1], [Kar2], [Kar3] proved that the similar problem for cellular au-
tomata with ﬁnite alphabet over Zd , d ≥ 2, is undecidable. Its proof is based
on R. Berger’s undecidability result for the tiling problem of Wang tiles.



Exercises

1.1. An action of a group Γ on a topological space X is said to be topologically
mixing if for each pair of nonempty subsets U and V of X there exists a
ﬁnite subset F ⊂ Γ such that U ∩ γV = ∅ for all γ ∈ Γ \ F . Show that if G
is a group and A is a set then the G-shift on AG is topologically mixing for
the prodiscrete topology on AG .

1.2. Let G be a group and let A be a set. Let x ∈ AG and let Ω1 and Ω2
be two subsets of G. Show that V (x, Ω1 ∪ Ω2 ) = V (x, Ω1 ) ∩ V (x, Ω2 ) and
WΩ1 ∪Ω2 = WΩ1 ∩ WΩ2 (see (1.3) and (1.19) for the deﬁnition of V (x, Ω) and
WΩ ).

1.3. Let G be a countable group and let A be a set. Show that the metric d
on AG introduced in Remark 1.9.2 is complete.

1.4. Let G be an uncountable group and let A be a set having at least two
elements. Prove that the prodiscrete topology on AG is not metrizable. Hint:
Prove that this topology does not satisfy the ﬁrst axiom of countability.

1.5. Let G be a group. Let A and B be two sets. Let τA : AG → AG and
τB : B G → B G be cellular automata. For x ∈ (A × B)G , let xA ∈ AG and
xB ∈ B G be the conﬁgurations deﬁned by x(g) = (xA (g), xB (g)) for all
g ∈ G. Show that the map τ : (A × B)G → (A × B)G given by τ (x)(g) =
(τA (xA )(g), τB (xB )(g)) for all g ∈ G is a cellular automaton.

1.6. Let G be a group and let S be a ﬁnite subset of G of cardinality k. Let
                                                                  k
A be a ﬁnite set of cardinality n. Show that there are exactly nn cellular
automata τ : AG → AG admitting S as a memory set.
30                                                            1 Cellular Automata

1.7. Let G = Z2 and A = {0, 1}. Let τ : AG → AG denote the cellular
automaton associated with the Game of Life. Let y ∈ AG be the constant
conﬁguration deﬁned by y(g) = 1 for all g ∈ G (all cells are alive). Find a
conﬁguration x ∈ AG such that y = τ (x).

1.8. Let A be a set and suppose that G is a trivial group. Show that the
monoid CA(G; A) is canonically isomorphic to the monoid consisting of all
maps from A to A (with composition of maps as the monoid operation). Also
show that the group ICA(G; A) is canonically isomorphic to the symmetric
group of A.

1.9. Let G be a group and let A be a set. Let τ : AG → AG be a cellular
automaton. Show that τ admits a memory set which is reduced to a single
element if and only if there exist an element s ∈ G and a map f : A → A
such that one has τ (x)(g) = f (x(gs)) for all x ∈ AG and g ∈ G.

1.10. Prove that there are exactly 218 cellular automata τ : {0, 1}Z → {0, 1}Z
whose minimal memory set is {−1, 0, 1}.

1.11. Let τ ∈ CA(Z2 ; {0, 1}) denote the cellular automaton associated with
the Game of Life. Show that the minimal memory set of τ is the set
{−1, 0, 1}2 .

1.12. Let G be a group and let A be a set. Let σ, τ ∈ CA(G; A). Let S0 (resp.
T0 , resp. C0 ) denote the minimal memory set of σ (resp. τ , resp. σ ◦ τ ). Prove
that C0 ⊂ S0 T0 . Give an example showing that this inclusion may be strict.

1.13. Let G be a group and let A be a set. Let H be a subgroup of G and let
τ ∈ CA(G, H; A). Show that τ and τH have the same minimal memory set.

1.14. Prove Proposition 1.4.9 by applying Theorem 1.9.1. Hint: Observe that
the composite of two uniformly continuous maps is a uniformly continuous
map.

1.15. Let G be a group and let A be a set. Let F be a nonempty ﬁnite
subset of G and set B = AF . The sets AG and B G are equipped with their
prodiscrete uniform structures and with the G-shift action. Show that the
map ΦF : AG → B G deﬁned by ΦF (x)(g) = (g −1 x)|F for all x ∈ AG and
g ∈ G is a G-equivariant uniform embedding.

1.16. Let G be a group, H ⊂ G a subgroup of G, and let A be a set. Let
H\G = {Hg : g ∈ G} be the set of all right cosets of H in G and set
B = AH\G . The set AG (resp. B H ) is equipped with its prodiscrete uniform
structure and with the G-shift (resp. H-shift) action. Let T ⊂ G be a
                                                                     complete
set of representatives for the right cosets of H in G so that G = t∈T Ht.
Show that the map Ψ = Ψ (H, T ) : AG → B H deﬁned by Ψ (x)(h)(Ht) = x(ht)
for all x ∈ AG , h ∈ H and t ∈ T is an H-equivariant uniform isomorphism.
Exercises                                                                   31

1.17. Let G be a group and let A be a set. For each s ∈ G, let τs : AG → AG
be the cellular automaton deﬁned by τs (x)(g) = x(gs) for all x ∈ AG , g ∈ G
(cf. Example 1.4.3(e)).
   (a) Show that τs ∈ ICA(G; A) for every s ∈ G.
   (b) Prove that the map Φ : G → ICA(G; A) deﬁned by φ(s) = τs for all
s ∈ G is a group homomorphism.
   (c) Prove that if A has at least two elements, then Φ is injective but not
surjective.

1.18. Let G be a group and let A be a set. Prove that the set consisting of
all invertible cellular automata τ : AG → AG admitting a memory set which
is reduced to a single element is a subgroup of ICA(G; A) isomorphic to the
direct product G × Sym(A).

1.19. (cf. [Amo]) Let G = Z and A = {0, 1}. Fix an integer n ≥ 3 and
let S = {−1, 0, 1, . . . , n}. Consider the element α ∈ AS (resp. β ∈ AS )
deﬁned by α(−1) = α(n) = 0 and α(k) = 1 for 0 ≤ k ≤ n − 1 (resp.
β(−1) = β(0) = β(n) = 0 and β(k) = 1 for 1 ≤ k ≤ n − 1) and the map
μ : AS → A deﬁned by μ(α) = 0, μ(β) = 1 and μ(y) = y(0) for y ∈ AS \{α, β}.
Let τ : AG → AG be the cellular automaton with memory set S and local
deﬁning map μ.
    (a) Show that S is the minimal memory set of τ .
    (b) Show that τ is an invertible cellular automaton and that τ −1 = τ .

1.20. Show that the inverse map of the bijective cellular automaton τ : AZ →
AZ studied in Example 1.10.3 is discontinuous, with respect to the prodiscrete
topology on AZ , at every conﬁguration x ∈ AZ .

1.21. Let G be a group and let A be a set. A subshift of the conﬁguration
space AG is a subset X ⊂ AG which is G-invariant (i.e., such that gx ∈ X
for all x ∈ X and g ∈ G) and closed in AG with respect to the prodiscrete
topology.
    (a) Show that ∅ and AG are subshifts of AG .
    (b) Show that if x ∈ AG then its orbit closure Gx ⊂ AG is a subshift.
                                                                    
    (c) Show that if (Xi )i∈I is a family of subshifts of AG then i∈I Xi is a
subshift of AG .                                                       
    (d) Show that if (Xi )i∈I is a ﬁnite family of subshifts of AG then i∈I Xi
is a subshift of AG .
    (e) Suppose that A is ﬁnite. Show that if X ⊂ AG is a subshift and
τ : AG → AG is a cellular automaton then τ (X) is a subshift of AG . Note:
This last statement becomes false when A is inﬁnite (see Example 3.3.3).

1.22. Let G be a group and let A and B be two sets. Let f : A → B be a
map and consider the map f∗ : AG → B G deﬁned by f∗ (x) = f ◦ x for all
x ∈ AG .
   (a) Show that if A is ﬁnite and X is a subshift of AG then f∗ (X) is a
subshift of B G . Hint: Use the compactness of the conﬁguration space AG .
32                                                         1 Cellular Automata

   (b) Let G = Z, A = Z, B = {0, 1} and let f : A → B be deﬁned by
f (n) = 0 if n < 0 and f (n) = 1 otherwise. Let X = {xn : n ∈ Z} ⊂ AZ ,
where xn (m) = n + m for all n, m ∈ Z. In other words, X is the Z-orbit Zx0
of the conﬁgurations x0 . Show that X is a subshift of AZ but f ∗ (X) is not a
subshift of B Z .
                                                                        
1.23. Let G be a group and let A be a set. Given a set of patterns P ⊂ AΩ ,
where the union runs over all ﬁnite subsets Ω of G, we set

     XP = {x ∈ AG : (gx)|Ω ∈
                           / P for all g ∈ G and all ﬁnite subsets Ω ⊂ G},

where (gx)|Ω denotes
                      the restriction of the conﬁguration gx to Ω.
   (a) Let P ⊂ AΩ be a set of patterns. Show that XP is a subshift of AG .
             Ω show that if X ⊂ A is a subshift, then there exists a
                                           G
   (b) Conversely,
subset P ⊂ A such that X = XP . Such a set P is called a deﬁning set of
forbidden patterns for X.

1.24. Let G be a group and let A be a set. Given a ﬁnite subset Ω ⊂ G and
a ﬁnite subset A ⊂ AΩ we set

                X(Ω, A) = {x ∈ AG : (gx)|Ω ∈ A for all g ∈ G}.

    (a) Let Ω ⊂ G and A ⊂ AΩ be ﬁnite subsets. Show that X(Ω, A) is a
subshift of AG . A subshift X ⊂ AG is said to be of ﬁnite type if there exists
a ﬁnite subset Ω ⊂ G and a ﬁnite subset A ⊂ AΩ such that X = X(Ω, A).
Such a set A is then called a deﬁning set of admissible patterns for X and
the subset Ω is called a memory set for X.
    (b) Suppose that A is ﬁnite. Show that a subshift X ⊂ AG is of ﬁnite type
if and only if it admits a ﬁnite deﬁning set of forbidden patterns.

1.25. Let G be a countable group and let A be a ﬁnite set. Show that there
are at most countably many distinct subshifts X ⊂ AG of ﬁnite type.

1.26. Let G be a group and let A be a ﬁnite set.
   (a) Let τ1 , τ2 : AG → AG be two cellular automata. Show that the set
{x ∈ AG : τ1 (x) = τ2 (x)} ⊂ AG is a subshift of ﬁnite type.
   (b) Deduce from (a) that if τ : AG → AG is a cellular automaton then the
set Fix(τ ) = {x ∈ AG : τ (x) = x} ⊂ AG is a subshift of ﬁnite type.
   (c) Conversely, show that if X ⊂ AG is a subshift of ﬁnite type then there
exists a cellular automaton τ : AG → AG such that X = Fix(τ ).

1.27. Suppose that a group Γ acts continuously on a topological space Z.
One says that the action of Γ on Z is topologically transitive if for any pair
of nonempty open subsets U and V of Z there exists an element γ ∈ Γ such
that U ∩ γV = ∅.
   Let G be a group and let A be a set. A subshift X ⊂ AG is said to be
irreducible if for any ﬁnite subset Ω of G and any two elements x1 , x2 ∈ X,
Exercises                                                                       33

there exist a conﬁguration x ∈ X and an element g ∈ G such that x|Ω = x1 |Ω
and (gx)|Ω = x2 |Ω .
   Suppose that X ⊂ AG is a subshift. Show that the action of G on X
induced by the G-shift is topologically transitive if and only if X is irreducible.
1.28. Let G be a group and let A be a set. Let B ⊂ A and consider the
subsets X, Y ⊂ AG deﬁned by X = {b : b ∈ B} ⊂ AG , where b denotes the
constant conﬁguration given by b(g) = b for all g ∈ G, and Y = {y ∈ AG :
y(g) ∈ B for all g ∈ G}.
   (a) Show that X and Y are subshifts of AG .
   (b) Show that if G is inﬁnite then Y is irreducible.
   (c) Suppose that B has at least two distinct elements. Show that X is not
irreducible.
1.29. Let G be a group acting continuously on a nonempty complete metric
space X whose topology satisﬁes the second axiom of countability (i.e., ad-
mitting a countable base of open subsets). Show that the following conditions
are equivalent:
    (i) the action of G on X is topologically transitive;
    (ii) there is a point x ∈ X whose G-orbit is dense in X;
    (iii) there is a dense subset D ⊂ X such that the G-orbit of each point
x ∈ D is dense in X.
    Hint: The implications (iii) ⇒ (ii) and (ii) ⇒ (i) are straightforward. To
prove (i) ⇒ (iii), consider a sequence (Un )n∈N of nonempty open subsets
of X which form a base of the topology and denote by Ωn the set of points
x ∈ X whose G-orbit meets Un . Then observe that each Ωn is and open dense
subset of X if (i) is satisﬁed and apply Baire’s theorem (Theorem I.1.1, also
cf. Remark I.1.2(ii)).
1.30. Let G be a countable group and let A be a countable (e.g. ﬁnite) set.
Let X ⊂ AG be a nonempty subshift. Show that the following conditions are
equivalent:
   (i) the subshift X is irreducible;
   (ii) there is a conﬁguration x ∈ X whose G-orbit is dense in X;
   (iii) there is a dense subset D ⊂ X such that the G-orbit of each conﬁgu-
ration x ∈ D is dense in X.
   Hint: Use the results of Exercises 1.3 and 1.29.
1.31. Let G be a group and let A be a set. One says that a subshift X ⊂ AG
is topologically mixing if the action of G on X induced by the G-shift is
topologically mixing (cf. Exercise 1.1).
   (a) Let X ⊂ AG be a subshift. Show that X is topologically mixing if and
only if for any ﬁnite subset Ω of G and any two conﬁgurations x1 , x2 ∈ X,
there exists a ﬁnite subset F ⊂ G such that, for all g ∈ G \ F , there exists a
conﬁguration x ∈ X satisfying x|Ω = x1 |Ω and (gx)|Ω = x2 |Ω .
   (b) Show that if G is inﬁnite then every topologically mixing subshift
X ⊂ AG is irreducible.
34                                                              1 Cellular Automata

1.32. Let G be a group and let A be a set. Let Δ ⊂ G be a ﬁnite subset.
A subshift X ⊂ AG is said to be Δ-irreducible if it satisﬁes the following
condition: if Ω1 and Ω2 are two ﬁnite subsets of G such that Ω1 and Ω2 δ are
disjoint for all δ ∈ Δ, then, given any two conﬁgurations x1 , x2 ∈ X, there
exists a conﬁguration x ∈ X which satisﬁes x|Ω1 = x1 |Ω1 and x|Ω2 = x2 |Ω2 .
A subshift X ⊂ AG is said to be strongly irreducible if there exists a ﬁnite
subset Δ ⊂ G such that X is Δ-irreducible.
   (a) Show that the subshift Y ⊂ AG described in Exercise 1.28 is {1G }-
irreducible and therefore strongly irreducible.
   (b) Show that every strongly irreducible subshift is topologically mixing.

1.33. Let G be a group and let A be a set. Let H be a subgroup of G.
For x ∈ AG and g ∈ G, denote by xH       g ∈ A
                                               H
                                                  the conﬁguration deﬁned by
 H
xg = (gx)|H .
   (a) Check that hxH   g = xhg for all x ∈ A , h ∈ H and g ∈ G.
                             H               G

   (b) Let X ⊂ AH be a subshift. Show that the set X (G) deﬁned by X (G) =
{x ∈ AG : xH  g ∈ X for all g ∈ G} is a subshift of A .
                                                      G

   (c) Show that if H = G then the subshift X      (G)
                                                        ⊂ AG is irreducible for
any subshift X ⊂ A .   H

   (d) Let X ⊂ AH be a subshift. Show that X (G) ⊂ AG is of ﬁnite type
(resp. topologically mixing, resp. strongly irreducible) if and only if X is of
ﬁnite type (resp. topologically mixing, resp. strongly irreducible).
   (e) Suppose that σ : AH → AH is a cellular automaton and let σ G : AG →
  G
A be the induced cellular automaton (cf. Sect. 1.7). Check that one has
       g = σ(xg ) for all x ∈ A and g ∈ G.
σ G (x)H        H                G

   (f) Show that if X ⊂ A is a subshift such that σ(X) ⊂ X then one has
                             H

σ G (X (G) ) ⊂ X (G) .

1.34. Let G be a group and let A be a set. Let F be a nonempty ﬁnite subset
of G and consider the map ΦF : AG → B G deﬁned in Exercise 1.15, where
B = AF . Let X ⊂ AG be a subshift and set X [F ] = ΦF (X).
   (a) Show that X [F ] is a subshift of B G .
   (b) Show that X is irreducible (resp. topologically mixing, resp. strongly
irreducible) if and only if X [F ] is irreducible (resp. topologically mixing, resp.
strongly irreducible).
   (c) Show that if X is of ﬁnite type then X [F ] is of ﬁnite type.

1.35. Let G be a group, H ⊂ G a subgroup of G, and let A be a set. Let also
T ⊂ G be a complete set of representatives for the right cosets of H in G and
consider the map Ψ : AG → B H deﬁned in Exercise 1.16, where B = AH\G .
Let X ⊂ AG be a subshift and set X (H,T ) = Ψ (X).
   (a) Show that X (H,T ) is a subshift of B H .
   (b) Show that if X is of ﬁnite type then X (H,T ) is of ﬁnite type.

1.36. Let A be a set. Let A∗ denote the monoid consisting of all words in
the alphabet A (cf. Sect. D.1). Recall that any word w ∈ A∗ can be uniquely
Exercises                                                                   35

written in the form w = a1 a2 · · · an , where n ≥ 0 and ai ∈ A for 1 ≤ i ≤ n.
The integer n is called the length of the word w and it is denoted by (w).
In the sequel, we shall identify the word w = a1 a2 · · · an with the pattern
p : {1, 2, . . . , n} → A deﬁned by p(i) = ai for 1 ≤ i ≤ n. Given a subshift
X ⊂ AZ and an integer n ≥ 0, we denote by Ln (X) ⊂ A∗ the set consisting
of all words w ∈ A∗ for which there exists an element x ∈ X such that
w = x(1)x(2) · · · x(n). The set L(X) = ∪n∈N Ln (X) is called the language
of X. The elements w ∈ L(X) are called the admissible words of X (or,
simply, the X-admissible words). The elements w ∈ A∗ \ L(X) are called the
forbidden words of X.
    (a) Let X and Y be two subshifts of AZ . Show that one has X ⊂ Y (resp.
X = Y ) if and only if L(X) ⊂ L(Y ) (resp. L(X) = L(Y )).
    (b) One says that a word u ∈ A∗ is a subword of a word w ∈ A∗ if there
exist v1 , v2 ∈ A∗ such that w = v1 uv2 . Let X ⊂ AZ be a subshift and let
L = L(X). Show that L satisﬁes the following conditions:
    (i) if w ∈ L, then u ∈ L for every subword u of w;
    (ii) if w ∈ L, then there exist a, a ∈ A such that awa ∈ L.
    (c) Conversely, show that if a subset L ⊂ A∗ satisﬁes conditions (i) and
(ii) in (b), then there exists a unique subshift X ⊂ AZ such that L = L(X).
1.37. Let A be a set and let X ⊂ AZ be a subshift.
   (a) Show that X is of ﬁnite type if and only if the following holds: there
exists an integer n0 ≥ 0 such that if the words u, v, w ∈ A∗ satisfy (v) ≥ n0
and uv, vw ∈ L(X), then one has uvw ∈ L(X).
   (b) Show that X is irreducible if and only if for every pair of words u and
v in L(X), there exists a word w ∈ A∗ such that uwv ∈ L(X).
   (c) Show that X is topologically mixing if and only if the following holds:
for every pair of words u and v in L(X), there exists an integer n0 ≥ 0 such
that for every integer n ≥ n0 there exists a word w ∈ A∗ of length (w) = n
satisfying uwv ∈ L(X).
   (d) Show that X is strongly irreducible if and only if the following holds:
there exists an integer n0 ≥ 0 such that, for every pair of words u and v in
L(X), and for every integer n ≥ n0 , there exists a word w ∈ A∗ of length
(w) = n such that uwv ∈ L(X).
1.38. Let A = {0, 1} and let X ⊂ AZ be the set of all x ∈ AZ such that
the following holds: if x(n) = 1, x(n + 1) = x(n + 2) = · · · = x(n + k) =
0, x(n + k + 1) = 1, for some n ∈ Z and k ∈ N, then k is even.
   (a) Show that X is a subshift (it is called the even subshift).
   (b) Show that X is not of ﬁnite type.
   (c) Show that X is strongly irreducible (and therefore topologically mixing
and irreducible).
1.39. Let A = {0, 1} and consider the subshift of ﬁnite type X ⊂ AZ deﬁned
by X = X{11} = {x ∈ AZ : (x(n), x(n + 1)) = (1, 1) for all n ∈ Z}. Show that
X is strongly irreducible (and therefore topologically mixing and irreducible).
The subshift X is called the golden mean subshift.
36                                                          1 Cellular Automata

1.40. Let A = {0, 1} and let X ⊂ AZ be the set consisting of the two conﬁg-
urations x, y ∈ AZ deﬁned by
                                                
                  0 if n is even                  1 if n is even
         x(n) =                    and y(n) =
                  1 otherwise                     0 otherwise,

for all n ∈ Z. Show that X is an irreducible subshift of ﬁnite type which is
not topologically mixing (and therefore not strongly irreducible either).

1.41. Let A be a set. Let X ⊂ AZ be a subshift of ﬁnite type. Show that X
is topologically mixing if and only if X is strongly irreducible.

1.42. Let A = {0, 1} and let X ⊂ AZ be the subshift with deﬁning set
of forbidden words {01k 0h 1 : 1 ≤ h ≤ k, k = 1, 2, . . .}. Show that X is
topologically mixing (and therefore irreducible) but not strongly irreducible.

1.43. Cellular automata between subshifts. Let G be a group and let A be a
set. The set AG is equipped with its prodiscrete uniform structure and with
the G-shift action. Let X, Y ⊂ AG be two subshifts and τ : X → Y a map.
Then the following are equivalent:
   (i) there exists a cellular automaton τ : AG → AG such that τ (x) = τ (x)
for all x ∈ X;
   (ii) τ is G-equivariant and uniformly continuous.
   One says that τ : X → Y is a cellular automaton if the two equivalent
conditions above are satisﬁed.

1.44. Let G be a group and let A be a ﬁnite set. Let τ : X → Y be a
map between subshifts X, Y ⊂ AG . Show that the following conditions are
equivalent:
   (i) τ is a cellular automaton,
   (ii) τ is G-equivariant and continuous (with respect to the topologies in-
duced on X and Y by the prodiscrete topology on AG ).

1.45. Let G be a group and let A be a ﬁnite set. Let τ : AG → AG be a
cellular automaton and let X ⊂ AG be an irreducible (resp. topologically
mixing, resp. strongly irreducible) subshift. Show that τ (X) is an irreducible
(resp. topologically mixing, resp. strongly irreducible) subshift of AG .
Chapter 2
Residually Finite Groups




This chapter is devoted to the study of residually ﬁnite groups, which form
a class of groups of special importance in several branches of mathematics.
As their name suggests it, residually ﬁnite groups generalize ﬁnite groups.
They are deﬁned as being the groups whose elements can be distinguished
after taking ﬁnite quotients (see Sect. 2.1). There are many other equivalent
deﬁnitions. For example, a group is residually ﬁnite if and only if it can be em-
bedded into the direct product of a family of ﬁnite groups (Corollary 2.2.6).
The class of residually ﬁnite groups is closed under taking subgroups and
taking projective limits. It contains in particular all ﬁnite groups, all ﬁnitely
generated abelian groups, and all free groups (Theorem 2.3.1). Every ﬁnitely
generated residually ﬁnite group is Hopﬁan (Theorem 2.4.3) and the automor-
phism group of a ﬁnitely generated residually ﬁnite group is itself residually
ﬁnite (Theorem 2.5.1). Examples of ﬁnitely generated groups which are not
residually ﬁnite are presented in Sect. 2.6. The following dynamical charac-
terization of residually ﬁnite groups is given in Sect. 2.7: a group is residually
ﬁnite if and only if there is a Hausdorﬀ topological space on which the group
acts continuously and faithfully with a dense subset of points with ﬁnite
orbit.



2.1 Deﬁnition and First Examples

Deﬁnition 2.1.1. A group G is called residually ﬁnite if for each element
g ∈ G with g = 1G , there exist a ﬁnite group F and a homomorphism
φ : G → F such that φ(g) = 1F .

Proposition 2.1.2. Let G be a group. Then the following conditions are
equivalent:
(a) G is residually ﬁnite;


T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,         37
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 2, © Springer-Verlag Berlin Heidelberg 2010
38                                                     2 Residually Finite Groups

(b) for all g, h ∈ G with g =
                             h, there exist a ﬁnite group F and a homomor-
    phism φ : G → F such that φ(g) = φ(h).

Proof. The fact that (b) implies (a) is obvious, since (b) gives (a) by taking
h = 1G . Conversely, suppose that G is residually ﬁnite. Let g, h ∈ G with
g = h. As gh−1 = 1G , there exist a ﬁnite group F and a homomorphism
φ : G → F such that φ(gh−1 ) = 1F . Since φ(gh−1 ) = φ(g)(φ(h))−1 , it follows
that φ(g) = φ(h). Therefore, (a) implies (b).

Proposition 2.1.3. Every ﬁnite group is residually ﬁnite.

Proof. Let G be a ﬁnite group and consider g ∈ G such that g = 1G . If
φ = IdG : G → G is the identity map, we have φ(g) = g = 1G .

Proposition 2.1.4. The additive group Z is residually ﬁnite.

Proof. Consider k ∈ Z such that k = 0. Choose an integer m such that |k| <
m. Then the canonical homomorphism φ : Z → Z/mZ (reduction modulo m)
satisﬁes φ(k) = 0.

     A similar argument gives us the following:

Proposition 2.1.5. The group GLn (Z) is residually ﬁnite for every n ≥ 1.

Proof. Let A = (aij ) ∈ GLn (Z) with A = In = 1GLn (Z) . Choose an integer
m such that |aij | < m for all i, j. Then the homomorphism φ : GLn (Z) →
GLn (Z/mZ) given by reduction modulo m satisﬁes φ(A) = 1GLn (Z/mZ) .

   We shall now give examples of groups which are not residually ﬁnite.
   A group G is called divisible if for each g ∈ G and each integer n ≥ 1,
there is an element h ∈ G such that hn = g.

Example 2.1.6. The additive groups Q, R, and C are divisible. More generally,
every Q-vector space, with its additive underlying group structure, is divisi-
ble. In particular, every ﬁeld of characteristic 0, with its underlying additive
group structure, is divisible.

Lemma 2.1.7. Let G be a divisible group and let F be a ﬁnite group. Then
every homomorphism φ : G → F is trivial.

Proof. Set n = |F |. Let g ∈ G. As G is divisible, we can ﬁnd h ∈ G such
that g = hn . If φ : G → F is a homomorphism, then we have φ(g) = φ(hn ) =
φ(h)n = 1F .

     The preceding lemma immediately yields the following result.

Proposition 2.1.8. A nontrivial divisible group cannot be residually ﬁnite.
2.1 Deﬁnition and First Examples                                              39

Example 2.1.9. The additive group underlying a ﬁeld of characteristic 0 is not
residually ﬁnite. In particular, the additive group Q is not residually ﬁnite.

   In order to give another characterization of residually ﬁniteness, we shall
use the following:

Lemma 2.1.10. Let G be a group and let H be a subgroup of G. Let K =
          −1
   g∈G gHg    . Then K is a normal subgroup of G contained in H. Moreover,
if H is of ﬁnite index in G, then Kis of ﬁnite index in G.

Proof. Since gHg −1 = H for g = 1G , we have K ⊂ H. Let Sym(G/H)
denote the group of permutations of G/H. Consider the action of G on G/H
given by left multiplication and let ρ : G → Sym(G/H) be the associated
homomorphism. For each g ∈ G, the stabilizer of gH is gHg −1 . Consequently,
we have K = Ker(ρ), which shows that K is a normal subgroup of G. The
group G/K is isomorphic to Im(ρ) ⊂ Sym(G/H). Suppose that H is of ﬁnite
index in G. This means that the set G/H is ﬁnite. This implies that the
group Sym(G/H) is ﬁnite. We deduce that the group G/K is ﬁnite, that is,
K is of ﬁnite index in G.

   Given a group G, the intersection of all subgroups of ﬁnite index of G is
called the residual subgroup (or proﬁnite kernel ) of G.

Proposition 2.1.11. Let G be a group and let N denote the residual sub-
group of G. Then:
  (i) N is equal to the intersection of all normal subgroups of ﬁnite index
      in G;
 (ii) N is a normal subgroup of G;
(iii) G is residually ﬁnite if and only if N = {1G }.

Proof. Denote by N  the intersection of all normal subgroups of ﬁnite index
of G. The inclusion N ⊂ N  is trivial. If H is a subgroup of ﬁnite index of G,
then K = ∩g∈G gHg −1 is a normal subgroup of ﬁnite index of G contained
in H, by Lemma 2.1.10. This implies N  ⊂ K ⊂ H. It follows that N  ⊂ N .
This shows (i).
    Assertion (ii) follows from (i) since the intersection of a family of normal
subgroups of G is a normal subgroup of G.
    Suppose that G is residually ﬁnite. Let g ∈ G such that g = 1G . Then there
exist a ﬁnite group F and a homomorphism φ : G → F such that φ(g) = 1F .
Thus g ∈ / Ker(φ). As the group G/Ker(φ) is isomorphic to F , the subgroup
Ker(φ) is of ﬁnite index in G. This shows that N = {1G }.
    Conversely, suppose that N = {1G }. Let g ∈ G such that g = 1G . By (i),
we can ﬁnd a normal subgroup of ﬁnite index K ⊂ G such that g ∈           / K. If
φ : G → G/K is the canonical homomorphism, we have φ(g) = 1G/K . This
shows that G is residually ﬁnite.
40                                                     2 Residually Finite Groups

2.2 Stability Properties of Residually Finite Groups

Proposition 2.2.1. Every subgroup of a residually ﬁnite group is residually
ﬁnite.
Proof. Let G be a residually ﬁnite group and let H be a subgroup of G. Let
h ∈ H such that h = 1G . Since G is residually ﬁnite, there exist a ﬁnite group
F and a homomorphism φ : G → F such that φ(h) = 1F . If φ : H → F is
the restriction of φ to H, we have φ (h) = φ(h) = 1F . Consequently, H is
residually ﬁnite.
Proposition 2.2.2. Let (Gi )i∈I be a family of residually ﬁnite groups. Then
their direct product G = i∈I Gi is residually ﬁnite.
Proof. Let g = (gi )i∈I ∈ G such that g = 1G . Then there exists i0 ∈ I
such that gi0 = 1Gi0 . Since Gi0 is residually ﬁnite, we can ﬁnd a ﬁnite group
F and a homomorphism φ : Gi0 → F such that φ(gi0 ) = 1F . Consider the
homomorphism φ : G → F deﬁned by φ = π ◦ φ, where π : G → Gi0 is
the projection onto Gi0 . We have φ (g) = φ(gi0 ) = 1F . Consequently, G is
residually ﬁnite.
Corollary 2.2.3. Let(Gi )i∈I be a family of residually ﬁnite groups. Then
their direct sum G = i∈I Gi is residually ﬁnite.

Proof. This follows immediately from Proposition 2.2.1
                                                      and Proposition 2.2.2,
since G is the subgroup of the direct product P = i∈I Gi consisting of all
g = (gi ) ∈ P for which gi = 1Gi for all but ﬁnitely many i ∈ I.
Corollary 2.2.4. Every ﬁnitely generated abelian group is residually ﬁnite.
Proof. If G is a ﬁnitely generated abelian group, then there exist an integer
r ≥ 0 and a ﬁnite abelian group T such that G is isomorphic to Zr × T . By
using Proposition 2.1.3 and Proposition 2.1.4, we deduce that G is residually
ﬁnite.
Remark 2.2.5. An arbitrary abelian group need not be residually ﬁnite. For
example, the additive group Q is not residually ﬁnite (Example 2.1.9).
Corollary 2.2.6. Let G be a group. Then the following conditions are equiv-
alent:
(a) the group G is residually ﬁnite;
(b) there exist a family (Fi )i∈I of ﬁnite groups such that
                                                         the group G is iso-
    morphic to a subgroup of the direct product group i∈I Fi .
Proof. The fact that (b) implies (a) follows from Proposition 2.1.3, Propo-
sition 2.2.2 and Proposition 2.2.1. Conversely, suppose that G is residually
ﬁnite. Then, for each g ∈ G \ {1G }, we can ﬁnd a ﬁnite group Fg and a
homomorphism φg : G → Fg such that φg (g) = 1Fg . Consider the group
2.2 Stability Properties of Residually Finite Groups                         41
                                           
                                  H=                Fg .
                                        g∈G\{1G }

The homomorphism ψ : G → H deﬁned by
                               
                         ψ=          φg
                                        g∈G\{1G }

is injective. Therefore, G is isomorphic to a subgroup of H. This shows that
(a) implies (b).

   The class of residually ﬁnite groups is closed under taking projective limits
(see Sect. E.2 for the deﬁnition of the limit of a projective system of groups):

Proposition 2.2.7. If a group G is the limit of a projective system of resid-
ually ﬁnite groups, then G is residually ﬁnite.

Proof. Let (Gi )i∈I be a projective system of residually ﬁnite groups such that
G = lim Gi . By construction
                              of a projective limit (see Appendix E), G is a
     ←−
subgroup of the group i∈I Gi . We deduce that G is residually ﬁnite by using
Proposition 2.2.2 and Proposition 2.2.1.

  A group G is called proﬁnite if G is the limit of some projective system of
ﬁnite groups. An immediate consequence of Proposition 2.2.7 is the following:

Corollary 2.2.8. Every proﬁnite group is residually ﬁnite.

Example 2.2.9. Let p be a prime number. Given integers n ≥ m ≥ 0, let
φn,m : Z/pm Z → Z/pn Z denote reduction modulo pn . Then (Z/pn Z, φn,m )
is a projective system of groups over N. The limit of this projective system
is called the group of p-adic integers and is denoted by Zp . Since Zp is the
projective limit of ﬁnite groups, it is proﬁnite and hence residually ﬁnite by
Corollary 2.2.8.

Remark 2.2.10. A group which is the limit of an inductive system of residually
ﬁnite groups need not be residually ﬁnite. For instance, we have seen in
Example 2.1.9 that the additive group underlying a ﬁeld of characteristic 0
is not residually ﬁnite. However, such a group is the limit of the inductive
system formed by its ﬁnitely generated subgroups, which are all residually
ﬁnite by Corollary 2.2.4.

  If P is a property of groups, one says that a group G is virtually P if G
contains a subgroup of ﬁnite index which satisﬁes P.

Lemma 2.2.11. Let G be a group. Let H be a subgroup of ﬁnite index of G
and let K be a subgroup of ﬁnite index of H. Then K is a subgroup of ﬁnite
index of G.
42                                                              2 Residually Finite Groups

Proof. Let h1 , . . . , hn be a complete set of representatives of the left cosets
of G modulo H and let k1 , . . . , kp be a complete set of representatives of
the left cosets of H modulo K. Observe that the elements hi kj , 1 ≤ i ≤ n,
1 ≤ j ≤ p, form a complete set of representatives of the left cosets of G
modulo K. Therefore [G : K] = np = [G : H][H : K] < ∞.

Proposition 2.2.12. Every virtually residually ﬁnite group is residually ﬁ-
nite.

Proof. Let G be a group and let H be a subgroup of ﬁnite index of G.
By Lemma 2.2.11, the intersection of the subgroups of ﬁnite index of G is
contained in the intersection of the subgroups of ﬁnite index of H. Since
a group is residually ﬁnite if and only if the intersection of its subgroups of
ﬁnite index is reduced to the identity element (Proposition 2.1.11), we deduce
that G is residually ﬁnite if H is residually ﬁnite.



2.3 Residual Finiteness of Free Groups

The goal of this section is to establish the following result:

Theorem 2.3.1. Every free group is residually ﬁnite.

     To prove this theorem, we shall use the following:

Lemma 2.3.2. The subgroup of SL2 (Z) generated by the matrices
                                         
                         12                 10
                   a=           and b =
                         01                 21

is a free group of rank 2.

Proof. The group GL2 (R) naturally acts on the set of lines of R2 passing
through the origin, that is, on the projective line P1 (R). In nonhomogeneous
coordinates this action is given by
                                          g11 t + g12
                                   gt =
                                          g21 t + g22

for g = (gij )1≤i,j≤2 ∈ GL2 (R) and t ∈ P1 (R) = R ∪ {∞} representing the line
of R2 with slope 1/t passing through (0, 0) (see Fig. 2.1). Note that we have
                                                               t
                      ak t = t + 2k       and      bk t =
                                                            2kt + 1
for all k ∈ Z. Consider the subsets Y and Z of P1 (R) deﬁned by

                   Y = ] − 1, 1[      and       Z = P1 (R) \ [−1, 1].
2.3 Residual Finiteness of Free Groups                                         43




Fig. 2.1 The action of GL2 (R) on P1 (R). Here, t = 1 and g = a



One immediately checks that, for all k ∈ Z \ {0}, one has

  ak Y = ]2k − 1, 2k + 1[ ⊂ Z       and     bk Z = ]1/(2k + 1), 1/(2k − 1)[ ⊂ Y.

By applying the Klein Ping-Pong theorem (Theorem D.5.1), we deduce that
a and b generate a free group of rank 2.

Proof of Theorem 2.3.1. Since GL2 (Z) is residually ﬁnite by Proposition
2.1.5, it follows from Lemma 2.3.2, Corollary D.5.3, and Proposition 2.2.1
that every free group of ﬁnite rank is residually ﬁnite.
   Consider now an arbitrary set X and let F (X) denote the free group
based on X. Let g ∈ F (X) such that g = 1F (X) . Let Y ⊂ X denote the set
of elements x ∈ X such that xk appear in the reduced form of g for some
k ∈ Z \ {0}. The subgroup F (Y ) ⊂ F (X) generated by Y is a free group with
base Y (see Proposition D.2.4). We have g ∈ F (Y ). As the group F (Y ) is
free of ﬁnite rank, it is residually ﬁnite by the ﬁrst part of the proof. Thus
we can ﬁnd a ﬁnite group H and a homomorphism φ : F (Y ) → H such that
φ(g) = 1H . Consider the unique homomorphism π : F (X) → F (Y ) such that
π(y) = y for every y ∈ Y and π(x) = 1F (Y ) for every x ∈ X \ Y . Then the
homomorphism φ ◦ π : F (X) → H satisﬁes φ ◦ π(g) = φ(π(g)) = φ(g) = 1H .
This shows that F (X) is residually ﬁnite.
44                                                   2 Residually Finite Groups

2.4 Hopﬁan Groups

Deﬁnition 2.4.1. A group G is called Hopﬁan if every surjective endomor-
phism of G is injective.

Examples 2.4.2. (a) Every ﬁnite group is Hopﬁan.
   (b) The additive group Q is Hopﬁan. Indeed, every endomorphism of the
group Q is of the form x → ax for some a ∈ Q, and it is clear that such an
endomorphism is surjective (resp. injective) if and only if a = 0.
   (c) Every simple group is Hopﬁan. (we recall that a simple group is a
nontrivial group G such that the only normal subgroups of G are {1G } and G).
   (d) The additive group Q/Z is not Hopﬁan. Indeed, the endomorphism
ψ : Q/Z → Q/Z deﬁned by ψ(x) = 2x is surjective but not injective.

Theorem 2.4.3. Every ﬁnitely generated residually ﬁnite group is Hopﬁan.

  Given groups G1 and G2 , we shall denote by Hom(G1 , G2 ) the set of all
homomorphisms from G1 to G2 . We begin by establishing the following result.
Lemma 2.4.4. Let G be a ﬁnitely generated group and let F be a ﬁnite group.
Then the set Hom(G, F ) is ﬁnite.

Proof. Let A be a ﬁnite generating subset of G. Let us set n = |A| and
p = |F |. As A generates G, any homomorphism u : G → F is completely
determined by the elements u(a), a ∈ A. Thus the set Hom(G, F ) contains
at most pn elements.

Proof of Theorem 2.4.3. Let G be a ﬁnitely generated residually ﬁnite group.
Suppose that ψ : G → G is a surjective endomorphism of G. Let K be a nor-
mal subgroup of ﬁnite index of G and let ρ : G → G/K denote the canonical
homomorphism. Consider the map

                    Φ : Hom(G, G/K) → Hom(G, G/K)

deﬁned by Φ(u) = u ◦ ψ for all u ∈ Hom(G, G/K). The map Φ is injective
since ψ is surjective by our hypothesis. As the set Hom(G, G/K) is ﬁnite by
Lemma 2.4.4, we deduce that Φ is also surjective. In particular, there exists
a homomorphism u0 ∈ Hom(G, G/K) such that ρ = u0 ◦ ψ. This implies
Ker(ψ) ⊂ Ker(ρ) = K. It follows that Ker(ψ) is contained in the intersection
of all normal subgroups of ﬁnite index of G. As G is residually ﬁnite, we
deduce that Ker(ψ) = {1G } by Proposition 2.1.11(iii). Thus ψ is injective.
This shows that G is Hopﬁan.

  Since every free group is residually ﬁnite by Theorem 2.3.1, an immediate
consequence of Theorem 2.4.3 is the following:

Corollary 2.4.5. Every free group of ﬁnite rank is Hopﬁan.
2.5 Automorphism Groups of Residually Finite Groups                        45

Remarks 2.4.6. (a) Let X be an inﬁnite set and let F (X) denote the free
group based on X. Every surjective but non injective map f : X → X ex-
tends to a surjective endomorphism ψ : F (X) → F (X) which is not injective.
Consequently, the group F (X) is not Hopﬁan. Since F (X) is residually ﬁnite
by Theorem 2.3.1, this shows that we cannot suppress the hypothesis that G
is ﬁnitely generated in Theorem 2.4.3.
   (b) An example of a ﬁnitely generated Hopﬁan group which is not residu-
ally ﬁnite will be given in Sect. 2.6 (see Proposition 2.6.1).



2.5 Automorphism Groups of Residually Finite Groups

Let G be a group. Recall that an automorphism of G is a bijective homomor-
phism α : G → G. Clearly, the set Aut(G) consisting of all automorphisms
of G is a subgroup of the symmetric group of G. The group Aut(G) is called
the automorphism group of G.

Theorem 2.5.1. Let G be a ﬁnitely generated residually ﬁnite group. Then
the group Aut(G) is residually ﬁnite.

  Let us ﬁrst establish the following result.

Lemma 2.5.2. Let G be a group. Let H1 and H2 be subgroups of ﬁnite index
of G. Then the subgroup H = H1 ∩ H2 is of ﬁnite index in G.

Proof. Two elements in G are left congruent modulo H if and only if they
are both left congruent modulo H1 and left congruent modulo H2 . Therefore,
there is an injective map from G/H into G/H1 × G/H2 given by gH →
(gH1 , gH2 ). As the sets G/H1 and G/H2 are ﬁnite by hypothesis, we deduce
that G/H is ﬁnite, that is, H is of ﬁnite index in G.

Proof of Theorem 2.5.1. Let α0 ∈ Aut(G) such that α0 = IdG . Then we can
ﬁnd an element g0 ∈ G such that α0 (g0 ) = g0 . As G is residually ﬁnite,
there exist a ﬁnite group F and a homomorphism φ : G → F satisfying
φ(α0 (g0 )) = φ(g0 ). Consider the set H deﬁned by
                                       
                             H=              Ker(ψ),
                                 ψ∈Hom(G,F )


where Hom(G, F ) denotes, as above, the set of all homomorphisms from G to
F . Observe that H is a normal subgroup of G since it is the intersection of a
family of normal subgroups of G. On the other hand, for every α ∈ Aut(G),
one has
46                                                        2 Residually Finite Groups
                                                         
                                         
                      α(H) = α                   Ker(ψ)
                                   ψ∈Hom(G,F )
                                     
                            =                 α(Ker(ψ))
                                ψ∈Hom(G,F )
                                     
                            =                 Ker(ψ ◦ α−1 ).
                                ψ∈Hom(G,F )


As the map from Hom(G, F ) to itself deﬁned by ψ → ψ ◦ α−1 is bijective
(with ψ → ψ ◦ α as inverse map), we get
                                  
                      α(H) =             Ker(ψ) = H.
                                ψ∈Hom(G,F )


Therefore α induces an automorphism α of G/H, given by α(gH) = α(g)H
for all g ∈ G. The map α → α is clearly a homomorphism from Aut(G)
to Aut(G/H). Let us show that the group Aut(G/H) is ﬁnite and that
α0 = 1Aut(G/H) = IdG/H . Observe ﬁrst that the set Hom(G, F ) is ﬁnite
by Lemma 2.4.4. As Ker(ψ) is of ﬁnite index in G for every ψ ∈ Hom(G, F ),
we deduce that H is of ﬁnite index in G by applying Lemma 2.5.2. This
implies that the group Aut(G/H) is ﬁnite. On the other hand, we have
α0 (g0 H) = α0 (g0 )H = g0 H since H is a subgroup of Ker(φ) and φ(g0 ) = g0 .
Therefore α0 = IdG/H . This shows that the group Aut(G) is residually ﬁnite.


   Every free group is residually ﬁnite by Theorem 2.3.1. Therefore we deduce
from Theorem 2.5.1 the following result.

Corollary 2.5.3. The group Aut(Fn ) is residually ﬁnite for every n ≥ 1.

  Every ﬁnitely generated abelian group is residually ﬁnite by Corollary 2.2.4.
Thus we have:

Corollary 2.5.4. The automorphism group of a ﬁnitely generated abelian
group is residually ﬁnite.

Remark 2.5.5. The automorphism group of a free abelian group of ﬁnite rank
n is isomorphic to GLn (Z). Thus, the residual ﬁniteness of GLn (Z) (Propo-
sition 2.1.5) may also be deduced from Corollary 2.5.4.

Corollary 2.5.6. Let R be a ring and let M be a left (or right) module over
R. Suppose that M is ﬁnitely generated as a Z-module. Then the automor-
phism group AutR (M ) of the R-module M is residually ﬁnite.

Proof. The group AutR (M ) is a subgroup of AutZ (M ). Since AutZ (M ) is
residually ﬁnite by Corollary 2.5.4, we deduce that AutR (M ) is residually
ﬁnite by applying Proposition 2.2.1.
2.6 Examples of Finitely Generated Groups Which Are Not Residually Finite   47

Corollary 2.5.7. Let R be a ring. Suppose that R is ﬁnitely generated as a
Z-module. Then the group GLn (R) is residually ﬁnite for every n ≥ 1.

Proof. This is an immediate consequence of the preceding corollary since
the group GLn (R) is isomorphic to AutR (Rn ), where Rn is viewed as a left
module over R.

Example 2.5.8. The ring of Gaussian integers Z[i] = {a + bi : a, b ∈ Z} is
a free abelian Z-module of rank 2. Thus, the group GLn (Z[i]) is residually
ﬁnite for every n ≥ 1 by Corollary 2.5.7. More generally, consider a number
ﬁeld K, that is, a ﬁeld extension of Q such that d = dimQ K < ∞. Let A
denote the ring of algebraic integers of K (we recall that an element x ∈ K
is called an algebraic integer of K if x is a root of a monic polynomial with
integral coeﬃcients). It is a standard fact in algebraic number theory that A
is a free Z-module of rank d. Thus, the group GLn (A) is residually ﬁnite for
every n ≥ 1 by Corollary 2.5.7.



2.6 Examples of Finitely Generated Groups Which Are
    Not Residually Finite

We have seen in Example 2.1.9 that the additive group Q is not residually
ﬁnite. Observe that the group Q is not ﬁnitely generated. In fact, any ﬁnitely
generated abelian group is residually ﬁnite by Corollary 2.2.4. The purpose
of this section is to give two examples of ﬁnitely generated groups G1 and G2
which are not residually ﬁnite.
   Our ﬁrst example is a subgroup of the symmetric group Sym(Z) generated
by two elements:

Proposition 2.6.1. Let G1 denote the subgroup of Sym(Z) generated by the
translation T : n → n + 1 and the transposition S = (0 1). Then G1 is a
ﬁnitely generated Hopﬁan group which is not residually ﬁnite.

   Let us ﬁrst establish the following lemmas:

Lemma 2.6.2. Let G be an inﬁnite simple group. Then G is not residually
ﬁnite.

Proof. The only normal subgroup of ﬁnite index of G is G itself. Therefore
G is not residually ﬁnite by Proposition 2.1.11(iii).

  Given a set X, we recall that Sym0 (X) denotes the subgroup of Sym(X)
consisting of all permutations of X whose support is ﬁnite (see Appendix C).

Lemma 2.6.3. Let X be an inﬁnite set. Then the group Sym0 (X) is not
residually ﬁnite.
48                                                      2 Residually Finite Groups

Proof. The subgroup Sym+ 0 (X) ⊂ Sym(X) consisting of all permutations of
X with ﬁnite support and signature 1 is an inﬁnite simple group by Theo-
rem C.4.3. Therefore Sym+0 (X) is not residually ﬁnite by Lemma 2.6.2. We
deduce that Sym0 (X) is not residually ﬁnite by using Proposition 2.2.1.

Lemma 2.6.4. The group G1 contains Sym0 (Z) as a normal subgroup. More-
over, G1 is the semidirect product of Sym0 (Z) with the inﬁnite cyclic subgroup
of G1 generated by T .

Proof. For all i ∈ Z, we have

                             T i ST −i = (i i + 1),                         (2.1)

which shows that (i i + 1) ∈ G1 . If i < j, we also have

                      (i j + 1) = (j j + 1)(i j)(j j + 1)

which, by induction on j, shows that (i j) ∈ G1 for all i, j ∈ Z with i < j.
Since the transpositions (i j), with i, j ∈ Z and i < j, generate Sym0 (Z) by
Corollary C.2.4, it follows that G1 contains Sym0 (Z). The fact that Sym0 (Z)
is normal in Sym(Z) (Proposition C.2.2) implies that Sym0 (Z) is normal
in G1 . Let H denote the subgroup of G1 generated by T . It is clear that
H ∩ Sym0 (Z) is reduced to the identity map IdZ . On the other hand, by
using (2.1), we see that every element g ∈ G1 may be written in the form
g = hσ, where h ∈ H and σ ∈ Sym0 (Z). Therefore, G1 is the semidirect
product of Sym0 (Z) and H.

Proof of Proposition 2.6.1. The group G1 contains Sym0 (Z) as a subgroup by
Lemma 2.6.4. As the group Sym0 (Z) is not residually ﬁnite by Lemma 2.6.3,
we conclude that G1 is not residually ﬁnite by applying Proposition 2.2.1.
    It remains to show that G1 is Hopﬁan. We start by observing that there
are exactly two surjective homomorphisms from G1 onto Z. Indeed, as G1 is
the semidirect product of Sym0 (Z) with the subgroup generated by T (Lem-
ma 2.6.4), every element g ∈ G1 can be uniquely written in the form g = T k σ,
where k ∈ Z and σ ∈ Sym0 (Z), and the map u : G1 → Z deﬁned by u(g) = k
is a surjective homomorphism. As all elements of Sym0 (Z) have ﬁnite order, it
immediately follows that the only homomorphisms from G1 onto Z are u and
−u. Now, let φ : G1 → G1 be a surjective homomorphism. Then u◦φ : G1 → Z
is a surjective homomorphism so that, by our preceding observation, we have
u◦φ = u or −u. As Ker(u) = Sym0 (Z) and φ : G1 → G1 is onto, it follows that
Ker(φ) ⊂ Sym0 (Z) and φ(Sym0 (Z)) = Sym0 (Z). The simplicity of Sym+        0 (Z)
(Theorem C.4.3) implies that Ker(φ) ∩ Sym+    0 (Z) is either equal  to Sym +
                                                                            0 (Z)
or reduced to the identity. We cannot have Ker(φ) ∩ Sym0 (Z) = Sym0 (Z),
                                                              +            +

that is, Sym+ 0 (Z) ⊂ Ker(φ), since this would imply that φ(Sym0 (Z)) is either
reduced to the identity or cyclic of order 2, which contradicts φ(Sym0 (Z)) =
Sym0 (Z). Consequently, we have Ker(φ) ∩ Sym+    0 (Z) = {IdZ }. If Ker(φ) is not
2.6 Examples of Finitely Generated Groups Which Are Not Residually Finite     49

reduced to the identity, it follows that Ker(φ) is a normal subgroup of order
2 of Sym0 (Z). But this is impossible since Proposition C.2.3 combined with
Proposition C.3.2 implies that, if X is an inﬁnite set, then every non-trivial
element in Sym0 (X) has an inﬁnite number of conjugates in Sym0 (X). Thus
Ker(φ) must be reduced to the identity, that is, φ is injective. This shows
that G1 is Hopﬁan.

   Our second example of a ﬁnitely generated but not residually ﬁnite group
will also show that the class of residually ﬁnite groups is not closed under
extensions. In other words, a group G admitting a normal subgroup N such
that both N and G/N are residually ﬁnite may fail to be residually ﬁnite.
   In order to construct it we consider ﬁrst the group
                                      
                                 H=       Hi ,
                                          i∈Z


                                                    5 . Let ψ : Z → Aut(H)
where each Hi is a copy of the alternating group Sym+
be the homomorphism deﬁned by ψ(n) = αn , where α ∈ Aut(H) is the
one-step shift given by
                              α(h) = (hi−1 )i∈Z
for all h = (hi )i∈Z ∈ H.

Proposition 2.6.5. The semidirect product G2 = H ψ Z is a ﬁnitely gen-
erated but not residually ﬁnite group.

Proof. By deﬁnition of a semidirect product, G2 is the group with underlying
set H × Z and group operation given by

                        (h, n)(h , n ) = (hαn (h ), n + n )

for all (h, n), (h , n ) ∈ H × Z.
   Let t be the element of G2 deﬁned by t = (1H , 1) and identify each element
h ∈ H with the element (h, 0) ∈ G. Then H is a normal subgroup of G2 and
the quotient group G2 /H is an inﬁnite cyclic group generated by the class of
t. One has
                                    (h, n) = htn                          (2.2)
and
                                 tn ht−n = αn (h)                           (2.3)
for all h ∈ H and n ∈ Z. It follows from (2.2) that G2 is generated by t and
the elements of H. In fact, since H is the direct sum of the groups Hi and

                                   Hi = ti H0 t−i                           (2.4)

by (2.3), we deduce that G2 is generated by t and the elements of H0 . As the
group H0 is ﬁnite, this shows that G is ﬁnitely generated.
50                                                      2 Residually Finite Groups

    Let us prove now that G2 is not residually ﬁnite. Suppose on the contrary
that G2 is residually ﬁnite. Let g be an element in H0 such that g = 1H0 .
The residual ﬁniteness of G2 implies the existence of a ﬁnite group F and a
homomorphism φ : G2 → F such that φ(g) = 1F . As H0 is a simple group, the
restriction of φ to H0 is injective. Therefore, the group φ(H0 ) is isomorphic
to H0 and hence to Sym+  5 . Let m = |F |. We have φ(t ) = φ(t) = 1F . Thus,
                                                        m       m

it follows from (2.4) that φ(Hm ) = φ(H0 ). Since xy = yx for all x ∈ H0 and
y ∈ Hm , this implies that φ(H0 ) is abelian. This contradicts the fact that
φ(H0 ) is isomorphic to Sym+  5 , which is not abelian.

Remark 2.6.6. Observe that the group H is residually ﬁnite by Corollary
2.2.3. The quotient group G2 /H is also residually ﬁnite since it is isomorphic
to Z. This shows that an extension of a residually ﬁnite group by a residually
ﬁnite group need not to be residually ﬁnite.



2.7 Dynamical Characterization of Residual Finiteness

Let G be a group and let A be a set. Recall that the set AG = {x : G → A}
is equipped with the prodiscrete topology and that G acts on AG by the left
shift deﬁned by (1.2).
Theorem 2.7.1. Let G be a group. Then the following conditions are equiv-
alent:
(a) the group G is residually ﬁnite;
(b) for every set A, the set of points of AG which have a ﬁnite G-orbit is
    dense in AG ;
(c) there exists a set A having at least two elements such that the set of points
    of AG which have a ﬁnite G-orbit is dense in AG ;
(d) there exists a Hausdorﬀ topological space X equipped with a continuous
    and faithful action of G such that the set of points of X which have a
    ﬁnite G-orbit is dense in X.
   We recall that an action of a group G on a set X is called faithful if 1G is
the only element of G ﬁxing all points of X.
Lemma 2.7.2. Let G be a group and let A be a set having at least two ele-
ments. Then the action of G on AG is faithful.
Proof. Let a and b be two distinct elements in A. Consider an element g0 in
G such that g0 = 1G . Let x ∈ AG be the conﬁguration deﬁned by x(g) = a if
g = 1G and x(g) = b otherwise. We have g0 x = x since g0 x(1G ) = x(g0−1 ) = b
and x(1G ) = a. Consequently, the action of G on AG is faithful.
Lemma 2.7.3. Let G be a residually ﬁnite group and let Ω be a ﬁnite subset
of G. Then there exists a normal subgroup of ﬁnite index K of G such that the
restriction of the canonical homomorphism ρ : G → G/K to Ω is injective.
Notes                                                                       51

Proof. Consider the ﬁnite subset

                   S = {g −1 h : g, h ∈ Ω and g = h} ⊂ G.

Since G is residually ﬁnite, we can ﬁnd, for every s ∈ S, a normal subgroup
of ﬁnite index Ns ⊂ G such that s ∈ / Ns . The set K = ∩s∈S Ns is a normal
subgroup of ﬁnite index in G by Lemma 2.5.2. Let ρ : G → G/K be the
canonical homomorphism. If g and h are distinct elements in Ω, then g −1 h ∈
                                                                           /
K and hence ρ(g) = ρ(h).

Proof of Theorem 2.7.1. Suppose that G is residually ﬁnite. Let A be a set
and let W be a neighborhood of a point x in AG . Let us show that W contains
a conﬁguration with ﬁnite G-orbit.
   Consider a ﬁnite subset Ω ⊂ G such that

                   V (x, Ω) = {y ∈ AG : y|Ω = x|Ω } ⊂ W.

By Lemma 2.7.3, we can ﬁnd a normal subgroup of ﬁnite index K ⊂ G such
that the restriction to Ω of the canonical homomorphism ρ : G → G/K(=
K\G) is injective. This implies that the map Φ : AG/K → AΩ deﬁned by
Φ(z) = (z ◦ ρ)|Ω is surjective. Thus we can ﬁnd an element z0 ∈ AG/K
such that the conﬁgurations z0 ◦ ρ and x coincide on Ω, that is, such that
z0 ◦ ρ ∈ V (x, Ω). On the other hand, the conﬁguration z0 ◦ ρ is K-periodic
by Proposition 1.3.3 (observe that K\G = G/K as K is normal in G). As
K is of ﬁnite index in G, we deduce that the G-orbit of z0 ◦ ρ is ﬁnite.
Thus W contains a conﬁguration whose G-orbit is ﬁnite. This shows that (a)
implies (b).
   Implication (b) ⇒ (c) is trivial.
   The fact that (c) implies (d) follows from Proposition 1.2.1, Proposi-
tion 1.2.2, and Lemma 2.7.2.
   Let us show that (d) implies (a). Suppose that the group G acts con-
tinuously and faithfully on a Hausdorﬀ topological space X and let E
denote the set of points of X whose G-orbit is ﬁnite. For x ∈ E, let
Stab(x) = {g ∈ G : gx = x} denote the stabilizer of x in G. Observe that
x ∈ E if and only if Stab(x) is of ﬁnite index in G. If E is dense in X, then
∩x∈E Stab(x) = {1G } since the action of G on X is continuous and faithful.
Thus, by Proposition 2.1.11 we have that G is residually ﬁnite.



Notes

A survey article on residually ﬁnite groups has been written by W. Magnus
[Mag].
   A group G is called linear if there exist an integer n ≥ 1 and a ﬁeld K such
that G is isomorphic to a subgroup of GLn (K). A theorem of A.I. Mal’cev
[Mal1] asserts that every ﬁnitely generated linear group is residually ﬁnite.
52                                                      2 Residually Finite Groups

An example of a ﬁnitely presented group which is residually ﬁnite but not
linear was recently given by C. Druţu and M. Sapir [DrS].
   The residual ﬁniteness of free groups was established by F. Levi [Lev].
The proof presented in Sect. 2.3 is based on the fact that the matrices 10 21
and 12 01 generate a free subgroup of GL2 (Z). This last result is due to I.N.
Sanov [San]. The reader may ﬁnd other proofs of the residual ﬁniteness of
free groups in [RobD, p. 158] and [MaKS, p. 116].
   Hopﬁan groups are named after H. Hopf who used topological methods
to prove that fundamental groups of closed orientable surfaces are Hop-
ﬁan (see [MaKS, p. 415]) and raised the question of the existence of ﬁnitely
generated non-Hopﬁan groups. The fact that every ﬁnitely generated resid-
ually ﬁnite group is Hopﬁan (Theorem 2.4.3) was discovered by Mal’cev
[Mal1]. The ﬁrst example of a ﬁnitely generated non-Hopﬁan group was given
by B.H. Neumann [Neu2]. Shortly after, a ﬁnitely presented non-Hopﬁan
group was found by G. Higman [Hig]. The simplest example of a ﬁnitely
presented non-Hopﬁan group is certainly provided by the Baumslag-Solitar
group BS(2, 3) = x, y : yx2 y −1 = x3 , that is, the quotient of the free group
F2 based on two generators x and y by the smallest normal subgroup of F2
containing the element x−3 yx2 y −1 (see [BaS], [MaKS], [LS]). On the other
hand, the Baumslag-Solitar group BS(2, 4) = x, y : yx2 y −1 = x4  is an
example of a ﬁnitely presented Hopﬁan group which is not residually ﬁnite
(the incorrect statement in [BaS] about the residual ﬁniteness of BS(2, 4)
was corrected by S. Meskin in [Mes]).
   The residual ﬁniteness of the automorphism group of a ﬁnitely generated
residually ﬁnite group (Theorem 2.5.1) was proved by G. Baumslag in [Bau].
   The group G1 of Sect. 2.6 was considered by Mal’cev in [Mal1]. Given
groups A and G, the wreath product A  G is the semidirect product H ψ
G, where H = ⊕g∈G A and ψ : G → Aut(A) is the group homomorphism
associated with the action of G on H ⊂ AG induced by the G-shift (see
[RobD], [Rot]). Thus, the group G2 of Sect. 2.6 is the wreath product G2 =
Sym+ 5 Z. The proof of Proposition 2.6.5 shows that, if A is a ﬁnitely generated
nonabelian simple group and G is a ﬁnitely generated inﬁnite group, then
the wreath product A  G is a ﬁnitely generated group which is not residually
ﬁnite. Examples of ﬁnitely generated nonabelian simple groups are provided
by the (ﬁnite) groups Sym+  n , where n ≥ 5, or PSLn (K), where n ≥ 2 and K
a ﬁnite ﬁeld having at least 4 elements, or one of the famous inﬁnite ﬁnitely
presented simple Thompson groups T or V (see [CFP]).


Exercises

2.1. Show that every quotient of a divisible group is a divisible group.
2.2. Show that every torsionfree divisible abelian group G is isomorphic to a
direct sum of copies of Q. Hint: Prove that there is a natural Q-vector space
structure on G.
Exercises                                                                   53

2.3. Let G be a group.
   (a) Show that it is possible to deﬁne a topology on G by taking as open
sets the subsets Ω ⊂ G which satisfy the following property: for each g ∈ Ω
there is a subgroup of ﬁnite index H ⊂ G such that gH ⊂ Ω. This topology
is called the proﬁnite topology on G.
   (b) Show that G is residually ﬁnite if and only if the proﬁnite topology on
G is Hausdorﬀ.

2.4. Show that the class of residually ﬁnite groups is not closed under taking
quotients. Hint: Any group is isomorphic to a quotient of a free group (see
Corollary D.4.2).

2.5. Let X be an inﬁnite set. Show that the symmetric group Sym(X) is not
residually ﬁnite. Hint: Use Cayley’s theorem (Theorem C.1.2) to prove that
Sym(X) contains a subgroup isomorphic to Q or use Lemma 2.6.3.

2.6. Let G be a residually ﬁnite group and let A be a ﬁnite set.
   (a) Show that there exists a canonical injective
                                                   homomorphism of the
group ICA(G; A) (cf. Sect. 1.10) into the group H Sym(Fix(H)), where
H runs over all ﬁnite index subgroups of G. Hint. Use the fact that the
conﬁgurations with ﬁnite G-orbit are dense in AG (cf. Theorem 2.7.1).
   (b) Deduce from (a) that ICA(G; A) is residually ﬁnite.

2.7. Let m be an integer such that |m| ≥ 2. Let G denote the quotient of
the free group F2 on two generators x and y by the normal closure of the
single element xyx−1 y −m . Thus, G is the group given by the presentation
G = a, b : aba−1 = bm , where a and b denote the images in G of x and y by
the quotient homomorphism.
   (a) Show that every element g ∈ G may be (not uniquely) written in the
form g = ai bj ak for some i, j, k ∈ Z.
   (b) Show that there is a unique group homomorphism φ : G → GL2 (Q)
which satisﬁes                                    
                               m0                   11
                     φ(a) =             and φ(b) =      .
                               0 1                  01
  (c) Use (a) to show that φ is injective and that the image of φ is the
subgroup φ(G) ⊂ GL2 (Q) given by
                         n                        
                           m r
                 φ(G) =           : n ∈ Z, r ∈ Z[1/m] ,
                            0 1

where Z[1/m] denotes the set of all rationals r ∈ Q which can be written in
the form r = umv for some u, v ∈ Z.
   (d) Use (c) to prove that G is torsionfree.
   (e) Prove that G is residually ﬁnite. Hint: You have to show that, for any
element g ∈ G \ {1G }, there exist a ﬁnite group F and a homomorphism
ψ : G → F such that ψ(g) = 1F . Write g = ai bj ak , where i, j, k ∈ Z, and
54                                                   2 Residually Finite Groups

treat ﬁrst the case i + k = 0 by using determinants. If i + k = 0, choose a
prime number p which is not a divisor of m nor a divisor of j, and consider
the homomorphism ψ : G → GL2 (Z/pZ) deﬁned by
                                                
                             m0                    11
                   ψ(a) =            and ψ(b) =          ,
                              0 1                  01

where n ∈ Z/pZ denotes the class of n ∈ Z modulo p.
2.8. Let m ≥ 2 be an integer. Denote by Z[1/m] the subgroup of the additive
group Q consisting of all rationals r which can be written in the form r = kmn
for some k, n ∈ Z. Show that the group Z[1/m] is residually ﬁnite. Hint:
Observe that Z[1/m] is isomorphic to a subgroup of the group G studied in
Exercise 2.7.
2.9. Let K be a ﬁeld of characteristic p > 0. Show that the additive group
K is residually ﬁnite. Hint: Use a base of K seen as a Z/pZ vector space and
apply Corollary 2.2.3.
2.10. Show that all elements of the additive group Q/Z have ﬁnite order but
that Q/Z is not residually ﬁnite.
2.11. Show that the multiplicative group Q∗ of nonzero rational numbers is
residually ﬁnite. Hint: Use the unique factorization of elements of Q∗ into
powers of prime numbers and apply Corollary 2.2.3.
2.12. Show that the automorphism group Aut(Q) of the additive group Q is
isomorphic to the multiplicative group Q∗ .
2.13. Show that the additive group R is neither residually ﬁnite nor Hopﬁan.
2.14. Let p be a prime. Show that the additive group Zp of p-adic integers is
not Hopﬁan.
2.15. Show that the multiplicative group R∗ of nonzero real numbers is nei-
ther residually ﬁnite nor Hopﬁan.
2.16. Let F be a free group of ﬁnite rank n. Suppose that S is a ﬁnite
generating subset of F of cardinality |S| ≤ n. Use the fact that F is Hopﬁan
(Corollary 2.4.5) to prove that |S| = n and that S is a base for F .
2.17. (M. Hall [Hal-M-2]) Let G be a ﬁnitely generated group and let n ≥ 1
be an integer. Show that G contains only a ﬁnite number of subgroups of
index n. Hint: Use Lemma 2.1.10 and Lemma 2.4.4.
2.18. Show that the group GLn (Z) is ﬁnitely generated. Hint: For 1 ≤ i, j ≤
n, let Eij denote the n × n matrix all of whose entries are 0 except the entry
located on the ith row and the jth column which is equal to 1. Use Euclidean
division in Z to show that GLn (Z) is generated by the n2 matrices In − 2Eii ,
In + Eij , where 1 ≤ i, j ≤ n and i = j.
Exercises                                                                   55

2.19. Show that GLn (Z) is Hopﬁan.

2.20. Give a direct proof of the fact that the automorphism group of a ﬁnitely
generated abelian group G is residually ﬁnite (Corollary 2.5.4). Hint: Show
that there is a ﬁnite group F and an integer n ≥ 0 such that Aut(G) is
isomorphic to F × GLn (Z).

2.21. Show that the group G1 considered in Sect. 2.6 contains no normal
subgroup H such that both H and G/H are residually ﬁnite.

2.22. Show that the group G2 considered in Sect. 2.6 is Hopﬁan.

2.23. A group G is called almost perfect if all nontrivial ﬁnite quotients of G
are nonabelian. Show that, if A is a ﬁnitely generated almost perfect nontriv-
ial group and G is a ﬁnitely generated inﬁnite group, then the wreath product
group A  G is ﬁnitely generated but not residually ﬁnite. Hint: Follow the
proof of Proposition 2.6.5.

2.24. Let G be a group. Denote by Nf q the set of all normal subgroups of
ﬁnite index of G, partially ordered by reverse inclusion.
   (a) Show that Nf q is a directed set.
   (b) For H, K ∈ Nf q with H ⊂ K, let ϕK,H : G/H → G/K denote the
canonical homomorphism. Show that the directed set Nf q together with the
homomorphisms ϕK,H form a projective system of groups. The limit of this
projective system is called the proﬁnite completion of the group G and is
denoted by G.
   (c) Show that there is a canonical homomorphism η : G → G and that the
kernel of η is the residual subgroup of G.
   (d) Prove that G is residually ﬁnite if and only if the canonical homomor-
phism η : G → G is injective.
Chapter 3
Surjunctive Groups




Surjunctive groups are deﬁned in Sect. 3.1 as being the groups on which all
injective cellular automata with ﬁnite alphabet are surjective. In Sect. 3.2 it is
shown that every subgroup of a surjunctive group is a surjunctive group and
that every locally surjunctive group is surjunctive. Every locally residually
ﬁnite group is surjunctive (Corollary 3.3.6). The class of locally residually
ﬁnite groups is quite large and includes in particular all ﬁnite groups, all
abelian groups, and all free groups (a still wider class of surjunctive groups,
namely the class of soﬁc groups, will be described in Chap. 7). In Sect. 3.4,
given an arbitrary group Γ , we introduce a natural topology on the set of its
quotient groups. In Sect. 3.7, it is shown that the set of surjunctive quotients
is closed in the space of all quotients of Γ .



3.1 Deﬁnition

A set X is ﬁnite if and only if every injective map f : X → X is surjective.
The deﬁnition given below is related to this characterization of ﬁnite sets.

Deﬁnition 3.1.1. A group G is said to be surjunctive if it satisﬁes the fol-
lowing condition: if A is a ﬁnite set, then every injective cellular automaton
τ : AG → AG is surjective (and hence bijective).

Remark 3.1.2. Given a group G and a ﬁnite set A, it follows from Theo-
rem 1.8.1 that a map f : AG → AG is a cellular automaton if and only if f is
G-equivariant (with respect to the G-shift) and continuous (with respect to
the prodiscrete topology on AG ). Thus, the deﬁnition of a surjunctive group
may be reformulated as follows: a group G is surjunctive if and only if, for
any ﬁnite set A, every injective G-equivariant continuous map f : AG → AG
is surjective.

Proposition 3.1.3. Every ﬁnite group is surjunctive.
T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,         57
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 3, © Springer-Verlag Berlin Heidelberg 2010
58                                                           3 Surjunctive Groups

Proof. If G is a ﬁnite group and A is a ﬁnite set, then the set AG is ﬁnite.
Therefore, every injective cellular automaton τ : AG → AG is surjective.



3.2 Stability Properties of Surjunctive Groups

Proposition 3.2.1. Every subgroup of a surjunctive group is surjunctive.

Proof. Suppose that H is a subgroup of a surjunctive group G. Let A be
a ﬁnite set and let τ : AH → AH be an injective cellular automaton over
H. Consider the cellular automaton τ G : AG → AG over G obtained from τ
by induction (see Sect. 1.7). The fact that τ is injective implies that τ G is
injective by Proposition 1.7.4(i). Since G is surjunctive, it follows that τ G is
surjective. By applying Proposition 1.7.4(ii), we deduce that τ is surjective.


Proposition 3.2.2. Let G be a group. Then the following conditions are
equivalent:
(a) G is surjunctive;
(b) every ﬁnitely generated subgroup of G is surjunctive.

Proof. The fact that (a) implies (b) follows from Proposition 3.2.1. Con-
versely, let G be a group all of whose ﬁnitely generated subgroups are sur-
junctive. Let A be a ﬁnite set and let τ : AG → AG be an injective cellular
automaton with memory set S. Let H denote the subgroup of G generated
by S and consider the cellular automaton τH : AH → AH obtained by re-
striction of τ (see Sect. 1.7). The fact that τ is injective implies that τH is
injective by Proposition 1.7.4(i). As H is ﬁnitely generated, it is surjunc-
tive by our hypothesis on G. It follows that τH is surjective. By applying
Proposition 1.7.4(ii), we deduce that τ is also surjective. This shows that (b)
implies (a).

   If P is a property of groups (e.g. being ﬁnite, being nilpotent, being solv-
able, being free, etc.), a group G is called locally P if all ﬁnitely generated
subgroups of G satisfy P. With this terminology, Proposition 3.2.2 may be
rephrased by saying that the class of surjunctive groups and the class of
locally surjunctive groups coincide.

Corollary 3.2.3. Every locally ﬁnite group is surjunctive.

Proof. This immediately follows from Proposition 3.2.2 since every ﬁnite
group is surjunctive by Proposition 3.1.3.

Example 3.2.4. Let X be a set and consider the group Sym0 (X) consisting of
all permutations of X which have ﬁnite support (see Sect. C.2). The group
Sym0 (X) is locally ﬁnite. Indeed, if Σ is a ﬁnite subset of Sym0 (X), then
3.3 Surjunctivity of Locally Residually Finite Groups                            59

the subgroup H ⊂ Sym0 (X) generated by Σ is ﬁnite since it is isomorphic
to a subgroup of Sym(A), where A denotes the union of the supports of
the elements of Σ. Consequently, the group Sym0 (X) is surjunctive. Observe
that Sym0 (X) is inﬁnite when X is inﬁnite. This yields our ﬁrst examples
of inﬁnite surjunctive groups. Finally, note that it follows from Lemma 2.6.3
that Sym0 (X) is not residually ﬁnite whenever X is inﬁnite.



3.3 Surjunctivity of Locally Residually Finite Groups

Theorem 3.3.1. Every residually ﬁnite group is surjunctive.

   Let us ﬁrst establish an important property of cellular automata with ﬁnite
alphabet, namely the fact that they always have a closed image with respect
to the prodiscrete topology on the set of conﬁgurations:

Lemma 3.3.2. Let G be a group and let A be a ﬁnite set. Let τ : AG → AG be
a cellular automaton. Then the set τ (AG ) is closed in AG for the prodiscrete
topology.

Proof. Since A is ﬁnite, the space AG is compact by Tychonoﬀ theorem (see
Corollary A.5.3). As τ is continuous by Proposition 1.4.8, we deduce that
τ (AG ) is a compact subset of AG . This implies that τ (AG ) is closed in AG
since AG is Hausdorﬀ by Proposition 1.2.1.

   The following example shows that Lemma 3.3.2 becomes false if we sup-
press the hypothesis that the alphabet is ﬁnite.

Example 3.3.3. Consider the map τ : NZ → NZ given by

                        τ (x)(n) = max(0, x(n) − x(n + 1))

for all x ∈ NZ and n ∈ Z. Clearly, τ is a cellular automaton over the group
Z and the alphabet N with memory set {0, 1}. Consider the conﬁguration
y : Z → N deﬁned by y(n) = 1 if n ≥ 0 and y(n) = 0 otherwise. Let F be a
ﬁnite subset of Z and choose an integer M ≥ 1 such that F ⊂ [−M +1, M −1].
Consider the conﬁguration xM : Z → N deﬁned by xM (n) = max(0, M − n)
if n ≥ 0 and xM (n) = M otherwise. Observe that yM = τ (xM ) is such
that yM (n) = 1 if 0 ≤ n ≤ M − 1 and yM (n) = 0 otherwise. Therefore, the
conﬁgurations yM and y coincide on [−M + 1, M − 1] and hence on F . Thus y
is in the closure of τ (NZ ) in NZ . On the other hand, it is clear that y is not in
the image of τ . This shows that τ (NZ ) is not closed in NZ for the prodiscrete
topology.

   In the proof of the surjunctivity of residually ﬁnite groups, we shall also
use the following result:
60                                                          3 Surjunctive Groups

Lemma 3.3.4. Let G be a group. Suppose that G satisﬁes the following prop-
erty: for each ﬁnite subset Ω ⊂ G, there exist a surjunctive group Γ and a
homomorphism φ : G → Γ such that the restriction of φ to Ω is injective.
Then G is surjunctive.

Proof. Let A be a ﬁnite set and equip AG with its prodiscrete topology.
Suppose that τ : AG → AG is an injective cellular automaton. Let us show
that τ is surjective, that is, τ (AG ) = AG . Since τ (AG ) is closed in AG by
Lemma 3.3.2, it suﬃces to prove that τ (AG ) is dense in AG . Consider a
conﬁguration x ∈ AG and a neighborhood W of x in AG . Then there is a
ﬁnite subset Ω ⊂ G such that

                   V (x, Ω) = {y ∈ AG : y|Ω = x|Ω } ⊂ W.

By our hypothesis, we may ﬁnd a surjunctive group Γ and a homomorphism
φ : G → Γ such that the restriction of φ to Ω is injective. Let K denote the
image of φ and let N denote its kernel. By Proposition 1.3.3, there is a bijec-
tive map ψ : AK → Fix(N ) given by ψ(z) = z ◦ φ for all z ∈ AK . Moreover,
if we identify AK with Fix(N ) via ψ, the restriction of τ to Fix(N ) yields a
cellular automaton τ : AK → AK over the group K (see Proposition 1.6.1).
Since the group Γ is surjunctive, the group K is surjunctive by Proposi-
tion 3.2.1. We deduce that τ is surjective and hence τ (Fix(N )) = Fix(N ).
On the other hand, as the restriction of φ to Ω is injective, we may ﬁnd
z0 ∈ AK such that ψ(z0 ) = x|Ω . We then have

             ψ(z0 ) ∈ Fix(N ) ∩ V (x, Ω) = τ (Fix(N )) ∩ V (x, Ω).

This shows that W meets the image of τ . Thus τ (AG ) is dense in AG .

Proof of Theorem 3.3.1. Let G be a residually ﬁnite group. If Ω is a ﬁnite
subset of G, then there exist, By Lemma 2.7.3, a ﬁnite group Γ and a ho-
momorphism φ : G → Γ such that the restriction of φ to Ω is injective. As
ﬁnite groups are surjunctive by Proposition 3.1.3, it follows that G satisﬁes
the hypothesis of Lemma 3.3.4. Consequently, G is surjunctive.

Corollary 3.3.5. Every free group is surjunctive.

Proof. Free groups are residually ﬁnite by Theorem 2.3.1.

Corollary 3.3.6. Every locally residually ﬁnite group is surjunctive.

Proof. This immediately follows from Theorem 3.3.1 by using Proposi-
tion 3.2.2.

Corollary 3.3.7. Every abelian group is surjunctive.

Proof. This is an immediate consequence of Corollary 3.3.6 since every
abelian group is locally residually ﬁnite by Corollary 2.2.4.
3.4 Marked Groups                                                             61

   When X is a ﬁnite set, every surjective map f : X → X is injective.
Therefore, a surjective cellular automaton with ﬁnite alphabet over a ﬁnite
group is necessarily injective. However, a surjective cellular automaton with
ﬁnite alphabet τ : AG → AG may fail to be injective when the group G is
inﬁnite as shown by the following example.

Example 3.3.8. Take A = Z/2Z = {0, 1} and G = Z. Let τ : AZ → AZ be the
map deﬁned by τ (x)(n) = x(n) + x(n + 1) for all x ∈ AZ and n ∈ Z. Clearly,
τ is a cellular automaton with memory set S = {0, 1} ⊂ Z and local deﬁning
map μ : AS → A given by μ(y) = y(0) + y(1) for all y ∈ AS . The cellular
automaton τ is surjective. Indeed, given an element y ∈ AG , the conﬁguration
x : Z → Z/2Z deﬁned by
                     ⎧
                     ⎪
                     ⎨0                                 if n = 0,
              x(n) = y(0) + y(1) + · · · + y(n − 1)     if n > 0,
                     ⎪
                     ⎩
                       y(n) + y(n + 1) + · · · + y(−1) if n < 0,

satisﬁes τ (x) = y. However τ is not injective since the two constant conﬁgu-
rations have the same image under τ .



3.4 Marked Groups

Let Γ be a group.
   A Γ -quotient is a pair (G, ρ), where G is a group and ρ : Γ → G is a
surjective homomorphism. We deﬁne an equivalence relation on the class of
all Γ -quotients by declaring that two Γ -quotients (G1 , ρ1 ) and (G2 , ρ2 ) are
equivalent when there exists a group isomorphism φ : G2 → G1 such that the
following diagram is commutative:

                                          G2
                                     ρ2


                                 Γ          φ∼
                                             =


                                     ρ1

                                          G1

that is, such that ρ1 = φ ◦ ρ2 . An equivalence class of Γ -quotients is called
a Γ -marked group. Observe that two Γ -quotients (G1 , ρ1 ) and (G2 , ρ2 ) are
equivalent if and only if Ker(ρ1 ) = Ker(ρ2 ). Thus, the set of Γ -marked groups
may be identiﬁed with the set N (Γ ) consisting of all normal subgroups of Γ .
   Let us identify the set P(Γ ) consisting of all subsets of Γ with the set
{0, 1}Γ by means of the bijection from P(Γ ) onto {0, 1}Γ given by A → χA ,
62                                                         3 Surjunctive Groups

where χA : Γ → {0, 1} is the characteristic map of A ⊂ Γ . We equip the set
P(Γ ) = {0, 1}Γ with its prodiscrete uniform structure and N (Γ ) ⊂ P(Γ )
with the induced uniform structure. Thus, a base of entourages of N (Γ ) is
provided by the sets

           VF = {(N1 , N2 ) ∈ N (Γ ) × N (Γ ) : N1 ∩ F = N2 ∩ F },

where F runs over all ﬁnite subsets of Γ . Intuitively, two normal subgroups
of Γ are “close” in N (Γ ) when their intersection with a large ﬁnite subset of
Γ coincide.

Proposition 3.4.1. Let Γ be a group. Then the space N (Γ ) of Γ -marked
groups is a totally disconnected compact Hausdorﬀ topological space.

Proof. The space P(Γ ) = {0, 1}Γ is totally disconnected and Hausdorﬀ by
Proposition 1.2.1. Moreover, P(Γ ) is compact by Corollary A.5.3 since it is
a product of ﬁnite spaces. Thus, it suﬃces to show that N (Γ ) is closed in
P(Γ ). To see this, observe that a subset E ∈ P(Γ ) is a normal subgroup of
Γ if and only if it satisﬁes
(1) 1Γ ∈ E;
(2) αβ −1 ∈ E for all α, β ∈ E;
(3) γαγ −1 ∈ E for all α ∈ E and γ ∈ Γ .
Denoting, for each γ ∈ Γ , by πγ : P(Γ ) = {0, 1}Γ → {0, 1} the projection
map corresponding to the γ-factor, these conditions are equivalent to
(1’) π1Γ (E) = 1;
(2’) πα (E)πβ (E)(παβ −1 (E) − 1) = 0 for all α, β ∈ Γ ;
(3’) πα (E)(πγαγ −1 (E) − 1) = 0 for all α, γ ∈ Γ .
As all projection maps are continuous on P(Γ ), this shows that N (Γ ) is
closed in P(Γ ).

Remark 3.4.2. If Γ is countable then the uniform structure on N (Γ ) is metriz-
able. Indeed, the uniform structure on P(Γ ) = {0, 1}Γ is metrizable when Γ
is countable (cf. Remark 1.9.2).

   Let P be a property of groups. A group Γ is called residually P if for
each element γ ∈ Γ with γ = 1Γ , there exist a group Γ  satisfying P and
an epimorphism φ : Γ → Γ  such that φ(γ) = 1Γ  . Observe that every group
which satisﬁes P is residually P.

Proposition 3.4.3. Let Γ be a group and let P be a property of groups.
Suppose that the class of groups which satisfy P is closed under taking ﬁnite
products and subgroups. Then the following conditions are equivalent:
(a) Γ is residually P;
(b) there exists a net (Ni )i∈I in N (Γ ) which converges to {1Γ } such that
    Γ/Ni satisﬁes P for all i ∈ I.
3.4 Marked Groups                                                               63

Proof. Suppose that Γ is residually P. For all γ ∈ Γ \{1Γ } we can ﬁnd a group
Γγ satisfying P and an epimorphism φγ : Γ → Γγ such that φγ (γ) = 1Γγ . Let
I ⊂ P(Γ ) be the directed set consisting of all ﬁnite subsets of Γ  not containing
1
 Γ partially ordered by inclusion. For i ∈ I we   denote  by  φ i =   γ∈i φγ : Γ →
                                                                            
   γ∈i Γγ the homomorphism deﬁned by φi (γ ) = (φγ (γ ))γ∈I for all γ ∈ Γ .
Set Ni = ker(φi ) and let us show that the net (Ni )i∈I in N (Γ ) converges to
{1Γ }. Given a ﬁnite set F ⊂ Γ set iF = F \ {1Γ }. Let f ∈ F \ {1Γ } and i ∈ I
such that iF ⊂ i. Then φi (f ) = 1Γi since φf (f ) = 1Γf . Thus

                          f∈
                           / Ni and f ∈
                                      / {1Γ } ∩ F.                           (3.1)

It follows that if 1Γ ∈/ F then Ni ∩ F = ∅ = {1Γ } ∩ F . On the other hand,
if 1Γ ∈ F , from (3.1) we deduce Ni ∩ F = {1Γ } = {1Γ } ∩ F . In either cases
we have Ni ∩ F = {1Γ } ∩ F . We deduce
                                        that limi Ni = {1Γ }. Finally, by our
assumptions on P, we have that γ∈i Γγ and its subgroup φi (Γ ) ∼      = Γ/Ni
satisfy P for all i ∈ I. This shows (a) ⇒ (b).
    Suppose now that (b) holds. Let γ ∈ Γ \ {1Γ }. Consider the ﬁnite set
F = {γ}. Then there exists iF ∈ I such that NiF ∩ F = {1Γ } ∩ F and
Γ/NiF satisfy P. As {1Γ } ∩ F = ∅ we have that γ ∈    / NiF . In other words,
if φF : Γ → Γ/NiF denotes the canonical epimorphism, we have φF (γ) =
1Γ/NiF . We deduce that Γ is residually P. This shows (b) ⇒ (a).
   Note that in the above proposition, the assumptions on P are not needed
for the implication (b) ⇒ (a)
   Let A be a set. Consider the set AΓ equipped with its prodiscrete uniform
structure and the Γ -shift action. For each N ∈ N (Γ ), let

               Fix(N ) = {x ∈ AΓ : γx = x for all γ ∈ N } ⊂ AΓ

denote the set of conﬁgurations which are ﬁxed by N . Recall from Proposi-
tion 1.3.6 that Fix(N ) is a closed Γ -invariant subset of AΓ .
   Let us equip P(AΓ ) with the Hausdorﬀ-Bourbaki uniform structure asso-
ciated with the prodiscrete uniform structure on AΓ (see Sect. B.4 for the
deﬁnition of the Hausdorﬀ-Bourbaki uniform structure on the set of subsets
of a uniform space).
Theorem 3.4.4. Let Γ be a group and let A be a set. Then the map
Ψ : N (Γ ) → P(AΓ ) deﬁned by Ψ (N ) = Fix(N ) is uniformly continuous.
Moreover, if A contains at least two elements then Ψ is a uniform embed-
ding.
Proof. Let N0 ∈ N (Γ ) and let W be an entourage of P(AΓ ). Let us show
that there exists an entourage V of N (Γ ) such that

                            Ψ (V [N0 ]) ⊂ W [Ψ (N0 )].                       (3.2)

This will prove that Ψ is continuous. By deﬁnition of the Hausdorﬀ-Bourbaki
uniform structure on P(AΓ ), there is an entourage T of AΓ such that
64                                                          3 Surjunctive Groups

     T = {(X, Y ) ∈ P(AΓ ) × P(AΓ ) : Y ⊂ T [X] and X ⊂ T [Y ]} ⊂ W.      (3.3)

Since AΓ is endowed with its prodiscrete uniform structure, there is a ﬁnite
subset F ⊂ Γ such that

                U = {(x, y) ∈ AΓ × AΓ : πF (x) = πF (y)} ⊂ T,             (3.4)

where πF : AΓ → AF is the projection map. Consider now the ﬁnite subset
E ⊂ Γ deﬁned by

                      E = F · F −1 = {γη −1 : γ, η ∈ F },

and the entourage V of N (Γ ) given by

             V = {(N1 , N2 ) ∈ N (Γ ) × N (Γ ) : N1 ∩ E = N2 ∩ E}.

We claim that V satisﬁes (3.2). To prove our claim, suppose that N ∈ V [N0 ].
Let x ∈ Fix(N ). The fact that N ∩ E = N0 ∩ E implies that if γ and η
are elements of F with γ = νη for some ν ∈ N , then ν ∈ N0 and therefore
x(γ) = x(η). Denoting by ρ0 : Γ → Γ/N0 the canonical epimorphism, we
deduce that we may ﬁnd an element x0 ∈ AΓ/N0 such that x(γ) = x0 ◦ ρ0 (γ)
for all γ ∈ F . We have x0 ◦ ρ0 ∈ Fix(N0 ) and (x, x0 ◦ ρ0 ) ∈ U . Since U ⊂ T
by (3.4), this shows that Fix(N ) ⊂ T [Fix(N0 )]. Therefore Ψ is continuous.
As N (Γ ) is compact by Proposition 3.4.1, we deduce that Ψ is uniformly
continuous by applying Theorem B.2.3.
   Suppose now that A has at least two elements. Let us show that Ψ is
injective. Let N1 , N2 ∈ N (Γ ). Fix two elements a, b ∈ A with a = b and
consider the map x : Γ → A deﬁned by x(γ) = a if γ ∈ N1 and x(γ) = b
otherwise. We clearly have x ∈ Fix(N1 ). Suppose that Ψ (N1 ) = Ψ (N2 ),
that is, Fix(N1 ) = Fix(N2 ). Then for all ν ∈ N2 , we have ν −1 x = x since
x ∈ Fix(N1 ) = Fix(N2 ), and hence x(ν) = ν −1 x(1Γ ) = x(1Γ ) = a. This
implies N2 ⊂ N1 . By symmetry, we also have N1 ⊂ N2 . Therefore N1 = N2 .
This shows that Ψ is injective. As N (Γ ) is compact and P(AΓ ) is Hausdorﬀ,
we conclude that Ψ is a uniform embedding by applying Proposition B.2.5.




3.5 Expansive Actions on Uniform Spaces

Let X be a uniform space and let Γ be a group acting on X. We consider the
diagonal action of Γ on X × X deﬁned by γ(x, y) = (γx, γy) for all γ ∈ Γ
and x, y ∈ X.
   One says that the action of Γ on X is uniformly continuous if the orbit
map X → X, x → γx, is uniformly continuous for each γ ∈ Γ . This is
3.6 Gromov’s Injectivity Lemma                                              65

equivalent to saying that γ −1 V is an entourage of X for all entourage V of
X and γ ∈ Γ .
  The action of Γ on X is said to be expansive if there exists an entourage
W0 of X such that              
                                  γ −1 W0 = ΔX ,                        (3.5)
                                 γ∈Γ

where ΔX = {(x, x) : x ∈ X} denotes the diagonal in X × X. Equality (3.5)
means that if x, y ∈ X satisfy (γx, γy) ∈ W0 for all γ ∈ Γ , then x = y. An
entourage W0 satisfying (3.5) is then called an expansivity entourage for the
action of Γ on X.

Remarks 3.5.1. (a) If a uniform space X admits an expansive uniformly con-
tinuous action of a group Γ , then the topology on X must be Hausdorﬀ.
Indeed, if W0 is an expansivity entourage for such an action then ΔX is
equal to the intersection of the entourages γ −1 W0 , γ ∈ Γ , by (3.5).
   (b) Suppose that B is a base of the uniform structure on X. Then an
action of a group Γ on X is expansive if and only if it admits an expansivity
entourage B0 ∈ B.
   (c) Let (X, d) be a metric space. Then an action of a group Γ on X is
expansive if and only if there exists a real number ε0 > 0 with the following
property: if x, y ∈ X satisfy d(γx, γy) < ε0 for all γ ∈ Γ , then x = y. Such
an ε is called an expansivity constant for the action of Γ on X.

   Our basic example of a uniformly continuous and expansive action is pro-
vided by the following:

Proposition 3.5.2. Let G be a group and let A be a set. Then the G-shift
on AG is uniformly continuous and expansive with respect to the prodiscrete
uniform structure on AG .

Proof. Uniform continuity follows from the fact that G acts on AG by per-
muting coordinates. Expansiveness is due to the fact that the action of G on
itself by left multiplication is transitive. Indeed, consider the entourage W0
of AG deﬁned by

                 W0 = {(x, y) ∈ AG × AG : x(1G ) = y(1G )}.

Given g ∈ G, we have (x, y) ∈ g −1 W0 if and only if x(g −1 ) = y(g −1 ). Thus
      −1
 g∈G g    W0 is equal to the diagonal in AG × AG .



3.6 Gromov’s Injectivity Lemma

The following result will be used in the next section to prove that surjunctive
groups deﬁne a closed subset of the space of Γ -marked groups for any group Γ .
66                                                                     3 Surjunctive Groups

Theorem 3.6.1 (Gromov’s injectivity lemma). Let X be a uniform
space endowed with a uniformly continuous and expansive action of a group Γ .
Let f : X → X be a uniformly continuous and Γ -equivariant map. Suppose
that Y is a subset of X such that the restriction of f to Y is a uniform
embedding. Then there exists an entourage V of X satisfying the following
property: if Z is a Γ -invariant subset of X such that Z ⊂ V [Y ], then the
restriction of f to Z is injective.
   (We recall that the notation Z ⊂ V [Y ] means that for each z ∈ Z there
exists y ∈ Y such that (z, y) ∈ V .)
Proof. By expansivity of the action of Γ , there is an entourage W0 of X such
that                          
                                 γ −1 W0 = ΔX .                          (3.6)
                                   γ∈Γ

It follows from the axioms of a uniform structure that we can ﬁnd a symmetric
entourage S of X such that

                                     S ◦ S ◦ S ⊂ W0 .                                   (3.7)

Since the restriction of f to Y is a uniform embedding, we can ﬁnd an en-
tourage T of X such that

                          (f (y1 ), f (y2 )) ∈ T ⇒ (y1 , y2 ) ∈ S                       (3.8)

for all y1 , y2 ∈ Y . Let U be a symmetric entourage of X such that

                                         U ◦ U ⊂ T.                                     (3.9)

Since f is uniformly continuous, we can ﬁnd an entourage E of X such that

                          (x1 , x2 ) ∈ E ⇒ (f (x1 ), f (x2 )) ∈ U                     (3.10)

for all x1 , x2 ∈ X.
   Let us show that the entourage V = S ∩ E has the required property. So
let Z be a Γ -invariant subset of X such that Z ⊂ V [Y ] and let us show that
the restriction of f to Z is injective.
   Let z  and z  be points in Z such that f (z  ) = f (z  ). Since f is Γ -
equivariant, we have
                                f (γz  ) = f (γz  )                    (3.11)
for all γ ∈ Γ . As the points γz  and γz  stay in Z, the fact that Z ⊂ V [Y ]
implies that there are points yγ and yγ in Y such that (γz  , yγ ) ∈ V and
(γz  , yγ ) ∈ V . Since V ⊂ E, it follows from (3.10) that (f (γz  ), f (yγ )) and
(f (γz  ), f (yγ )) are in U . As U is symmetric, we also have (f (yγ ), f (γz  )) ∈ U .
We deduce that (f (yγ ), f (yγ )) ∈ U ◦ U ⊂ T by using (3.9) and (3.11). This
implies (yγ , yγ ) ∈ S by (3.8). On the other hand, we also have (γz  , yγ ) ∈ S
and (yγ , γz  ) ∈ S since V ⊂ S and S is symmetric. It follows that
3.7 Closedness of Marked Surjunctive Groups                                      67

                          (γz  , γz  ) ∈ S ◦ S ◦ S ⊂ W0

by (3.7). This gives us                         
                              (z  , z  ) ∈         γ −1 W0 ,
                                                γ∈Γ
                 
and hence z = z by (3.6). Thus the restriction of f to Z is injective.



3.7 Closedness of Marked Surjunctive Groups

Theorem 3.7.1. Let Γ be a group. Then the set of normal subgroups N ⊂ Γ
such that the quotient group Γ/N is surjunctive is closed in N (Γ ).

Proof. Let N ∈ N (Γ ) and let (Ni )i∈I be a net in N (Γ ) converging to N .
Suppose that the groups Γ/Ni are surjunctive for all i ∈ I. Let us show that
the group Γ/N is also surjunctive.
    Let A be a ﬁnite set and let τ : AΓ/N → AΓ/N be an injective cellular
automaton over the group Γ/N . Let S ⊂ Γ/N be a memory set for τ with
associated local deﬁning map μ : AS → A. Choose a subset S ⊂ Γ such that
the canonical epimorphism ρ : Γ → Γ/N gives a bijection ψ : S → S, and let
              e
π : AS → AS denote the bijective map induced by ψ. Consider the cellular
automaton τ : AΓ → AΓ over Γ with memory set S and local deﬁning map
                    e
 = μ ◦ π −1 : AS → A. To simplify notation, let us set X = AΓ , f = τ,
μ
Y = Fix(N ) and Zi = Fix(Ni ).
    We claim that the hypotheses of Theorem 3.6.1 are satisﬁed by X, f and
Y . Indeed, we ﬁrst observe that the action of Γ on X is uniformly continuous
and expansive by Proposition 3.5.2. On the other hand, the cellular automa-
ton f : X → X is uniformly continuous and Γ -equivariant by Theorem 1.9.1.
Finally, the restriction of f to Y is injective since this restriction is conjugate
to τ by Proposition 1.6.1. As Y is a closed subset of X and hence compact,
it follows from Proposition B.2.5 that the restriction of f to Y is a uniform
embedding. By applying Theorem 3.6.1, it follows that there exists an en-
tourage V of X such that if Z is a Γ -invariant subset of X with Z ⊂ V [Y ],
then the restriction of f to Z is injective.
    Since the net (Zi )i∈I converges to Y for the Hausdorﬀ-Bourbaki topology
on P(X) by Theorem 3.4.4, there is an element i0 ∈ I such that Zi ⊂ V [Y ]
for all i ≥ i0 . As the sets Zi are Γ -invariant by Proposition 1.3.6, it follows
that the restriction of f to Zi is injective for all i ≥ i0 . On the other hand,
f (Zi ) ⊂ Zi and the restriction of f to Zi is conjugate to a cellular automaton
τi : AΓ/Ni → AΓ/Ni over the group Γ/Ni for all i ∈ I by Proposition 1.6.1. As
the groups Γ/Ni are surjunctive by our hypotheses, we deduce that f (Zi ) =
Zi for all i ≥ i0 . Now, it follows from Proposition B.4.6 that the net (f (Zi ))i∈I
converges to f (Y ) in P(X). Thus, the net (Zi )i∈I converges to both Y and
f (Y ). As Y and f (Y ) are closed in X (by compactness of Y ), we deduce that
68                                                          3 Surjunctive Groups

Y = f (Y ) by applying Proposition B.4.3. This shows that τ is surjective since
τ is conjugate to the restriction of f to Y . Consequently, the group Γ/N is
surjunctive.



Notes

Surjunctive groups were introduced by W. Gottschalk. The ﬁrst results
on these groups are due to W. Lawton who proved in particular Proposi-
tion 3.2.1, Corollary 3.2.3, Theorem 3.3.1, and Corollary 3.3.7 (see [Got],
[Law]).
   The characterization of inﬁnite sets by the existence of injective but not
surjective self-maps is known as Dedekind’s deﬁnition of inﬁnite sets.
   Proposition 3.3.6 together with Mal’cev theorem [Mal1] which says that
every ﬁnitely generated linear group is residually ﬁnite implies that every
linear group is surjunctive.
   The problem of the existence of a non surjunctive group was raised by
Gottschalk in [Got] and remains open up to now. Note that to prove that
all groups are surjunctive it would suﬃce to prove that the symmetric
group Sym(N) is surjunctive (this immediately follows from Proposition 3.2.1,
Proposition 3.2.2, and the fact that every ﬁnitely generated group is count-
able and hence isomorphic to a subgroup of Sym(N) by Cayley’s theorem).
   In [CeC11] it is shown that if G is a non-periodic group, then for every inﬁ-
nite set A there exists a cellular automaton τ : AG → AG whose image τ (AG )
is not closed in AG with respect to the prodiscrete topology (cf. Lemma 3.3.2
and Example 3.3.3).
   Theorem 3.6.1 is a uniform version of Lemma 4.H” in [Gro5]. The proof
presented in this chapter of the surjunctivity of limits of surjunctive groups
(Theorem 3.7.1) closely follows Sect. 4 of [Gro5] (see also [CeC10]). There is
another proof based on techniques from model theory (see [Gro5] and [GlG]).



Exercises

3.1. Let K be an algebraically closed ﬁeld. Show that every injective polyno-
mial map f : K → K is surjective.
3.2. Show that every injective polynomial map f : R → R is surjective.
3.3. Show that the polynomial map f : Q → Q deﬁned by f (x) = x3 is
injective but not surjective.
3.4. Show that every injective holomorphic map f : C → C is surjective.
3.5. Give an example of a real analytic map f : R → R which is injective but
not surjective.
Exercises                                                                  69

3.6. Let K be a ﬁeld and let V be a vector space over K. Show that V is
ﬁnite-dimensional if and only if every injective endomorphism f : V → V is
surjective.
3.7. Let R be a ring and let M be a left (or right) R-module. One says that
M is Artinian if every descending chain N0 ⊃ N1 ⊃ N2 ⊃ . . . eventually
stabilizes (i.e., there is an integer n0 ≥ 0 such that NN = Nn+1 for all
n ≥ n0 ). Show that if M is Artinian then every injective endomorphism
f : M → M is surjective. Hint: Consider the sequence of submodules deﬁned
by Nn = Im(f n ) for n ≥ 0.
3.8. Let U = {z ∈ C : |z| = 1}. Show that every injective continuous map
f : U → U is surjective.
3.9. Let n ≥ 0 be an integer. An n-dimensional topological manifold is a
nonempty Hausdorﬀ topological space X such that each point in X ad-
mits a neighborhood homeomorphic to Rn . Show that if X is a compact
n-dimensional topological manifold, then every injective continuous map
f : X → X is surjective. Hint: Use Brouwer’s invariance of domain to prove
that f (X) is open in X.
3.10. Let P be a property of groups. Show that every subgroup of a locally
P group is itself locally P.
3.11. Let P be a property of groups. Let G be a group. Show that G is locally
P if and only if all its ﬁnitely generated subgroups are locally P.
3.12. Show that the additive group Q is locally cyclic.
3.13. Show that in a locally ﬁnite group every element has ﬁnite order.
3.14. Let G be an abelian group. Show that G is locally ﬁnite if and only if
every element of G has ﬁnite order.
3.15. Show that every subgroup and every quotient of a locally ﬁnite group
is a locally ﬁnite group.
3.16. Let G be a group. Suppose that G contains a normal subgroup H such
that both H and G/H are locally ﬁnite. Show that G is locally ﬁnite.
3.17. Let G be a group which is the limit of an inductive system of locally
ﬁnite groups. Show that G is locally ﬁnite.
3.18. Show that the direct sum of any family of locally ﬁnite groups is a
locally ﬁnite group.
3.19. Let G be a group. Let S denote the set consisting of all normal locally
ﬁnite subgroups of G.
   (a) Show that if H ∈S and K ∈ S then HK ∈ S.
   (b) Show that M = H∈S H is a normal locally ﬁnite subgroup of G and
that every normal locally ﬁnite subgroup of G is contained in M .
70                                                           3 Surjunctive Groups

3.20. Let G be a locally ﬁnite group and let A be a set. Show that every
bijective cellular automaton τ : AG → AG is invertible.

3.21. Let G be a locally ﬁnite group and let A be a ﬁnite set. Show that
every surjective cellular automaton τ : AG → AG is injective.

3.22. Let G be a locally ﬁnite group and let A be a set. Let τ : AG → AG
be a cellular automaton. Show that τ (AG ) is closed in AG with respect to
the prodiscrete topology. Hint: First treat the case when G is ﬁnite, then use
Sect. 1.7 and Proposition A.4.3.

3.23. Let G be a group and let A be a nonzero abelian group. Suppose that
s0 ∈ G is an element of inﬁnite order. Show that the map τ : AG → AG
deﬁned by τ (x)(g) = x(gs0 ) − x(g), for all x ∈ AG and g ∈ G, is a cellular
automaton which is surjective but not injective.

3.24. Let X be an inﬁnite set. Show that the symmetric group Sym(X) is
not locally residually ﬁnite.

3.25. Let G be a group. Suppose that there exists a family (Ni )i∈I of normal
subgroups of G satisfying the following properties:
       for all i and j in I, there exists k in I such that Nk ⊂ Ni ∩ Nj ;
   (1) 
   (2) i∈I Ni = {1G };
   (3) the group G/Ni is surjunctive for each i ∈ I.
   Show that G is surjunctive. Hint: Apply Lemma 3.3.4.

3.26. It follows from Theorem 3.3.1 that every residually ﬁnite group is sur-
junctive. The goal of this exercise is to present an alternative proof of this
result. Let G be a residually ﬁnite group and let A be a ﬁnite set. Let
τ : AG → AG be an injective cellular automaton.
                                                        Fix a family (Γi )i∈I of
subgroups of ﬁnite index of G such that i∈I Γi = {1G } (the existence of
such a family follows from the residual ﬁniteness of G).
    (a) Show that, for each i ∈ I, the set Fix(Γi ) = {x ∈ AG : gx =
x for all g ∈ Γi } is ﬁnite.
    (b) Show that τ(Fix(Γi )) = Fix(Γi ) for all i ∈ I.
    (c) Prove that i∈I Fix(Γi ) is dense in AG and conclude.

3.27. Let X be a set. Let (Ai )i∈I be a net of subsets of X.
   (a) Show that           !           !
                                  Aj ⊂         Aj .
                              i j≥i       i j≥i

   (b) Let B be a subset of X. Show that the net (Ai )i∈I converges to B with
respect to the prodiscrete topology on P(X) = {0, 1}X if and only if
                              !          !
                         B=         Aj =        Aj .
                                i j≥i        i j≥i
Exercises                                                                    71

3.28. Let G be a group and let A be a set. Let H be a subgroup of G.
In Exercise 1.33, we associated with each subshift X ⊂ AH the subshift
X (G) = {x ∈ AG : xH   g ∈ X for all g ∈ G} ⊂ A , where xg = (gx)|H for
                                                    G           H

all x ∈ A , h ∈ H and g ∈ G. Let σ : A → A be a cellular automaton
           G                                H       H

and denote by σ G : AG → AG the induced cellular automaton. Show that
if X, Y ⊂ AH are two subshifts such that σ(X) ⊂ Y , then the cellular
automaton σ G |X (G) : X (G) → Y (G) is injective (resp. surjective) if and only
if the cellular automaton σ|X : X → Y is injective (resp. surjective).

3.29. Let G be a group and let A be a ﬁnite set. Given a subshift Z ⊂ AG
we denote by Zf the set of all conﬁgurations in Z whose G-orbit is ﬁnite
(cf. Example 1.3.1(c)). We say that Z is surjunctive if every injective cellular
automaton σ : Z → Z is surjective. Let X ⊂ AG be a subshift such that Xf
is dense in X.
   (a) Let τ : AG → AG be a cellular automaton. Consider the subshift Y =
τ (X). Show that Yf is dense in Y .
   (b) Deduce from (a) that X is surjunctive.

3.30. Let A be a ﬁnite set and let X ⊂ AZ be an irreducible subshift of ﬁnite
type.
   (a) Show that Xf is dense in X.
   (b) Deduce from (a) and Exercise 3.29(b) that X is surjunctive (compare
with its stronger version in Exercise 6.36).
   (c) Let A = {0, 1} and consider the subshift of ﬁnite type Y ⊂ AZ deﬁned
by Y = {x ∈ AZ : (x(n), x(n + 1)) = (0, 1) for all n ∈ Z}. Show that
Yf consists of the two constant conﬁgurations x0 and x1 and therefore it is
closed but not dense in Y .
   (d) Show that the subshift Y is surjunctive.
   (e) Let A = {0, 1} and let Y as in (c). Consider the associated subshift
Z = Y (Z ) ⊂ AZ deﬁned in Exercise 1.33. Show that Z is an irreducible
          2        2


subshift of ﬁnite type but that Zf is not dense in Z.
   (f) Show that the subshift Z is surjunctive.

3.31. Show that the golden mean subshift is surjunctive. Hint: Use Exer-
cise 1.39 and Exercise 3.30(b).

3.32. Show that the even subshift is surjunctive. Hint: Use Exercise 3.30.

3.33. A subshift of ﬁnite type which is not surjunctive (cf. [Weiss, Sect. 4]).
Let A = {0, 1, 2} and consider the subshift of ﬁnite type X = X(Ω, A) ⊂ AZ
with memory set Ω = {0, 1} ⊂ Z and deﬁning set of admissible words A =
{00, 01, 11, 12, 22} ⊂ AΩ .
   (a) Show that X is not irreducible.
   (b) Consider the cellular automaton σ : AZ → AZ with memory set S =
{0, 1} and local deﬁning map μ : AS → A deﬁned by
72                                                        3 Surjunctive Groups
                             
                              1        if y(0)y(1) = 01
                      μ(y) =
                              y(0)     otherwise.

Show that σ(X) ⊂ X.
  (c) Show that the cellular automaton τ = σ|X : X → X is injective but
not surjective. Deduce that X is not surjunctive.

3.34. Let G be a group and let A be a ﬁnite set. Suppose that G contains an
element of inﬁnite order and that A contains at least two distinct elements.
   (a) Show that there exists a subshift X ⊂ AG which is not surjunctive.
   (b) Show that if, in addition, G is not inﬁnite cyclic then there exists an
irreducible subshift X ⊂ AG which is not surjunctive. Hint: Use Exercise 3.33
and Exercise 1.33(c).

3.35. Given a group Γ acting continuously on a topological space Z, a subset
M ⊂ Z is called a minimal set if M is a nonempty Γ -invariant subset of Z
and the Γ -orbit of every point m ∈ M is dense in M .
   Let G be a group and let A be a set. A subshift X ⊂ AG is called minimal
if X is a minimal set with respect to the G-shift action on AG .
   (a) Show that a subshift X ⊂ AG is minimal if and only if X = ∅ and
there is no subshift Y in AG such that ∅ = Y  X.
   (b) Show that every minimal subshift X ⊂ AG is irreducible.
   (c) Show that the ﬁnite minimal subshifts in AG are precisely the ﬁnite
G-orbits.
   (d) Show that if X ⊂ AG is an inﬁnite minimal subshift then the G-orbit
of every conﬁguration x ∈ X is inﬁnite.
   (e) Show that if X and Y are minimal subshifts in AG then either X = Y
or X ∩ Y = ∅.

3.36. Let G be a group and let A be a ﬁnite set. Let X, Y ⊂ AG be two
subshifts. Show that if X is nonempty and Y is minimal then every cellular
automaton τ : X → Y is surjective.

3.37. Let G be a group and let A be a ﬁnite set. Show that every minimal
subshift X ⊂ AG is surjunctive.

3.38. Let G be a group and let A be a ﬁnite set. Show that every nonempty
subshift X ⊂ AG contains a minimal subshift. Hint: Apply Zorn’s lemma to
the set of nonempty subshifts contained in X.

3.39. Let G be a group and let A be a set. A subset R ⊂ G is called syndetic
if there exists a ﬁnite subset K ⊂ G such that the set Kg meets R for every
g ∈ G. A conﬁguration x ∈ AG is called almost periodic if for every ﬁnite
subset Ω ⊂ G the set R(x, Ω) = {g ∈ G : (gx)|Ω = x|Ω } is syndetic in G.
    (a) Show that if x ∈ AG is an almost periodic conﬁguration then its orbit
closure X = Gx ⊂ AG is a minimal subshift. Hint: Suppose that the orbit
closure X = Gx of a conﬁguration x ∈ AG is not minimal. Then there exists
Exercises                                                                      73

a nonempty subshift Y ⊂ X with x ∈    / Y . This implies that there is a ﬁnite
subset Ω ⊂ G such that x|Ω = y|Ω for all y ∈ Y . Let K be a ﬁnite subset
of G and consider the set Ω  = K −1 Ω. Choose an arbitrary conﬁguration
y0 ∈ Y . Since y0 ∈ X, there is an element g0 ∈ G such that (g0 x)|Ω  = y0 |Ω  .
This implies that (kg0 x)|Ω = (ky0 )|Ω = x|Ω for all k ∈ K. Thus Kg0 does
not meet R(x, Ω) so that x is not almost-periodic.
   (b) Suppose that the set A is ﬁnite. Show that if X ⊂ AG is a minimal
subshift, then every conﬁguration x ∈ X is almost-periodic. Hint: Observe
that if Ω ⊂ G is a ﬁnite subset and x ∈ X, then the open sets gV , where
V = {y ∈ AG : y|Ω = x|Ω } and g runs over G, cover X by minimality and
use the compactness of X.
   (c) Suppose that the set A is ﬁnite. Show that a nonempty subshift X ⊂
AG is minimal if and only if X is irreducible and every conﬁguration x ∈ X
is almost-periodic.

3.40. Let A be a set. The language of a conﬁguration x ∈ AZ is the subset
L(x) ⊂ A∗ consisting of all words w ∈ A∗ which can be written in the form
w = x(n + 1)x(n + 2) . . . x(n + m) for some integers n ∈ Z and m ≥ 0.
   (a) Let X ⊂ AZ be a subshift and let x ∈ X. Show that L(x) ⊂ L(X) and
that one has L(x) = L(X) if and only if the Z-orbit of x is dense in X.
   (b) Show that a nonempty subshift X ⊂ AZ is minimal if and only if one
has L(x) = L(X) for all x ∈ X.
   (c) Show that a conﬁguration x ∈ AZ is almost periodic if and only if
it satisﬁes the following condition: for every word u ∈ L(x), there exists an
integer n = n(u) ≥ 0 such that u is a subword of any word v ∈ L(x) of
length n.

3.41. The Thue-Morse sequence. Let A = {0, 1}. The Thue-Morse sequence
is the map x : N → A deﬁned by
          
           1 if the number of ones in the binary expansion of n is odd
   x(n) =
           0 otherwise.

   (a) Check that

                    x(0)x(1) . . . x(16) = 0110100110010110.

   (b) Show that one has x(k + 3m2n ) = x(k) for all k, m, n ∈ N such that
0 ≤ k ≤ 2n .
   (c) Show that x satisﬁes the recurrence relations
                         ⎧
                         ⎪
                         ⎨x(0) = 0
                           x(2n) = x(n)
                         ⎪
                         ⎩
                           x(2n + 1) = 1 − x(n)

and that these relations uniquely determine x.
74                                                                3 Surjunctive Groups

   (d) Consider the unique monoid homomorphism ϕ : A∗ → A∗ which satis-
ﬁes
                        ϕ(0) = 01 and ϕ(1) = 10.
Show that

                ϕ(x(0)x(1) . . . x(2n − 1)) = x(0)x(1) . . . x(2n+1 − 1)

for all n ∈ N.
   (e) Consider the unique monoid isomorphism ι : A∗ → A∗ which satisﬁes

                               ι(0) = 1 and ι(1) = 0.

Show that

     x(0)x(1) . . . x(2n+1 − 1) = x(0)x(1) . . . x(2n − 1)ι(x(0)x(1) . . . x(2n − 1))

for all n ∈ N.
   Note: The Thue-Morse sequence was ﬁrst studied by E. Prouhet in a 1851
paper dealing with problems in number theory. It is an example of an auto-
matic sequence (see [AlS, Sect. 5.1]).

3.42. The Morse subshift. Let A = {0, 1} and let L = {(x(n), x(n + 1),
. . . , x(n + m)) : n, m ∈ N} ⊂ A∗ , where x : N → A is the Thue-Morse
sequence.
     (a) Show that the set L satisﬁes the conditions (i) and (ii) in Exer-
cise 1.36(b).
     (b) Let X ⊂ AZ denote the unique subshift whose language is L(X) = L
(cf. Exercise 1.36(c)). Show that X is an inﬁnite minimal subshift (it is called
the Morse subshift). Hint: Use Exercises 3.39(a), 3.40 and 3.41(b).

3.43. Toeplitz subshifts. Let A be a ﬁnite set. A conﬁguration x ∈ AZ is said
to be a Toeplitz conﬁguration if for every n ∈ Z there exists k ≥ 1 such that
x(n) = x(n + kr) for all r ∈ Z. In other words, x is a Toeplitz conﬁguration
if there exists a partition of Z into arithmetic progressions such that x is
constant on each element of the partition. Given a Toeplitz conﬁguration
x ∈ AZ and n ∈ Z we set

               k(x, n) = min{k ≥ 1 : x(n) = x(n + kr) for all r ∈ Z}.

One says that a subshift X ⊂ AZ is a Toeplitz subshift if it is the orbit closure
of some Toeplitz conﬁguration x ∈ AZ .
   (a) Let x ∈ AZ be a Toeplitz conﬁguration. Show that the Z-orbit of x is
ﬁnite if and only if the set {k(x, n) : n ∈ Z} is ﬁnite.
   (b) Show that every Toeplitz conﬁguration x ∈ AZ is almost-periodic.
Hint: Use Exercise 3.40.
   (c) Show that every Toeplitz subshift X ⊂ AZ is minimal.
Exercises                                                                  75

3.44. Let A be a ﬁnite set and let X ⊂ AZ be a Toeplitz subshift.
   (a) Show that X is irreducible. Hint: Use Exercises 3.43(d) and 3.35.
   (b) Show that X is surjunctive. Hint: Use Exercises 3.43(d) and 3.37.
Chapter 4
Amenable Groups




This chapter is devoted to the class of amenable groups. This is a class of
groups which plays an important role in many areas of mathematics such as
ergodic theory, harmonic analysis, representation theory, dynamical systems,
geometric group theory, probability theory and statistics. As residually ﬁnite
groups, amenable groups generalize ﬁnite groups but there are residually ﬁ-
nite groups which are not amenable and there are amenable groups which
are not residually ﬁnite. An amenable group is a group whose subsets admit
an invariant ﬁnitely additive probability measure (see Sect. 4.4). The class of
amenable groups contains in particular all ﬁnite groups, all abelian groups
and, more generally, all solvable groups (Theorem 4.6.3). It is closed under the
operations of taking subgroups, taking quotients, taking extensions, and tak-
ing inductive limits (Sect. 4.5). The notion of a Følner net, roughly speaking,
a net of almost invariant ﬁnite subsets of a group, is introduced in Sect. 4.7.
Paradoxical decompositions are deﬁned in Sect. 4.8. The Følner-Tarski the-
orem (Theorem 4.9.1) asserts that amenability, existence of a Følner net,
and non-existence of a paradoxical decomposition are three equivalent con-
ditions for groups. Another characterization of amenable groups is given in
Sect. 4.10: a group is amenable if and only if every continuous aﬃne action of
the group on a nonempty compact convex subset of a Hausdorﬀ topological
vector space admits a ﬁxed point (Corollary 4.10.2).



4.1 Measures and Means

Let E be a set. We shall denote by P(E) the set of all subsets of E.

Deﬁnition 4.1.1. A map μ : P(E) → [0, 1] is called a ﬁnitely additive prob-
ability measure on E if it satisﬁes the following properties:
(1) μ(E) = 1,
(2) μ(A ∪ B) = μ(A) + μ(B) for all A, B ∈ P(E) such that A ∩ B = ∅.

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,       77
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 4, © Springer-Verlag Berlin Heidelberg 2010
78                                                            4 Amenable Groups

Example 4.1.2. Let F be a nonempty ﬁnite subset of E. Then the map
μF : P(E) → [0, 1] deﬁned by

                                           |A ∩ F |
                                μF (A) =
                                             |F |

for all A ⊂ E, is a ﬁnitely additive probability measure on E.

Proposition 4.1.3. Let μ : P(E) → [0, 1] be a ﬁnitely additive probability
measure on E. Then one has:
  (i) μ(∅) = 0;
 (ii) μ(A ∪ B) = μ(A) + μ(B) − μ(A ∩ B);
(iii) μ(A ∪ B) ≤ μ(A) + μ(B);
(iv) A ⊂ B ⇒ μ(B \ A) = μ(B) − μ(A);
 (v) A ⊂ B ⇒ μ(A) ≤ μ(B);
for all A, B ∈ P(E).

Proof. We have μ(E) = μ(E ∪ ∅) = μ(E) + μ(∅), which implies (i). For
all A, B ∈ P(E), we have μ(A ∪ B) = μ(A) + μ(B \ A) and μ(B) = μ(A ∩
B) + μ(B \ A), which gives (ii). Since μ(A ∩ B) ≥ 0, equality (ii) implies
(iii). If A ⊂ B, we have μ(B) = μ(B \ A) + μ(A), which implies (iv). Finally,
inequality (v) follows from (iv) since μ(B \ A) ≥ 0.

   Consider now the real vector space ∞ (E) consisting of all bounded func-
tions x : E → R. Recall that ∞ (E) is a Banach space for the norm  · ∞
deﬁned by
                            x∞ = sup |x(a)|.
                                       a∈E
           ∞
We equip  (E) with the partial ordering ≤ given by

                      x ≤ y ⇐⇒ (x(a) ≤ y(a) for all a ∈ E).

For each λ ∈ R, we shall also denote by λ the element of ∞ (E) which is
identically equal to λ on E.

Deﬁnition 4.1.4. A mean on E is a linear map m : ∞ (E) → R such that:
(1) m(1) = 1,
(2) x ≥ 0 ⇒ m(x) ≥ 0
for all x ∈ ∞ (E).

Example 4.1.5. Let S be a countable (ﬁnite or inﬁnite) subset of E and let
f : S → R such that:
(C1) f(s) > 0 for all s ∈ S;
(C2) s∈S f (s) = 1.
4.1 Measures and Means                                                       79

Then the map mf : ∞ (E) → R deﬁned by

                            mf (x) =         f (s)x(s)
                                       s∈S

is a mean on E.
   One says that a mean m on E has ﬁnite (resp. countable) support if there
exists a ﬁnite (resp. countable) subset S ⊂ E and a map f : S → R satisfying
conditions (C1) and (C2) above such that m = mf .

Proposition 4.1.6. Let m : ∞ (E) → R be a mean on E. Then one has:
  (i) m(λ) = λ,
 (ii) x ≤ y ⇒ m(x) ≤ m(y),
(iii) inf E x ≤ m(x) ≤ supE x,
(iv) |m(x)| ≤ x∞ ,
for all λ ∈ R and x, y ∈ ∞ (E).

Proof. (i) By linearity, we have m(λ) = λm(1) = λ.
  (ii) If x ≤ y then m(y) − m(x) = m(y − x) ≥ 0 and thus m(x) ≤ m(y).
  (iii) We have inf E x ≤ x ≤ supE x and therefore inf E x ≤ m(x) ≤ supE x
by applying (i) and (ii).
  (iv) From (iii) we get −x∞ ≤ m(x) ≤ x∞ , that is, |m(x)| ≤ x∞ .

   Consider the topological dual of ∞ (E), that is, the vector space (∞ (E))∗
consisting of all continuous linear maps u : ∞ (E) → R.
   Recall that (∞ (E))∗ is a Banach space for the operator norm  ·  deﬁned
by
                              u = sup |u(x)|                             (4.1)
                                     x   ∞ ≤1


for all u ∈ (∞ (E))∗ .

Proposition 4.1.7. Let m : ∞ (E) → R be a mean on E. Then m ∈
(∞ (E))∗ and m = 1.

Proof. By deﬁnition m is linear. Inequality (iv) in Proposition 4.1.6 shows that
m is continuous and satisﬁes m ≤ 1. Since m(1) = 1, we have m = 1.

   Let PM(E) (resp. M(E)) denote the set of all ﬁnitely additive probability
measures (resp. of all means) on E. We are going to show that there is a
natural bijection between the sets PM(E) and M(E). This natural bijection,
which is analogous to the Riesz representation in measure theory, may be used
to view ﬁnitely additive measures on E as points in the dual space (∞ (E))∗
where classical techniques of functional analysis may be applied.
   For each subset A ⊂ E, we denote by χA the characteristic map of A,
that is, the map χA : E → R deﬁned by χA (x) = 1 if x ∈ A and χA (x) = 0
otherwise.
80                                                                      4 Amenable Groups

     Let m ∈ M(E). Consider the map m : P(E) → R given by

                                      m(A) = m(χA ).

Observe that 0 ≤ χA ≤ 1 and therefore m(A) ∈ [0, 1] by Proposition 4.1.6(ii).
We have m(E) = m(χE ) = m(1) = 1. On the other hand, if A and B are
disjoint subsets of E, we have χA∪B = χA + χB and thus m(A ∪ B) =
m(A) + m(B) by linearity of m. It follows that m ∈ PM(E).
Theorem 4.1.8. The map Φ : M(E) → PM(E) deﬁned by Φ(m) = m is
bijective.
   The proof will be divided in several steps.
   Denote by E(E) the set of all maps x : E → R which take only ﬁnitely
many values. Observe that E(E) is the vector subspace of ∞ (E) spanned by
the set of characteristic maps {χA : A ⊂ E}.
Lemma 4.1.9. The vector subspace E(E) is dense in ∞ (E).
Proof. Let x ∈ ∞ (E) and ε > 0. Set α = inf E x and β = supE x. Choose
an integer n ≥ 1 such that (β − α)/n < ε and set λi = α + i(β − α)/n for
i = 1, 2, . . . , n. Consider the map y : E → R deﬁned by

                               y(a) = min{λi : x(a) ≤ λi }

for all a ∈ E. The map y take its values in the set {λ1 , . . . , λn }. Thus y ∈
E(E). We have x − y∞ ≤ (β − α)/n < ε by construction. Consequently,
E(E) is dense in ∞ (E).
     Let μ ∈ PM(E). Let us set, for all x ∈ E(E),

                                   μ(x) =         μ(x−1 (λ))λ.                       (4.2)
                                            λ∈R

Observe that there is only a ﬁnite number of nonzero terms in the right-hand
side of (4.2) since x ∈ E(E) and μ(∅) = 0.
Lemma 4.1.10. Let x ∈ E(E). Suppose that there is a ﬁnite partition (Ai )i∈I
of E such that the restriction of x to Ai is constant equal to αi for each i ∈ I.
Then one has
                              μ(x) =      μ(Ai )αi .
                                              i∈I

Proof. Since μ is ﬁnitely additive, we have
                                      
                μ(Ai )αi =                  μ(Ai ) λ =         μ(x−1 (λ))λ = μ(x).
          i∈I                λ∈R    αi =λ                λ∈R
4.1 Measures and Means                                                      81

Lemma 4.1.11. The map μ : E(E) → R is linear and continuous.
Proof. Let x, y ∈ E(E) and ξ, η ∈ R. Denote by V (resp. W ) the set of values
taken by x (resp. y). The subsets x−1 (α) ∩ y −1 (β), (α, β) ∈ V × W , form a
ﬁnite partition of E. By applying Lemma 4.1.10, we get

           μ(ξx + ηy) =                 μ(x−1 (α) ∩ y −1 (β))(ξα + ηβ)
                           (α,β)∈V ×W
                            ⎛                                      ⎞

                         = ξ⎝              μ(x−1 (α) ∩ y −1 (β))α⎠
                              (α,β)∈V ×W
                                ⎛                                      ⎞

                            + ⎝η                 μ(x−1 (α) ∩ y −1 (β))β ⎠
                                    (α,β)∈V ×W

                         = ξμ(x) + ημ(y).

Consequently, μ is linear.
  Formula (4.2) implies inf E x ≤ μ(x) ≤ supE x since

                                 μ(x−1 (λ)) = μ(E) = 1.
                           λ∈R

It follows that |μ(x)| ≤ x∞ for all x ∈ E(E). This shows that the linear
map μ is continuous.
Lemma 4.1.12. Let X be a normed vector space and let Y be a dense vector
subspace of X. Suppose that ϕ : Y → R is a continuous linear map. Then
                                      : X → R extending ϕ (that is, such
there exists a continuous linear map ϕ
      Y = ϕ).
that ϕ|
Proof. Let x ∈ X. Since Y is dense in X, we can ﬁnd a sequence (yn )n≥0 of
points of Y which converges to x. The sequence (ϕ(yn )) is a Cauchy sequence
since
               |ϕ(yp ) − ϕ(yq )| = |ϕ(yp − yq )| ≤ ϕyp − yq 
for all p, q ≥ 0. As R is complete, this sequence converges. Set ϕ(x)       =
lim ϕ(yn ). If (yn ) is another sequence of points in Y converging to x, then
|ϕ(yn ) − ϕ(yn )| ≤ ϕyn − yn . Thus we have lim ϕ(yn ) = lim ϕ(yn ).
This shows that ϕ(x)      does not depend of the choice of the sequence (yn ).
The linearity of ϕ gives the linearity of ϕ    by taking limits. We also get
ϕ(x)
        ≤ ϕx for all x ∈ X by taking limits. This shows that the linear
map ϕ   is continuous. If x ∈ Y , we have ϕ(x)
                                                 = ϕ(x) since we can take as
(yn ) the constant sequence yn = x in this case. Thus ϕ   extends ϕ.
Proof of Theorem 4.1.8. Let μ ∈ PM(E). By Lemma 4.1.9, Lemma 4.1.11
and Lemma 4.1.12, the map μ : E(E) → R can be extended to a continuous
            : ∞ (E) → R. We have
linear map μ
82                                                          4 Amenable Groups

                          (1) = μ(1) = μ(E) = 1.
                          μ

If y ∈ E(E) and y ≥ 0, then μ   (y) = μ(y) ≥ 0 by (4.2). Consider now an
element x ∈ ∞ (E) such that x ≥ 0. Let (yn )n≥0 be a sequence of elements
of E(E) converging to x. Let us set zn = |yn |. Since zn ∈ E(E) and zn ≥ 0, we
have μ(zn ) ≥ 0. On the other hand, the sequence (zn ) converges to x since,
by the triangle inequality, x − zn ∞ ≤ x − yn ∞ . It follows that

                           (x) = lim μ(zn ) ≥ 0.
                           μ
                                   n→∞

      ∈ M(E).
Thus μ
  For every subset A ⊂ E, we have

                           (χA ) = μ(χA ) = μ(A).
                           μ

Therefore Φ(μ) = μ. This proves that Φ is surjective.
   It remains to show that Φ is injective. To see this, consider m1 , m2 ∈ M(E)
such that Φ(m1 ) = Φ(m2 ). This means that m1 (χA ) = m2 (χA ) for every
subset A ⊂ E. By linearity, this implies that m1 and m2 coincide on E(E).
Since E(E) is dense in ∞ (E) by Lemma 4.1.9, we deduce that m1 = m2 by
continuity of m1 and m2 . This shows that Φ is injective.



4.2 Properties of the Set of Means

Let E be a set.
   The topology on (∞ (E))∗ associated with the operator norm  ·  deﬁned
in (4.1) is called the strong topology on (∞ (E))∗ . Another topology that is
commonly used is the weak-∗ topology on (∞ (E))∗ . Recall that the weak-∗
topology on (∞ (E))∗ is by deﬁnition the smallest topology for which the
evaluation map

                            ψx : (∞ (E))∗ → R
                                         u → u(x)

is continuous for each x ∈ ∞ (E) (see Sect. F.2).
   By Proposition 4.1.7, the set M(E) is contained in the unit sphere

                         {u : u = 1} ⊂ (∞ (E))∗ .

The following result will play an important role in the sequel.

Theorem 4.2.1. The set M(E) is a convex compact subset of (∞ (E))∗ with
respect to the weak-∗ topology.
4.3 Measures and Means on Groups                                            83

Proof. Let m1 , m2 ∈ M(E) and t ∈ [0, 1]. Then (tm1 + (1 − t)m2 )(1) =
tm1 (1) + (1 − t)m2 (1) = t + (1 − t) = 1 and (tm1 + (1 − t)m2 )(x) = tm1 (x) +
(1 − t)m2 (x) ≥ 0 for all x ∈ ∞ (E) such that x ≥ 0. Thus tm1 + (1 − t)m2 ∈
M(E). This shows that M(E) is convex. Equip now (∞ (E))∗ with the
weak-∗ topology and suppose that (mi )i∈I is a net in M(E) converging to
u ∈ (∞ (E))∗ . Then, for every i ∈ I, we have ψ1 (mi ) = mi (1) = 1 and
ψx (mi ) = mi (x) ≥ 0 for all x ∈ ∞ (E) such that x ≥ 0. By taking limits,
we get u(1) = ψ1 (u) = 1 and u(x) = ψx (u) ≥ 0 for all x ∈ ∞ (E) such
that x ≥ 0. Thus u ∈ M(E). This shows that M(E) is closed in (∞ (E))∗
(Proposition A.2.1). As M(E) is contained in the unit ball of (∞ (E))∗ ,
which is compact for the weak-∗ topology by the Banach-Alaoglu Theorem
(Theorem F.3.1), it follows that M(E) is compact.



4.3 Measures and Means on Groups

In this section, we shall see that the set of ﬁnitely additive measures and the
set of means carry additional structure when the underlying set is a group.
Indeed, in this case, the group naturally acts on both sets. Moreover, there
are involutions coming from the operation of taking inverses in the group.
   More precisely, let G be a group.
   The group G naturally acts on the left and on the right on each of the sets
PM(G) and M(G) in the following way.
   Firstly, for μ ∈ PM(G) and g ∈ G, we deﬁne the maps gμ : P(G) → [0, 1]
and μg : P(G) → [0, 1] by

                gμ(A) = μ(g −1 A)    and    μg(A) = μ(Ag −1 )

for all A ∈ P(G). One clearly has gμ ∈ PM(G) and μg ∈ PM(G). Moreover,
it is straightforward to check that the map (g, μ) → gμ (resp. (μ, g) → μg)
deﬁnes a left (resp. right) action of G on PM(G). Note that these two actions
commute in the sense that g(μh) = (gμ)h for all g, h ∈ G and μ ∈ PM(G).
    On the other hand, recall that we introduced in Sect. 1.1 a left action of
G on RG (the G-shift) by deﬁning, for all g ∈ G and x ∈ RG , the element
gx ∈ RG by
                       gx(g  ) = x(g −1 g  ) for all g  ∈ G.
Similarly, we make G act on the right on RG by deﬁning the element xg ∈ RG
by
                    xg(g  ) = x(g  g −1 ) for all g  ∈ G.
These two actions of G on RG are linear and commute. Moreover, the vec-
tor subspace ∞ (G) ⊂ RG is left invariant by both actions. Observe that
gx∞ = xg∞ = x∞ for all g ∈ G and x ∈ ∞ (G). Thus the left (resp.
right) action of G on ∞ (G) is isometric (and therefore continuous).
84                                                              4 Amenable Groups

   By duality, we also get a left and a right action of G on (∞ (G))∗ . More
precisely, for g ∈ G and u ∈ (∞ (G))∗ , we deﬁne the elements gu and ug by

                  gu(x) = u(g −1 x)      and    ug(x) = u(xg −1 ),

for all x ∈ ∞ (G). We have gu ∈ (∞ (G))∗ and ug ∈ (∞ (G))∗ since the left
and right actions of G on ∞ (G) are linear and continuous.
   Note that the set M(G) is invariant under both actions of G on (∞ (G))∗ .

Proposition 4.3.1. The left (resp. right) action of G on M(G) is aﬃne and
continuous with respect to the weak-∗ topology on M(G).

Proof. It is clear that the left (resp. right) action of G on (∞ (G))∗ is linear.
On the other hand, these actions are continuous if we equip (∞ (G))∗ with
the weak-∗ topology. Indeed, if we ﬁx g ∈ G, the map u → gu is continuous
on (∞ (G))∗ since, for each x ∈ ∞ (G), the map u → gu(x) is the evalua-
tion map at g −1 x, which is continuous by deﬁnition of the weak-∗ topology.
Similarly, the map u → ug is continuous. Since M(G) is a convex subset of
(∞ (G))∗ , we deduce that the restrictions of both actions to M(G) are aﬃne
and continuous.

     Given μ ∈ PM(G), we deﬁne the map μ∗ : P(G) → [0, 1] by

                       μ∗ (A) = μ(A−1 ) for all A ∈ P(G).

It is clear that μ∗ ∈ PM(G) and that the map μ → μ∗ is an involution of
PM(G).
   For x ∈ ∞ (G), deﬁne x∗ ∈ ∞ (G) by

                           x∗ (g) = x(g −1 ) for all g ∈ G.

The map x → x∗ is an isometric involution of ∞ (G). By duality, it gives an
isometric involution u → u∗ of (∞ (G))∗ deﬁned by

                       u∗ (x) = u(x∗ )    for all x ∈ ∞ (G).

Note that m∗ ∈ M(G) for all m ∈ M(G).

Proposition 4.3.2. Let g ∈ G, x ∈ ∞ (G), μ ∈ PM(G) and u ∈ (∞ (G))∗ .
Then one has
   (i) (gx)∗ = x∗ g −1 ;
  (ii) (xg)∗ = g −1 x∗ ;
 (iii) (gμ)∗ = μ∗ g −1 ;
 (iv) (μg)∗ = g −1 μ∗ ;
  (v) (gu)∗ = u∗ g −1 ;
 (vi) (ug)∗ = g −1 u∗ .
4.4 Deﬁnition of Amenability                                                    85

Proof. For every h ∈ G, we have

           (gx)∗ (h) = gx(h−1 ) = x(g −1 h−1 ) = x∗ (hg) = x∗ g −1 (h),

which gives (gx)∗ = x∗ g −1 . The proofs of the other properties are similar.

Proposition 4.3.3. Let g ∈ G and m ∈ M(G). Then one has:
      " = g m;
  (i) gm
      " = mg;
 (ii) mg
      "∗ = m∗ .
(iii) m

   We need the following result.

Lemma 4.3.4. Let g ∈ G and A ⊂ G. Then one has:
   (i) (χA )∗ = χA−1 ;
  (ii) gχA = χgA .

Proof. (i) For h ∈ G one has (χA )∗ (h) = χA (h−1 ) = 1 ⇔ h−1 ∈ A ⇔ h ∈
A−1 ⇔ χA−1 (h) = 1. This shows that (χA )∗ = χA−1 . (ii) For h ∈ G one
has (gχA )(h) = χA (g −1 h) = 1 ⇔ g −1 h ∈ A ⇔ h ∈ gA ⇔ χgA (h) = 1. This
shows that gχA = χgA .

Proof of Proposition 4.3.3. For every A ∈ P(G), we have, using Lem-
ma 4.3.4(ii),

     "
     gm(A) = gm(χA ) = m(g −1 χA ) = m(χg−1 A ) = m(g −1 A) = g m(A).

     " = g m. Similarly, we get mg
Thus gm                          " = mg.
  On the other hand, for every A ∈ P(G), using Lemma 4.3.4(i) one obtains

                                                             "∗ (A)
       m∗ (A) = m(A−1 ) = m(χA−1 ) = m((χA )∗ ) = m∗ (χA ) = m

                         "∗ .
and this shows that m∗ = m

Remark 4.3.5. Properties (i) and (ii) in Proposition 4.3.3 say that the bi-
jective map Φ : M(G) → PM(G) given by m → m (see Theorem 4.1.8) is
bi-equivariant.



4.4 Deﬁnition of Amenability

Let G be a group.
   A ﬁnitely additive probability measure μ ∈ PM(G) is called left-invariant
(resp. right-invariant) if μ is ﬁxed under the left (resp. right) action of G on
PM(G), that is, if it satisﬁes gμ = μ (resp. μg = μ) for all g ∈ G. One says
that μ is bi-invariant if μ is both left and right-invariant.
86                                                           4 Amenable Groups

   Similarly, a mean m ∈ M(G) is called left-invariant (resp. right-invariant)
if m is ﬁxed under the left (resp. right) action of G on M(G). One says that
m is bi-invariant if m is both left and right invariant.

Proposition 4.4.1. Let μ ∈ PM(G). Then μ is left-invariant (resp. right-
invariant) if and only if μ∗ is right-invariant (resp. left-invariant).

Proof. This immediately follows from Proposition 4.3.2(ii).

Proposition 4.4.2. Let m ∈ M(G). Then m is left-invariant (resp. right-
invariant) if and only if m∗ is right-invariant (resp. left-invariant).

Proof. This immediately follows from Proposition 4.3.2(iii).

Proposition 4.4.3. Let m ∈ M(G). Then m is left-invariant (resp. right-
invariant, resp. bi-invariant) if and only if the associated ﬁnitely additive
probability measure m ∈ PM(G) is left-invariant (resp. right-invariant, resp.
bi-invariant).

Proof. This immediately follows from assertions (i) and (ii) of Proposi-
tion 4.3.3.

Proposition 4.4.4. Let G be a group. Then the following conditions are
equivalent:
(a) there exists a left-invariant ﬁnitely additive probability measure
    μ : P(G) → [0, 1] on G;
(b) there exists a right-invariant ﬁnitely additive probability measure
    μ : P(G) → [0, 1] on G;
(c) there exists a bi-invariant ﬁnitely additive probability measure
    μ : P(G) → [0, 1] on G;
(d) there exists a left-invariant mean m : ∞ (G) → R on G;
(e) there exists a right-invariant mean m : ∞ (G) → R on G;
(f) there exists a bi-invariant mean m : ∞ (G) → R on G.

Proof. Equivalences (a) ⇔ (d), (b) ⇔ (e) and (c) ⇔ (f) immediately follow
from Proposition 4.4.3. The equivalence between (a) and (b) follows from
Proposition 4.4.1. Implication (f) ⇒ (d) is trivial.
    Thus it suﬃces to show (d) ⇒ (f) to conclude. Suppose that there exists
a left-invariant mean m : ∞ (G) → R. For each x ∈ ∞ (G), deﬁne the map
 : G → R by
x
                        (g) = m(xg) for all g ∈ G.
                        x
By Proposition 4.1.6(iv), we have

                     |
                      x(g)| = |m(xg)| ≤ xg∞ = x∞ .

           ∈ ∞ (G) for all x ∈ ∞ (G). Consider now the map M : ∞ (G) →
Therefore x
R deﬁned by
4.4 Deﬁnition of Amenability                                               87

                                  x) for all x ∈ ∞ (G).
                        M (x) = m(
Clearly M is a mean on G.
  Let h ∈ G and x ∈ ∞ (G). For all g ∈ G, we have

                       #
                       hx(g)                    (g),
                             = m(hxg) = m(xg) = x

                                          #=x
since m is left-invariant. We deduce that hx . This implies

                                  # = m(
                       M (hx) = m(hx)   x) = M (x).

Consequently M is left-invariant. On the other hand, for all g ∈ G, we have

              #
              xh(g)                         (hg) = h−1 x
                    = m((xh)g) = m(x(hg)) = x           (g).

                 # = h−1 x
It follows that xh       . Therefore, by using again the fact that m is
left-invariant, we get

                           # = m(h−1 x
                M (xh) = m(xh)       ) = m(
                                            x) = M (x).

Therefore the mean M is also right-invariant. This shows that (d) implies (f).


Deﬁnition 4.4.5. A group G is called amenable if it satisﬁes one of the
equivalent conditions of Proposition 4.4.4.

Proposition 4.4.6. Every ﬁnite group is amenable.

Proof. If G is a ﬁnite group, then the map μ : P(G) → [0, 1] deﬁned by

                                 |A|
                        μ(A) =         for all A ∈ P(G)
                                 |G|

is a bi-invariant ﬁnitely additive probability measure on G.

Theorem 4.4.7. The free group on two generators F2 is not amenable.

Proof. Suppose that there exists a left-invariant ﬁnitely additive probability
measure μ : P(F2 ) → [0, 1]. Denote by a and b the canonical generators of
F2 . Let A ⊂ F2 be the set of elements of F2 whose reduced form begins by a
nonzero (positive or negative) power of a. We have F2 = A ∪ aA and hence
μ(F2 ) ≤ μ(A) + μ(aA) = 2μ(A). Since μ(F2 ) = 1, this implies
                                            1
                                   μ(A) ≥     .                          (4.3)
                                            2
On the other hand, the subsets A, bA and b2 A are pairwise disjoint. Thus
one has μ(F2 ) ≥ μ(A) + μ(bA) + μ(b2 A) = 3μ(A). This gives
88                                                                            4 Amenable Groups

                                                1
                                    μ(A) ≤
                                                3
contradicting (4.3).



4.5 Stability Properties of Amenable Groups

Proposition 4.5.1. Every subgroup of an amenable group is amenable.

Proof. Let G be an amenable group and let H be a subgroup of G. Let
μ : P(G) → [0, 1] be a left-invariant ﬁnitely additive probability measure on
G. Choose a complete set of representatives of the right cosets of G mod-
ulo H, that is, a subset R ⊂ G such that, for each g ∈ G, there exists a
unique element (h, r) ∈ H × R satisfying g = hr. Let us check that the map
 : P(H) → [0, 1] deﬁned by
μ
                                     
                               !
                  (A) = μ
                  μ                Ar      for all A ∈ P(H)
                              r∈R

is a left-invariant ﬁnitely additive probability measure on H.
   Firstly, we have
                                         
                                    !
                       (H) = μ
                       μ                Hr = μ(G) = 1.
                                    r∈R

On the other hand, if A and B are disjoint subsets of H, then
                                            
                                !
                (A ∪ B) = μ
                μ                  (A ∪ B)r
                                     r∈R
                                                                     
                                      !                       !
                            =μ              Ar       ∪              Br
                                      r∈R                  r∈R
                                                                      
                                      !                       !
                            =μ             Ar       +μ              Br
                                     r∈R                      r∈R

                             (A) + μ
                            =μ      (B),

since the sets              !                       !
                                 Ar    and                Br
                           r∈R                      r∈R

are disjoint.
4.5 Stability Properties of Amenable Groups                                   89

   Finally, for all h ∈ H and A ∈ P(H), we have
                                                 
                      !              !            !
      (hA) = μ
      μ                  hAr = μ h      Ar = μ           (A).
                                                    Ar = μ
                     r∈R                 r∈R              r∈R

This shows that H is amenable.

   Combining Proposition 4.5.1 with Theorem 4.4.7, we get:

Corollary 4.5.2. If G is a group containing a subgroup isomorphic to the
free group on two generators F2 , then G is not amenable.

Examples 4.5.3. (a) Let X be a set having at least two elements. Then the
free group F (X) based on X is not amenable. Indeed, the subgroup of F (X)
generated by two distinct elements a, b ∈ X is isomorphic to F2 .
   (b) The group SL(n, Z) is not amenable for n ≥ 2. Indeed, as we have seen
in Lemma 2.3.2, the subgroup of SL(2, Z) generated by the matrices 10 21
and 12 01 is isomorphic to F2 .

Proposition 4.5.4. Every quotient of an amenable group is amenable.

Proof. Let G be an amenable group and let H be a normal subgroup of G. Let
ρ : G → G/H denote the canonical homomorphism. Consider a left-invariant
ﬁnitely additive probability measure μ : P(G) → [0, 1] on G. Let us show that
the map μ : P(G/H) → [0, 1] deﬁned by

                   μ(A) = μ(ρ−1 (A))          for all A ∈ P(G/H)

is a left-invariant ﬁnitely additive probability measure on G/H.
   Firstly, we have

                     μ(G/H) = μ((ρ−1 (G/H)) = μ(G) = 1.

On the other hand, if A and B are disjoint subsets of G/H, then

μ(A ∪ B) = μ(ρ−1 (A ∪ B)) = μ(ρ−1 (A) ∪ ρ−1 (B)) = μ(ρ−1 (A)) + μ(ρ−1 (B))

since ρ−1 (A) ∩ ρ−1 (B) = ∅. Thus we have μ(A ∪ B) = μ(A) + μ(B).
   Finally, if g ∈ G and A ⊂ G/H, we have

       μ(ρ(g)A) = μ(ρ−1 (ρ(g)A)) = μ(gρ−1 (A)) = μ(ρ−1 (A)) = μ(A).

As ρ is surjective, it follows that μ is left-invariant with respect to G/H. This
shows that G/H is amenable.

   In the next proposition we show that the class of amenable groups is closed
under the operation of taking extensions of amenable groups by amenable
groups.
90                                                                            4 Amenable Groups

Proposition 4.5.5. Let G be a group and let H be a normal subgroup of
G. Suppose that the groups H and G/H are amenable. Then the group G is
amenable.
Proof. Since H is amenable, we can ﬁnd a H-left-invariant mean m0 : ∞ (H) →
R. Let x ∈ ∞ (G). Consider the map x : G/H → R deﬁned by

                           (g) = m0 ((g −1 x)|H )
                           x                                for all g ∈ G,

where g = gH = Hg ∈ G/H denote the class of g modulo H. The map x         is
well deﬁned. Indeed, if g1 and g2 are elements of G such that g1 = g2 , then
g2 = g1 h for some h ∈ H, and hence

 m0 ((g2−1 x)|H ) = m0 ((h−1 g1−1 x)|H ) = m0 (h−1 (g1−1 x)|H ) = m0 ((g1−1 x)|H )

                                                 ∈ ∞ (G/H) since, by Propo-
since m0 is H-left-invariant. Observe also that x
sition 4.1.6(iv),

          x(g)| = |m0 ((g −1 x)|H )| ≤ sup |(g −1 x)(h)| ≤ g −1 x∞ = x∞
         |
                                               h∈H

for all g ∈ G.
   As the group G/H is amenable, there exists a G/H-left-invariant mean
m1 : ∞ (G/H) → R. Let us set, for each x ∈ ∞ (G),

                                            m(x) = m1 (
                                                       x).

Clearly m is a mean on G. Let us show that it is G-left-invariant.
  Let g ∈ G and x ∈ ∞ (G). For all g  ∈ G, we have
                           −1
      x(g  ) = m0 ((g 
     g#                         gx)|H ) = m0 (((g −1 g  )−1 x)|H ) = x              (g −1 g  )
                                                                      (g −1 g  ) = x
                x(g  ).
             = g

Thus g#
      x = g
           x. As m1 is G/H-left-invariant, it follows that

                    m(gx) = m1 (#
                                g x) = m1 (g
                                            x) = m1 (
                                                     x) = m(x),

which shows that m is G-left-invariant.Therefore G is amenable.
Corollary 4.5.6. Suppose that G1 and G2 are amenable groups. Then the
group G = G1 × G2 is amenable.
Proof. The set H = {(g1 , 1G2 ) : g1 ∈ G1 } is a normal subgroup of G isomor-
phic to G1 with quotient G/H isomorphic to G2 .
Remark 4.5.7. It immediately follows from the preceding corollary that every
direct product of a ﬁnite number of amenable groups is amenable. How-
ever, a direct product of inﬁnitely many amenable groups is not necessarily
amenable. For example, it follows from Theorem 2.3.1 and Corollary 2.2.6
4.5 Stability Properties of Amenable Groups                                  91

that there exists a (countable) family
                                   of ﬁnite, and hence amenable, groups
(Gi )i∈I such that the group G = i∈I Gi contains a subgroup isomorphic to
F2 . Such a group G is not amenable by Corollary 4.5.2.

Corollary 4.5.8. Every virtually amenable group is amenable.

Proof. Let G be a virtually amenable group. Let H be an amenable subgroup
of ﬁnite index of G. By Lemma 2.1.10, the set K = ∩g∈G gHg −1 is a normal
subgroup of ﬁnite index of G contained in H. The group K is amenable
by Proposition 4.5.1. On the other hand the group G/K is ﬁnite and hence
amenable. Consequently, G is amenable by Proposition 4.5.5.

  Our next goal is to show that an inductive limit of amenable groups is
amenable. In the proof we shall use the following:

Lemma 4.5.9. Let G be a group. Suppose that there is a net (mi )i∈I in
M(G) such that, for each g ∈ G, the net (gmi − mi )i∈I converges to 0 in
(∞ (G))∗ for the weak-∗ topology. Then G is amenable.

Proof. Since M(G) is compact for the weak-∗ topology by Theorem 4.2.1, we
may assume, after taking a subnet if necessary, that the net (mi ) converges
to a mean m ∈ M(G). Let g ∈ G. Since the left action of G on M(G) is
continuous by Proposition 4.3.1, we deduce that, for every x ∈ ∞ (G) the
net (gmi − mi )(x) = gmi (x) − mi (x) converges to 0. By taking limits, we
get gm(x) − m(x) = 0. Therefore gm = m. This shows that the mean m is
left-invariant. Thus G is amenable.

Proposition 4.5.10. Every group which is the limit of an inductive system
of amenable groups is amenable.

Proof. Let (Gi )i∈I be an inductive system of amenable groups and set G =
lim Gi . Consider the family (Hi )i∈I of subgroups G deﬁned by Hi = hi (Gi ),
−→
where hi : Gi → G is the canonical homomorphism. As Hi is amenable
by Proposition 4.5.4, we can ﬁnd, for each i ∈ I, a Hi -left-invariant mean
#i : ∞ (Hi ) → R. Consider the family mi : ∞ (G) → R of means on G deﬁned
m
by
                             #i (x|Hi ) for all x ∈ ∞ (G).
                    mi (x) = m
Let g ∈ G. Since G = lim Gi , there exists i0 (g) ∈ I such that g ∈ Hi for all
                        −→
i ≥ i0 (g). For x ∈ ∞ (G) and i ≥ i0 (g), we have

       (gmi − mi )(x) = gmi (x) − mi (x) = g m
                                             #i (x|Hi ) − m
                                                          #i (x|Hi ) = 0,

      #i is Hi -left-invariant. Thus gmi −mi = 0 for all i ≥ i0 (g). By applying
since m
Lemma 4.5.9, we deduce that G is amenable.

  Every group is the inductive limit of its ﬁnitely generated subgroups.
Therefore we have:
92                                                            4 Amenable Groups

Corollary 4.5.11. Every locally amenable group is amenable.
     Since every ﬁnite group is amenable, we obtain in particular the following:
Corollary 4.5.12. Every locally ﬁnite group is amenable.
Example 4.5.13. Let X be a set. Then the group Sym0 (X) consisting of all
permutations of X with ﬁnite support is locally ﬁnite (see Example 3.2.4).
Consequently, the group Sym0 (X) is amenable. The groups Sym0 (X), where
X is a inﬁnite set, are our ﬁrst examples of inﬁnite amenable groups. Re-
call from Lemma 2.6.3 that Sym0 (X) is not residually ﬁnite whenever X is
inﬁnite.

               Let (Gi )i∈I be a family of amenable groups. Then their
Corollary 4.5.14.
direct sum G = i∈I Gi is amenable.
Proof. Every ﬁnitely generated subgroup of G is a subgroup of some ﬁnite
product of the groups Gi and hence amenable by Corollary 4.5.6 and Propo-
sition 4.5.1. Thus G is locally amenable and therefore amenable by Corol-
lary 4.5.11.


4.6 Solvable Groups

Theorem 4.6.1. Every abelian group is amenable.
Proof. Let G be an abelian group. Equip (∞ (G))∗ with the weak-∗ topology.
By Theorem 4.2.1, the set M(G) is a nonempty convex compact subset of
(∞ (G))∗ . On the other hand, it follows from Proposition 4.3.1 that the action
of G on M(G) is aﬃne and continuous (note that the left and the right actions
coincide since G is Abelian). By applying the Markov-Kakutani ﬁxed-point
Theorem (Theorem G.1.1), we deduce that G has at least one ﬁxed point in
M(G). Such a ﬁxed point is clearly a bi-invariant mean on G. This shows
that G is amenable.
   Let G be a group. Recall the following deﬁnitions. The commutator of two
elements h and k in G is the element [h, k] ∈ G deﬁned by [h, k] = hkh−1 k −1 .
If H and K are subgroups of G, we denote by [H, K] the subgroup of G
generated by all commutators [h, k], where h ∈ H and k ∈ K. Note that
[H, K] ⊂ K if K is normal in G. Note also that [H, K] is normal in G if H
and K are both normal in G.
   The subgroup D(G) = [G, G] is called the derived subgroup, or commutator
subgroup, of G. The subgroup D(G) is normal in G and the quotient group
G/D(G) is abelian. Observe that G is abelian if and only if [G, G] = {1G }.
A group is called metabelian if its derived subgroup is abelian.
   The derived series of a group G is the sequence (Di (G))i≥0 of subgroups
of G inductively deﬁned by D0 (G) = G and Di+1 (G) = D(Di (G)) for all
i ≥ 0. One has
4.6 Solvable Groups                                                           93

                      G = D0 (G) ⊃ D1 (G) ⊃ D2 (G) ⊃ . . .
with Di+1 (G) normal in Di (G) and Di (G)/Di+1 (G) abelian for all i ≥ 0.
   The group G is said to be solvable if there is an integer i ≥ 0 such that
Di (G) = {1G }. The smallest integer i ≥ 0 such that Di (G) = {1G } is then
called the solvability degree of G.

Examples 4.6.2. (a) A group is solvable of degree 0 if and only if it is reduced
to the identity element.
   (b) The solvable groups of degree 1 are the nontrivial abelian groups.
   (c) The solvable groups of degree 2 are the nonabelian metabelian groups.
   (d) Let K be a ﬁeld. The aﬃne group over K is the subgroup Aﬀ(K) of
Sym(K) consisting of all permutations of K which are of the form x → ax + b,
where a, b ∈ K and a = 0. The group D1 (Aﬀ(K)) is the group of translations
x → x + b, b ∈ K. Since D1 (Aﬀ(K)) is abelian, we have Di (Aﬀ(K)) =
{1Aﬀ(K) } for all i ≥ 2. Consequently, the group Aﬀ(K) is solvable of
degree 2.
   (e) The alternating groups Sym+           +
                                  2 and Sym3 are abelian and hence solvable
of degree 1. The group Sym4 is solvable of degree 2. For n ≥ 5, the alternating
                            +

group Sym+                                                  i       +
            n is simple (see Remark C.4.4) and therefore D (Symn ) = Symn
                                                                               +

for all i ≥ 0. Thus Symn is not solvable for n ≥ 5.
                         +

   (f) The symmetric group Symn is solvable of degree 1 for n = 2, solvable
of degree 2 for n = 3, solvable of degree 3 for n = 4, and not solvable for
n ≥ 5.

Theorem 4.6.3. Every solvable group is amenable.

Proof. We proceed by induction on the solvability degree i of the group. For
i = 0, the group is reduced to the identity element and there is nothing to
prove. Suppose now that the statement is true for solvable groups of degree
i for some i ≥ 0. Let G be a solvable group of degree i + 1. Then its derived
subgroup D(G) is solvable of degree i and hence amenable by our induction
hypothesis. As G/D(G) is abelian and therefore amenable by Theorem 4.6.1,
we deduce that G is amenable by applying Proposition 4.5.5.

Remark 4.6.4. The alternating group Sym+   5 is amenable since it is ﬁnite.
However, as mentioned above, Sym+5 is not solvable. An example of an inﬁnite
amenable group which is not solvable is provided by the group Z × Sym+  5.

    Let G be a group. The lower central series of G is the sequence (C i (G))i≥0
of subgroups of G deﬁned by C 0 (G) = G and C i+1 (G) = [C i (G), G] for
all i ≥ 0. An easy induction shows that C i (G) is normal in G and that
C i+1 (G) ⊂ C i (G) for all i. The group G is said to be nilpotent if there is an
integer i ≥ 0 such that C i (G) = {1G }. The smallest integer i ≥ 0 such that
C i (G) = {1G } is then called the nilpotency degree of G.
94                                                                4 Amenable Groups

Example 4.6.5. Let R be a nontrivial commutative ring. The Heisenberg group
with coeﬃcients in R is the subgroup HR of GL3 (R) consisting of all matrices
of the form                      ⎛     ⎞
                                  1yz
                   M (x, y, z) = ⎝0 1 x⎠ (x, y, z ∈ R).
                                  001
One easily checks that the center Z(HR ) of HR consists of all matrices of the
form M (0, 0, z), z ∈ R, and that Z(HR ) is isomorphic to the additive group
(R, +). Moreover, one has D(HR ) = Z(HR ). It follows that HR is nilpotent
of degree 2.

Proposition 4.6.6. Every nilpotent group is solvable.

Proof. An easy induction yields Di (G) ⊂ C i (G) for all i ≥ 0.

Remark 4.6.7. We have seen in Example 4.6.2(d) that the aﬃne group Aﬀ(K)
over a ﬁeld K is solvable. However, the group G = Aﬀ(K) is not nilpotent.
Indeed, the lower central series satisﬁes C i (G) = D(G) = {1G } for all i ≥ 1.

     From Theorem 4.6.3 and Proposition 4.6.6, we get:

Corollary 4.6.8. Every nilpotent group is amenable.



4.7 The Følner Conditions

Proposition 4.7.1. Let G be a group. Then the following conditions are
equivalent:
(a) for every ﬁnite subset K ⊂ G and every real number ε > 0, there exists a
    nonempty ﬁnite subset F ⊂ G such that

                             |F \ kF |
                                       <ε      for all k ∈ K;                 (4.4)
                                |F |

(b) there exists a net (Fj )j∈J of nonempty ﬁnite subsets of G such that

                              |Fj \ gFj |
                        lim               =0     for all g ∈ G;               (4.5)
                         j       |Fj |

(c) for every ﬁnite subset K ⊂ G and every real number ε > 0, there exists a
    nonempty ﬁnite subset F ⊂ G such that

                             |F \ F k|
                                       <ε      for all k ∈ K;                 (4.6)
                                |F |
4.7 The Følner Conditions                                                     95

(d) there exists a net (Fj )j∈J of nonempty ﬁnite subsets of G such that,

                                 |Fj \ Fj g|
                         lim                 =0    for all g ∈ G.           (4.7)
                             j      |Fj |

Proof. First observe that the equivalences (a) ⇔ (c) and (b) ⇔ (d) are obvi-
ous. Indeed, for any ﬁnite subset F ⊂ G and any element k ∈ G, we have

                             |F \ kF |   |F −1 \ F −1 k −1 |
                                       =                                    (4.8)
                                |F |          |F −1 |

since the map g → g −1 is bijective on G.
   Let us show that (a) implies (b). Suppose (a). Let J denote the set of all
pairs (K, ε), where K is a ﬁnite subset of G and ε > 0. We equip J with the
partial ordering ≤ deﬁned by

                   (K, ε) ≤ (K  , ε ) ⇔ (K ⊂ K  and ε ≥ ε ).

Note that (J, ≤) is a lattice, that is, a partially ordered set in which any two
elements admit a supremum (also called a join) and an inﬁmum (also called
a meet). Indeed, one has

             sup{(K, ε), (K  , ε )} = (K ∪ K  , min(ε, ε )) and
              inf{(K, ε), (K  , ε )} = (K ∩ K  , max(ε, ε )).

In particular, J is a directed set. By (a), for each j = (K, ε) ∈ J, there exists
a nonempty ﬁnite subset Fj ⊂ G such that

                            |Fj \ kFj |
                                        <ε     for all k ∈ K.               (4.9)
                               |Fj |

Let us ﬁx now some element g ∈ G and ε0 > 0. Set j0 = ({g}, ε0 ). If j = (K, ε)
satisﬁes j ≥ j0 , then g ∈ K and ε ≤ ε0 . Thus we have

                                    |Fj \ gFj |
                                                < ε0 ,                    (4.10)
                                       |Fj |

for all j ≥ j0 by (4.9). This shows that the net (Fj )j∈J satisﬁes (4.5). Con-
sequently, (a) implies (b).
   Finally, let us show (b) ⇒ (a). Suppose (b). Let K ⊂ G be a ﬁnite subset
and let ε > 0. By (4.5), for every k ∈ K there exist j(k) ∈ J such that

                       |Fj \ kFj |
                                   <ε        for all j ≥ j(k).
                          |Fj |

Since J is a directed set, we can ﬁnd j0 ∈ J such that j0 ≥ j(k) for all k ∈ K.
Then, taking F = Fj0 we have (4.6). This shows that (b) implies (a).
96                                                            4 Amenable Groups

Deﬁnition 4.7.2. One says that a group G satisﬁes the Følner conditions if
G satisﬁes one of the equivalent conditions of Proposition 4.7.1.

   Given a group G, a net (Fj )j∈J of nonempty ﬁnite subsets of G which
satisﬁes (4.5) (resp. (4.7)) is called a left (resp. right) Følner net for G.
   Observe that Fj \ g −1 Fj (resp. Fj \ Fj g −1 ) is the set of elements of Fj
that are moved out of Fj by left (resp. right) multiplication by g. Thus, a net
(Fj )j∈J of nonempty ﬁnite subsets of G is a left (resp. right) Følner net if
and only if, for each g ∈ G, the proportion of elements of Fj that are moved
out of Fj by left (resp. right) multiplication by g converges to 0.

Remarks 4.7.3. (a) It immediately follows from (4.8) that (Fj ) is a left Følner
net if and only if (Fj−1 ) is a right Følner net.
   (b) If (Fj )j∈J is a left Følner net for G and (aj )j∈J is a net of elements
of G indexed by the same directed set J, then the net (Fj aj ) is also a left
Følner net. Indeed, we have

                          |Fj aj \ gFj aj |   |Fj \ gFj |
                                            =
                               |Fj aj |          |Fj |

for all j ∈ J and g ∈ G, since right multiplication by aj gives a bijection
from Fj onto Fj aj and from Fj \ gFj onto Fj aj \ gFj aj . Similarly, if (Fj ) is
a right Følner net, then (aj Fj ) is also a right Følner net.

   For commutative groups, the concepts of left and right Følner nets coincide
so that one simply speaks of Følner nets in this case.
   If the directed set J is isomorphic to N, one speaks of left and right Følner
sequences.

Examples 4.7.4. (a) Let G be a ﬁnite group. Then the sequence (Fn )n∈N ,
where Fn = G for all n ∈ N, is a left (and right) Følner sequence since
Fn \ gFn = Fn \ Fn g = G \ G = ∅ for all g ∈ G. Therefore G satisﬁes the
Følner conditions.
  (b) Let G = Z. Then the sequence (Fn )n∈N deﬁned by

                            Fn = {0, 1, . . . , n − 1}

is a Følner sequence. Indeed, if g ∈ Z is ﬁxed and n ≥ |g|, then

                             |Fn \ (Fn + g)|   |g|
                                             =
                                   |Fn |        n

which converges to 0 as n tends to inﬁnity. This shows that Z satisﬁes the
Følner conditions (see Fig. 4.1).
   (c) More generally, if G = Zr (r ≥ 1), one checks that the sequence (Fn )n∈N
given by
                            Fn = {0, 1, . . . , n − 1}r
4.7 The Følner Conditions                                                     97




Fig. 4.1 The Følner set F5 in Z, its translate F5 + 3 and F5 \ (F5 + 3)



is a Følner sequence for G (see Fig. 4.2). Thus, Zr satisﬁes the Følner condi-
tions.
Proposition 4.7.5. Let G be group. Then the following conditions are equiv-
alent:
(a) G is countable and satisﬁes the Følner conditions;
(b) G admits a left Følner sequence;
(c) G admits a right Følner sequence.
Proof. (a) ⇒ (b). Suppose (a). As G is countable, we can ﬁnd a sequence
(Kn )n∈N of ﬁnite subsets of G such that Kn ⊂ Kn+1 for all n and G = n Kn .
Let (εn ) be a sequence of positive real numbers converging to 0. By condition
(a) in Proposition 4.7.1, we can ﬁnd, for each n, a nonempty ﬁnite subset
Fn ⊂ G such that

                         |Fn \ gFn |
                                     < εn     for all g ∈ Kn .
                            |Fn |

Given an element g ∈ G, one has g ∈ Kn for n large enough and the preceding
inequality implies
                                 |Fn \ gFn |
                            lim              = 0.
                           n→∞      |Fn |
This shows that (Fn ) is a left Følner sequence for G.
   (b) ⇒ (a). Suppose that G admits a left Følner sequence (Fn )n∈N . Let us
show that G is countable. Set Kn = {ab−1 : a, b ∈ Fn }. Consider an element
g ∈ G. Then, for n large enough, we have

                                   |Fn \ gFn |
                                               < 1.
                                      |Fn |
                                                                        
This implies Fn ∩ gFn = ∅ and hence g ∈ Kn . It follows that G = n Kn .
As Kn is ﬁnite for each n, we deduce that G is countable. This shows that
(b) implies (a).
   As observed above, (Fn ) is a left Følner sequence if and only if (Fn−1 ) is a
right Følner sequence. This shows that conditions (b) and (c) are equivalent.
98                                                                     4 Amenable Groups




Fig. 4.2 The Følner set F5 in Z2 , its translate F5 + (3, 2) and F5 \ (F5 + (3, 2))



4.8 Paradoxical Decompositions

Deﬁnition 4.8.1. Let G be a group. A left paradoxical decomposition of G is
a triple (K, (Ak )k∈K , (Bk )k∈K ) where K is a ﬁnite subset of G, and (Ak )k∈K
and (Bk )k∈K are families of subsets of G indexed by K such that
                                       
                 $           $ $               $          $
          G=        kAk               kBk =        Ak =       Bk ,       (4.11)
                  k∈K                k∈K             k∈K         k∈K
       
where     means disjoint union.
  Similarly, a right paradoxical decomposition of G is a triple (K, (Ak )k∈K ,
(Bk )k∈K ) where K is a ﬁnite subset of G, and (Ak )k∈K and (Bk )k∈K are
families of subsets of G indexed by K such that
                                     
                $          $ $               $         $
         G=         Ak k            Bk k =      Ak =       Bk .        (4.12)
                  k∈K                k∈K             k∈K         k∈K
4.9 The Theorems of Tarski and Følner                                             99

   By taking inverses in G, it is clear that (K, (Ak )k∈K , (Bk )k∈K ) is a left par-
adoxical decomposition of G if and only if (K −1 , (A−1                 −1
                                                        k−1 )k∈K , (Bk−1 )k∈K )
                                                                 −1               −1

is a right decomposition of G. This shows that G admits a left paradoxical
decomposition if and only if it admits a right paradoxical decomposition. If
this is the case, we simply say that G admits a paradoxical decomposition.

Example 4.8.2. Consider the free group of rank two G = F2 freely generated
by a and b. Let us partition F2 into four subsets A+ , A− , B + and B − as
follows. We denote by A+ (resp. A− ) the subset of F2 consisting of all elements
whose reduced form starts with a positive (resp. negative) power of a. Let
also B + denote the subset of F2 consisting of all elements either of the form
b−n for n = 0, 1, 2, . . ., or whose reduced form starts with a positive power of
b. Finally, let B − = F2 \ (A+ ∪ A− ∪ B + ), so that B − consists of all elements
in F2 whose reduced form starts with, but is not equal to, a negative power
of b. Then we have
              $       $        $                $                $
    F2 = A+      A−         B+    B − = a−1 A+     A− = b−1 B +     B − . (4.13)

   For example, if g = a2 b ∈ F2 , we have g ∈ A+ and, on the one hand,
g = a−1 (a3 b) ∈ a−1 A+ and, on the other, g = b−1 (ba2 b) ∈ b−1 B + .
   Thus, setting A1 = A− , Aa = a−1 A+ , Ab = ∅, B1 = B − , Ba = ∅ and
Bb = b−1 B + , (4.13) becomes
                         $       $      $     $        $
                 F2 = A1    aAa     bAb    B1    aBa       bBb
                         $     $
                    = A1    Aa    Ab                                   (4.14)
                         $     $
                    = B1    Ba    Bb ,

which, with K = {1, a, b}, is nothing but (4.11). This shows that F2 admits
a paradoxical decomposition.



4.9 The Theorems of Tarski and Følner

The Tarski alternative theorem asserts that a group is either amenable or
admits a paradoxical decomposition. The theorem of Følner says that a group
is amenable if and only if it satisﬁes the Følner conditions. Thus, we have
the following:

Theorem 4.9.1 (Tarski-Følner). Let G be a group. Then the following
conditions are equivalent.
(a) G is amenable;
(b) G admits no paradoxical decompositions;
(c) G satisﬁes the Følner conditions.
100                                                                        4 Amenable Groups

  Theorem 4.9.1 directly follows from the equivalence of conditions (a), (b)
and (g) contained in the theorem below:

Theorem 4.9.2. Let G be a group. Then the following conditions are equiv-
alent:
(a) G is not amenable;
(b) G does not satisfy the Følner conditions;
(c) there exists a ﬁnite subset K ⊂ G such that |KF | ≥ 2|F | for every ﬁnite
    subset F ⊂ G.;
(d) there exists a ﬁnite subset K ⊂ G such that |F K| ≥ 2|F | for every ﬁnite
    subset F ⊂ G;
(e) there exist a 2-to-one surjective map ϕ : G → G and a ﬁnite subset K ⊂ G
    such that g(ϕ(g))−1 ∈ K for all g ∈ G;
(f) there exist a 2-to-one surjective map ϕ : G → G and a ﬁnite subset K ⊂ G
    such that g −1 ϕ(g) ∈ K for all g ∈ G;
(g) G admits a paradoxical decomposition.

   We recall that a surjective map f : X → Y from a set X onto a set Y is
said to be 2-to-one if every y ∈ Y has exactly two preimages in X.

Proof of Theorem 4.9.2. By taking inverses in G, it is clear that (c) ⇔ (d)
and (e) ⇔ (f). Thus, it suﬃces to prove (a) ⇒ (b), (b) ⇒ (c), (c) ⇒ (e), (e)
⇒ (g), and (g) ⇒ (a).
   (a) ⇒ (b). Suppose that G satisﬁes the Følner conditions. Then G admits
a left Følner net (Fj )j∈J . Consider, for each j ∈ J, the mean with ﬁnite
support mj : ∞ (G) → R deﬁned by

                            1
                mj (x) =                  x(h)    for all x ∈ ∞ (G).
                           |Fj |
                                   h∈Fj


Let g ∈ G. For every x ∈ ∞ (G), we have

          (gmj − mj )(x) = gmj (x) − mj (x)
                           = mj (g −1 x) − mj (x)
                                   ⎛                                  ⎞
                              1 ⎝
                           =              x(gh) −                 x(h)⎠
                             |Fj |
                                          h∈Fj             h∈Fj
                                   ⎛                                 ⎞
                              1 ⎝
                           =                      x(h) −          x(h)⎠
                             |Fj |
                                          h∈gFj            h∈Fj
                                     ⎛                                         ⎞
                                1 ⎝
                           =                          x(h) −               x(h)⎠ ,
                               |Fj |
                                          h∈gFj \Fj            h∈Fj \gFj
4.9 The Theorems of Tarski and Følner                                              101

which gives, by using triangle inequality,
                                  ⎛                                         ⎞
                              1 ⎝
        |(gmj − mj )(x)| ≤                 |x(h)| +                    |x(h)|⎠
                            |Fj |
                                        h∈gFj \Fj          h∈Fj \gFj

                                1
                           ≤         (|gFj \ Fj | + |Fj \ gFj |)x∞ .
                               |Fj |

As the sets gFj and Fj have the same cardinality, we have

                             |gFj \ Fj | = |Fj \ gFj |.                          (4.15)

Thus, we ﬁnally get

                                               |Fj \ gFj |
                      |(gmj − mj )(x)| ≤ 2                 x∞ .
                                                  |Fj |

This implies that
                            lim (gmj − mj )(x) = 0,
                               j

since (Fj ) is a left Følner net. Thus, the net (gmj − mj )j∈J converges to
0 in (∞ (G))∗ for the weak-∗ topology. It follows that G is amenable by
Lemma 4.5.9. This shows that (a) implies (b).
   (b) ⇒ (c). Suppose that G does not satisfy the Følner conditions. Then,
there exist a ﬁnite subset K0 ⊂ G and ε0 > 0 such that for every nonempty
ﬁnite subset F ⊂ G one has
                                   |F \ k0 F |
                                               ≥ ε0                              (4.16)
                                      |F |

for some k0 = k0 (F ) ∈ K0 . Consider the set K1 = K0 ∪ {1G }. Let F be a
nonempty ﬁnite subset of G. Observe that K1 F ⊃ F and K1 F \F = K0 F \F .
Thus, we have

                |K1 F | − |F | = |K1 F \ F |
                               = |K0 F \ F |
                               ≥ |k0 F \ F |
                               = |F \ k0 F | (since |F | = |k0 F |)
                               ≥ ε0 |F | (by (4.16)),

which gives
                               |K1 F | ≥ (1 + ε0 )|F |.
102                                                                 4 Amenable Groups

  Choose n0 ∈ N such that (1 + ε0 )n0 ≥ 2 and set K = K1n0 . Then, we have

          |KF | = |K1n0 F | ≥ (1 + ε0 )|K1n0 −1 F | ≥ · · · ≥ (1 + ε0 )n0 |F |

so that |KF | ≥ 2|F | for every ﬁnite subset F ⊂ G. This shows that (b)
implies (c).
   (c) ⇒ (e). Suppose that G satisﬁes condition (c), that is, there exists a
ﬁnite subset K ⊂ G such that

                  |KF | ≥ 2|F | for every ﬁnite subset F ⊂ G.                    (4.17)

Consider the bipartite graph GK (G) = (G, G, E) (see Appendix H), where
the set E ⊂ G × G of edges consists of all the pairs (g, h) such that g ∈ G
and h ∈ Kg.
   We claim that GK (G) satisﬁes the Hall 2-harem conditions. Indeed, if
F is a ﬁnite subset of G, then, using the terminology for bipartite graphs
introduced in Sect. H.1, the right and left neighborhoods of F in GK (G)
are the sets NR (F ) = KF and NL (F ) = K −1 F respectively. Therefore, we
have
                             |NR (F )| = |KF | ≥ 2|F |,

by applying (4.17). On the other hand, if k ∈ K, then NL (F ) ⊃ k−1 F so
that
                                                  1
                     |NL (F )| ≥ |k−1 F | = |F | ≥ |F |.
                                                  2
This proves our claim. Thus, by virtue of the Hall harem Theorem (Theo-
rem H.4.2), we deduce the existence of a perfect (1, 2)-matching M for GK (G).
In other words, there exists a 2-to-one surjective map ϕ : G → G such that
(ϕ(g), g) ∈ E, that is, g(ϕ(g))−1 ∈ K for all g ∈ G. This shows that (c)
implies (e).
   (e) ⇒ (g). Suppose (e), that is, there exist a 2-to-one surjective map
ϕ : G → G and a ﬁnite set K ⊂ G such that

                           g(ϕ(g))−1 ∈ K for all g ∈ G.                          (4.18)

By the axiom of choice, we can ﬁnd maps ψ1 , ψ2 : G → G such that, for every
g ∈ G, the elements ψ1 (g) and ψ2 (g) are the two preimages of g for ϕ.
   Observe that θ1 (g) = ψ1 (g)g −1 and θ2 (g) = ψ2 (g)g −1 belong to K for
every g ∈ G by (4.18). For each k ∈ K, deﬁne Ak and Bk by

        Ak = {g ∈ G : θ1 (g) = k}         and Bk = {g ∈ G : θ2 (g) = k}.

We have
                                    $            $
                              G=          Ak =         Bk .                      (4.19)
                                    k∈K          k∈K
4.10 The Fixed Point Property                                              103


 On the other hand, observe that if g ∈Ak then ψ1 (g) = kg. Thus
                                                                  ψ1 (G) =
  k∈K kAk . Similarly, we have ψ2 (G) =   k∈K kBk . As G = ψ1 (G)   ψ2 (G),
we deduce that                                   
                            $         $ $
                      G=        kAk            kBk .                 (4.20)
                                k∈K                    k∈K

Combining together (4.19) and (4.20), ,we deduce that (K, (Ak )k∈K , (Bk )k∈K )
is a left paradoxical decomposition for G. This shows that (e) implies (g).
   (g) ⇒ (a). Suppose that G admits a left paradoxical decomposition
(K, (Ak )k∈K , (Bk )k∈K ). If μ : P(G) → [0, 1] is a left invariant ﬁnitely ad-
ditive probability measure on G, then (4.11) gives

                     1 = μ(G)
                                                                  
                                 $               $        $
                      =μ               kAk                      kBk
                                 k∈K                      k∈K

                      =         μ(kAk ) +          μ(kBk )
                          k∈K                k∈K

                      =         μ(Ak ) +         μ(Bk )
                          k∈K              k∈K
                             $                   $
                      = μ(        Ak ) + μ(            Bk )
                            k∈K                 k∈K
                      = μ(G) + μ(G)
                      = 2,

which is clearly absurd. Therefore G is not amenable. This shows that (g)
implies (a).



4.10 The Fixed Point Property

The following ﬁxed point theorem is a generalization of the Markov-Kakutani
theorem (Theorem G.1.1).

Theorem 4.10.1. Let G be an amenable group acting aﬃnely and contin-
uously on a nonempty convex compact subset C of a Hausdorﬀ topological
vector space X. Then G ﬁxes at least one point in C.

Proof. Let (Fj )j∈J be a left Følner net for G.
  Choose an arbitrary point x ∈ C and set
                                         1
                                 xj =                  hx.
                                        |Fj |
                                                h∈Fj
104                                                                                      4 Amenable Groups

for each j ∈ J. Observe that xj ∈ C since C is convex. By compactness of
C, we can assume, after taking a subnet, that the net (xj )j∈J converges to a
point c ∈ C.
   Let g ∈ G. For every j ∈ J, we have
             ⎛             ⎞
                1                1
gxj − xj = g ⎝          hx⎠ −            hx
               |Fj |            |Fj |
                            h∈Fj                        h∈Fj
                1                      1
             =                  ghx −                   hx (since the action of G on C is aﬃne)
               |Fj |                  |Fj |
                         h∈Fj                   h∈Fj
                  1                      1
             =                   hx −                   hx,
                 |Fj |                  |Fj |
                         h∈gFj                  h∈Fj

which yields, after simpliﬁcation,
                                         1                            1
                     gxj − xj =                               hx −                       hx.            (4.21)
                                        |Fj |                        |Fj |
                                                h∈gFj \Fj                    h∈Fj \gFj

Consider the points
                 1                                                                 1
      yj =                               hx,            and          zj =                               hx.
             |gFj \ Fj |                                                      |Fj \ gFj |
                            h∈gFj \Fj                                                       h∈Fj \gFj

Note that yj and zj belong to C by convexity of C.
   We have |Fj \ gFj | = |gFj \ Fj | since the sets Fj and gFj have the same
cardinality (cf. (4.15)). Setting

                                             |Fj \ gFj |   |gFj \ Fj |
                                   λj =                  =             ,
                                                |Fj |         |Fj |

equality (4.21) gives us

                                      gxj − xj = λj yj − λj zj .

The net (λj ) converges to 0 since (Fj ) is a left Følner net. As C is compact,
it follows that
                           lim λj yj = lim λj zj = 0,
                                         j                j

by using Lemma G.2.2. Therefore, we have

                                    gc − c = lim(gxj − xj ) = 0.
                                                    j

This shows that c is ﬁxed by G.
Notes                                                                      105

Corollary 4.10.2. Let G be a group. Then the following conditions are equiv-
alent:
(a) the group G is amenable;
(b) every continuous aﬃne action of G on a nonempty convex compact subset
    of a Hausdorﬀ topological vector space admits a ﬁxed point;
(c) every continuous aﬃne action of G on a nonempty convex compact subset
    of a Hausdorﬀ locally convex topological vector space admits a ﬁxed point.

Proof. Implication (a) ⇒ (b) follows from the preceding theorem. Implication
(b) ⇒ (c) is trivial. Finally,(c) ⇒ (a) follows from Theorem 4.2.1, Proposi-
tion 4.3.1 and the fact that (∞ (G))∗ is a locally convex Hausdorﬀ topological
vector space for the weak-∗ topology (see Sect. F.2).



Notes

The theory of amenable groups emerged from the study of the axiomatic
properties of the Lebesgue integral and the discovery of the Banach-Tarski
paradox at the beginning of the last century (see [Har3], [Pat], [Wag]). The
ﬁrst deﬁnition of an amenable group, by the existence of an invariant ﬁnitely
additive probability measure, is due to J. von Neumann in [vNeu1]. Von
Neumann proved in particular that every abelian group is amenable (Theo-
rem 4.6.1) and that an amenable group cannot contain a subgroup isomorphic
to F2 (Corollary 4.5.2). The term amenable was introduced in the 1950s by
M.M. Day, who played a central role in the development of the modern theory
of amenable groups by using means and applying techniques from functional
analysis. Moreover, Day extended the notion of amenability to semigroups,
for which one has to distinguish between right amenability and left amenabil-
ity.
    The question of the existence of a non-amenable group containing no
subgroup isomorphic to F2 , which is called by some authors the von Neu-
mann conjecture or Day’s problem, was answered in the aﬃrmative by A.Yu.
Ol’shanskii [Ols] who gave an example of a ﬁnitely generated non-amenable
group all of whose proper subgroups are cyclic. Other examples of non-
amenable groups with no subgroup isomorphic to F2 were found by S.I. Adyan
[Ady] who showed that the free Burnside group B(m, n) is non-amenable for
m ≥ 2 and n odd with n ≥ 665. The free Burnside group B(m, n) is the quo-
tient of the free group Fm by the subgroup of Fm generated by all n-powers,
that is, all elements of the form wn for some w ∈ Fm . The order of every
element of B(m, n) divide n. In particular, B(m, n) is a periodic group, that
is, a group in which every element has ﬁnite order. It is clear that a periodic
group cannot contain a subgroup isomorphic to F2 . A geometric method for
constructing ﬁnitely generated non-amenable periodic groups was described
by M. Gromov in [Gro3]. Examples of ﬁnitely presented non-amenable groups
106                                                          4 Amenable Groups

which contain no subgroup isomorphic to F2 were given by A.Yu Ol’shanskii
and M. Sapir [OlS].
   There is also a more general notion of amenability for locally compact
groups and actions of locally compact groups (see [Gre], [Pat]).
   A group G is called polycyclic if it admits a ﬁnite sequence of subgroups

                   {1G } = H0 ⊂ H1 ⊂ H2 ⊂ · · · ⊂ Hn = G

such that Hi is normal in Hi+1 and Hi+1 /Hi is a (ﬁnite or inﬁnite) cyclic
group for each 0 ≤ i ≤ n − 1. Clearly, every polycyclic group is solvable. It is
not hard to prove that every ﬁnitely generated nilpotent group is polycyclic. It
was shown by L. Auslander [Aus] that every polycyclic group is isomorphic
to a subgroup of SLn (Z) for some integer n ≥ 1. It follows in particular
that every polycyclic group is residually ﬁnite. This last result is due to
K.A. Hirsch [Hir] (see also [RobD, p. 154]). P. Hall [Hall2] proved that every
ﬁnitely generated metabelian group is residually ﬁnite and gave an example
of a ﬁnitely generated solvable group of degree 3 which is not residually ﬁnite.
   The equivalence between Følner conditions and amenability was estab-
lished by E. Følner in [Føl]. The proof was later simpliﬁed by I. Namioka in
[Nam]. The equivalence between amenability and the non-existence of a para-
doxical decomposition is due to A. Tarski (see [Tar1], [Tar2] and [CGH1]).
   Let G be a group. Given a left (or right) paradoxical decomposition
P = (K, (Ak )k∈K , (Bk )k∈K ) of G, the integer number c(P) = m + n, where
m = |{k ∈ K : Ak = ∅}| and n = |{k ∈ K : Bk = ∅}|, is called the
complexity of P. Then the quantity T (G) = inf c(P), where the inﬁmum is
taken over all left (or right) paradoxical decompositions P of G, is called
the Tarski number of G. One uses the convention that T (G) = ∞ if G ad-
mits no paradoxical decompositions, that is, if G is amenable (cf. Theorem
4.9.1). It was proved by B. Jonsson, a student of Tarski in the 1940s, that a
group G has Tarski number T (G) = 4 if and only if G contains a subgroup
isomorphic to F2 , the free group of rank 2. In [CGH1, CGH2] it was shown
that for the free Burnside groups B(m, n) with m ≥ 2 and n ≥ 665 odd one
has 6 ≤ T (B(m, n)) ≤ 14. The computations involve spectral analysis and
Cheeger-Buser type isoperimetric inequalities (see Sect. 6.10 and Sect. 6.12)
and Adyan’s cogrowth estimates [Ady] for the free Burnside groups B(m, n)
(see (6.117) in the Notes for Chap. 6).
   The extension of the Markov-Kakutani ﬁxed point theorem to amenable
groups (cf. Theorem 4.10.1) is due to Day [Day2].



Exercises

4.1. Let G be an inﬁnite group and let μ : P(G) → [0, 1] be a left (or right)
invariant ﬁnitely additive probability measure on G. Show that every ﬁnite
subset A ⊂ G satisﬁes μ(A) = 0.
Exercises                                                                  107

4.2. Let X be an inﬁnite set. Prove that the symmetric group Sym(X) is not
amenable. Hint: Show that Sym(X) contains a subgroup isomorphic to the
free group F2 .

4.3. Show that the ﬁnitely generated and non residually ﬁnite groups G1
and G2 described in Sect. 2.6 are amenable. Hint: Each of these groups is the
semidirect product of a locally ﬁnite group and an inﬁnite cyclic group.

4.4. Let G be a group.
   (a) Suppose that H and K are normal subgroups of G. Prove that HK
is a normal subgroup of G and that the groups HK/K and H/(H ∩ K) are
isomorphic.
   (b) Suppose that H and K are normal amenable subgroups of G. Prove
that HK is a normal amenable subgroup of G.
   (c) Show that the set of all normal amenable subgroups of G has a maximal
element for inclusion. This maximal element is called the amenable radical of
the group G. Hint: Use (b) and Proposition 4.5.10 to show that the union of
all normal amenable subgroups of G is a normal amenable subgroup of G.

4.5. Let G be a group. Show that G is metabelian if and only if it contains
a normal subgroup N such that the group G/N is abelian.

4.6. Let G be a ﬁnitely generated solvable group. Show that if all elements
of G have ﬁnite order then G is ﬁnite. Hint: Use induction on the solvability
degree of G.

4.7. Show that every subgroup of a solvable (resp. nilpotent) group is solvable
(resp. nilpotent).

4.8. Show that every quotient of a solvable (resp. nilpotent) group is solvable
(resp. nilpotent).

4.9. Let G be a group containing a normal subgroup H such that both H
and G/H are solvable. Show that G is solvable.

4.10. Show that the direct product of two nilpotent groups is a nilpotent
group.

4.11. Show that a semidirect product of two nilpotent groups may fail to be
nilpotent. Hint: Take for example the symmetric group Sym3 , which is the
semidirect product of two cyclic groups.

4.12. Let G be a group. Show that G is solvable if and only if there is a ﬁnite
sequence
                  {1G } = H0 ⊂ H1 ⊂ H2 ⊂ · · · ⊂ Hn = G
of subgroups of G such that Hi is normal in Hi+1 and Hi+1 /Hi is abelian for
all 0 ≤ i ≤ n − 1.
108                                                         4 Amenable Groups

4.13. Let G be a group and i ≥ 0. Show that the group C i (G)/C i+1 (G) is
contained in the center of G/C i+1 (G).

4.14. Show that every nontrivial nilpotent group has a nontrivial center.

4.15. Let G be a nilpotent group of nilpotency degree d ≥ 1. Show that the
quotient group G/C d−1 (G) is nilpotent of nilpotency degree d − 1.

4.16. Let G be a ﬁnite group whose order is a power of a prime number.
Show that G is nilpotent. Hint: Prove that the center of G is nontrivial by
considering the action of G on itself by conjugation and then proceed by
induction.

4.17. Let G be a group. Denote by Nnq (resp. Nsq , resp. Naq ) the set of all
normal subgroups N ⊂ G such that the quotient group G/N is nilpotent
(resp. solvable, resp. amenable). The sets Nnq , Nsq and Naq are partially
ordered by reverse inclusion.
   (a) Show that if N1 and N2 are two elements of Nnq (resp. Nsq , resp. Naq ),
then N1 ∩ N2 is an element of Nnq (resp. Nsq , resp. Naq ). Hint: observe that
if ρ1 : G → G/N1 and ρ2 : G → G/N2 are the canonical homomorphisms,
then the map ψ : G → G/N1 × G/N2 deﬁned by ψ(g) = (ρ1 (g), ρ2 (g)) is a
homomorphism whose kernel is N1 ∩ N2 .
   (b) Show that Nnq (resp. Nsq , resp. Naq ) gives rise to a projective sys-
tem of groups in a natural way. The limit of this projective system is called
the pronilpotent completion (resp. prosolvable completion, resp. proamenable
completion) of the group G and is denoted by Gn (resp. Gs , resp. Ga ).
   (c) Show that there is a canonical homomorphism G → Gn (resp. G → Gs ,
resp. G → Ga ) and that this homomorphism is injective if and only if G is
residually nilpotent (resp. residually solvable, resp. residually amenable).

4.18. Recall that a group G is called polycyclic if it admits a ﬁnite sequence
of subgroups
                  {1G } = H0 ⊂ H1 ⊂ H2 ⊂ · · · ⊂ Hn = G
such that Hi is normal in Hi+1 and Hi+1 /Hi is a (ﬁnite or inﬁnite) cyclic
group for each 0 ≤ i ≤ n − 1.
   (a) Show that every polycyclic group is ﬁnitely generated.
   (b) Show that every subgroup of a polycyclic group is polycyclic.
   (c) Deduce from (a) and (b) that every subgroup of a polycyclic group is
ﬁnitely generated.

4.19. The lamplighter group is the wreath product L = (Z/2Z)Z. Thus, L is
the semidirect product of the groups H = ⊕n∈Z An and Z, where An = Z/2Z
for all n ∈ Z and Z acts on H by the Z-shift.
   (a) Show that the group L is metabelian (and therefore solvable) and
residually ﬁnite.
Exercises                                                                  109

   (b) Prove that L is ﬁnitely generated. Hint: Show that L is generated by
the two elements s and t corresponding respectively to the nontrivial element
of A0 and to the canonical generator of Z.
   (c) Show that L is not polycyclic. Hint: Observe that H is not ﬁnitely
generated and use Exercise 4.18(c).

4.20. Show that every ﬁnite solvable group is polycyclic.

4.21. Let m be an integer such that |m| ≥ 2. Let G be the group given by
the presentation G = a, b : aba−1 = bm . Use the results in Exercise 2.7
to prove that the commutator subgroup [G, G] is isomorphic to the additive
group Z[1/m] and that the quotient group G/[G, G] is inﬁnite cyclic.

4.22. Let G be a locally ﬁnite group. Let S denote the directed set consisting
of all ﬁnitely generated subgroups of G partially ordered by inclusion. Prove
that the net (H)H∈S is a Følner net for G.

4.23. Show that the sequence (Fn )n∈N , where Fn consists of all rational num-
bers of the form k/n! with k ∈ N and k ≤ (n + 1)!, is a Følner sequence for
the additive group Q.

4.24. Let G = HZ denote the integral Heisenberg group (cf. Example 4.6.5).
For each integer n ≥ 0, deﬁne the subset Fn ⊂ G by
              ⎧⎛        ⎞                                     ⎫
              ⎨ 1xz                                           ⎬
        Fn = ⎝0 1 y ⎠ ∈ G : 1 ≤ x ≤ n, 1 ≤ y ≤ n, 1 ≤ z ≤ n2 .
              ⎩                                               ⎭
                  001

Show that the sequence (Fn )n≥0 is a Følner sequence for G.

4.25. Let G be a group. Show that G is amenable if and only if the following
condition holds: for every ﬁnite subset K ⊂ G and every ε > 0, there exists
a ﬁnite subset F ⊂ G such that |KF | < (1 + ε)|F |.

4.26. Let G be a countable amenable group. Show that
                                                   G admits a left (resp.
right) Følner sequence (Fn )n∈N which satisﬁes G = n∈N Fn and Fn ⊂ Fn+1
for all n ∈ N.

4.27. Let (K, (Ak )k∈K , (Bk )k∈K ) be a left (or right) paradoxical decomposi-
tion of a group G. Show that |K| ≥ 3.

4.28. Let G be a group and H ⊂ G a subgroup. Let (K, (Ak )k∈K , (Bk )k∈K )
be a left paradoxical decomposition of H and T ⊂ G a set of representa-
                                                                      
tives for the
             right cosets of H in G. For each k ∈ K set Ak = t∈T Ak t
and Bk = t∈T Bk t. Show that (K, (Ak )k∈K , (Bk )k∈K ) is a left paradoxical
decomposition of G.
110                                                       4 Amenable Groups

4.29. Let T (G) ∈ N ∪ {∞} denote the Tarski number of a group G.
   (a) Show that T (G) ≥ 4 for all groups G.
   (b) Show that T (G) = 4 if and only if G contains a subgroup isomorphic
to F2 . Hint: Use Example 4.8.2 and the Klein Ping-Pong theorem (Theo-
rem D.5.1).
   (c) Let H be a subgroup of a group G. Show that T (G) ≤ T (H).
   (d) Let N be a normal subgroup of a group G. Show that T (G) ≤ T (G/N ).
   (e) Let G be a group. Show that there exists a ﬁnitely generated subgroup
H ⊂ G such that T (H) = T (G).
   (f) Let G be a group. Suppose that all elements of G have ﬁnite order.
Show that T (G) ≥ 6.
Chapter 5
The Garden of Eden Theorem




The Garden of Eden Theorem gives a necessary and suﬃcient condition for
the surjectivity of a cellular automaton with ﬁnite alphabet over an amenable
group. It states that such an automaton is surjective if and only if it is pre-
injective. As the name suggests it, pre-injectivity is a weaker notion than
injectivity. It means that any two conﬁgurations which have the same image
under the automaton must be equal if they coincide outside a ﬁnite subset
of the underlying group (see Sect. 5.2). We shall establish the Garden of
Eden theorem in Sect. 5.8 by showing that both the surjectivity and the pre-
injectivity are equivalent to the maximality of the entropy of the image of the
cellular automaton. The entropy of a set of conﬁgurations with respect to a
Følner net of an amenable group is deﬁned in Sect. 5.7. Another important
tool in the proof of the Garden of Eden theorem is a notion of tiling for groups
introduced in Sect. 5.6. The Garden of Eden theorem is used in Sect. 5.9 to
prove that every residually amenable (and hence every amenable) group is
surjunctive. In Sect. 5.10 and Sect. 5.11, we give simple examples showing
that both implications in the Garden of Eden theorem become false over a
free group of rank two. In Sect. 5.12 it is shown that a group G is amenable
if and only if every surjective cellular automaton with ﬁnite alphabet over
G is pre-injective. This last result gives a characterization of amenability in
terms of cellular automata.



5.1 Garden of Eden Conﬁgurations and Garden of Eden
    Patterns

Let G be a group and let A be a set. Let τ : AG → AG be a cellular automaton.
A conﬁguration y ∈ AG is called a Garden of Eden conﬁguration for τ if y
is not in the image of τ . Thus the surjectivity of τ is equivalent to the non-
existence of Garden of Eden conﬁgurations.


T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,      111
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 5, © Springer-Verlag Berlin Heidelberg 2010
112                                                 5 The Garden of Eden Theorem

    The biblical terminology “Garden of Eden” (a peaceful place where we will
never return) comes from the fact that one often regards a cellular automaton
τ : AG → AG from a dynamical viewpoint. This means that one thinks of a
conﬁguration as evolving with time according to τ : if x ∈ AG is the conﬁg-
uration at time t = 0, 1, 2, . . ., then τ (x) is the conﬁguration at time t + 1.
A conﬁguration x ∈ AG \ τ (AG ) is called a Garden of Eden conﬁguration
because it may only appear at time t = 0.
    A pattern p : Ω → A is called a Garden of Eden pattern for τ if there is
no conﬁguration x ∈ AG such that τ (x)|Ω = p. It follows from this deﬁnition
that if p : Ω → G is a Garden of Eden pattern for τ , then any conﬁguration
y ∈ AG such that y|Ω = p is a Garden of Eden conﬁguration for τ . Thus,
the existence of a Garden of Eden pattern implies the existence of Garden of
Eden conﬁgurations, that is, the non-surjectivity of τ . It turns out that the
converse is also true when the alphabet set is ﬁnite:

Proposition 5.1.1. Let G be a group and let A be a ﬁnite set. Let τ : AG →
AG be a cellular automaton. Suppose that τ is not surjective. Then τ admits
a Garden of Eden pattern.

Proof. We know that the set τ (AG ) is closed in AG for the prodiscrete topol-
ogy by Lemma 3.3.2. It follows that the set AG \ τ (AG ) is open in AG .
Therefore, if y ∈ AG is a Garden of Eden conﬁguration for τ , we may ﬁnd a
ﬁnite subset Ω ⊂ G such that

               V (y, Ω) = {x ∈ AG : x|Ω = y|Ω } ⊂ AG \ τ (AG ).

In other words, every conﬁguration extending y|Ω is not in τ (AG ), that is,
y|Ω is a Garden of Eden pattern for τ .



5.2 Pre-injective Maps

Let G be a group and let A be a set.
   Two conﬁgurations x1 , x2 ∈ AG are called almost equal if the set {g ∈
G : x1 (g) = x2 (g)} is ﬁnite. It is clear that being almost equal deﬁnes an
equivalence relation on the set AG .
   Given a subset X ⊂ AG and a set Z, a map f : X → Z is called pre-
injective if it satisﬁes the following condition: if two conﬁgurations x1 , x2 ∈ X
are almost equal and such that f (x1 ) = f (x2 ), then x1 = x2 . It immediately
follows from this deﬁnition that the injectivity of f implies its pre-injectivity.
The converse is trivially true when the group G is ﬁnite. However, a pre-
injective map f : AG → Z may fail to be injective when G is inﬁnite.

Examples 5.2.1. (a) Let us take G = Z and A = Z/3Z. Consider the cellular
automaton τ : AG → AG deﬁned by τ (x)(n) = x(n−1)+x(n)+x(n+1) for all
5.2 Pre-injective Maps                                                       113

x ∈ AG and n ∈ G. Then τ is pre-injective. Indeed, suppose that x1 , x2 ∈ AG
are two conﬁgurations such that the set Ω = {n ∈ G : x1 (n) = x2 (n)} is a
nonempty ﬁnite subset of Z. Let n0 denote the largest element in Ω. Then
τ (x1 )(n0 + 1) = τ (x2 )(n0 + 1) and hence τ (x1 ) = τ (x2 ). This sows that τ
is pre-injective. However, τ is not injective since the constant conﬁgurations
c0 , c1 ∈ AG given by c0 (n) = 0 and c1 (n) = 1 for all n ∈ Z have the same
image c0 by τ .
    (b) Let G = Z2 and A = {0, 1}. Consider the cellular automaton τ : AG →
A associated with the Game of Life (cf. Example 1.4.3(a)). Let x1 ∈ AG
   G

be the conﬁguration with no live cells (x1 (g) = 0 for all g ∈ G) and let
x2 ∈ AG be the conﬁguration with only one live cell at the origin (x2 (g) = 1
if g = (0, 0) and x2 (g) = 0 otherwise). Then x1 and x2 are almost equal and
one has τ (x1 ) = τ (x2 ) = x1 . Therefore τ is not pre-injective.
    (c) Let G be a group and let A = {0, 1}. Let S be a ﬁnite subset of G
having at least 3 elements. Let τ : AG → AG be the majority action cellular
automaton associated with G and S (cf. Example 1.4.3(c)).
    Let x0 ∈ AG be the conﬁguration deﬁned by x0 (g) = 0 for all g ∈ G.
Let x1 ∈ AG be the conﬁguration deﬁned by x1 (1G ) = 1 and x1 (g) = 0 if
g = 1G . One has τ (x0 ) = τ (x1 ) = x0 and {g ∈ G : x0 (g) = x1 (g)} = {1G }.
Consequently, τ is not pre-injective.

   The operations of induction and restriction of cellular automata with re-
spect to a subgroup of the underlying group have been introduced in Sect. 1.7.
It turns out that pre-injectivity, like injectivity and surjectivity (see Propo-
sition 1.7.4), is preserved by these operations. More precisely, we have the
following result (which will not be used in the proof of the Garden of Eden
theorem given below):

Proposition 5.2.2. Let G be a group and let A be a set. Let H be a sub-
group of G and let τ ∈ CA(G, H; A). Let τH ∈ CA(H; A) denote the cellular
automaton obtained by restriction of τ to H. Then, τ is pre-injective if and
only if τH is pre-injective.

Proof. First recall from (1.16) the factorizations
                                                  
                    AG =         Ac and τ =          τc ,                  (5.1)
                          c∈G/H                    c∈G/H


where τc : Ac → Ac satisﬁes τc (
                                x|c ) = (τ (              ∈ Ac .
                                            x))|c for all x
   Suppose that τ is pre-injective. We want to show that τH is pre-injective.
So let x, y ∈ AH be almost equal conﬁgurations over H such that τH (x) =
τH (y). Let us ﬁx an arbitrary element a0 ∈ A and extend x and y to conﬁg-
urations x and y in AG by setting
                                                      
                 x(g) if g ∈ H,                          y(g) if g ∈ H,
        (g) =
        x                              and y(g) =
                 a0     otherwise                        a0     otherwise
114                                                         5 The Garden of Eden Theorem

for all g ∈ G. Note that the conﬁgurations x            and y are almost equal since
{g ∈ G : x   (g) = y(g)} = {h ∈ H : x(h) = y(h)}. By construction, x           |c = y|c
for all c ∈ G/H \ {H}, while x       |H = x and y|H = y. From (5.1), we deduce
that τ ( x) = τ (y ). It follows that x = y, by pre-injectivity of τ . This implies
that x = x   |H equals y|H = y. This shows that τH is pre-injective.
    Conversely, suppose that τH is pre-injective. Let x       , y ∈ AG be almost equal
conﬁgurations over G such that τ (        x) = τ (y ). For each g ∈ G, consider the
conﬁgurations x    g , yg ∈ AH deﬁned by x   g (h) = x (gh) and yg (h) = y(gh) for
all h ∈ H. Observe that the conﬁgurations x         g and yg are almost equal since
 and y are almost equal. On the other hand, we have x
x                                                                  g = φ∗g (
                                                                             x|c ) and yg =
  ∗                                         ∗
    y |c ), where c = gH ∈ G/H and φg : A → A is the bijective map deﬁned
φg (                                            c       H

by φ∗g (u)(h) = u(gh) for all u ∈ Ac . As τ (   x) = τ (y ), we have τc ( x|c ) = τc (
                                                                                         y |c )
by (5.1). We deduce that τH (                 yg ) since φ∗g conjugates τc and τH by
                                    xg ) = τH (
Proposition 1.18. Consequently, we have x          g = yg for all g ∈ G by the pre-
injectivity of τH . This implies that x     = y. Therefore, τ is pre-injective.



5.3 Statement of the Garden of Eden Theorem

The Garden of Eden theorem gives a necessary and suﬃcient condition for
the surjectivity of a cellular automaton with ﬁnite alphabet over an amenable
group. Its name comes from the fact that the surjectivity of a cellular au-
tomaton is equivalent to the absence of Garden of Eden conﬁgurations (see
Sect. 5.1).

Theorem 5.3.1 (The Garden of Eden theorem).
   Let G be an amenable group and let A be a ﬁnite set. Let τ : AG → AG be
a cellular automaton. Then one has

                       τ is surjective ⇐⇒ τ is pre-injective.

  The proof of Theorem 5.3.1 will be given in Sect. 5.8 (see Theorem 5.8.1).
Let us ﬁrst present some applications of this theorem.

Examples 5.3.2. (a) Let G = Z and A = Z/3Z. We have seen in Exam-
ple 5.2.1(a) that the cellular automaton τ : AG → AG deﬁned by τ (x)(n) =
x(n − 1) + x(n) + x(n + 1) is pre-injective. Since Z is amenable (cf. Theo-
rem 4.6.1), it follows from the Garden of Eden theorem that τ is surjective.
In fact, a direct proof of the surjectivity of τ is not diﬃcult (see Exercise 5.5).
   (b) Let G = Z2 and A = {0, 1}. Consider the cellular automaton τ : AG →
  G
A associated with the Game of Life. We have seen in Example 5.2.1(b)
that τ is not pre-injective. The group Z2 is amenable by Theorem 4.6.1. By
applying the Garden of Eden theorem, we deduce that τ is not surjective (see
Sect. 5.13 for a direct proof).
5.4 Interiors, Closures, and Boundaries                                            115

   (c) Let G be a group and let A = {0, 1}. Let S be a ﬁnite subset of G
having at least 3 elements. Let τ : AG → AG be the majority action cellular
automaton associated with G and S.
   We have seen in Example 5.2.1(c) that τ is not pre-injective. Thus it
follows from the Garden of Eden theorem that if G is amenable then τ is not
surjective. We shall see in Sect. 5.10 that if G is the free group F2 , then τ is
surjective.



5.4 Interiors, Closures, and Boundaries

Let G be a group.
   Let E and Ω be subsets of G. The E-interior Ω −E and the E-closure Ω +E
of Ω are the subsets of G deﬁned respectively by

                         Ω −E = {g ∈ G : gE ⊂ Ω}          and
                         Ω   +E
                                  = {g ∈ G : gE ∩ Ω = ∅}

(see Figs. 5.1–5.2). Observe that
                                             
                                    Ω −E =         Ωe−1                          (5.2)
                                             e∈E

and                                    !
                             Ω +E =         Ωe−1 = ΩE −1 .                       (5.3)
                                      e∈E




Fig. 5.1 The E-interior Ω −E of a set Ω. Here, Ω ⊂ R2 , E = {e, f } with e = (2, 1) and
f = (−1, −1)
116                                                   5 The Garden of Eden Theorem




Fig. 5.2 The E-closure Ω +E of a set Ω. Here, Ω ⊂ R2 , E = {e, f } with e = (2, 1) and
f = (−1, −1)

The E-boundary of Ω is the subset ∂E (Ω) of G deﬁned by

                               ∂E (Ω) = Ω +E \ Ω −E
(see Fig. 5.3).

Examples 5.4.1. (a) If E = ∅, then Ω −E = G and Ω +E = ∂E (Ω) = ∅.
   (b) If E = {1G }, then Ω −E = Ω +E = Ω and ∂E (Ω) = ∅.
   (c) If a ∈ G and E = {1G , a}, then Ω −E = Ω ∩ Ωa−1 , Ω +E = Ω ∪ Ωa−1 ,
so that

      ∂E (Ω) = (Ω ∪ Ωa−1 ) \ (Ω ∩ Ωa−1 ) = (Ω \ Ωa−1 ) ∪ (Ωa−1 \ Ω)             (5.4)

is the symmetric diﬀerence between the sets Ω and Ωa−1 (see Fig. 5.4).
   (d) Let us take G = Z2 and E = {−1, 0, 1}2 . Let a, b, c, d ∈ Z and consider
the rectangle Ω = [a, b] × [c, d] = {(x, y) ∈ Z2 : a ≤ x ≤ b, c ≤ y ≤ d}. Then
one has

Ω −E = [a + 1, b − 1] × [c + 1, d − 1]   and    Ω +E = [a − 1, b + 1] × [c − 1, d + 1]

(see Fig. 5.5).

Here are some general properties of the sets Ω −E , Ω +E and ∂E (Ω) which we
shall frequently use in the sequel.

Proposition 5.4.2. Let G be a group. Let E, E1 , E2 and Ω be subsets of G.
Then the following hold:
  (i) (G \ Ω)−E = G \ Ω +E ;
 (ii) (G \ Ω)+E = G \ Ω −E ;
5.4 Interiors, Closures, and Boundaries                                             117




Fig. 5.3 The E-boundary ∂E (Ω) of a set Ω. Here, Ω ⊂ R2 , E = {e, f } with e = (2, 1)
and f = (−1, −1)




Fig. 5.4 The E-interior Ω −E = Ω ∩ Ωa−1 , the E-closure Ω +E = Ω ∪ Ωa−1 , and the
E-boundary ∂E (Ω) = (Ω ∪ Ωa−1 ) \ (Ω ∩ Ωa−1 ) of a set Ω when E = {1G , a}




Fig. 5.5 The E-interior Ω −E , the E-closure Ω +E , and the E-boundary ∂E (Ω) of a rect-
angle Ω ⊂ Z2 . Here, Ω = [a, b] × [b, c] and E = {−1, 0, −1}2



(iii) if   a ∈ E, then Ω −E ⊂ Ωa−1 ⊂ Ω +E ;
(iv) if    1G ∈ E, then Ω −E ⊂ Ω ⊂ Ω +E ;
 (v) if    E is nonempty and Ω is ﬁnite, then Ω −E is ﬁnite;
(vi) if    E and Ω are both ﬁnite, then Ω +E and ∂E (Ω) are ﬁnite;
118                                                5 The Garden of Eden Theorem

 (vii) if E1 ⊂ E2 , then Ω −E2 ⊂ Ω −E1 , Ω +E1 ⊂ Ω +E2 and ∂E1 (Ω) ⊂ ∂E2 (Ω);
(viii) if h ∈ G, then h(Ω −E ) = (hΩ)−E , h(Ω +E ) = (hΩ)+E and h(∂E (Ω)) =
       ∂E (hΩ).

Proof. (i) By deﬁnition, we have g ∈ G \ Ω +E if and only if gE does not meet
Ω, that is, if and only if g ∈ (G \ Ω)−E .
   (ii) By replacing Ω by G \ Ω in (i) we get Ω −E = G \ (G \ Ω)+E which
gives (ii) after taking complements.
   (iii) If a ∈ E, then Ω −E ⊂ Ωa−1 by (5.2) and Ωa−1 ⊂ Ω +E by (5.3).
   (iv) Assertion (iii) gives (iv) by taking a = 1G .
   (v) If a ∈ E and Ω is ﬁnite, then |Ω −E | ≤ |Ωa−1 | = |Ω| by (iii).
   (vi) If E and Ω are both ﬁnite, then |Ω +E | ≤ |Ω||E| by (5.3) so that Ω +E
is ﬁnite. The set ∂E (Ω) is then also ﬁnite since it is contained in Ω +E .
   (vii) The ﬁrst two statements follow immediately from (5.2) and (5.3),
respectively, and imply that

      ∂E1 (Ω) = Ω +E1 \ Ω −E1 ⊂ Ω +E2 \ Ω −E1 ⊂ Ω +E2 \ Ω −E2 = ∂E2 (Ω).

   (viii) By using (5.2) we have

              h(Ω −E ) = h ∩e∈E Ωe−1 = ∩e∈E hΩe−1 = (hΩ)−E ,

which gives the ﬁrst statement. Similarly, from (5.3) we get

                 h(Ω +E ) = h(ΩE −1 ) = (hΩ)E −1 = (hΩ)+E .

Finally, we have

           h(∂E (Ω)) = h(Ω +E \ Ω −E ) = hΩ −E − hΩ −E = ∂E (hΩ).



Proposition 5.4.3. Let G be a group and let A be a set. Let τ : AG → AG
be a cellular automaton with memory set S. Let x and x be elements of AG .
Suppose that there is a subset Ω of G such that x and x coincide on Ω (resp.
on G \ Ω). Then the conﬁgurations τ (x) and τ (x ) coincide on Ω −S (resp.
on G \ Ω +S ).

Proof. Suppose that x and x coincide on Ω. If g ∈ Ω −S , then gS ⊂ Ω and
therefore τ (x)(g) = τ (x )(g) by Lemma 1.4.7. It follows that τ (x) and τ (x )
coincide on Ω −S .
   Suppose now x and x coincide on G \ Ω. Then τ (x) and τ (x ) coincide on
(G \ Ω)−S = G \ Ω +S by the ﬁrst part of the proof and Proposition 5.4.2(i).


Proposition 5.4.4. Let G be a group and let (Fj )j∈J be a net of nonempty
ﬁnite subsets of G. Then the following conditions are equivalent:
5.4 Interiors, Closures, and Boundaries                                                      119

(a) the net (Fj )j∈J is a right Følner net for G;
(b) one has

                        |∂E (Fj )|
                  lim              =0        for every ﬁnite subset E ⊂ G.
                   j      |Fj |

Proof. (b) ⇒ (a). Suppose (b). Let g ∈ G and take E = {1G , g −1 }. By (5.4),
we have
                           Fj \ Fj g ⊂ ∂E (Fj ),
and hence
                                   |Fj \ Fj g| ≤ |∂E (Fj )|.
Therefore, property (b) implies

                                           |Fj \ Fj g|
                                    lim                = 0.
                                      j       |Fj |

This shows that (Fj ) is a right Følner net for G.
(a) ⇒ (b). Let E be a ﬁnite subset of G. By (5.2) and (5.3) we have
                                                     
                             !               
                                     −1              −1
               ∂E (Fj ) =       Fj a     \      Fj b
                                a∈E                           b∈E
                                                                                     
                                   !                                  
                                                 −1                                −1
                           =              Fj a                 G\           Fj b
                                a∈E                                   b∈E
                                                                                     
                                   !                             !
                                                 −1                                −1
                           =              Fj a                        (G \ Fj b         )
                                a∈E                            b∈E
                                !
                           =           (Fj a−1 \ Fj b−1 ).
                               a,b∈E

This implies
                          |∂E (Fj )| ≤                |Fj a−1 \ Fj b−1 |.                   (5.5)
                                            a,b∈E

Now observe that, for all a, b ∈ E, we have

                          |Fj a−1 \ Fj b−1 | = |Fj \ Fj b−1 a|,

since right multiplication by a is bijective on G. Therefore, inequality (5.5)
gives us
                        |∂E (Fj )|            |Fj \ Fj g|
                                   ≤ |E|2 max             ,
                          |Fj |           g∈K    |Fj |
where K is the ﬁnite subset of G deﬁned by K = {b−1 a : a, b ∈ E}. This
shows that (a) implies (b).
120                                                  5 The Garden of Eden Theorem

Corollary 5.4.5. Let G be a group. Then the following conditions are equiv-
alent:
(a) G is amenable;
(b) for every ﬁnite subset E ⊂ G and every real number ε > 0, there exists a
    nonempty ﬁnite subset F ⊂ G such that

                                    |∂E (F )|
                                              < ε.                          (5.6)
                                      |F |

Proof. Suppose ﬁrst that G is amenable. It follows from the Tarski-Følner
theorem (Theorem 4.9.1) and Proposition 4.7.1 that there exists a right
                                                                  |∂ (F )|
Følner net (Fj )j∈J in G. By Proposition 5.4.4 we have that limj E|Fj |j = 0
for every ﬁnite subset E ⊂ G. Thus, given ε > 0 and a ﬁnite subset S ⊂ G,
                                |∂ (F )|
there exists j0 ∈ J such that E|Fj |j < ε for all j ≥ j0 . Taking F = Fj0 we
deduce (5.6). This shows (a) ⇒ (b).
   Conversely, suppose (b). Let J denote the set of all pairs (E, ε), where E
is a ﬁnite subset of G and ε > 0. We equip J with the partial ordering ≤
deﬁned by
                   (E, ε) ≤ (E  , ε ) ⇔ (E ⊂ E  and ε ≤ ε).
Then J is a directed set. By (b), for every j = (E, ε) ∈ J, there exists a
nonempty ﬁnite subset Fj ⊂ G such that

                                  |∂E (Fj )|
                                             < ε.                           (5.7)
                                    |Fj |

Let us show that
                    |∂E (Fj )|
              lim              = 0 for every ﬁnite subset E ⊂ G.            (5.8)
                j     |Fj |

Fix a ﬁnite subset E0 ⊂ G and ε0 > 0. Let j ∈ J and suppose that j ≥
j0 , where j0 = (E0 , ε0 ) ∈ J. By virtue of Proposition 5.4.2(vii) we have
∂E0 (Fj ) ⊂ ∂E (Fj ) so that, from (5.7), we deduce that

                        |∂E0 (Fj )|   |∂E (Fj )|
                                    ≤            < ε ≤ ε0 .
                           |Fj |        |Fj |

This shows (5.8). From Proposition 5.4.4 and Proposition 4.7.1 we deduce
that G satisﬁes the Følner conditions. Thus G is amenable by virtue of the
Tarski-Følner theorem (Theorem 4.9.1).
5.5 Mutually Erasable Patterns                                                   121

5.5 Mutually Erasable Patterns

In this section, we give a characterization of pre-injective cellular automata
based on the notion of mutually erasable patterns. This leads to an equiv-
alent deﬁnition of pre-injectivity which is frequently used in the literature.
However, the material contained in this section will not be used in the proof
of the Garden of Eden theorem so that the reader who is only interested in
this proof may go directly to the next section.
    Let G be a group and let A be a set.
    Let Z be a set and let f : AG → Z be a map. Two distinct patterns
p1 , p2 : Ω → Z with the same support Ω ⊂ G are called mutually erasable
(with respect to f ) if they satisfy the following condition: if x1 , x2 ∈ AG are
conﬁgurations such that x1 |Ω = p1 , x2 |Ω = p2 and x1 |G\Ω = x2 |G\Ω , then
f (x1 ) = f (x2 ).

Example 5.5.1. Let G = Z2 and A = {0, 1}. Consider the cellular automaton
τ : AG → AG associated with the Game of Life (see Example 1.4.3(a)). Let
Ω = {−1, 0, 1}2 be the 3 × 3 square in Z2 centered at the origin and consider
the pattern p1 (resp. p2 ) with support Ω deﬁned by p1 (g) = 0 for all g ∈ Ω
(resp. p2 (g) = 1 if g = (0, 0) and p2 (g) = 0 otherwise). Then it is clear that
p1 and p2 are mutually erasable patterns for τ (see Fig. 5.6).




Fig. 5.6 Two mutually erasable patterns for the Game of Life (recall that ◦ denotes a
dead cell, while • denotes a live cell)


   Suppose that p1 and p2 are mutually erasable patterns for a map f : AG →
Z. Let Ω denote their common support and consider two conﬁgurations x1
and x2 which coincide outside Ω and such that x1 |Ω = p1 and x2 |Ω = p2 .
Then x1 and x2 are almost equal and f (x1 ) = f (x2 ). On the other hand,
x1 = x2 since p1 = p2 and therefore f is not pre-injective. This shows that a
pre-injective map f : AG → Z admits no mutually erasable patterns. It turns
out that for cellular automata, the converse is true:
122                                                  5 The Garden of Eden Theorem

Proposition 5.5.2. Let G be a group and let A be a set. Let τ : AG → AG be
a cellular automaton. Then τ is pre-injective if and only if it does not admit
mutually erasable patterns.

Proof. It remains only to show that if τ is not pre-injective then it admits
mutually erasable patterns. So let us assume that τ is not pre-injective. This
means that there exist conﬁgurations x1 , x2 ∈ AG satisfying τ (x1 ) = τ (x2 )
such that Σ = {g ∈ G : x1 (g) = x2 (g)} is a nonempty ﬁnite subset of G.
Let S be a memory set for τ such that S = S −1 and 1G ∈ S. Consider the
                                                    2
ﬁnite sets S 2 = {s1 s2 : s1 , s2 ∈ S} and Ω = Σ +S . Let us show that the
patterns p1 = x1 |Ω and p2 = x2 |Ω are mutually erasable. First observe that
p1 = p2 since Σ ⊂ Ω. Suppose now that y1 , y2 ∈ AG are two conﬁgurations
coinciding outside Ω such that y1 |Ω = p1 and y2 |Ω = p2 . Then y1 and y2
coincide outside Σ since p1 and p2 coincide on Ω \ Σ. This implies

                    τ (y1 )(g) = τ (y2 )(g) for all g ∈ G \ Σ +S              (5.9)

by Proposition 5.4.3. On the other hand, for i = 1, 2, the conﬁgurations yi
and xi coincide on Ω by construction. Thus, it follows from Proposition 5.4.3
that τ (yi ) and τ (xi ) coincide on Ω −S . As τ (x1 ) = τ (x2 ), we deduce that the
conﬁgurations τ (y1 ) and τ (y2 ) coincide on Ω −S . Now observe that Σ +S ⊂
Ω −S . Indeed, if g ∈ Σ +S , that is, gs0 ∈ Σ for some s0 ∈ S, then gs ∈ Ω for
all s ∈ S since gss−1 s0 = gs0 ∈ gsS 2 ∩ Σ. It follows that τ (y1 ) and τ (y2 )
coincide on Σ +S . Combining this with (5.9), we conclude that τ (y1 ) = τ (y2 ).
This sows that p1 and p2 are mutually erasable patterns.



5.6 Tilings

Let G be a group.
   Let E and E  be subsets of G. A subset T ⊂ G is called an (E, E  )-tiling
of G if the sets gE, g ∈ T are pairwise disjoint and if the sets gE  , g ∈ T
cover G. In other words, T ⊂ G is an (E, E  )-tiling if and only if the following
conditions are satisﬁed:
(T1) g1 E ∩g2 E = ∅ for all g1 , g2 ∈ T such that g1 = g2 ;
(T2) G = g∈T gE  .

Examples 5.6.1. (a) In the additive group R, the set Z is a ([0, 1[, [0, 1[)-tiling
and the set [0, 1] is a (2Z, Z)-tiling.
   (b) If G is a group and H is a subgroup of G, then every complete set of
representatives for left cosets of G modulo H is an (H, H)-tiling.

Remark 5.6.2. Let G be a group and let E and E  be subsets of G. If T is an
(E, E  )-tiling of G and if E1 and E1 are subsets of G such that E1 ⊂ E and
E  ⊂ E1 , then it is clear that T is also an (E1 , E1 )-tiling of G.
5.6 Tilings                                                               123

   The Zorn lemma may be used to prove the existence of (E, E  )-tilings for
any subset E of G and for E  ⊂ G “large enough”. More precisely, we have
the following:

Proposition 5.6.3. Let G be a group and let E be a nonempty subset of G.
Let E  = {g1 g2−1 : g1 , g2 ∈ E}. Then there is an (E, E  )-tiling T ⊂ G.

Proof. Consider the set S consisting of all subsets S ⊂ G such that the sets
(gE)g∈S are pairwise disjoint. Observe that S is not empty since {1G } ∈ S.
On the other hand, the set S, partially ordered by inclusion, is inductive.
                                                                     
Indeed, if S  is a totally ordered subset of S, then the set M = S∈S  S
belongs to S and is an upper bound for S  . By applying Zorn’s lemma, we
deduce that S admits a maximal element T . The sets (gE)g∈T are pairwise
disjoint since T ∈ S. On the other hand, consider an arbitrary element h ∈ G.
By maximality of T , we can ﬁnd g ∈ T such that the set hE meets gE. This
implies h ∈ gE  . This shows that the sets (gE  )g∈T cover G. Consequently,
T is an (E, E  )-tiling of G.

Proposition 5.6.4. Let G be an amenable group and let (Fj )j∈J be a right
Følner net for G. Let E and E  be ﬁnite subsets of G and suppose that T ⊂ G
is an (E, E  )-tiling of G. Let us set, for each j ∈ J,

                    Tj = T ∩ Fj−E = {g ∈ T : gE ⊂ Fj }.

Then there exist a real number α > 0 and an element j0 ∈ J such that

                        |Tj | ≥ α|Fj |    for all j ≥ j0 .

Proof. After possibly replacing E  by E ∪ E  , we can assume that E ⊂ E  .
                              
Let us set Tj+ = T ∩ Fj+E = {g ∈ T : gE  ∩ Fj = ∅}. As the sets gE  ,
g ∈ Tj+ , cover Fj , we have |Fj | ≤ |Tj+ | · |E  |, which gives

                                  |Tj+ |   1
                                         ≥                            (5.10)
                                   |Fj |  |E |
for all j ∈ J. Observe now that
                               (        
                                          )
                     Tj+ \ Tj = T ∩ Fj+E \ T ∩ Fj−E
                                            
                             = T ∩ (Fj+E \ Fj−E )
                                                     
                             ⊂ T ∩ (Fj+E \ Fj−E )
                             ⊂ T ∩ ∂E  (Fj )
                             ⊂ ∂E  (Fj )

where the ﬁrst inclusion follows from E ⊂ E  . Thus we have

                           |∂E  (Fj )| ≥ |Tj+ | − |Tj |.
124                                                         5 The Garden of Eden Theorem

Using (5.10), we then deduce

                       |Tj |   |Tj+ | |∂E  (Fj )|   1   |∂E  (Fj )|
                             ≥        −            ≥  −              .
                       |Fj |    |Fj |    |Fj |      |E |    |Fj |

Hence we have
                                     |Tj |       1
                                           ≥α=
                                     |Fj |     2|E  |
for j large enough, by Proposition 5.4.4 (see Fig. 5.7).




Fig. 5.7 The set T7 = T ∩ F7−E ⊂ Z2 , where E = {(0, 0), (1, 0)}, E  = {0, 1} × {0, 1} and
                                                                        |T7 |
T = (2Z + 1) × (2Z + 1) ⊂ Z2 is an (E, E  )-tiling in Z2 . Note that   |F7 |
                                                                                =   12
                                                                                    64
                                                                                         =    3
                                                                                             16
                                                                                                  ≥    2
                                                                                                      16
                                                                                                           =
1         1
8
    =   2|E  |
                  =α
5.7 Entropy                                                                125

5.7 Entropy

In this section, G is an amenable group, F = (Fj )j∈J is a right Følner net
for G, and A is a ﬁnite set.
   For E ⊂ G, we denote by πE : AG → AE the canonical projection (restric-
tion map). We thus have πE (x) = x|E for all x ∈ AG .

Deﬁnition 5.7.1. Let X ⊂ AG . The entropy entF (X) of X with respect to
the right Følner net F = (Fj )j∈J is deﬁned by
                                             log |πFj (X)|
                       entF (X) = lim sup                  .
                                       j          |Fj |
  Here are some immediate properties of entropy.
Proposition 5.7.2. One has
  (i) entF (AG ) = log |A|;
 (ii) entF (X) ≤ entF (Y ) if X ⊂ Y ⊂ AG ;
(iii) entF (X) ≤ log |A| for all X ⊂ AG .

Proof. (i) If X = AG , then, for every j, we have πFj (X) = AFj and therefore
              log |πFj (X)|   log |A||Fj |   |Fj | log |A|
                            =              =               = log |A|.
                   |Fj |         |Fj |           |Fj |
Thus we have entF (X) = log |A|.
   (ii) If X ⊂ Y , then πFj (X) ⊂ πFj (Y ) and hence |πFj (X)| ≤ |πFj (Y )| for
all j. This implies entF (X) ≤ entF (Y ).
   (iii) This follows immediately from (i) and (ii).

   An important property of cellular automata is the fact that applying a
cellular automaton to a set of conﬁgurations cannot increase the entropy of
the set. More precisely, we have the following:

Proposition 5.7.3. Let τ : AG → AG be a cellular automaton and let X ⊂
AG . Then one has
                        entF (τ (X)) ≤ entF (X).
Proof. Let Y = τ (X). Let S ⊂ G be a memory set for τ . After replacing
S by S ∪ {1G }, we can assume that 1G ∈ S. Let Ω be a ﬁnite subset of G.
Observe ﬁrst that τ induces a map
                            τΩ : πΩ (X) → πΩ −S (Y )
deﬁned as follows. If u ∈ πΩ (X), then
                              τΩ (u) = (τ (x))|Ω −S ,
where x is an element of X such that x|Ω = u. Note that the fact that τΩ (u)
does not depend on the choice of such an x follows from Proposition 5.4.3.
126                                                     5 The Garden of Eden Theorem

Clearly τΩ is surjective. Indeed, if v ∈ πΩ −S (Y ), then there exists x ∈ X
such that (τ (x))|Ω −S = v. Then, setting u = πΩ (x) we have, by construction,
τΩ (u) = v. Therefore, we have
                               |πΩ −S (Y )| ≤ |πΩ (X)|.                       (5.11)
Observe now that Ω −S ⊂ Ω, since 1G ∈ S (cf. Proposition 5.4.2(iv)). Thus
                           −S
πΩ (Y ) ⊂ πΩ −S (Y ) × AΩ\Ω . This implies
                                                          −S
               log |πΩ (Y )| ≤ log |πΩ −S (Y ) × AΩ\Ω          |
                                                          Ω\Ω −S
                              = log |πΩ −S (Y )| + log |A        |
                              = log |πΩ −S (Y )| + |Ω \ Ω −S | log |A|
                              ≤ log |πΩ (X)| + |Ω \ Ω −S | log |A|,

by (5.11). As Ω \ Ω −S ⊂ ∂S (Ω), we deduce that
                 log |πΩ (Y )| ≤ log |πΩ (X)| + |∂S (Ω)| log |A|.
By taking Ω = Fj , this gives us
                log |πFj (Y )|   log |πFj (X)| |∂S (Fj )|
                               ≤              +           log |A|.
                     |Fj |            |Fj |      |Fj |
Since
                                        |∂S (Fj )|
                                  lim              =0
                                   j      |Fj |
by Proposition 5.4.4, we ﬁnally get
                            log |πFj (Y )|           log |πFj (X)|
      entF (Y ) = lim sup                  ≤ lim sup               = entF (X).
                    j            |Fj |          j         |Fj |


   It follows from Proposition 5.7.2 that the maximal value for the entropy of
a subset X ⊂ AG is log |A|. The following result gives a suﬃcient condition
on X which implies that its entropy is strictly less than log |A|.

Proposition 5.7.4. Let X ⊂ AG . Suppose that there exist ﬁnite subsets E
and E  of G and an (E, E  )-tiling T ⊂ G such that πgE (X)  AgE for all
g ∈ T . Then one has entF (X) < log |A|.

Proof. For each j ∈ J, let us deﬁne, as in Proposition 5.6.4 (see Fig. 5.7), the
subset Tj ⊂ T by Tj = T ∩ Fj−E = {g ∈ T : gE ⊂ Fj } and set
                                          $
                              Fj∗ = Fj \     gE
                                              g∈Tj

(see Fig. 5.8). By hypothesis, we have
              |πgE (X)| ≤ |AgE | − 1 = |A||gE| − 1 for all g ∈ T.             (5.12)
5.7 Entropy                                                                                    127




                            ‘
Fig. 5.8 The set F7∗ = F7 \ g∈T7 gE = F7 \ T7 E ⊂ Z2 , where E and T are as in Fig. 5.7
(note that here F7 is the whole square, while F7∗ ⊂ F7 consists of its •-points)


As                                             ∗      
                           πFj (X) ⊂ AFj ×                  πgE (X),
                                                     g∈Tj

we get
                               ∗       
     log |πFj (X)| ≤ log |AFj ×               πgE (X)|
                                       g∈Tj

                  = |Fj∗ | log |A| +              log |πgE (X)|
                                           g∈Tj

                  ≤ |Fj∗ | log |A| +              log(|A||gE| − 1) (by (5.12))
                                           g∈Tj

                  =   |Fj∗ | log |A|   +          |gE| log |A| +          log(1 − |A|−|gE| )
                                           g∈Tj                    g∈Tj

                  = |Fj | log |A| + |Tj | log(1 − |A|−|E| ),
128                                                        5 The Garden of Eden Theorem

since
                  |Fj | = |Fj∗ | +          |gE|   and     |gE| = |E|.
                                     g∈Tj

By setting c = − log(1 − |A|−|E| ) (note that c > 0), this gives us

               log |πFj (X)| ≤ |Fj | log |A| − c|Tj |       for all j ∈ J.

Now, by Proposition 5.6.4, there exist α > 0 and j0 ∈ J such that |Tj | ≥ α|Fj |
for all j ≥ j0 . Thus

                  log |πFj (X)|
                                ≤ log |A| − cα           for all j ≥ j0 .
                       |Fj |

This implies that

                                log |πFj (X)|
           entF X = lim sup                   ≤ log |A| − cα < log |A|.
                           j         |Fj |


  Recall from Sect. 1.1 that G acts on the left on AG by the shift (g, x) → gx
deﬁned by gx(g  ) = x(g −1 g  ) for g, g  ∈ G and x ∈ AG .
Corollary 5.7.5. Let X be a G-invariant subset of AG . Suppose that there
exists a ﬁnite subset E ⊂ G such that πE (X)  AE . Then one has entF (X) <
log |A|.
Proof. Let E  = {g1 g2−1 : g1 , g2 ∈ E}. By Proposition 5.6.3, we may ﬁnd
an (E, E  )-tiling T ⊂ G. Since πE (X)  AE and X is G-invariant, we have
πgE (X)  AgE for all g ∈ G. This implies entF (X) < log |A| by Proposi-
tion 5.7.4.



5.8 Proof of the Garden of Eden Theorem

The purpose of this section is to establish the following:
Theorem 5.8.1. Let G be an amenable group and let A be a ﬁnite set. Let
F = (Fj )j∈J be a right Følner net for G. Let τ : AG → AG be a cellular
automaton. Then the following conditions are equivalent:
(a) τ is surjective;
(b) entF (τ (AG )) = log |A|;
(c) τ is pre-injective.
   Note that this will prove the Garden of Eden theorem (Theorem 5.3.1)
since the Garden of Eden theorem asserts the equivalence of conditions (a)
and (c) in Theorem 5.8.1.
5.8 Proof of the Garden of Eden Theorem                                      129

   We divide the proof of Theorem 5.8.1 into several lemmas. In these lemmas,
it is assumed that the hypotheses of Theorem 5.8.1 are satisﬁed: G is an
amenable group, F = (Fj )j∈J is a right Følner net for G, A is a ﬁnite set,
and τ : AG → AG is a cellular automaton.

Lemma 5.8.2. Suppose that τ is not surjective. Then one has entF (τ (AG )) <
log |A|.

Proof. By Proposition 5.1.1, τ admits a Garden of Eden pattern. This means
that there is a ﬁnite subset E ⊂ G such that πE (τ (AG ))  AE . The set τ (AG )
is G-invariant since τ is G-equivariant by Proposition 1.4.4. We deduce that
entF (τ (AG )) < log |A| by applying Corollary 5.7.5.

Lemma 5.8.3. Suppose that

                               ent(τ (AG )) < log |A|.                     (5.13)

Then τ is not pre-injective.

Proof. Let S be a memory set for τ such that 1G ∈ S. Let Y = τ (AG ). We
have Fj−S ⊂ Fj ⊂ Fj+S by Proposition 5.4.2(iv) and therefore Fj+S \ Fj ⊂
                                            +S
                                                 \Fj
∂S (Fj ). As πF +S (Y ) ⊂ πFj (Y ) × AFj               , it follows that
               j



               log |πF +S (Y )| ≤ log |πFj (Y )| + |Fj+S \ Fj | log |A|
                      j


                                  ≤ log |πFj (Y )| + |∂S (Fj )| log |A|.

This implies

               log |πF +S (Y )|       log |πFj (Y )| |∂S (Fj )|
                       j
                                  ≤                 +           log |A|.   (5.14)
                     |Fj |                 |Fj |       |Fj |

As
                                            log |πFj (Y )|
                    ent(Y ) = lim sup                      < log |A|
                                      j          |Fj |
by hypothesis, and
                                          |∂S (Fj )|
                                    lim              =0
                                      j     |Fj |
by Proposition 5.4.4, we deduce from inequality (5.14) that there exists j0 ∈ J
such that
                           log |πF +S (Y )|
                                            < log |A|.
                                  j0
                                                                         (5.15)
                                |Fj0 |
Let us ﬁx an arbitrary element a0 ∈ A and denote by Z the ﬁnite set of
conﬁgurations z ∈ AG such that z(g) = a0 for all g ∈ G\Fj0 . Inequality (5.15)
gives us
130                                                            5 The Garden of Eden Theorem

                           |πF +S (Y )| < |A||Fj0 | = |Z|.
                              j0


Observe that τ (z1 ) and τ (z2 ) coincide outside Fj +S for all z1 , z2 ∈ Z. Thus
                                                               0


                  |τ (Z)| = |πF    +S
                                        (τ (Z))| ≤ |πF    +S
                                                               (Y )| < |Z|.
                                  j0                     j0



This implies that we may ﬁnd distinct conﬁgurations z1 , z2 ∈ Z such that
τ (z1 ) and τ (z2 ). Since z1 and z2 coincide outside the ﬁnite set Fj0 , this shows
that τ is not pre-injective.

Lemma 5.8.4. Suppose that τ is not pre-injective. Then one has

                             entF (τ (AG )) < log |A|.                               (5.16)

Proof. Since τ is not pre-injective, we may ﬁnd two conﬁgurations x1 , x2 ∈
AG satisfying τ (x1 ) = τ (x2 ) such that the set

                          Ω = {g ∈ G : x1 (g) = x2 (g)}

is a nonempty ﬁnite subset of G. Observe that, for each h ∈ G, the conﬁg-
urations hx1 and hx2 satisfy τ (hx1 ) = τ (hx2 ) (since τ is G-equivariant by
Proposition 1.4.4) and {g ∈ G : hx1 (g) = hx2 (g)} = hΩ.
   Let S be a memory set for τ such that 1G ∈ S. Then the set

                             R = {s−1 s : s, s ∈ S}

is ﬁnite and we have 1G ∈ R. Let E = Ω +R . By Proposition 5.6.3, we may
ﬁnd a ﬁnite subset E  ⊂ G and an (E, E  )-tiling T ⊂ G. Consider the subset
Z ⊂ AG consisting of all conﬁgurations z ∈ AG such that

                       z|hE = (hx1 )|hE          for all h ∈ T.

Observe that, for each h ∈ T , we have

                                    πhE (Z)  AhE

since (hx1 )|hE ∈
                / πhE (Z). We deduce that entF (Z) < log |A| by applying
Proposition 5.7.4. As entF (τ (Z)) ≤ entF (Z) by Proposition 5.7.3, this implies

                              entF (τ (Z)) < log |A|.                                (5.17)

Thus, to establish inequality (5.16), it suﬃces to prove that τ (AG ) = τ (Z).
To see this, consider an arbitrary conﬁguration x ∈ AG and let us show that
there is a conﬁguration z ∈ Z such that τ (x) = τ (z). Let

                        T  = {h ∈ T : x|hE = (hx1 )|hE }.
5.9 Surjunctivity of Locally Residually Amenable Groups                    131

Let z ∈ AG be the conﬁguration deﬁned by
                 
                   hx2 (g) if there is h ∈ T  such that g ∈ hE,
          z(g) =
                   x(g)     otherwise.

Notice that the conﬁguration z is obtained from x by modifying the values
taken by x only on the subsets of the form hΩ, where h ∈ T  , (since, as we
have seen above, hx1 and hx2 coincide outside hΩ).
   By construction, we have z ∈ Z.
   Let g ∈ G. Let us shows that τ (x)(g) = τ (z)(g).
   Suppose ﬁrst that gS does not meet any of the sets hΩ, h ∈ T  . Then
we have z|gS = x|gS . We deduce that τ (z)(g) = τ (x)(g) by applying
Lemma 1.4.7.
   Suppose now that there is an element h ∈ T  such that gS meets hΩ. This
means that there exists an element s0 ∈ S such that gs0 ∈ hΩ. For each
s ∈ S, we have gss−1 s0 = gs0 ∈ hΩ. As s−1 s0 ∈ R, this implies

             gs ∈ (hΩ)+R = hΩ +R         (by Proposition 5.4.2(viii))
                = hE.

We deduce that gS ⊂ hE. Thus we have τ (x)(g) = τ (hx1 )(g) since x|hE =
hx1 |hE . Similarly, by applying Lemma 1.4.7, we get τ (z)(g) = τ (hx2 )(g),
since z and hx2 coincide on hE. As τ (hx1 ) = τ (hx2 ), we deduce that
τ (x)(g) = τ (z)(g).
   Thus τ (z) = τ (x). This shows that τ (AG ) = τ (Z) and completes the proof
of the lemma.

Proof of Theorem 5.8.1. If τ is surjective, then τ (AG ) = AG and hence
entF (τ (AG )) = entF (AG ) = log |A|. Thus (a) implies (b). Since the converse
implication follows from Lemma 5.8.2, we deduce that conditions (a) and (b)
are equivalent. The fact that (c) implies (b) follows from Lemma 5.8.3 and
the converse implication follows from Lemma 5.8.4. Thus, conditions (b) and
(c) are also equivalent.



5.9 Surjunctivity of Locally Residually Amenable
    Groups

The notion of a residually ﬁnite group was introduced in Chap. 2. More
generally, if P is a property of groups, a group G is called residually P if
for each element g ∈ G with g = 1G , there exist a group Γ satisfying P and
an epimorphism φ : G → Γ such that φ(g) = 1Γ . Observe that every group
which satisﬁes P is residually P.
132                                                 5 The Garden of Eden Theorem

   According to the preceding deﬁnition, a group G is called residually
amenable if for each element g ∈ G with g = 1G , there exist an amenable
group Γ and an epimorphism φ : G → Γ such that φ(g) = 1Γ . Note that,
as every subgroup of an amenable group is amenable, it is not necessary to
require that the homomorphism φ is surjective in this deﬁnition. Observe also
that every subgroup of a residually amenable group is residually amenable
and that the fact that every ﬁnite group is amenable (Proposition 4.4.6)
implies that every residually ﬁnite group is residually amenable.

Theorem 5.9.1. Every residually amenable group is surjunctive.

  Let us ﬁrst establish the following:

Lemma 5.9.2. Let G be a residually amenable group and let Ω be a ﬁnite
subset of G. Then there exist an amenable group Γ and a homomorphism
ρ : G → Γ such that the restriction of ρ to Ω is injective.

Proof. Consider the ﬁnite subset S ⊂ G deﬁned by

                       S = {g −1 h : g, h ∈ Ω and g = h}.

Since G is residually amenable, we can ﬁnd, for each s ∈ S, an amenable
group Λs and a homomorphism φs : G → Λs such that φs (s) = 1Λs . Let us
show that the group                 
                               Γ =     Λs
                                        s∈S

and the homomorphism ρ : G → Γ given by
                                 
                             ρ=      φs
                                        s∈S

have the required properties. The fact that the group Γ is amenable follows
from Corollary 4.5.6. On the other hand, suppose that g and h are distinct
elements of Ω. Then s = g −1 h ∈ S and φs (g) = φs (h) since (φs (g))−1 φs (h) =
φs (g −1 h) = φs (s) = 1Λs . This implies ρ(g) = ρ(h). Therefore, the restriction
of ρ to Ω is injective.

Proof of Theorem 5.9.1. Since every injective cellular automaton is pre-
injective, the Garden of Eden theorem (Theorem 5.3.1) implies that every
amenable group is surjunctive. By applying Lemma 3.3.4 and Lemma 5.9.2,
it follows that every residually amenable group is surjunctive.

  As an immediate consequence of Theorem 5.9.1 and Proposition 3.2.2, we
obtain the following:

Corollary 5.9.3. Every locally residually amenable group is surjunctive.
5.11 A Pre-injective but Not Surjective Cellular Automaton over F2          133

5.10 A Surjective but Not Pre-injective Cellular
     Automaton over F2

The Garden of Eden theorem (Theorem 5.3.1) implies that every surjective
cellular automaton with ﬁnite alphabet over an amenable group is necessarily
pre-injective. In this section, we give an example of a surjective but not pre-
injective cellular automaton with ﬁnite alphabet over the free group F2 .
   Let G = F2 be the free group on two generators a and b. Let S =
{a, b, a−1 , b−1 } and A = {0, 1}. Consider the cellular automaton τ : AG → AG
deﬁned by                       ⎧            
                                ⎪
                                ⎨1        if        x(gs) > 2,
                                             s∈S
                      τ (x)(g) = 0        if        x(gs) < 2,
                                ⎪
                                ⎩            s∈S
                                   x(g) if     s∈S x(gs) = 2.

Thus τ is the majority action automaton associated with G and S (see Ex-
ample 1.4.3(c)). We have already seen in Example 5.2.1(c) that τ is not
pre-injective.
   Let us show that τ is surjective. Let y ∈ AG be an arbitrary conﬁguration.
We may construct a conﬁguration x ∈ AG such that y = τ (x) in the following
way. Consider the map ψ : G\{1G } → G which associates to each g ∈ G\{1G }
the element of G obtained by suppressing the last factor in the reduced form
of g. Thus if g = s1 s2 . . . sn with si ∈ S for 1 ≤ i ≤ n and si si+1 = 1G for
1 ≤ i ≤ n − 1, then ψ(g) = s1 s2 . . . sn−1 . Let x ∈ AG be the conﬁguration
deﬁned by x(g) = y(ψ(g)) for all g ∈ G \ {1G } and x(1G ) = 0. Then, for each
g ∈ G, the conﬁguration x takes the value y(g) at (at least) three of the four
elements gs, s ∈ S. it follows that τ (x) = y. Thus τ is surjective.
   More generally, let G be a group containing a free subgroup H based on
two elements a and b. Let τ : {0, 1}G → {0, 1}G be the majority action cellu-
lar automaton over G associated with the set S = {a, b, a−1 , b−1 }. We have
seen in Example 5.2.1(c) that τ is not pre-injective. Consider its restriction
τH : {0, 1}H → {0, 1}H . Note that τH is the majority action cellular automa-
ton over H associated with S. We have seen above that τH is surjective. It
follows from Proposition 1.7.4(ii) that τ is also surjective. Thus, every group
containing a free subgroup of rank two admits a cellular automaton with ﬁ-
nite alphabet which is surjective but not pre-injective. This will be extended
to all non-amenable groups in Sect. 5.12.



5.11 A Pre-injective but Not Surjective Cellular
     Automaton over F2

It follows from the Garden of Eden theorem (Theorem 5.3.1) that every pre-
injective cellular automaton with ﬁnite alphabet over an amenable group is
134                                                      5 The Garden of Eden Theorem

necessarily surjective. In this section, we give examples of cellular automata
with ﬁnite alphabet over the free group F2 which are pre-injective but not
surjective.
    Let G = F2 be the free group on two generators a and b. Let H be a
nontrivial abelian group. Our alphabet will be the group A = H ×H. We shall
use additive notation for the group operations on H and A. Let p1 , p2 : A → A
be the group endomorphisms deﬁned respectively by p1 (u) = (h1 , 0) and
p2 (u) =(h2 , 0) for all u = (h1 , h2 ) ∈ A. Let us equip the Cartesian product
AG = g∈G A with its natural Abelian group structure. Consider the map
τ : AG → AG given by

      τ (x)(g) = p1 (x(ga)) + p2 (x(gb)) + p1 (x(ga−1 )) + p2 (x(gb−1 ))       (5.18)

for all g ∈ G and x ∈ AG .
   It is clear that τ is a cellular automaton over the group G and the alphabet
A with memory set S = {a, b, a−1 , b−1 } and a group endomorphism of AG .

Proposition 5.11.1. The cellular automaton τ : AG → AG deﬁned by (5.18)
is pre-injective but not surjective.

Proof. The image of τ is contained in (H × {0})G  (H × H)G = AG . Thus
τ is not surjective.
   Let us show that τ is pre-injective. Suppose not. Then there exist con-
ﬁgurations x1 , x2 ∈ AG satisfying τ (x1 ) = τ (x2 ) such that the set Ω =
{g ∈ G : x1 (g) = x2 (g)} is a nonempty ﬁnite subset of G. The conﬁgura-
tion x0 = x1 − x2 ∈ AG satisﬁes τ (x0 ) = τ (x1 ) − τ (x2 ) = 0 and one has
Ω = {g ∈ G : x0 (g) = 0}. Consider an element g0 ∈ Ω whose reduced form
has maximal length, say n0 . Then x0 (g0 ) is a nonzero element (h0 , k0 ) of A.
   If h0 = 0, take s0 ∈ {a, a−1 } such that the reduced form of g0 s0 has length
n0 + 1. Then, for each s ∈ S \ {s−1 0 }, the length of the reduced form of g0 s0 s
is n0 + 2 and hence x(g0 s0 s) = 0. By applying 5.18, we deduce that

                     τ (x0 )(g0 s0 ) = p1 (x0 (g0 )) = (h0 , 0) = 0,

which contradicts the fact that τ (x0 ) = 0.
   If h0 = 0, then k0 = 0 and we proceed similarly by taking s0 ∈ {b, b−1 }
such that the reduced form of g0 s0 has length n0 + 1. This gives us

                     τ (x0 )(g0 s0 ) = p2 (x0 (g0 )) = (k0 , 0) = 0,

which yields again a contradiction. This shows that τ is pre-injective.

   If we take for H a ﬁnite abelian group of cardinality |H| = n ≥ 2 (e.g.,
the group H = Z/nZ), this gives us a pre-injective but not surjective cellular
automaton over F2 whose alphabet is ﬁnite of cardinality n2 .
   From Proposition 1.7.4 we deduce the following:
5.12 A Characterization of Amenability in Terms of Cellular Automata                135

Proposition 5.11.2. Let G be a group containing a free subgroup of rank
two. Then there exist a ﬁnite set A and a cellular automaton τ : AG → AG
which is pre-injective but not surjective.



5.12 A Characterization of Amenability in Terms of
     Cellular Automata

In Sect. 5.10, we gave an example of a cellular automaton with ﬁnite alphabet
over the free group F2 which is surjective but not pre-injective. In fact, the
existence of such an automaton holds for any non-amenable group:

Theorem 5.12.1. Let G be a non-amenable group. Then there exists a ﬁnite
set A and a cellular automaton τ : AG → AG which is surjective but not
pre-injective.

Proof. Since G is non-amenable, it follows from Theorem 4.9.2 that there
exist a 2-to-one surjective map ϕ : G → G and a ﬁnite subset S ⊂ G such
that
                         (ϕ(g))−1 g ∈ S for all g ∈ G.            (5.19)
Our alphabet will be the Cartesian product A = S × S. Let us ﬁx some total
order ≤ on S and an arbitrary element s0 ∈ S. Deﬁne the map μ : AS → A
by
         ⎧
         ⎪     
         ⎨(s , t ) if there exists a unique element (s, t) ∈ S × S with s < t
μ(y) =                 such that y(s) = (s, s ) and y(t) = (t, t ), where s , t ∈ S,
         ⎪
         ⎩
            (s0 , s0 ) otherwise,
                                                                                  (5.20)
for all y ∈ AS .
    Let us show that the cellular automaton τ : AG → AG with memory set S
and local deﬁning map μ has the required properties.
    We ﬁst observe that S has at least two elements since otherwise (5.19)
would imply that ϕ is bijective. Let s1 ∈ S such that s1 = s0 . Consider the
conﬁgurations x0 , x1 ∈ AG , where x0 is deﬁned by x0 (g) = (s0 , s0 ) for all
g ∈ G, and x1 is deﬁned by x1 (g) = (s0 , s0 ) if g = 1G and x1 (1G ) = (s0 , s1 ).
The conﬁgurations x0 and x1 are almost equal since they diﬀer only at 1G .
On the other hand, it is clear that x0 and x1 have the same image, namely
x0 , by τ . Thus τ is not pre-injective.
    We use the properties of ϕ to prove that τ is surjective. Let x ∈ AG be
an arbitrary conﬁguration. Let us show that there is a conﬁguration z ∈ AG
such that x = τ (z). We construct z in the following way. Let u : G → S and
v : G → S be the maps deﬁned by x(g) = (u(g), v(g)) for all g ∈ G. For
each g ∈ G, there are exactly two elements sg , tg ∈ S such that sg < tg and
ϕ(gsg ) = ϕ(gtg ) = g. Let us set z(gsg ) = (sg , u(g)) and z(gtg ) = (tg , v(g)).
136                                                      5 The Garden of Eden Theorem

Observe that z : G → A is well deﬁned and that the value of z at g ∈ G
is either ((ϕ(g))−1 g, u(ϕ(g)) or ((ϕ(g))−1 g, v(ϕ(g)). It immediately follows
from the deﬁnition of τ that x = τ (z). This shows that τ is surjective.

  Combining Theorem 5.12.1 with Theorem 5.3.1, we obtain the following
characterization of amenable groups in terms of cellular automata:

Corollary 5.12.2. Let G be a group. Then the following conditions are equiv-
alent:
(a) G is amenable;
(b) every surjective cellular automaton with ﬁnite alphabet over G is pre-
    injective.



5.13 Garden of Eden Patterns for Life

Let τ : {0, 1}Z → {0, 1}Z denote the cellular automaton associated with the
              2            2


Game of Life (see Example 1.4.3(a)). As it was observed in Example 5.3.2(b),
it follows from the Garden of Eden theorem that τ is not surjective. Thus,
Proposition 5.1.1 implies that τ admits Garden of Eden patterns. The purpose
of this section is to present a direct proof of the existence of such patterns.
This construction will provide a concrete illustration of the ideas underly-
ing the proof that surjectivity implies pre-injectivity in the Garden of Eden
theorem.
   Given an integer n ≥ 1, one says that a subset Ω ⊂ Z2 is a square of size
n × n in Z2 if there exist p, q ∈ Z such that
          Ω = {p, p + 1, . . . , p + n − 1} × {q, q + 1, . . . , q + n − 1}.

Proposition 5.13.1. Let τ : {0, 1}Z → {0, 1}Z be the cellular automaton
                                        2                2


associated with the Game of Life. Then every square Ω ⊂ Z2 of size n × n
with n ≥ 3 × 109 is the support of a Garden of Eden pattern for τ .

Proof. Let n ≥ 1 be an integer. Consider a square Cn ⊂ Z2 of size 5n × 5n.
Let Dn ⊂ Cn be the square of size (5n − 2) × (5n − 2) which is the S-interior
of Dn for S = {−1, 0, 1}2 ⊂ Z2 . Thus Dn is obtained from Cn by removing
the 20n − 4 points of Z2 located on the (usual) boundary of Cn .
   Let us set Xn = {0, 1}Cn and Yn = {0, 1}Dn . The map τ induces a map
τn : Xn → Yn deﬁned as follows. If u ∈ Xn , we set τn (u) = (τ (x))|Dn , where
x ∈ {0, 1}Z satisﬁes x|Cn = u (the fact that (τ (x))|Dn does not depend of
           2


the choice of x follows from Proposition 5.4.3 since S is a memory set for τ
and Dn is the S-interior of Cn ). We have
                                         2         2
                                                       −20n+4
                         |Yn | = 2(5n−2) = 225n                 .
Let us divide the square Cn into n2 squares of size 5 × 5 (see Fig. 5.10).
5.13 Garden of Eden Patterns for Life                                                           137




Fig. 5.9 A square Cn ⊂ Z2 of size 5n × 5n and its S-interior Dn ⊂ Cn , a square of size
(5n − 2) × (5n − 2) where S = {−1, 0, 1}2 ⊂ Z2 ; here n = 3


   There are 225 maps from each square of size 5 × 5 to the set {0, 1}. Now
observe that if the restriction of an element u ∈ Xn to one of these 5 × 5
squares is identically 0, then we may replace the 0 value at the center of this
5 × 5 square by 1 without changing τn (u). We deduce that
                                                                               −25
                                 2            25
                                                   −1) n2                            ))n2
       |τn (Xn )| ≤ (225 − 1)n = (2log2 (2            )     = 2(25+log2 (1−2                .

Therefore we have |τn (Xn )| < |Yn | if

                   (25 + log2 (1 − 2−25 ))n2 < 25n2 − 20n + 4.

This inequality is equivalent to

                          −n2 log2 (1 − 2−25 ) − 20n + 4 > 0,

which is veriﬁed if and only if
                             2           *
               n>                −25
                                     (5 + 25 + log2 (1 − 2−25 )),
                    − log2 (1 − 2 )

that is, if and only if
                                     n ≥ 465 163 744.
138                                                      5 The Garden of Eden Theorem




Fig. 5.10 The square Cn ⊂ Z2 of size 5n × 5n is divided into n2 squares of size 5×5; here,
as in Fig. 5.9, n = 3


For such values of n, the map τn is not surjective, i.e., there exists a Garden
of Eden pattern whose support is Dn . This shows the existence of a Garden
of Eden pattern of size

                            2 325 818 718 × 2 325 818 718.



Notes

According to M. Gardner (see [Gar-2, p.230]), it was J. Tuckey who intro-
duced the term “Garden of Eden” in the theory of cellular automata. The
ﬁrst contribution to the Garden of Eden theorem goes back to E.F. Moore
[Moo] who proved that every surjective cellular automaton with ﬁnite alpha-
bet over Z2 is pre-injective. The converse implication was established shortly
after by J. Myhill [Myh]. This is the reason why the Garden of Eden theo-
rem for Z2 is often referred to as the Moore-Myhill theorem. The next step
in the proof of the Garden of Eden theorem was done by A. Machı̀ and
F. Mignosi [MaM] who extended it to ﬁnitely generated groups of subexpo-
nential growth (see Chap. 6 for the deﬁnition of ﬁnitely generated groups of
subexponential growth). Then, the Garden of Eden theorem was proved for
Exercises                                                                  139

all ﬁnitely generated amenable groups by A. Machı̀, F. Scarabotti and the
ﬁrst author [CMS1]. The general case may be reduced to the case of ﬁnitely
generated groups by considering the restriction of the cellular automaton to
the subgroup generated by a memory set and applying Proposition 1.7.4(ii)
and Proposition 5.2.2 (see [CeC8]). The proof based on Følner nets which is
presented in this chapter is more direct.
   The term “pre-injective” was introduced by M. Gromov in the appendix
of [Gro5].
   It follows from a result due to D.S. Ornstein and B. Weiss (see [OrW],
[Gro6], [Kri]) that the lim sup appearing in the deﬁnition of entropy (Deﬁni-
tion 5.7.1) is in fact a true limit and is independent of the particular choice
of the right Følner net F in the group.
   Versions of the Garden of Eden theorem for cellular automata over certain
classes of subshifts (closed invariant subsets of the full shift) may be found
in the appendix of [Gro5] and in two papers of F. Fiorenzi [Fio1], [Fio2]. See
also [CFS].
   The ﬁrst examples of pre-injective (resp. surjective) cellular automata
which are not surjective (resp. not pre-injective) where described by D.E.
Muller (unpublished class notes). The underlying group was the modu-
lar group G = P SL(2, Z) = (Z/2Z) ∗ (Z/3Z) (note that G contains the free
group F2 ).
   Theorem 5.12.1 is due to L. Bartholdi [Bar].
   The computation in Sect. 5.13 is taken from [BCG, Page 828]. The size
of the corresponding Garden of Eden pattern is far from being optimal. The
ﬁrst explicit example of a Garden of Eden pattern for the cellular automaton
associated with Conway’s Game of Life was found by R. Banks in 1971.
Banks’ pattern is supported by a rectangle of size 33 × 9 and has 226 alive
cells. The smallest known Garden of Eden pattern for Life, found by N.
Beluchenko on September 2009, has as support a square 11 × 11 and bears
69 alive cells. It was proved that there exist no Garden of Eden patterns for
Life with support contained in a rectangle of size 6 × 5.



Exercises

5.1. Let G be a group and let A be a ﬁnite set. Let τ : AG → AG be a cellular
automaton admitting a memory set M ⊂ G such that |M | = 1. Show that
the following conditions are equivalent:
   (i) τ is pre-injective;
   (ii) τ is injective;
   (iii) τ is surjective.
5.2. Let G be a group and let A be a ﬁnite set. Let τ : AG → AG be a non-
surjective cellular automaton. Show that there are uncountably many Garden
of Eden conﬁgurations in AG .
140                                               5 The Garden of Eden Theorem

5.3. Life on Z. Let A = {0, 1} and consider the cellular automaton τ : AZ →
AZ with memory set S = {−1, 0, 1} and local deﬁning map μ : AS → A given
by                                   
                                1 if     s∈S y(s) = 2
                      μ(y) =
                                0 otherwise

for all y ∈ AS .
   (a) Show that τ is not pre-injective.
   (b) Deduce from (a) that τ is not surjective either. Hint: Use Theorem 4.6.1
and the Garden of Eden Theorem (cf. Exemple 5.3.2(c)).
   (c) It follows from Proposition 5.1.1 that τ admits a Garden of Eden
pattern. Check that the map p : {0, 1, 2, 3, 4, 5, 6, 7, 8} → A deﬁned by p(0) =
p(1) = p(3) = p(5) = p(8) = 1 and p(2) = p(4) = p(6) = p(7) = 0 is a Garden
of Eden pattern for τ .

5.4. Let G = Z, A = {0, 1} and let τ : AG → AG be the majority action
cellular automaton (cf. Example 1.4.3(c)). We have seen in Example 5.2.1(c)
that τ is not pre-injective so that, by amenability of the group G (cf. The-
orem 4.6.1) and the Garden of Eden Thoerem, τ is not surjective either (cf.
Exemple 5.3.2(c)). It follows from Proposition 5.1.1 that τ admits a Gar-
den of Eden pattern. Check that the map p : {1, 2, 3, 4, 5} → A deﬁned by
p(1) = p(3) = p(4) = 0 and p(2) = p(5) = 1 is a Garden of Eden pattern
for τ .

5.5. Let (A, +) be an abelian group (not necessarily ﬁnite). Let τ : AZ → AZ
be the cellular automaton deﬁned by τ (x)(n) = x(n − 1) + x(n) + x(n + 1)
for all x ∈ AZ and n ∈ Z. Show that τ is surjective. Hint: Given an arbitrary
conﬁguration y ∈ AZ , construct a conﬁguration x ∈ AZ such that x(0) =
x(1) = 0A and τ (x) = y.

5.6. Take G = Z and A = Z/2Z = {0, 1}. Let x1 ∈ AG be the conﬁguration
deﬁned by x1 (n) = 1 for all n ∈ Z. Let x2 ∈ AG be the conﬁguration deﬁned
by x2 (0) = 1 and x2 (n) = 0 for all n ∈ Z \ {0}. Let f : AG → AG be the map
deﬁned by f (x2 ) = x1 and f (x) = x for all x ∈ AG \ {x2 }. Let g : AG → AG
be the map deﬁned by g(x)(n) = x(n + 1) + x(n) for all n ∈ Z and x ∈ AG .
Verify that the maps f and g are both pre-injective but that the map g ◦ f
is not pre-injective.

5.7. Let G be group and let A be a set. Suppose that σ : AG → AG and
τ : AG → AG are pre-injective cellular automata. Show that the cellular
automaton τ ◦ σ is pre-injective.

5.8. Let G be a locally ﬁnite group and let A be a set. Show that every
pre-injective cellular automaton τ : AG → AG is injective.

5.9. Give a direct proof of the Garden of Eden theorem (Theorem 5.3.1) in
the case when the group G is locally ﬁnite.
Exercises                                                                      141

5.10. Life in a tree. Let G = F4 denote the free group based on four genera-
tors a, b, c, d. Let A = {0, 1}. Consider the cellular automaton τ : AG → AG
with memory set

                     S = {1G , a, b, c, d, a−1 , b−1 , c−1 , d−1 }

and local deﬁning map μ : AS → A given by
                  ⎧       ⎧
                  ⎪
                  ⎪       ⎪
                          ⎨ s∈S y(s) = 3
                  ⎪
                  ⎨1 if      or
           μ(y) =         ⎪
                          ⎩
                  ⎪
                  ⎪            s∈S y(s) = 4 and y((0, 0)) = 1,
                  ⎪
                  ⎩
                    0 otherwise

for all y ∈ AS (cf. Example 1.4.3(a)). Show that τ is surjective but not
pre-injective.
5.11. Let G be a group. Let E, F and Ω be subsets of G.
   (a) Show that (Ω −E )−F = Ω −F E and (Ω +E )+F = Ω +F E .
   (b) Let G = Z, E = {−2, −1, 0, 1, 2}, F = {−1, 0, 1} and Ω = {−10, −9, . . . ,
−1, 0, 1, . . . , 9, 10}. Check that ∂F (∂E (Ω)) = {−13, −12, −9, −8, 8, 9, 12, 13}
and ∂F E (Ω) = {−13, −12, −11, −10, −9, −8, 8, 9, 10, 11, 12, 13}. Deduce that,
in general, one has ∂F (∂E (Ω)) = ∂EF (Ω).
5.12. Let G be a group and let E ⊂ G. Determine the sets ∂E (∅) and ∂E (G).
5.13. Let G be a group. Let E and Ω be subsets of G. Show that ∂E (G\Ω) =
∂E (Ω).
5.14. Let G be a group. Let E, Ω1 and Ω2 be subsets of G. Show that
∂E (Ω1 ∪ Ω2 ) ⊂ ∂E (Ω1 ) ∪ ∂E (Ω2 ). Give an example showing that one may
have ∂E (Ω1 ∪ Ω2 ) = ∂E (Ω1 ) ∪ ∂E (Ω2 ).
5.15. Let G be a group. Let E, Ω1 and Ω2 be subsets of G. Show that
∂E (Ω1 \ Ω2 ) ⊂ ∂E (Ω1 ) ∪ ∂E (Ω2 ). Give an example showing that one may
have ∂E (Ω1 \ Ω2 ) = ∂E (Ω1 ) ∪ ∂E (Ω2 ).
5.16. Let G be a group. Let E and Ω be subsets of G. Show that Ω −gE =
Ω −E g −1 , Ω +gE = Ω +E g −1 , and ∂gE (Ω) = ∂E (Ω)g −1 for all g ∈ G.
5.17. Let G be a group. Show that a subset R ⊂ G is syndetic (cf. Exer-
cise 3.39) if and only if there exists a ﬁnite subset S ⊂ G such that the set
Ω = R−1 satisﬁes Ω +S = G.
5.18. Let G be a group. Let E and Ω be subsets of G. Show that Ω ⊂
     −1
(Ω +E )−E .
5.19. Let G be a group and let A be a set. Let τ : AG → AG be a cellular
automaton with memory set M . Let Ω be a subset of G. Show that if two
                                           −1
conﬁgurations x1 , x2 ∈ AG coincide on Ω +M then the conﬁgurations τ (x1 )
and τ (x2 ) coincide on Ω.
142                                                  5 The Garden of Eden Theorem

5.20. Let (A, +) be a ﬁnite abelian group and let ϕ : A × A → A be a map.
Let τ : AZ → AZ be the map deﬁned by τ (x)(n) = x(n)+ϕ(x(n+1), x(n+2))
for all n ∈ Z and x ∈ AZ .
   (a) Show that τ is a cellular automaton over the group Z and the alpha-
bet A.
   (b) Show that τ is pre-injective.
   (c) Show that τ is surjective.
5.21. Let G = Z and A = {0, 1}. Verify that, among the 16 cellular automata
τ : AZ → AZ with memory set S = {0, 1} ⊂ Z, there are exactly 6 of them
which are surjective, 4 of them which are injective, 4 of them which are
bijective, and 10 of them which are neither surjective nor injective. Hint: The
Garden of Eden Theorem may help.
5.22. Topological entropy. Let G be an amenable group and let F = (Fj )j∈J
be a right Følner net for G. If X is a compact topological space equipped with
a continuous action of G, the topological entropy hF (X, G), 0 ≤ hF (X, G) ≤
∞, of X is deﬁned as follows. Suppose that U = (Ui )i∈I is an open cover
of X. We denote by N (U) the smallest integer    n ≥ 0 such that there is a
ﬁnite subset I0 ⊂ I of cardinality n such that i∈I0 Ui = X (note that there
exists such a ﬁnite subset I0 ⊂ I by compactness of X). Given a nonempty
subset F ⊂ G, we deﬁne the open cover UF = (Wα )α∈I F indexed by the set
I F = {α : F → I} by setting
                                        
                                Wα =      gUα(g)
                                      g∈F


for all α ∈ I F . Finally, we set

                                             log N (UFj )
                          hF (U) = lim sup
                                      j          |Fj |

and
                             hF (X, G) = sup hF (U),
                                            U

where U ranges over all open covers of X.
   Observe that it is clear from this deﬁnition that if X and Y are two
compact topological spaces, each equipped with a continuous action of G,
such that there exists a G-equivariant homeomorphism f : X → Y , then one
has hF (X, G) = hF (Y, G).
   (a) Let X be a compact space and let U = (Ui )i∈I and V = (Vk )k∈K be
two open covers of X. One says that the open cover V is ﬁner than U if, for
each k ∈ K, there exists i ∈ I such that Vk ⊂ Ui . Show that if the open cover
V is ﬁner than the open cover U then one has N (U) ≤ N (V).
   (b) Let X be a compact space and let U = (Ui )i∈I be an open cover of X
which forms a partition of X (i.e., such that Ui1 ∩ Ui2 = ∅ for all i1 , i2 ∈ I
with i1 = i2 ). Show that N (U) = |{i ∈ I : Ui = ∅}|.
Exercises                                                                  143

  (c) Let A be a ﬁnite set and let X ⊂ AG be a subshift. Show that if X is
equipped with the action of G induced by the G-shift on AG , then one has

                            hF (X, G) = entF (X).

Hint: Consider the open cover T = (Ta )a∈A of X deﬁned by Ta = {x ∈ X :
x(1G ) = a} and deduce from (b) that N (TFj ) = |πFj (X)|, where πFj : AG →
AFj denotes the projection map. This gives hF (X, G) ≥ hF (T ) = entF (X).
To prove hF (X, G) ≤ entF (X), observe that if U = (Ui )i∈I is an arbitrary
open cover of X, then there exists a ﬁnite subset Ω ⊂ G such that the open
cover TΩ is ﬁner than U. Apply (a) to get N (UFj ) ≤ |πFj Ω (X)| and ﬁnally
use the fact that F is a right Følner net to conclude.
   Note: It can be shown by using a result due to Ornstein and Weiss (cf.
the notes above) that the topological entropy hF (X, G) of a compact space
X equipped with a continuous action of an amenable group G is in fact
independent of the choice of the right Følner net F.
5.23. Let G be an amenable group and let F = (Fj )j∈J be a right Følner
net for G. Let A and B be ﬁnite sets. Suppose that X ⊂ AG and Y ⊂ B G
are two subshifts such that there exists a bijective continuous G-equivariant
map ϕ : X → Y . Show that entF (X) = entF (Y ). Hint: Use Exercise 5.22.
5.24. Let G be an amenable group, F a right Følner net for G, and A a ﬁnite
set. Let X be a subset of AG and let X denote the closure of X in AG for
the prodiscrete topology. Show that one has entF (X) = entF (X).
5.25. Let G be an amenable group and let (Fj )j∈J be a right Følner net for
G. Let A be a ﬁnite set. Suppose that X (resp. Y ) is a subset of AG having
at least two distinct elements. Show that entF (X ∪ Y ) ≤ entF (X) + entF (Y ).
5.26. Let G be an amenable group, A a ﬁnite set, F be a right Følner net
for G, and X ⊂ AG a subshift. Let F be a nonempty ﬁnite subset of G and
consider the subshift X [F ] ⊂ B G , where B = AF (cf. Exercise 1.34). Show
that entF (X [F ] ) = entF (X).
5.27. Let G be a group, A be a set and X ⊂ AG a subshift. Let also H ⊂ G
be a subgroup of G and T ⊂ G a complete set of representatives for the right
cosets of H in G, and consider the subshift X (H,T ) ⊂ B H , where B = AH\G
(cf. Exercise 1.35). Suppose that G and H are isomorphic and denote by
φ : G → H an isomorphism. Let F = (Fj )j∈J be a right Følner net in G so
that F  = (φ(Fj ))j∈J is a right Følner net in G. Show that entF (X (H,T ) ) =
entF  (X).
5.28. Let G = Z and A = {0, 1}. Set Fn = {0, 1, . . . , n − 1} and recall
from Example 4.7.4(b) that F = (Fn )n∈N is a Følner sequence in Z. Show
that if X ⊂ AZ is either the even subshift considered in Exercise 1.38 or
the golden mean
             √
                subshift considered in Exercise 1.39 then entF (X) = log ϕ,
           1+ 5
where ϕ = 2 is the golden number.
144                                                  5 The Garden of Eden Theorem

5.29. Entropy of the Morse subshift. Let A = {0, 1} and let x ∈ AN and
X ⊂ AZ denote the Thue-Morse sequence (cf. Exercises 3.41) and the Morse
subshift (cf. Exercise 3.42) respectively.
   (a) Show that |Ln (X)| ≤ 8n for all n ≥ 1. Hint: Let n ≥ 1 and denote
by k the unique integer such that 2k−1 ≤ n < 2k . Consider the words u =
x(0)x(1) · · · x(2k − 1) and v = ι(u) (cf. Exercise 3.41(e)). Observe that any
word w ∈ Ln (X) is necessarily a subword of one of the words uv, vv, vu, or
uu. Altogether, this gives at most 4 · 2k = 8 · 2k−1 ≤ 8n distinct possibilities
for w.
   (b) Let F = (Fn )n≥1 denote the Følner sequence of Z where Fn =
{0, 1, . . . , n − 1}. Deduce from (a) that entF (X) = 0.

5.30. Let A = {0, 1, 2} and set Y = {y ∈ AZ : y(g) ∈ {1, 2} for all g ∈ Z}
and X = Y ∪ {x0 }, where x0 ∈ AZ denotes the constant conﬁguration deﬁned
by x0 (g) = 0 for all g ∈ Z.
   (a) Show that X and Y are subshifts of ﬁnite type of AZ and that one has
the strict inclusion Y  X.
   (b) Show that X is not irreducible.
   (c) Check that X and Y have the same entropy entF (X) = entF (Y ) =
log 2 with respect to the Følner sequence F = (Fn )n∈N of Z given by Fn =
{0, 1, . . . , n − 1}.

5.31. Let G be an amenable group, A a ﬁnite set, X ⊂ AG a strongly irre-
ducible subshift, and Y ⊂ AG a nonempty subshift such that Y  X. Let
also F = (Fj )j∈J be a right Følner net in G. For a subset Ω ⊂ G we denote
by πΩ : AG → AΩ the projection (restriction) map.
   (a) Show that there exists a ﬁnite subset Ω0 ⊂ G such that πΩ0 (Y ) 
πΩ0 (X).
   (b) Let Δ ⊂ G be a ﬁnite subset such that 1G ∈ Δ and X is Δ-irreducible.
Let E = Ω0+Δ and set ξ = |πE (X)|−1 and E  = EE −1 = {ab−1 : a, b ∈ E}.
By virtue of Proposition 5.6.3 we can ﬁnd an (E, E  )-tiling T ⊂ G. For j ∈ J
set Tj = {g ∈ T : gE ⊂ Fj }. Show that ξ|πFj (X)| ≤ |πFj \gE (X)| for all
g ∈ Tj .
   (c) Let p ∈ πΩ0 (X) \ πΩ0 (Y ) (cf. (a)) and let x ∈ X such that x|Ω0 = p.
For g ∈ G set pg = (gx)|gΩ0 ∈ AgΩ0 . Show that pg ∈ πgΩ0 (X) \ πgΩ0 (Y ).
                                           F
   (d) For j ∈ J and g ∈ Tj denote by πgΩj 0 : πFj (X) → πgΩ0 (X) the projec-
tion (restriction) map and let pg ∈ πgΩ0 (X) \ πgΩ0 (Y ) (cf. (c)). Using (b) and
the Δ-irreducibility of X show that |πFj (X)\(πgΩj 0 )−1 (pg )| ≤ (1−ξ)|πFj (X)|
                                                  F

for all j ∈ J and g ∈ Tj .
   (e) For j ∈ J denote by πFj (X)∗ the set of patterns p ∈ πFj (X) such
that πgΩj 0 (p) = pg for all g ∈ Tj . Observe that πFj (X)∗ = πFj (X) \
        F
         Fj −1
  g∈Tj (πgΩ0 )   (pg ) and using the Δ-irreducibility of X and an inductive ar-
gument based on (d), show that

                       |πFj (X)∗ | ≤ (1 − ξ)|Tj | |πFj (X)|.
Exercises                                                                     145

   (f) Observe that πFj (Y ) ⊂ πFj (X)∗ and deduce from (e) that log |πFj (Y )| ≤
|Tj | log(1 − ξ) + log |πFj (X)|.
   (g) By Proposition 5.6.4 there exists a real number α > 0 and an element
j0 ∈ J such that |Tj | ≥ α|Fj | for all j ≥ j0 . Deduce from (f) that entF (Y ) ≤
α log(1 − ξ) + entF (X).
   (h) Deduce from (g) that entF (Y ) < entF (X).

5.32. Let G be an amenable group and let A be a ﬁnite set. Let F = (Fj )j∈J
be a right Følner net in G. Let X ⊂ AG be a nonempty strongly irreducible
subshift. Show that if X is not minimal then one has entF (X) > 0. Hint:
Show that, with the notation introduced in Exercise 5.31, one has entF (X) ≥
α log 2.

5.33. Let G be a group and let A be a ﬁnite set. Let Δ be a ﬁnite subset
of G and let X ⊂ AG be a Δ-irreducible subshift. Suppose that (Ωi )i∈I is a
(possibly inﬁnite) family of (possibly inﬁnite) subsets of G such that
                         ⎛            ⎞
                              !
                  Ωi+Δ ∩ ⎝         Ωk ⎠ = ∅ for all i ∈ I.
                            k∈I\{i}


Let also (xi )i∈I be a family of conﬁgurations in X.
   Denote by Pf (G) the set of all ﬁnite subsets of G. For each Λ ∈ Pf (G) let
X(Λ) ⊂ X denote the set consisting of all conﬁgurations in X which coincide
with xi on Λ ∩ Ωi for all i ∈ I.
   (a) Show that X(Λ) is closed in X for each Λ ∈ Pf (G).
   (b) Show that if we ﬁx Λ ∈ Pf (G), then the subsets Ψi = Λ ∩ Ωi are all
contained in Λ and satisfy
                          ⎛            ⎞
                               !
                   Ψi+Δ ∩ ⎝         Ψk ⎠ = ∅ for all i ∈ I.
                             k∈I\{i}


   (c) Fix Λ ∈ Pf (G) and set IΛ = {i ∈ I : Λ ∩ Ωi = ∅}. Show that IΛ
is ﬁnite. Then, applying induction on the cardinality of IΛ , show that, by
Δ-irreducibility of X, one has X(Λ) = ∅.
   (d) Show that X(Λ1 ) ∩ X(Λ2 ) ∩ · · · ∩ X(Λn ) = X(Λ1 ∪ Λ2 ∪ · · · ∪ Λn ) and
deduce that X(Λ1 )∩X(Λ2 )∩· · ·∩X(Λn ) = ∅ for all Λ1 , Λ2 , . . . , Λn ∈ Pf (G).
   (e) Deduce from (d) that the family (X(Λ))Λ∈Pf (G) has a nonempty in-
tersection.
   (f) Let x ∈ X be such that x ∈ X(Λ) for each ﬁnite subset Λ ⊂ G (whose
existence is guaranteed by (e)). Show that x coincides with xi on Ωi for all
i ∈ I.

5.34. Let G be an amenable group and let A be a ﬁnite set. Let F = (Fj )j∈J
be a right Følner net in G. Let X ⊂ AG be a (possibly minimal) strongly
irreducible subshift containing at least two distinct conﬁgurations x0 and x1 .
146                                                 5 The Garden of Eden Theorem

   (a) Show that there exists a ﬁnite subset D ⊂ G such that (gx0 )|gD =
(gx1 )|gD for all g ∈ G.
   (b) Let Δ be a ﬁnite subset of G such that X is Δ-irreducible and 1G ∈ Δ.
Set E = D+Δ . By Proposition 5.6.3 there exists an (E, E  )-tiling T ⊂ G for
some ﬁnite subset E  ⊂ G. Consider the subset Z ⊂ X consisting of all the
conﬁgurations z ∈ X such that, for all g ∈ T , one has either z|gD = (gx0 )|gD
or z|gD = (gx1 )|gD . Applying Exercise 5.33 to the family (gD)g∈T show that,
given any map ι : T → {0, 1}, there exists a conﬁguration x ∈ X such that
x|gD = (gxι(g) )|gD for all g ∈ T .
   (c) Deduce that |ZF j | ≥ 2|Tj | for all j ∈ J, where, Tj = {g ∈ T : gE ⊂ Fj }.
   (d) By Proposition 5.6.4 there exists a real number α > 0 and an element
j0 ∈ J such that |Tj | ≥ α|Fj | for all j ≥ j0 . Deduce from (c) that entF (Z) ≥
α log 2.
   (e) Deduce that entF (X) > 0.

5.35. Let G be a group and let A be a ﬁnite set. Let X ⊂ AG be a strongly
irreducible subshift. Suppose that Δ is a ﬁnite subset of G such that X is
Δ-irreducible. Show that if Ω1 and Ω2 are (possibly inﬁnite) subsets of G
such that Ω1+Δ ∩ Ω2 = ∅, then, given any two conﬁgurations x1 and x2 in X,
there exists a conﬁguration x ∈ X which coincides with x1 on Ω1 and with
x2 on Ω2 . Hint: For each ﬁnite subset Ω ⊂ G, consider the subset X(Ω) ⊂ X
consisting of all conﬁgurations in X which coincide with x1 on Ω ∩ Ω1 and
with x2 on Ω ∩ Ω2 . Observe that the family formed by the sets X(Ω), where
Ω runs over all ﬁnite subsets of G is a family of closed subsets of X having
the ﬁnite intersection property and use the compactness of X.

5.36. (cf. Lemma 5.8.3) Let G be an amenable group, F = (Fj )j∈J a right
Følner net for G, and A a ﬁnite set. Let τ : X → Y be a cellular automa-
ton, where X, Y ⊂ AG are subshifts such that X is strongly irreducible and
entF (Y ) < entF (X).
   (a) Let S ⊂ G be a memory set for τ . Up to enlarging the subset S if
necessary, we can also suppose that 1G ∈ S and that X is S-irreducible.
Deduce from the hypothesis entF (Y ) < entF (X) that there exists j0 ∈ J
such that |πF +S2 (Y )| < |πFj0 (X)|.
              j0

   (b) Fix an arbitrary conﬁguration x0 ∈ X and consider the ﬁnite subset
Z ⊂ X consisting of all conﬁgurations z ∈ X which coincide with x0 on G \
Fj+S
  0
     . Show that πFj0 (Z) = πFj0 (X). Hint: Use the result of Exercise 5.35(a)
by taking Ω1 = Fj0 and Ω2 = G \ Fj+S 0
                                       .
                                                                                  2
   (c) Use Proposition 5.4.3 to show that τ (z) coincide with τ (x0 ) on G\Fj+S
                                                                             0
for all z ∈ Z.
   (d) Deduce from (c) that |τ (Z)| = |πF +S2 (τ (Z))|.
                                           j0
   (e) Using the fact that τ (Z) ⊂ Y , deduce from (c), (a) and (b) that there
exist conﬁgurations z1 = z2 in Z such that τ (z1 ) = τ (z2 ).
   (f) Deduce from (e) that τ is not pre-injective.
Exercises                                                                    147

5.37. Let G be an amenable group, F = (Fj )j∈J a right Følner net for G,
and A a ﬁnite set. Let X, Y ⊂ AG be two strongly irreducible subshifts such
that entF (X) = entF (Y ). Show that every pre-injective cellular automaton
τ : X → Y is surjective. Hint: Use the results of Exercise 5.31 and Exer-
cise 5.36.

5.38. Let G be an amenable group and let A be a ﬁnite set. Let X ⊂ AG
be a strongly irreducible subshift. Show that every pre-injective cellular au-
tomaton τ : X → X is surjective. Hint: Use Exercise 5.37 with Y = X.

5.39. Let G be an amenable group and let A be a ﬁnite set. Show that every
strongly irreducible subshift X ⊂ AG is surjunctive. Hint: This immediately
follows from Exercise 5.38.

5.40. (cf. Lemma 5.8.4) Let G be an amenable group, F = (Fj )j∈J a right
Følner net for G, and A a ﬁnite set. Let X ⊂ AG be a strongly irreducible
subshift of ﬁnite type and let τ : X → AG be a cellular automaton which is
not pre-injective. Let x1 , x2 ∈ X such that τ (x1 ) = τ (x2 ) and Ω = {g ∈ G :
x1 (g) = x2 (g)} is a nonempty ﬁnite subset of G. Let S be a memory set for
both τ and X. Up to enlarging the subset S if necessary, we can also suppose
                                                               −1
that 1G ∈ S and that X is S-irreducible. Set E = Ω +(S S) = {ωs−1 s :
ω ∈ Ω, s, s ∈ S} and E  = EE −1 = {ab−1 : a, b, ∈ E}. By Proposition 5.6.3
there exists an (E, E  )-tiling T ⊂ G. Let Z ⊂ X be the set consisting of all
conﬁgurations z in X such that z|tE = (tx1 )|tE for all t ∈ T .
   (a) Using the S-irreducibility of X, show that entF (Z) < entF (X). Hint:
Use the arguments in Exercise 5.31.
   (b) From (a) and Proposition 5.7.3 deduce that entF (τ (Z)) ≤ entF (X).
   (c) Using the fact that S is a memory set for X, show that for every x ∈ X
the conﬁguration z deﬁned by
            
              tx2 (g) if there is t ∈ T such that g ∈ tE and x|tE = tx1 |tE ,
    z(g) =
              x(g)      otherwise.

satisﬁes z ∈ Z and τ (z) = τ (x) (cf. the end of the proof of Lemma 5.8.4).
   (d) Deduce from (c) that τ (Z) = τ (X).
   (e) Deduce from (b) and (d) that entF (τ (X)) < entF (X).

5.41. Let G be an amenable group, F = (Fj )j∈J a right Følner net for G,
and A a ﬁnite set. Let X, Y ⊂ AG be two subshifts such that X is strongly
irreducible of ﬁnite type and entF (X) = entF (Y ). Show that every surjec-
tive cellular automaton τ : X → Y is pre-injective. Hint: Use the result of
Exercise 5.40.

5.42. The Garden of Eden theorem for strongly irreducible subshifts of ﬁnite
type. (cf. [Fio2, Theorem 4.7]). Let G be an amenable group, A a ﬁnite set,
X ⊂ AG a strongly irreducible subshift of ﬁnite type, and τ : X → X a
cellular automaton. Show that τ is pre-injective if and only if it is surjective.
148                                               5 The Garden of Eden Theorem

Hint: Combine together the results from Exercise 5.41 with Y = X and
Exercise 5.38.

5.43. Let G be a group. Let F be a nontrivial ﬁnite abelian group and set
A = F × F . Suppose that G contains an element h0 ∈ G of inﬁnite order (e.g.
G = Z). Denote by H ⊂ G the inﬁnite cyclic subgroup generated by h0 . For
each x ∈ AG , let x1 , x2 : G → F be the maps deﬁned by x(g) = (x1 (g), x2 (g))
for all g ∈ G. Consider the subset X ⊂ AG consisting of all conﬁgurations
x ∈ AG which satisfy x2 (gh0 ) = x2 (g) for any g ∈ G. In other words, X is
formed by all the conﬁgurations x ∈ AG such that x2 is constant on each left
coset of H in G.
   (a) Show that X is a subshift of ﬁnite type.
   (b) Consider the map τ : X → X deﬁned by τ (x) = (x1 + x2 , 0) for all
x = (x1 , x2 ) ∈ X (here 0 denotes the zero conﬁguration, i.e., the constant
conﬁguration whose value at each element of G is equal to the identity element
of F ). Show that τ is a cellular automaton.
   (c) Show that the cellular automaton τ deﬁned in (b) is pre-injective but
not surjective.
   (d) Show that if H is of inﬁnite index in G (this is the case, for example,
when G = Z2 ) then the subshift X is irreducible.

5.44. Let G be a group and let A be a set. Let H be a subgroup of G.
Suppose that σ : AH → AH is a cellular automaton and let σ G : AG → AG
be the induced cellular automaton (cf. Sect. 1.7). Let X ⊂ AH be a subshift
and denote by X (G) ⊂ AG the associated subshift deﬁned in Exercise 1.33.
Suppose that σ(X) ⊂ X. Show that the cellular automaton σ G |X (G) : X (G) →
X (G) is pre-injective if and only if the cellular automaton σ|X : X → X is
pre-injective.

5.45. Let A = {0, 1}. Let x0 , x1 ∈ AZ denote the two constant conﬁgurations
deﬁned by x0 (n) = 0 and x1 (n) = 1 for all n ∈ Z.
   (a) Show that X = {x0 , x1 } is a subshift of ﬁnite type.
   (b) Show that the map τ : X → X given by τ (x0 ) = τ (x1 ) = x0 is a
cellular automaton which is pre-injective but neither surjective nor injective.

5.46. Let A = {0, 1}, G = Z2 , and H = Z × {0} ⊂ G. Consider the subset
X = Fix(H) ⊂ AG consisting of all the conﬁgurations x ∈ AG which are
ﬁxed by each element of H.
   (a) Show that X is an irreducible subshift of ﬁnite type of AG .
   (b) Consider the map τ : X → X deﬁned by τ (x)(g) = 0 for all x ∈ X and
g ∈ G. Show that τ is a cellular automaton which is pre-injective but neither
surjective nor injective.

5.47. ([Fio1, Counterexample 4.27]) Let A = {0, 1, 2} and let X ⊂ AZ be the
subshift of ﬁnite type with deﬁning set of forbidden words {01, 02}.
   (a) Show that X is not irreducible.
Exercises                                                                 149

   (b) Consider the cellular automaton σ : AZ → AZ with memory set S =
{0, 1} and local deﬁning map
                                
                                 y(0) if y(1) = 0
                         μ(y) =
                                 0      otherwise.

Show that σ(X) ⊂ X.
   (c) Show that the cellular automaton σ|X : X → X is surjective but not
pre-injective.

5.48. Let A, X ⊂ AZ and σ : AZ → AZ as in Exercise 5.47. Let H = Z×{0} ⊂
Z2 and let X(Z2 ) be the associated irreducible subshift of ﬁnite type in AZ
                                                                            2



deﬁned as in Exercise 1.33 and let σ Z : AZ → AZ be the induced cellular
                                       2    2        2


                                                  Z2            2         2
automaton. Show that the cellular automaton σ |X (Z2 ) : X (Z ) → X (Z ) is
surjective but not pre-injective.

5.49. ([Fio1, Section 3]) Let A = {0, 1} and let X ⊂ AZ be the even subshift
(cf. Exercise 1.38). Let also σ : AZ → AZ be the cellular automaton with
memory set S = {0, 1, 2, 3, 4} and local deﬁning map μ : AS → A given by
         
          1 if y(0)y(1)y(2) ∈ {000, 111} or y(0)y(1)y(2)y(3)y(4) = 00100
 μ(y) =
          0 otherwise.

   (a) Show that σ(X) ⊂ X.
   (b) Set τ = σ|X : X → X. Show that τ is surjective.
   (c) Show that τ is not pre-injective. Hint: Show that the conﬁgurations

                       x1 = · · · 0000(100100)0000 · · ·

and
                       x2 = · · · 0000(011100)0000 · · ·
satisfy
                 τ (x1 ) = τ (x2 ) = · · · 1111(100100)1111 · · ·
Chapter 6
Finitely Generated Amenable Groups




This chapter is devoted to the growth and amenability of ﬁnitely generated
groups. The choice of a ﬁnite symmetric generating subset for a ﬁnitely gen-
erated group deﬁnes a word metric on the group and a labelled graph, which
is called a Cayley graph. The associated growth function counts the number
of group elements in a ball of radius n with respect to the word metric. We
deﬁne a notion of equivalence for such growth functions and observe that the
growth functions associated with diﬀerent ﬁnite symmetric generating sub-
sets are in the same equivalence class (Corollary 6.4.5). This equivalence class
is called the growth type of the group. The notions of polynomial, subexpo-
nential and exponential growth are introduced in Sect. 6.5. In Sect. 6.7 we
give an example of a ﬁnitely generated metabelian group with exponential
growth. We prove that ﬁnitely generated nilpotent groups have polynomial
growth (Theorem 6.8.1). In Sect. 6.9 we consider the Grigorchuk group. It is
shown that it is an inﬁnite periodic (Theorem 6.9.8), residually ﬁnite (Corol-
lary 6.9.5) ﬁnitely generated group of intermediate growth (Theorem 6.9.17).
In the subsequent section, we show that every ﬁnitely generated group of
subexponential growth is amenable (Theorem 6.11.2). In Sect. 6.12 we prove
the Kesten-Day characterization of amenability (Theorem 6.12.9) which as-
serts that a group with a ﬁnite (not necessarily symmetric) generating subset
is amenable if and only if 0 is in the 2 -spectrum of the associated Laplacian.
Finally, in Sect. 6.13 we consider the notion of quasi-isometry for not nec-
essarily countable groups and we show that amenability is a quasi-isometry
invariant (Theorem 6.13.23).



6.1 The Word Metric

Let G be a group.
   One says that a subset S ⊂ G generates G, or that S is a generating subset
of G, if every element g ∈ G can be expressed as a product of elements in

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,      151
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 6, © Springer-Verlag Berlin Heidelberg 2010
152                                                  6 Finitely Generated Amenable Groups

S ∪ S −1 , that is, for each g ∈ G there exist n ≥ 0, s1 , s2 , . . . , sn ∈ S and
ε1 , ε2 , . . . , εn ∈ {1, −1} such that

                                   g = sε11 sε22 · · · sεnn .                          (6.1)

   A subset S ⊂ G is called symmetric if S = S −1 , that is, s−1 ∈ S whenever
s ∈ S. Observe that if S ⊂ G is a generating subset of G, then S ∪ S −1 is a
symmetric generating subset of G.
   Recall that G is said to be ﬁnitely generated if it admits a ﬁnite generating
subset. If S ⊂ G is a ﬁnite generating subset of G, then S ∪ S −1 is a ﬁnite
symmetric generating subset of G. Thus any ﬁnitely generated group admits
a ﬁnite symmetric generating subset.
   Let G be a ﬁnitely generated group and let S be a ﬁnite symmetric gen-
erating subset of G.
   The S-word-length S (g) = G   S (g) of an element g ∈ G is the minimal
integer n ≥ 0 such that g can be expressed as a product of n elements in S,
that is,

            S (g) = min{n ≥ 0 : g = s1 s2 · · · sn , si ∈ S, 1 ≤ i ≤ n}.              (6.2)

   It immediately follows from the deﬁnition that for g ∈ G one has

                            S (g) = 0 if an only if g = 1G .                          (6.3)

Proposition 6.1.1. One has

                                    S (g −1 ) = S (g)                                (6.4)

and
                                S (gh) ≤ S (g) + S (h)                              (6.5)
for all g, h ∈ G.

Proof. Let g, h ∈ G. Set m = S (g) and n = S (h). Then there exist
s1 , s2 , . . . , sm and t1 , t2 , . . . , tn in S such that g = s1 s2 · · · sm and h =
                                                     −1 −1
t1 t2 · · · tn . We have g −1 = s−1         m · · · s2 s1  so that S (g −1 ) ≤ m = S (g).
                                                −1
Exchanging the roles of g and g                      we get S (g) ≤ S (g −1 ) and therefore
      −1
S (g ) = S (g).
    On the other hand, we have gh = s1 s2 · · · sm t1 t2 · · · tn so that S (gh) ≤
m + n = S (g) + S (h).

                          S : G × G → N deﬁned by
   Consider the map dS = dG

                                  dS (g, h) = S (g −1 h)                              (6.6)

for all g, h ∈ G.

Proposition 6.1.2. The map dS is a metric on G.
6.2 Labeled Graphs                                                                       153

Proof. Let g, h, k ∈ G. It follows from (6.3) that dS (g, h) = 0 if and only
if g = h. Moreover, from (6.4) we deduce that dS (g, h) = dS (h, g). Finally,
using (6.5) we get

                    dS (g, k) + dS (k, h) = S (g −1 k) + S (k −1 h)
                                           ≥ S ((g −1 k)(k −1 h))
                                           = S (g −1 h)
                                           = dS (g, h).


  The metric dS is called the word metric on G associated with the ﬁnite
symmetric generating subset S.
Proposition 6.1.3. The metric dS is invariant by left multiplication, that
is,
                       dS (gg1 , gg2 ) = dS (g1 , g2 )
for all g, g1 , g2 ∈ G.
Proof. We have

 dS (gg1 , gg2 ) = S ((gg1 )−1 gg2 ) = S (g1−1 g −1 gg2 ) = S (g1−1 g2 ) = dS (g1 , g2 ).



We may rephrase the previous result by saying that the action of G on itself
by left multiplication is an isometric action with respect to the word metric.
  For g ∈ G and n ∈ N, we denote by

                          BSG (g, n) = {h ∈ G : dS (g, h) ≤ n}

the ball of radius n in G centered at the element g ∈ G. When g = 1G we
have BSG (1G , n) = {h ∈ G : S (h) ≤ n} and we simply write BSG (n) instead
of BSG (1G , n). Also, when there is no ambiguity on the group G, we omit the
supscript “G” and we simply write BS (g, n) and BS (n) instead of BSG (g, n)
and BSG (n).



6.2 Labeled Graphs

Let S be a set. An S-labeled graph is a pair Q = (Q, E), where Q is a set,
called the set of vertices, and E is a subset of Q×S ×Q, called the set of edges.
The projection map λ : E → S, deﬁned by λ(e) = s for all e = (q, s, q  ) ∈ E,
is called the labelling map. Also consider the projection maps α, ω : E → Q
deﬁned by α(e) = q and ω(e) = q  for all e = (q, s, q  ) ∈ E. Then, α(e) and
ω(e) are called the initial and terminal vertices of the edge e ∈ E.
154                                                        6 Finitely Generated Amenable Groups

    Let Q1 = (Q1 , E1 ) and Q2 = (Q2 , E2 ) be two S-labeled graphs. An S-
labeled graph homomorphism from Q1 to Q2 is a map φ : Q1 → Q2 such that
(φ(q), s, φ(q  )) ∈ E2 for all (q, s, q  ) ∈ E1 . An S-labeled graph homomorphism
φ : Q1 → Q2 which is bijective and such that the inverse map φ−1 : Q2 →
Q1 is also an S-labeled graph homomorphism is called a S-labeled graph
isomorphism. If such an S-labeled graph isomorphism exists one says that
the S-labeled graphs Q1 and Q2 are isomorphic.
    An S-labeled graph Q = (Q, E) is said to be ﬁnite if the sets Q and E are
both ﬁnite.
    Let Q = (Q, E) be an S-labeled graph.
    An S-labeled subgraph of Q is an S-labeled graph Q = (Q , E  ) such that
Q ⊂ Q and E  ⊂ E.
    Let Q ⊂ Q and set E  = E ∩ (Q × S × Q ). Then the S-labeled graph
Q = (Q , E  ) is called the S-labeled subgraph of Q induced on Q . Sometimes,
  

by abuse of language, we shall simply denote by Q the S-labeled graph
Q = (Q , E  ).
    If there exist vertices q, q  ∈ Q and labels s1 = s2 in S such that
(q, s1 , q  ), (q, s2 , q  ) ∈ E, in other words, if there exist two edges with the
same initial and terminal vertices but with diﬀerent labels, then one says
that Q has multiple edges.
    An edge of the form (q, s, q), q ∈ Q, s ∈ S, is called a loop at q.
    A path in Q is a ﬁnite sequence of edges π = (e1 , e2 , . . . , en ), e1 , e2 , . . . , en ∈
E, such that ω(ei ) = α(ei+1 ) for all i = 1, . . . , n − 1. The integer n is called
the length of the path π and it is denoted by (π). The vertices π − = α(e1 )
and π + = ω(en ) are called the initial and terminal vertices of π and one says
that π connects π − to π + . The label of a path π = (e1 , e2 , . . . , en ) is deﬁned
by λ(π) = (λ(e1 ), λ(e2 ), . . . , λ(en )) ∈ S n . For q ∈ Q, we also admit the empty
path starting and ending at q. It has length 0 and its label is the empty
word . Let π1 = (e1 , e2 , . . . , en ) and π2 = (e1 , e2 , . . . , em ) be two paths with
π1+ = π2− . Then the path

                         π1 π2 = (e1 , e2 , . . . , en , e1 , e2 , . . . , em )

is called the composition of the paths π1 and π2 . Note that (π1 π2 ) = (π1 ) +
(π2 ) and that λ(π1 π2 ) = λ(π1 )λ(π2 ).
    Let q, q  ∈ Q. If there is no path connecting q to q  we set dQ (q, q  ) = ∞,
otherwise, we set

               dQ (q, q  ) = min{(π) : π a path connecting q to q  }.                  (6.7)

A path π connecting q to q  with minimal length, that is, such that (π) =
dQ (q, q  ), is called a geodesic path from q to q  .
Proposition 6.2.1. Let Q = (Q, E) be a labeled graph. Then, for all q, q  , q  ∈
Q one has:
6.2 Labeled Graphs                                                                        155

  (i) dQ (q, q  ) ∈ N ∪ {∞};
 (ii) dQ (q, q  ) = 0 if and only if q = q  ;
(iii) dQ (q, q  ) < ∞ if and only if there exists a path which connects q to q  ;
(iv) dQ (q, q  ) ≤ dQ (q, q  ) + dQ (q  , q  ) (triangular inequality).

Proof. The statements (i), (ii), and (iii) are trivial. Let us prove (iv). If
dQ (q, q  ) = ∞ or dQ (q  , q  ) = ∞ there is nothing to prove. Otherwise, let π1
be a geodesic path connecting q to q  and π2 a geodesic path connecting q 
to q  . Then π1 π2 connects q to q  and therefore

         dQ (q, q  ) ≤ (π1 π2 ) = (π1 ) + (π2 ) = dQ (q, q  ) + dQ (q  , q  ).



Note that, in general, for q, q  ∈ Q one has dQ (q, q  ) = dQ (q  , q). For q ∈ Q
and r ∈ N we denote by B(q, r) = {q  ∈ Q : dQ (q, q  ) ≤ r} the ball of radius
r centered at q.
   The labeled graph Q is said to be connected if given any two vertices q, q  ∈
Q there exists a path which connects q to q  . Equivalently, Q is connected if
and only if dQ (q, q  ) < ∞ for all q, q  ∈ Q.
   A path π in Q such that π − = π + is said to be closed.
   The valence (or degree) δ(q) of a vertex q ∈ Q is the cardinality of the set
{e ∈ E : α(e) = q}. If δ(q) < ∞ for all q ∈ Q, one says that Q is locally ﬁnite.
If all vertices have the same ﬁnite valence k then one says that Q is regular
of degree k.
   Suppose that S is equipped with an involution s → s. Then the labeled
graph Q is said to be edge-symmetric if for all e = (q, s, q  ) ∈ E one has that
the inverse edge e−1 = (q  , s, q) also belongs to E.
   If Q is edge-symmetric and (q, s, q  ) ∈ E one says that the vertices q and q 
are neighbors. Suppose that Q is edge-symmetric. If π = (e1 , e2 , . . . , en ) is a
path in Q connecting a vertex q to a vertex q  , then π −1 = (en −1 , en−1 −1 , . . . ,
e2 −1 , e1 −1 ) is a path in Q connecting q  to q. The path π −1 is called the
inverse of π. Note that (π −1 ) = (π).
Corollary 6.2.2. Suppose that Q is edge-symmetric and connected. Then the
map dQ : Q × Q → N deﬁned in (6.7) is a metric on the set Q of vertices
of Q.

Proof. This follows immediately from Proposition 6.2.1 and the fact that
dQ (q, q  ) = dQ (q  , q) for all q, q  ∈ Q. The latter immediately follows from
the fact that the map π → π −1 yields a length-preserving bijection from the
set of paths connecting q to q  onto the set of paths connecting q  to q.

The metric dQ is called the graph metric on Q.
  Let π = (e1 , e2 , . . . , en ) be a path in Q. We associate with π the sequence
πQ = (q0 , q1 , . . . , qn ) ∈ Qn+1 deﬁned by qi = α(ei+1 ) for all i = 0, 1, . . . , n
and qn = ω(en ). The vertices q0 , q1 , . . . , qn are called the vertices visited by π.
156                                                6 Finitely Generated Amenable Groups

One says that π is simple if qi = qj for all 0 ≤ i = j ≤ n. If π is closed,
one says that π is a closed simple path if qi = qj for all 0 ≤ i, j ≤ n such
that (i, j) = (0, n). One says that π is proper, or with no back–tracking, if
ei+1 = e−1
         i   for i = 1, 2, . . . , n − 1.
   An edge-symmetric, connected labeled graph with no loops, no multiple
edges and with no closed proper paths is called a tree.



6.3 Cayley Graphs

Let G be a ﬁnitely generated group and S a ﬁnite symmetric generating
subset of G. The Cayley graph of G with respect to S is the S-labeled graph
CS (G) = (Q, E) whose vertices are the group elements, that is, Q = G and
the edge set is E = {(g, s, gs) : g ∈ G and s ∈ S}.




Fig. 6.1 An edge in the Cayley graph CS (G) is a triple (g, s, h), where g ∈ G, s ∈ S, and
h = gs


   Note that, as S is symmetric, the inverse map s → s−1 is an involu-
tion on S. Since we have (h, s−1 , g) ∈ E for all (g, s, h) ∈ E, it follows
that the Cayley graph CS (G) is edge-symmetric with respect to the inverse
map on S. Moreover, the Cayley graph is connected. For, given g, h ∈ G, as
S generates G, we can ﬁnd a nonnegative integer n and s1 , s2 , . . . , sn ∈ S
such that g −1 h = s1 s2 · · · sn . Then the path π = (e1 , e2 , . . . , en ), where
ei = (gs1 s2 · · · si−1 , si , gs1 s2 · · · si−1 si ), i = 1, 2, . . . , n, connects g to h =
gs1 s2 · · · sn . Also observe that if 1G ∈ S then CS (G) has a loop at each ver-
tex and that, on the contrary, CS (G) has no loops if 1G ∈                   / S. On the other
hand, CS (G) has no multiple edges, that is, for all g, h ∈ G, there exists at
most one s ∈ S such that (g, s, h) ∈ E, namely s = g −1 h if g −1 h ∈ S.
Proposition 6.3.1. Let G be a ﬁnitely generated group. Let S ⊂ G be a
ﬁnite symmetric generating subset. Then, the S-distance of two group ele-
ments equals the graph distance of the same elements viewed as vertices in
the associated Cayley graph CS (G). In other words,

                                 dS (g, h) = dCS (G) (g, h)                             (6.8)

for all g, h ∈ G.
Proof. Let g, h ∈ G and suppose that π = (e1 , e2 , . . . , en ) is a geodesic path
connecting g and h. Let λ(π) = (s1 , s2 , . . . , sn ) be the label of π. It then
follows that dS (g, h) = S (g −1 h) = S (s1 s2 · · · sn ) ≤ n = (π) = dCS (G) (g, h).
6.3 Cayley Graphs                                                                       157

Conversely, suppose that dS (g, h) = m. Then we can ﬁnd s1 , s2 , . . . , sm ∈ S
such that g −1 h = s1 s2 · · · sm . Then the unique path π  = (e1 , e2 , . . . , em )
with (π  )− = g and label λ(π  ) = s1 s2 · · · sm clearly satisﬁes (π  )+ = h, that
is, it connects g to h. We deduce that dCS (G) (g, h) ≤ (π  ) = m = dS (g, h).
Then (6.8) follows.
   Note that, in particular, two distinct elements g and h in G are neighbors
in the graph CS (G) if and only if dS (g, h) = 1. For all g ∈ G, the map
s → gs is a bijection from S onto the set gS of all neighbors of g in CS (G).
In particular, all vertices g in CS (G) have the same degree δ(g) = |S|.
   Summarizing, we have that a Cayley graph is a connected, edge-symmetric
and regular labeled graph.
Examples 6.3.2. We graphically represent Cayley graphs by connecting two
neighboring vertices by a single directed labeled arc e (see Fig. 6.1). Thus
one should think of the inverse edge e−1 as the oppositely directed arc with
label λ(e)−1 .

  (a) Let G = Z and take S = {1, −1} as a ﬁnite symmetric generating
subset of G. Then the Cayley graph CS (Z) is represented in Fig. 6.2.




Fig. 6.2 The Cayley graph of G = Z for S = {1, −1}



   (b) Let G = Z and take S = {1, 0, −1} as a ﬁnite symmetric generating
subset of G. Then the Cayley graph CS (Z) is represented in Fig. 6.3. Note
that as 0 = 1Z ∈ S, we have a loop at each vertex in CS (Z).




Fig. 6.3 The Cayley graph of G = Z for S = {1, 0, −1}



   (c) Let G = Z and S = {2, −2, 3, −3}. Then, the corresponding Cayley
graph CS (Z) is represented in Fig. 6.4.
   (d) Let G = Z×(Z/2Z), where Z/2Z = {0, 1} and take S = {(1, 0), (−1, 0),
(0, 1)}. Then the Cayley graph CS (G) is represented by the bi-inﬁnite ladder
as in Fig. 6.5.
   (e) Let G = D∞ be the inﬁnite dihedral group, that is, the group of
isometries of the real line R generated by the reﬂections r : R → R and
158                                              6 Finitely Generated Amenable Groups




Fig. 6.4 The Cayley graph of G = Z for S = {2, −2, 3, −3}




Fig. 6.5 The Cayley graph of G = Z × (Z/2Z) for S = {(1, 0), (−1, 0), (0, 1)}



s : R → R deﬁned by

                r(x) = −x          (symmetry with respect to 0)
                s(x) = 1 − x       (symmetry with respect to 1/2)

for all x ∈ R. Note that r2 = s2 = 1G . Taking S = {r, s}, the Cayley graph
CS (G) is as in Fig. 6.6.




Fig. 6.6 The Cayley graph of G = D∞ for S = {r, s}



   (f) Let G be the inﬁnite dihedral group, as in the previous example. Denote
by t : R → R the map deﬁned by t(x) = x + 1 for all x ∈ R (translation).
Then we have t = sr and hence s = tr. It follows that the set S = {r, t, t−1 } is
also a symmetric generating subset of G and the corresponding Cayley graph
CS (G) is as in Fig. 6.7.
   (g) Let G = Z2 and take S = {(1, 0), (−1, 0), (0, 1), (0, −1)} as a ﬁnite and
symmetric generating subset of G. Then, the corresponding Cayley graph
CS (Z2 ) is given in Fig. 6.8.
   (h) Let G = Z2 and take
6.3 Cayley Graphs                                                                    159




Fig. 6.7 The Cayley graph of G = D∞ for S = {r, t, t−1 }




Fig. 6.8 The Cayley graph of G = Z2 for S = {(1, 0), (−1, 0), (0, 1), (0, −1)}




      S = {(1, 0), (−1, 0), (0, 1), (0, −1), (1, 1), (−1, 1), (1, −1), (−1, −1)}.

Then, the corresponding Cayley graph CS (Z2 ) is as in Fig. 6.9.
   (i) Let G = FX be the free group based on a nonempty ﬁnite set X and
take S = X ∪X −1 . Then, the Cayley graph CS (FX ) is a regular tree of degree
|S| = 2|X| (see Fig. 6.10). Indeed, since 1FX ∈         / S, the Cayley graph CS (FX )
does not have loops. Moreover, if π is a nontrivial proper path in CS (FX )
with label λ(π) = (s1 , s2 , . . . , sn ) ∈ S ∗ , then, the word w = s1 s2 · · · sn ∈ S ∗
is nonempty and, by deﬁnition of properness, it is reduced. Therefore 1FX
and h = s1 s2 · · · sn ∈ FX are distinct and we have π + = π − h = π − , that is,
π is not closed. This shows that CS (FX ) is a tree.
160                                                 6 Finitely Generated Amenable Groups




Fig. 6.9 The Cayley graph of G = Z2 for S = {(1, 0), (−1, 0), (0, 1), (0, −1), (1, 1), (−1, 1),
(1, −1), (−1, −1)}




6.4 Growth Functions and Growth Types

Let G be a ﬁnitely generated group and S ⊂ G a ﬁnite and symmetric
generating subset of G. The growth function of G relative to S is the function
γSG : N → N deﬁned by

                      γSG (n) = |BSG (n)| = |{g ∈ G : S (g) ≤ n}|                       (6.9)

for all n ∈ N. When there is no ambiguity we omit the supscript “G” and
simply denote it by γS .
   Note that γS (0) = |BS (0)| = |{1G }| = 1 and that γS (n) ≤ γS (n + 1) for
all n ∈ N. Also, as the map (s1 , s2 , . . . , sn ) → s1 s2 · · · sn is a surjection from
(S ∪ {1G })n to BS (n), one has

                                  γS (n) ≤ |S ∪ {1G }|n                                (6.10)

for all n ∈ N.

Proposition 6.4.1. Let G be a ﬁnitely generated group and let S and S  be
two ﬁnite symmetric generating subsets of G. Let c = max{S  (s) : s ∈ S}.
6.4 Growth Functions and Growth Types                                             161




Fig. 6.10 The Cayley graph of G = F2 for S = {a, a−1 , b, b−1 }




Then the following holds.
  (i) S  (g) ≤ cS (g) for all g ∈ G;
 (ii) dS  (g, h) ≤ cdS (g, h) for all g, h ∈ G;
(iii) BS (n) ⊂ BS  (cn) for all n ∈ N;
(iv) γS (n) ≤ γS  (cn) for all n ∈ N.

Proof. (i) Let g ∈ G. Suppose that S (g) = n. Then there exist s1 , s2 , . . . , sn ∈
S such that g = s1 s2 · · · sn . Using (6.5) we get
                                                         n
                   S  (g) = S  (s1 s2 · · · sn ) ≤         S  (si ) ≤ cn.
                                                         i=1

(ii) By applying (i) we have, for all g, h ∈ G,

                 dS  (g, h) = S  (g −1 h) ≤ cS (g −1 h) = cdS (g, h).
162                                                6 Finitely Generated Amenable Groups

Finally, from (ii), we have that dS  (g, 1G ) ≤ cn if dS (g, 1G ) ≤ n for all g ∈ G.
This gives (iii). Thus

                       γS (n) = |BS (n)| ≤ |BS  (cn)| = γS  (cn)

for all n ∈ N.

   Two metrics d and d on a set X are said to be Lipschitz-equivalent if there
exist constants c1 , c2 > 0 such that

                            c1 d(x, y) ≤ d (x, y) ≤ c2 d(x, y)

for all x, y ∈ X.

Corollary 6.4.2. Let G be a ﬁnitely generated group and let S and S  be two
ﬁnite symmetric generating subsets of G. Then, the word metrics dS and dS 
are Lipschitz-equivalent.

   A non-decreasing function γ : N → [0, +∞) is called a growth function. Let
γ, γ  : N → [0, +∞) be two growth functions. One says that γ  dominates γ,
and one writes γ  γ  , if there exists an integer c ≥ 1 such that

                             γ(n) ≤ cγ  (cn) for all n ≥ 1.

One says that γ and γ  are equivalent and one writes γ ∼ γ  if γ  γ  and
γ   γ.

Proposition 6.4.3. We have the following:
  (i)  is reﬂexive and transitive;
 (ii) ∼ is an equivalence relation;
(iii) let γ1 , γ2 , γ1 , γ2 : N → [0, +∞) be growth functions. Suppose that γ1 ∼
      γ1 , γ2 ∼ γ2 and that γ1  γ2 . Then γ1  γ2 .

Proof. It is clear that  is reﬂexive. Let γ1 , γ2 , γ3 : N → [0, +∞) be growth
functions. Suppose that γ1  γ2 and that γ2  γ3 . Let c1 and c2 be positive
integers such that γ1 (n) ≤ c1 γ2 (c1 n) and γ2 (n) ≤ c2 γ3 (c2 n) for all n ≥ 1.
Then, taking c = c1 c2 one has

                    γ1 (n) ≤ c1 γ2 (c1 n) ≤ c1 c2 γ3 (c2 c1 n) = cγ3 (cn)

for all n ≥ 1. Thus  is also transitive. This shows (i).
    Property (ii) immediately follows from (i) and the deﬁnition of ∼.
    Finally, suppose that γ1 , γ2 , γ1 , γ2 satisfy the hypotheses of (iii). Then we
have in particular, γ1  γ1 , γ1  γ2 and γ2  γ2 . From (i) we deduce that
γ1  γ2 .

  Let γ : N → [0, +∞) be a growth function. We denote by [γ] the ∼-
equivalence class of γ. By abuse of notation, we shall also write [γ] ∼ γ(n).
6.4 Growth Functions and Growth Types                                        163

If γ1 and γ2 are two growth functions, we write [γ1 ]  [γ2 ] if γ1  γ2 . This
deﬁnition makes sense by virtue of Proposition 6.4.3(iii). Note that, this way,
 becomes a partial ordering on the set of equivalence classes of growth
functions.

Examples 6.4.4. (a) Let α and β be nonnegative real numbers. Then nα  nβ
if and only if α ≤ β, and nα ∼ nβ if and only if α = β.
    (b) Let γ : N → [0, +∞) be a growth function. Suppose that γ is a poly-
nomial of degree d for some d ≥ 0. Then one has γ(n) ∼ nd .
    (c) Let a, b ∈ (1, +∞). Then

                                    an ∼ b n .                            (6.11)

Indeed, suppose for instance that a ≤ b. On the one hand we have an ≤ bn for
all n ≥ 1, so that trivially an  bn . On the other, setting c = [loga b] + 1 > 1
(here [ · ] denotes the integer part), one has

                   bn = (aloga b )n = a(loga b)n ≤ acn ≤ cacn

for all n ≥ 1, so that bn  an . We deduce that an ∼ bn . In particular, we
have an ∼ exp(n) for all a ∈ (1, +∞).
   (d) Let d ≥ 0 be an integer. Then nd  exp(n) and nd ∼ exp(n). As a
consequence if γ : N → [0, +∞) is a growth function such that γ(n)  nd ,
                                                             nd
then γ  exp(n) and γ ∼ exp(n). Indeed, since limn→∞ exp(n)      = 0, the
              d
             n
sequence ( exp(n) )n≥1 is bounded and we can ﬁnd an integer c ≥ 1 such that
  nd
exp(n)  ≤ c for all n ≥ 1. It follows that nd ≤ c exp(n) ≤ c exp(cn) for all
n ≥ 1 and therefore nd  exp(n).
   On the other hand, suppose by contradiction that exp(n)  nd . Then we
can ﬁnd an integer c > 0 such that exp(n) ≤ c(cn)d for all n ≥ 1. But then
exp(n)
  nd
       ≤ cd+1 for all n ≥ 1 contradicting the fact that limn→∞ exp(n)
                                                                  nd
                                                                       = +∞.
Thus n ∼ exp(n).
        d

   The remaining statements concerning the growth function γ immediately
follow from transitivity of  (cf. Proposition 6.4.3(i)) and symmetry of ∼ (cf.
Proposition 6.4.3(ii)).

  From Proposition 6.4.1(iii) and (6.10) we deduce the following:

Corollary 6.4.5. Let G be a ﬁnitely generated group and let S and S  be
two ﬁnite symmetric generating subsets of G. Then, the growth functions
associated with S and S  are equivalent, that is, γS ∼ γS  . Moreover, γS (n) 
exp(n).

   Let G be a ﬁnitely generated group. The equivalence class [γS ] of the
growth functions associated with the ﬁnite symmetric generating subsets S
of G is called the growth type of G and we denote it by γ(G).
164                                          6 Finitely Generated Amenable Groups

Proposition 6.4.6. Let γ : N → [0, +∞) be a growth function with γ(0) > 0.
Then γ ∼ 1 if and only if γ is bounded.

Proof. Suppose ﬁrst that γ is bounded. Then we can ﬁnd an integer c ≥ 1
such that γ(n) ≤ c for all n ≥ 1. It follows that γ(n) ≤ c1(n) ≤ c1(cn) for
all n ≥ 1. Thus γ  1. On the other hand, setting c = [ γ(0)
                                                           1
                                                             ] + 1, we have
1(n) = 1 ≤ cγ(0) ≤ cγ(n) ≤ cγ(cn) for all n ≥ 1 so that 1  γ. This shows
that γ ∼ 1.
   Conversely, suppose that γ ∼ 1. Then γ  1 and we can ﬁnd an integer
c ≥ 1 such that γ(n) ≤ c1(cn) = c for all n ≥ 1. This shows that γ is
bounded.

Corollary 6.4.7. Let G be a ﬁnitely generated group. Then γ(G) ∼ 1 if and
only if G is ﬁnite. As a consequence, all ﬁnite groups have the same growth
type.

Proof. Let S be a ﬁnite and symmetric generating subset of G. Suppose that
γ(G) ∼ γS (n) ∼ 1. Then, by Proposition 6.4.6 we deduce that γS is bounded,
say by an integer c ≥ 1. This shows that |G| ≤ c and therefore G is ﬁnite.
Conversely, if G is ﬁnite, we have γS (n) = |BS (n)| ≤ |G| for all n ≥ 1, that is,
γS is bounded. From Proposition 6.4.6 we deduce that γ(G) ∼ γS (n) ∼ 1.

Proposition 6.4.8. Let G be an inﬁnite ﬁnitely generated group. Then n 
γ(G).

Proof. Let S be a ﬁnite symmetric generating subset of G. Consider the
inclusions

  {1G } = BS (0) ⊂ BS (1) ⊂ BS (2) ⊂ · · · ⊂ BS (n) ⊂ BS (n + 1) ⊂ · · · (6.12)

Let us show that if BS (n) = BS (n+1) for some n ∈ N , then BS (n) = BS (m)
for all m ≥ n. We proceed by induction on m. Suppose that BS (n) = BS (m)
for some m ≥ n + 1. For all g ∈ BS (m + 1) there exist g  ∈ BS (m) and
s ∈ S such that g = g  s. By the inductive hypothesis, g  ∈ BS (m − 1) so that
g = g  s ∈ BS (m − 1)S ⊂ BS (m). Since BS (m) ⊂ BS (m + 1), it follows that
BS (m + 1) = BS (m) = BS (n).
   As a consequence, if BS (n) = BS (n + 1) for some n ∈ N, then we have
G = BS (n). Since, by our assumptions, G is inﬁnite, we deduce that all
the inclusions in (6.12) are strict. It follows that for all n ∈ N we have
n ≤ |BS (n)| = γS (n). This shows that n  γS (n) and therefore n  γ(G).

Deﬁnition 6.4.9. Let G be a ﬁnitely generated group.
   One says that G has exponential (resp. subexponential ) growth if γ(G) ∼
exp(n) (resp. γ(G) ∼ exp(n)).
   One says that G has polynomial growth if there exists an integer d ≥ 0
such that γ(G)  nd .
6.4 Growth Functions and Growth Types                                                     165

Proposition 6.4.10. Every ﬁnitely generated group of polynomial growth has
subexponential growth.

Proof. Let G be a ﬁnitely generated group. It follows from Example 6.4.4(d)
that if γ(G)  nd for some integer d ≥ 0, then γ(G) ∼ exp(n).

Examples 6.4.11. (a) Let G = Z. With S = {1, −1} one has that the ball of
radius r centered at the element g ∈ G is the interval [g − r, g + r] = {n ∈
Z : g − r ≤ n ≤ g + r}, see Fig. 6.11. We have γS (n) = 2n + 1. It follows that
γ(Z) ∼ γS (n) ∼ n. In particular, Z has polynomial growth.




Fig. 6.11 The ball BS (n, r) ⊂ Z with S = {1, −1}; here r = 2


    (b) Let G = Z2 and S = {(1, 0), (−1, 0), (0, 1), (0, −1)}. Then the ball
of radius r centered at the element g = (n, m) ∈ G is the diagonal square
with vertices (n + r, m), (n − r, m), (n, m − r), (n, m + r), see Fig. 6.12. In the
language of cellular automata, the ball BSZ (g, 1) is 
                                             2
                                                        commonly called the von
                                                          n
Neumann neighborhood of g. We have γS (n) = 1 + k=1 4k = 2n2 + 2n + 1.
It follows that γ(Z ) ∼ γS (n) ∼ n . In particular, Z has polynomial growth.
                   2                2                   2




Fig. 6.12 The ball BS (n, r) ⊂ Z2 with S = {(1, 0), (−1, 0), (0, 1), (0, −1)} and r = 2
166                                              6 Finitely Generated Amenable Groups

   (c) Let G = Z2 and

      S = {(1, 0), (−1, 0), (0, 1), (0, −1), (1, 1), (−1, 1), (1, −1), (−1, −1)}.

Then the ball of radius r centered at the element g = (n, m) ∈ G is the square
[n−r, n+r]×[m−r, m+r], see Fig. 6.13. In the language of cellular automata,
the ball BSZ (g, 1) is commonly called the Moore neighborhood of g. We have
            2



γSZ (n) = 4n2 + 4n + 1 = (2n + 1)2 = (γSZ (n))2 . Note that this yields again
   2


γ(Z2 ) ∼ γS (n) ∼ n2 and the polynomial growth of Z2 (cf. Example 6.4.11(b)
above).




Fig. 6.13 The ball BS (n, r) ⊂ Z2 with S = {±(1, 0), ±(0, 1), ±(1, 1), ±(1, −1)} and r = 2



   (d) Let G = Z × (Z/2Z) and S = {(1, 0̄), (−1, 0̄), (1, 1̄), (−1, 1̄)}. Then the
ball of radius r centered at the element (n, 0̄) is represented in Fig. 6.14. We
deduce that γS (n) = (2n + 1) + 2(n − 1) + 1 = 4n. Thus γ(Z × (Z/2Z)) ∼
γS (n) ∼ n. In particular, Z × (Z/2Z) has polynomial growth.
   (e) Let G = D∞ be the inﬁnite dihedral group and S = {r, s}. Then the
ball of radius n centered at the element g ∈ G is represented in Fig. 6.15. It
follows that γS (n) = 2n + 1. Thus γ(D∞ ) ∼ γS (n) ∼ n. In particular, D∞
has polynomial growth.
6.4 Growth Functions and Growth Types                                                    167




Fig. 6.14 The ball BS ((n, 0), r) ⊂ Z × (Z/2Z) with S = {(1, 0), (−1, 0), (0, 1)}; here r = 2




Fig. 6.15 The ball BS (g, n) ⊂ D∞ with S = {r, s}; here n = 3



   (f) Let G = D∞ be the inﬁnite dihedral group and S = {r, t, t−1 }. Then
the ball of radius r centered at the element g ∈ G is represented in Fig. 6.16.
It follows that γS (n) = (2n + 1) + 2(n − 1) + 1 = 4n. Note that this yields
again γ(D∞ ) ∼ γS (n) ∼ n and the polynomial growth of D∞ .




Fig. 6.16 The ball BS (g, n) ⊂ D∞ with S = {r, t, t−1 }; here n = 2


   (g) Let G = Fk be the free group of rank k ≥ 2. Let {a1 , a2 , . . . , ak } be a
free basis and set S = {a1 , a−1        −1                −1
                              1 , a2 , a2 , . . . , ak , ak }. Then the ball of radius
r centered at the element g ∈ G is the ﬁnite tree rooted at g of depth r (see
Fig. 6.17). We have
                                     n−1
                                                         k(2k − 1)n − 1
                 γSFk (n) = 1 + 2k         (2k − 1)j =                  .
                                     j=0
                                                             k−1

It follows that γ(Fk ) ∼ γS (n) ∼ (2k − 1)n ∼ exp(n). In particular, Fk has
exponential growth.
168                                                6 Finitely Generated Amenable Groups




Fig. 6.17 The ball BS (a, 2) ⊂ F2 with S = {a, a−1 , b, b−1 }



6.5 The Growth Rate

Lemma 6.5.1. Let (an )n≥1 be a sequence of positive real numbers such that
an+m ≤ an am for all n, m ≥ 1. Then the limit
                                              √
                                        lim   n
                                                  an
                                       n→∞
                             √
exists and equals inf n≥1    n a .
                                n

Proof. Fix an integer t ≥ 1 and, for all n ≥ 1 write n = qt+r, with 0 ≤ r < t.
                                  √         q/n √
Then an ≤ aqt ar ≤ aqt ar and n an ≤ at n ar . As 0 ≤ r/n < t/n and
limn→∞ t/n = 0, we have that limn→∞ r/n = 0 and limn→∞ q/n = 1/t. In
                    q/n 1/n       1/t    √                       √       √
particular limn→∞ at ar = at = t at . Thus, lim supn→∞ n an ≤ t at .
                        √               √                 √
This gives lim supn→∞ n an ≤ inf t≥1 t at ≤ lim inf t→∞ t at completing the
proof.
6.5 The Growth Rate                                                           169

Proposition 6.5.2. Let G be a ﬁnitely generated group and let S be a ﬁnite
symmetric generating subset of G. Then, the limit
                                      *
                           λS = lim n γS (n)                        (6.13)
                                  n→∞

exists and λS ∈ [1, +∞).

Proof. From (6.5) we deduce that BS (n + m) ⊆ BS (n)BS (m) and therefore

                      γS (n + m) = |BS (n + m)|
                                 ≤ |BS (n)BS (m)|
                                 ≤ |BS (n)| · |BS (m)|
                                 = γS (n)γS (m).

Thus, the sequence {γS (n)}n≥1 satisﬁes the hypotheses of the previous lemma
and λS exists and is ﬁnite. As γS (n) ≥ 1 for all n ∈ N we also have λS ≥ 1.

Deﬁnition 6.5.3. The number λS = λG
                                  S in (6.13) is called the growth rate
of G with respect to S.

Proposition 6.5.4. Let G be a ﬁnitely generated group and let S be a ﬁ-
nite symmetric generating subset of G. Then λS > 1 if and only if G has
exponential growth.

Proof. Suppose that γ(G) ∼ exp(n). We then have exp(n)  γS so that there
exists an integer c ≥ 1 such that en ≤ cγS (cn) for all n ≥ 1. This implies
    √           √             *          (        √ )(         *       )
1 < c e = lim cn en ≤ lim cn cγS (cn) = lim cn c · lim cn γS (cn) = λS .
         n→∞          n→∞                 n→∞            n→∞
                                                               *
Conversely, suppose that λS > 1. By Lemma 6.5.1 we have        n
                                                                   γS (n) ≥ λS so
that
                               γS (n) ≥ λnS .
This shows that exp(n) ∼ λnS  γS (n). By Corollary 6.4.5 we have γS (n) 
exp(n) and therefore γ(G) ∼ γS ∼ exp(n).

Corollary 6.5.5. Let G be a ﬁnitely generated group and let S be a ﬁnite
symmetric generating subset of G. Then λS = 1 if and only if G has subex-
ponential growth.

  As an immediate consequence of Proposition 6.5.4 and Proposition 6.4.3(ii)
we deduce the following.

Corollary 6.5.6. Let G be a ﬁnitely generated group and let S and S  be two
ﬁnite symmetric generating subsets of G. Then λS = 1 (resp. λS > 1) if and
only if λS  = 1 (resp. λS  > 1).
170                                                6 Finitely Generated Amenable Groups

6.6 Growth of Subgroups and Quotients

Proposition 6.6.1. Let G be a group and let N be a normal subgroup of G.
Suppose that N and the quotient group G/N are both ﬁnitely generated. Then
G is ﬁnitely generated.

Proof. Denote by π : G → G/N the quotient homomorphism. Let U ⊂ N
and T ⊂ G/N be two ﬁnite symmetric generating subsets of N and G/N
respectively. Let S ⊂ G be a ﬁnite symmetric set such that π(S) ⊃ T and
S ⊃ U . Let us prove that S generates G. Let g ∈ G. Then there exist h ≥ 0
and t1 , t2 , . . . , th ∈ T such that π(g) = t1 t2 · · · th . Let s1 , s2 , . . . , sh ∈ S be
such that π(si ) = ti for i = 1, 2, . . . , h. Setting g  = s1 s2 · · · sh we then have
π(g  ) = π(g). It follows that n = (g  )−1 g ∈ ker(π) = N . Therefore, there
exist k ≥ 0 and sh+1 , sh+2 , . . . , sh+k ∈ S such that n = sh+1 sh+2 · · · sh+k .
It follows that g = g  n = s1 s2 · · · sh sh+1 , sh+2 · · · sh+k . This shows that S
generates G.

Proposition 6.6.2. Let G be a group and let H be a subgroup of ﬁnite index
in G. Then, G is ﬁnitely generated if and only if H is ﬁnitely generated.

Proof. Let R ⊂ G be a complete set of representatives of the right cosets of
H in G such that 1G ∈ R. Note that |R| = [G : H] < ∞. Suppose ﬁrst that
H is ﬁnitely generated. Let S ⊂ H be a ﬁnite symmetric generating subset
of H. Given g ∈ G, there exist r ∈ R and h ∈ H such that g = hr. Let
s1 , s2 , . . . , sn ∈ S be such that h = s1 s2 · · · sn . Then g = s1 s2 · · · sn r. This
shows that the set S ∪ R is a ﬁnite generating subset of G.
    Suppose now that G is ﬁnitely generated and let S be a ﬁnite symmetric
generating subset of G. Let us show that the ﬁnite set

                                    S  = RSR−1 ∩ H                                   (6.14)

generates H. Let h ∈ H and write h = s1 s2 · · · sn where si ∈ S. Then, there
exists h1 ∈ H and r1 ∈ R such that s1 = h1 r1 . Note that h1 = 1G s1 r1−1 ∈ S  .
By induction, for all i = 2, 3, . . . , n−1 there exist hi ∈ H and ri ∈ R such that
ri−1 si = hi ri . Moreover, hi = ri−1 si ri−1 ∈ S  . Thus, setting hn = rn−1 sn we
have
               h = s1 s2 · · · sn
                 = (1G s1 r1−1 )(r1 s2 r2−1 ) · · · (rn−2 sn−1 rn−1
                                                                −1
                                                                    )(rn−1 sn )
                 = h1 h2 · · · hn−1 hn .

Note that hn = h−1              −1 −1
                     n−1 · · · h2 h1 h ∈ H and, on the other hand, hn =
rn−1 sn = rn−1 sn 1G ∈ RSR . Thus also hn ∈ S  . This shows that S  gener-
                               −1

ates H.
6.6 Growth of Subgroups and Quotients                                               171

Proposition 6.6.3. Let G be a ﬁnitely generated group and let H be a ﬁnitely
generated subgroup of G. Then γ(H)  γ(G).

Proof. Let SG (resp. SH ) be a ﬁnite symmetric generating subset of G
(resp. H). Then the set S = SH ∪ SG is a ﬁnite symmetric generating subset
of G. As SH ⊂ S we have BSHH (n) ⊂ BSG (n) and therefore γSHH (n) ≤ γSG (n)
for all n ∈ N. Thus, γ(H)  γ(G).

Corollary 6.6.4. Every ﬁnitely generated group which contains a ﬁnitely
generated subgroup of exponential growth has exponential growth.

  From Example 6.4.11(d) and Corollary 6.6.4 we deduce the following.

Corollary 6.6.5. Every ﬁnitely generated group which contains a subgroup
isomorphic to the free group F2 has exponential growth.

   In the following proposition we show that ﬁnitely generated groups and
their ﬁnite index subgroups (which are ﬁnitely generated as well, by Propo-
sition 6.6.2) have the same growth type.

Proposition 6.6.6. Let G be a ﬁnitely generated group and let H be a ﬁnite
index subgroup of G. Then H is ﬁnitely generated and γ(H) = γ(G).

Proof. Since [G : H] < ∞, we deduce from Proposition 6.6.2 that H is ﬁnitely
generated. It follows from Proposition 6.6.3 that γ(H)  γ(G).
   Let now S be a ﬁnite symmetric generating subset of G and consider the
ﬁnite symmetric set S  = RSR−1 ∩ H. It follows from the proof of Propo-
sition 6.6.2 that S  generates H. Let g ∈ BSG (n) and write g = s1 s2 · · · sn ,
where s1 , s2 , . . . , sn ∈ S. As in the proof of Proposition 6.6.2 we may ﬁnd
r0 = 1G , r1 , . . . , rn ∈ R such that

          g = s1 s2 · · · sn
            = (1G s1 r1−1 )(r1 s2 r2−1 ) · · · (rn−2 sn−1 rn−1
                                                           −1
                                                               )(rn−1 sn rn−1 )rn
            = h1 h2 · · · hn−1 hn rn

where hi = ri−1 si ri−1 ∈ S  . It follows that BSG (n) ⊂ BSH (n)R so that, taking
cardinalities,

  γSG (n) = |BSG (n)| ≤ |BSH (n)||R| = [G : H]γSH (n) ≤ [G : H]γSH ([G : H]n).

This shows that γ(G)  γ(H). It follows that γ(G) = γ(H).

   Two groups G1 and G2 are called commensurable if there exist ﬁnite index
subgroups H1 ⊂ G1 and H2 ⊂ G2 such that H1 and H2 are isomorphic. From
the previous proposition we immediately deduce:

Corollary 6.6.7. If G1 and G2 are commensurable groups and G2 is ﬁnitely
generated, then G1 is ﬁnitely generated and one has γ(G1 ) = γ(G2 ).
172                                                    6 Finitely Generated Amenable Groups

Proposition 6.6.8. Let G be a ﬁnitely generated group and let N be a normal
subgroup of G. Then the quotient group G/N is ﬁnitely generated and one
has γ(G/N )  γ(G). If in addition N is ﬁnite, then γ(G/N ) = γ(G).
Proof. Let S be a ﬁnite symmetric generating subset of G and let π : G →
G/N denote the canonical quotient homomorphism. Then S  = π(S) is a
ﬁnite symmetric generating subset of G/N . Thus, for all n ∈ N one has
                                      G/N
                                   BS      (n) = π(BSG (n))                              (6.15)

and therefore
                     G/N                  G/N
                    γS      (n) = |BS         (n)| ≤ |BSG (n)| = γSG (n).

This shows that γ(G/N )  γ(G).
  Suppose now that N is ﬁnite. From (6.15) we deduce that BSG (n) ⊂
 −1   G/N
π (BS  (n)) and therefore
                                       G/N                  G/N               G/N
      γSG (n) = |BSG (n)| ≤ |N ||BS         (n)| = |N |γS       (n) ≤ |N |γS     (|N |n).

This shows that γ(G)  γ(G/N ). It follows that γ(G) = γ(G/N ).
Lemma 6.6.9. Let γ1 , γ2 , γ1 , γ2 : N → [0, +∞) be growth functions. Suppose
that γ1  γ1 , γ2  γ2 . Then the products γ1 γ2 , γ1 γ2 : N → [0, ∞) are also
growth functions and one has γ1 γ2  γ1 γ2 .
Proof. Since the product of non-decreasing functions is also non-decreasing,
it is clear that γ1 γ2 and γ1 γ2 are also growth functions. Let c1 and c2 be
positive integers such that γ1 (n) ≤ c1 γ1 (c1 n) and γ2 (n) ≤ c2 γ2 (c2 n) for all
n ≥ 1. Taking c = c1 c2 we have

                           (γ1 γ2 )(n) = γ1 (n)γ2 (n)
                                       ≤ c1 c2 γ1 (c1 n)γ2 (c2 n)
                                       ≤ c1 c2 γ1 (c1 c2 n)γ2 (c1 c2 n)
                                        = c(γ1 γ2 )(cn)

for all n ≥ 1. This shows γ1 γ2  γ1 γ2 .
  Given two growth functions γ1 and γ2 we set [γ1 ] · [γ2 ] = [γ1 γ2 ]. This
deﬁnition makes sense since if γ1 ∼ γ1 and γ2 ∼ γ2 then γ1 γ2 ∼ γ1 γ2 as it
immediately follows from Lemma 6.6.9.
Proposition 6.6.10. Let G1 and G2 be two ﬁnitely generated groups. Then
the direct product G1 × G2 is also ﬁnitely generated and γ(G1 × G2 ) =
γ(G1 )γ(G2 ).
Proof. Let S1 and S2 be ﬁnite symmetric generating subsets of G1 and G2 .
Then the set
6.7 A Finitely Generated Metabelian Group with Exponential Growth                                    173

                              S = (S1 × {1G2 }) ∪ ({1G1 } × S2 )
is a ﬁnite symmetric generating subset of G1 × G2 . Let (g1 , g2 ) ∈ BSG1 ×G2 (n).
Then there exist s1,1 , s2,1 , . . . , sk,1 ∈ S1 and s1,2 , s2,2 , . . . , sh,2 ∈ S2 , where
h + k ≤ n, such that

(g1 , g2 ) = (s1,1 , 1G2 )(s2,1 , 1G2 ) · · · (sk,1 , 1G2 ) · (1G1 , s1,2 )(1G1 , s2,2 ) · · · (1G1 , sh,2 )
           = (s1,1 s2,1 · · · sk,1 , s1,2 s2,2 · · · sh,s ).

Thus, BSG1 ×G2 (n) ⊂ BSG11 (n) × BSG22 (n) and γSG1 ×G2 (n) ≤ γSG11 (n)γSG22 (n). This
shows that γ(G1 × G2 )  γ(G1 )γ(G2 ).
   On the other hand, if g1 ∈ BSG11 (n) and g2 ∈ BSG22 (n), then (g1 , g2 ) ∈
BSG1 ×G2 (2n) and one has γSG11 (n)γSG22 (n) ≤ γSG1 ×G2 (2n) ≤ 2γSG1 ×G2 (2n).
This shows that γ(G1 )γ(G2 )  γ(G1 × G2 ). It follows that γ(G1 × G2 ) =
γ(G1 )γ(G2 ).

  From Example 6.4.11(a) and the previous proposition one immediately
deduces the following.
Corollary 6.6.11. Let d be a positive integer. Then γ(Zd ) ∼ nd .

Corollary 6.6.12. Every ﬁnitely generated abelian group has polynomial
growth.

Proof. Let G be a ﬁnitely generated abelian group. Then there exist an in-
teger d ≥ 0 and a ﬁnite group F such that G is isomorphic to the cartesian
product Zd × F . It follows from Proposition 6.6.10, Corollary 6.6.11 and
Corollary 6.4.7 that γ(G) = γ(Zd )γ(F ) ∼ nd . This shows that G has polyno-
mial growth.



6.7 A Finitely Generated Metabelian Group
    with Exponential Growth

We have seen in Corollary 6.6.12 that every ﬁnitely generated abelian group
has polynomial growth. The purpose of the present section is to give an
example of a ﬁnitely generated metabelian group with exponential growth. As
every metabelian group is solvable and hence amenable (Theorem 4.6.3), this
will show in particular that there exist ﬁnitely generated amenable groups,
and even ﬁnitely generated solvable groups, whose growth is exponential.

Proposition 6.7.1. Let G denote the subgroup of GL2 (Q) generated by the
two matrices                              
                          20                 11
                    A=           and B =         .
                          01                 01
Then G is a ﬁnitely generated metabelian group with exponential growth.
174                                                      6 Finitely Generated Amenable Groups

Proof. The group G is ﬁnitely generated by deﬁnition. We have
                              k                     
                               2 r
                       G=           : k ∈ Z, r ∈ Z[1/2] ,                             (6.16)
                               0 1

where Z[1/2] is the subring of Q consisting of all dyadic rationals. Indeed, if
we denote by H the right-hand side of (6.16), we ﬁrst observe that G ⊂ H
since H is clearly a subgroup of GL2 (Q) containing A and B. On the other
hand, we also have the inclusion H ⊂ G since any r ∈ Z[1/2] can be written
in the form r = 2m n for some m, n ∈ Z, so that
                                      
                                2k r
                                           = Am B n Ak−m ∈ G.
                                0 1

   From (6.16), we deduce that the determinant map yields a surjective ho-
momorphism from G onto an inﬁnite cyclic group whose kernel is isomorphic
to the additive group Z[1/2] and is therefore abelian. Since any element in
[G, G] has determinant 1, this shows that [G, G] is abelian, that is, that G is
metabelian.
   It remains to show that G has exponential growth. To see this, let us
estimate from below the cardinality of the ball BS (3n − 2), where S is the
ﬁnite symmetric generating subset of G deﬁned by S = {A, B, A−1 , B −1 }
and n ≥ 1 is a ﬁxed integer. Consider the subset E ⊂ G consisting of all
matrices of the form                    
                                        1q
                               M (q) =        ,
                                        01
where q is an integer such that 0 ≤ q ≤ 2n − 1. Developing q in base 2, we
get
                                                n
                                       q=            ui 2i−1 ,
                                               i=1

where ui ∈ {0, 1} for 1 ≤ i ≤ n. This gives us
                             u  u      u      n−1 un
                           1 1 1 1 2 2 1 22 3       12
             M (q) =                           ···           .
                           01     01    0 1         0 1

As we have                                
                                 1 2i−1
                                               = Ai−1 BA−(i−1)
                                 0 1

for all 1 ≤ i ≤ n, it follows that we can write M (q) in the form

 M (q) = B u1 AB u2 A−1 A2 B u3 A−2 · · · An−2 B un−1 A−(n−2) An−1 B un A−(n−1)
       = B u1 AB u2 AB u3 A · · · AB un−1 AB un A−(n−1) .
6.8 Growth of Finitely Generated Nilpotent Groups                                          175

This shows that

                    S (M (q)) ≤ (2n − 1) + (n − 1) = 3n − 2.

We deduce that |BS (3n − 2)| ≥ |E| = 2n . It follows that the growth rate of
G with respect to S satisﬁes
                        *                          √      √
          λS = lim 3n−2 |BS (3n − 2)| ≥ lim
                                                3n−2       3
                                                     2n = 2 > 1.
                  n→∞                                   n→∞

Thus G has exponential growth.



6.8 Growth of Finitely Generated Nilpotent Groups

In this section we prove the following
Theorem 6.8.1. Every ﬁnitely generated nilpotent group has polynomial
growth.
In order to prove this result we need some preliminaries.

Lemma 6.8.2. Let G be any group. Let H and K be two normal subgroups
of G. Suppose that S ⊆ H and T ⊆ K generate H and K respectively. Then
[H, K] is equal to the normal closure in G of the set {[s, t] : s ∈ S, t ∈ T }.

Proof. Denote by N the normal closure in G of the set {[s, t] : s ∈ S, t ∈ T }
and let us show that N = [H, K]. Since {[s, t] : s ∈ S, t ∈ T } ⊂ [H, K] and
[H, K] is a normal subgroup, we have

                                         N ⊂ [H, K].                                     (6.17)

Consider the quotient homomorphism π : G → G/N . For all s ∈ S and t ∈ T
we have [π(s), π(t)] = π([s, t]) = 1G/N , that is, π(s) and π(t) commute. It
follows that all elements of π(H) commute with all elements of π(K), since
S generates H and T generates K. In other words, π([h, k]) = [π(h), π(k)] =
1G/N , for all h ∈ H and k ∈ K. This gives [h, k] ∈ N for all h ∈ H and k ∈ K
and therefore [H, K] ⊂ N . From (6.17) we deduce that [H, K] = N .

Let G be a group. Recall that the lower central series of G is the se-
quence (C i (G))i≥0 of normal subgroups of G deﬁned by C 0 (G) = G and
C i+1 (G) = [C i (G), G] for all i ≥ 0. Given elements g1 , g2 , . . . , gi ∈ G, i ≥ 3,
we inductively set

               [g1 , g2 , . . . , gi ] = [[g1 , g2 , . . . , gi−1 ], gi ] ∈ C i−1 (G).
                                                      (i)
If S ⊂ G and i ≥ 2 we then denote by SG the set consisting of all elements
of the form
176                                                    6 Finitely Generated Amenable Groups

                        [s1 , s2 , . . . , si ], s1 , s2 , . . . , si ∈ S.          (6.18)
The elements (6.18) are called simple S-commutators of weight i. Note that
 (i)
SG ⊂ C i−1 (G).
Lemma 6.8.3. Let G be any group. Let SG ⊂ G be a generating subset of G.
Then for all i ≥ 1, the subgroup C i (G) is the normal closure in G of the set
 (i+1)
SG .
Proof. Let us prove the statement by induction on i. We have that C 1 (G) =
                                         (2)
[G, G] is the normal closure in G of SG = {[s1 , s2 ] : s1 , s2 ∈ SG }, as it
follows from Lemma 6.8.2 by taking H = K = G and S = T = SG . Thus, the
statement holds for i = 1. Suppose by induction that C i−1 (G) is the normal
                  (i)                                                (i+1)
closure in G of SG , denote by N the normal closure in G of SG , and
                                      (i+1)
let us show that C i (G) = N . Since SG      ⊂ C i (G) and C i (G) is a normal
subgroup, we deduce that
                                 N ⊂ C i (G).                            (6.19)
                                                                             (i)
Denote by π : G → G/N the quotient map. Let w ∈ SG and s ∈ SG .
                               (i+1)
Then, by deﬁnition, [w, s] ∈ SG      and therefore [w, s] ∈ N . It follows that
[π(w), π(s)] = π([w, s]) = 1G/N , that is, π(w) and π(s) commute. As SG gen-
erates G, we have that π(SG ) generates G/N and therefore π(w) ∈ Z(G/N ).
It follows that π(hwh−1 ) = π(h)π(w)π(h)−1 = π(w) for all h ∈ G, so that
π([hwh−1 , s]) = [π(hwh−1 ), π(s)] = [π(w), π(s)] = 1G/N . It follows that

                                     [hwh−1 , s] ∈ N.                               (6.20)

By the inductive hypothesis, every element in C i−1 (G) can be expressed
as a product (h1 w1 h−1             −1                −1             (i)
                         1 )(h2 w2 h2 ) · · · (hm wm hm ) with wk ∈ SG and hk ∈
G, k = 1, 2, . . . , m, for some m ∈ N. By taking H = C i−1 (G), K = G,
                     (i)
S = {wh : w ∈ SG , h ∈ G} and T = SG in Lemma 6.8.2, we deduce that
C (G) = [C (G), G] is the normal closure in G of the set {[hwh−1 , s] :
  i          i−1
      (i)
w ∈ SG , h ∈ G, s ∈ SG }. Thus from (6.20) it follows that C i (G) ⊂ N . By
using (6.19) this shows that C i (G) = N .
Lemma 6.8.4. Let G be a ﬁnitely generated nilpotent group of nilpotency
degree d ≥ 1. Then the subgroups C i (G), i = 1, 2, . . . , d − 1 are ﬁnitely
generated.
Proof. Let SG ⊂ G be a ﬁnite generating subset of G. We ﬁrst show that
the quotient groups C i (G)/C i+1 (G) are ﬁnitely generated, i = 0, 1, . . . , d − 1.
From Lemma 6.8.3 we have that C i (G) is the normal closure in G of the
           (i+1)
ﬁnite set SG . Therefore, if π : G → G/C i+1 (G) denotes the quotient ho-
momorphism, we have that C i (G)/C i+1 (G) = π(C i (G)) is the normal clo-
                                     (i+1)            (i+1)
sure in G/C i+1 (G) of the set π(SG ). But π(SG ) = (π(SG ))(i+1) ⊂
                                        (i+1)
Z(C i (G)/C i+1 (G)) and therefore π(SG ) generates C i (G)/C i+1 (G).
6.8 Growth of Finitely Generated Nilpotent Groups                                177

   Let us now prove the statement by reverse induction starting from i = d−1.
It follows from the ﬁrst part of the proof that the subgroup C d−1 (G) ∼    =
C d−1 (G)/{1G } = C d−1 (G)/C d (G) is ﬁnitely generated. Suppose by induc-
tion that the subgroup C i+1 (G) is ﬁnitely generated for some i ≤ d − 2.
From the ﬁrst part of the proof we have that C i (G)/C i+1 (G) is also ﬁnitely
generated. Therefore from Proposition 6.6.1 we deduce that C i (G) is ﬁnitely
generated.

   We are now in position to prove the main result of this section.

Proof of Theorem 6.8.1. Let G be a ﬁnitely generated nilpotent group of
nilpotency degree d. Let us prove the statement by induction on d. If d = 0
then G = {1G } and therefore G has polynomial growth. Suppose now that
d ≥ 1 and that all ﬁnitely generated nilpotent groups of nilpotency degree
≤ d − 1 have polynomial growth.
    We ﬁrst observe that the subgroup H = C 1 (G) is nilpotent of nilpotency
degree ≤ d − 1. Indeed, as one immediately checks by induction, we have
C i (H) ⊂ C i+1 (G) for all i = 0, 1, . . . , d − 1, so that C d−1 (H) ⊂ C d (G) =
{1G }. Moreover, by Lemma 6.8.4, we have that H is ﬁnitely generated. Thus,
by the inductive hypothesis we have that H has polynomial growth. Let
T ⊂ H be a ﬁnite symmetric generating subset of H. Then there exist integers
c1 > 0 and q ≥ 0 such that

                                γTH (n) ≤ c1 (c1 n)q                          (6.21)

for all n ≥ 1.
     Let S = {s1 , s2 , . . . , sk } ⊂ G be a ﬁnite symmetric generating subset of
G. Let g ∈ G and suppose that m = G             S (g) ≤ n. Then there exist 1 ≤
i1 , i2 , . . . , im ≤ k such that

                                g = si1 si2 · · · sim .                       (6.22)

Since g2 g1 = g1 g2 [g2−1 , g1−1 ] and [g2−1 , g1−1 ] ∈ H for all g1 , g2 ∈ G, we can
permute the generators in (6.22) and express g in the form

                                g = sj1 sj2 · · · sjm h                       (6.23)

where 1 ≤ j1 ≤ j2 ≤ · · · ≤ jm ≤ k and h ∈ H. Let us estimate H
                                                               T (h). We set


                              T (w) : w ∈ S , 2 ≤ i ≤ d}.
                     L = max{H            (i)
                                                                              (6.24)

As we observed above, exchanging a pair of consecutive generators produces
a simple S-commutator of weight two on their right. It is clear that one
needs at most n such exchanges to bring sj1 , where j1 = ip1 = min{ip : p =
1, 2, . . . , m}, to the leftmost place. Analogously, one needs at most n such
exchanges to bring sj2 , where j2 = min{ip : p = 1, 2, . . . , m; p = p1 }, to the
leftmost but one place (in fact on the right of sj1 ). And so on. Altogether,
178                                                6 Finitely Generated Amenable Groups

there are at most mn ≤ n2 such exchanges. This produces at most n2 simple
S-commutators of weight two. But at each step, when moving a generator sjt
to the left, we also have to exchange it with all the simple S-commutators
on its left that were produced before (namely by sj1 , sj2 , . . . , sjt−1 ). As one
easily checks by induction, that this produces, altogether, at most n3 simple
S-commutators of weight three, n4 simple S-commutators of weight four, and
so on. Continuing this way, since G is nilpotent of nilpotency degree d, all
simple S-commutators of weight d+1 are equal to 1G . Thus, the total number
of simple S-commutators that are eventually produced in this process is at
most n2 + n3 + · · · + nd ≤ dnd . It follows from (6.24) that

                                      T (h) ≤ Ldn .
                                     H          d
                                                                                      (6.25)

   On the other hand, we can bound the number of elements in G which are
of the form sj1 sj2 · · · sjm , where 1 ≤ j1 ≤ j2 ≤ · · · ≤ jm ≤ k, by c2 nk , where
c2 > 0 is a constant independent of n. Indeed, each such group element can
be written in the form sn1 1 sn2 2 · · · snk k , where 0 ≤ ni ≤ n for all i = 1, 2, . . . , k.
   We deduce from (6.21) and (6.25) that

                     γSG (n) ≤ c2 nk c1 (Ldnd )q = Cnδ ≤ C(Cn)δ

for all n ≥ 1, where δ = k + qd and C = c1 c2 (Ld)q . Note that C > 0 is a
constant independent of n. It follows that G has polynomial growth.

   From Theorem 6.8.1 and Proposition 6.6.6 we deduce the following:
Corollary 6.8.5. Every ﬁnitely generated virtually nilpotent group has poly-
nomial growth.



6.9 The Grigorchuk Group and Its Growth

In this section we present the Grigorchuk group and some of its main prop-
erties, namely being inﬁnite, periodic, residually ﬁnite and of intermediate
growth.
   Let Σ = {0, 1}. We denote by Σ ∗ = ∪n∈N Σ n the set of all words on the
alphabet Σ. Recall that Σ ∗ is a monoid for the word concatenation whose
identity element is the empty word (cf. Sect. D.1). Every word w ∈ Σ ∗ may
be uniquely written in the form w = σ1 σ2 · · · σn , where σ1 , σ2 , . . . , σn ∈ Σ
and n = (w) ∈ N is the length of w.
   Denote by Sym(Σ ∗ ) the symmetric group on Σ ∗ (cf. Appendix C). We
introduce a partial order  in Σ ∗ by setting u  v, u, v ∈ Σ ∗ , if there exists
w ∈ Σ ∗ such that uw = v. We then set

Sym(Σ ∗ , ) = {g ∈ Sym(Σ ∗ ) : g(u)  g(v) for all u, v ∈ Σ ∗ such that u  v}.
                                                                          (6.26)
6.9 The Grigorchuk Group and Its Growth                                     179

Note that Sym(Σ ∗ , ) is a subgroup of Sym(Σ ∗ ). Moreover, for w ∈ Σ ∗ the
length (w) equals the maximum of n ∈ N such that there exists a sequence
(wk )0≤k≤n of distinct words in Σ ∗ such that = w0  w1  · · ·  wn = w.
It follows that if g ∈ Sym(Σ ∗ , ) then (g(w)) = (w) for all w ∈ Σ ∗ .
   Consider the elements a, b, c, d ∈ Sym(Σ ∗ ) deﬁned as follows. We ﬁrst
deﬁne a by setting
                                    a( ) =                                (6.27)
and
                         a(0w) = 1w,       a(1w) = 0w                    (6.28)
for all w ∈ Σ ∗ . Then, for all w ∈ Σ ∗ , we deﬁne b(w), c(w), d(w) by induction
on (w). We start by setting

                            b( ) = c( ) = d( ) = .                       (6.29)
Then we set
                       b(0w) = 0a(w), b(1w) = 1c(w),
                       c(0w) = 0a(w), c(1w) = 1d(w),                     (6.30)
                       d(0w) = 0w,    d(1w) = 1b(w)
for all w ∈ Σ ∗ . By an obvious induction we have

                            a, b, c, d ∈ Sym(Σ ∗ , ).                   (6.31)

Example 6.9.1. Let w = 10110 ∈ Σ ∗ . Then we have

              a(w) = a(10110) = 00110,
              b(w) = b(10110) = 1c(0110) = 10a(110) = 10010,
              c(w) = c(10110) = 1d(0110) = 10110,
              d(w) = d(10110) = 1b(0110) = 10a(110) = 10010.

Deﬁnition 6.9.2. The Grigorchuk group is the subgroup G of Sym(Σ ∗ ) gen-
erated by the elements a, b, c, d.

  Observe that by (6.31) we have

                               G ⊂ Sym(Σ ∗ , ).                         (6.32)

Proposition 6.9.3. The following relations hold in G.

                           a2 = b 2 = c 2 = d 2 = 1G                     (6.33)

and
                    bc = cb = d, dc = cd = b, db = bd = c.               (6.34)

Proof. To prove (6.33), we have to show that

                                   g 2 (w) = w                           (6.35)
180                                            6 Finitely Generated Amenable Groups

for all w ∈ Σ ∗ and g ∈ {a, b, c, d}. We have a(ε) = ε by (6.27). Moreover
from (6.28) we have

            a2 (0w) = a(1w) = 0w       and a2 (1w) = a(0w) = 1w,            (6.36)

for all w ∈ Σ ∗ . This shows that a2 = 1G . To prove (6.35) for g = b, c and
d, we use induction on (w). By virtue of (6.29) this holds when (w) = 0.
Suppose that (6.35) holds when (w) = n. From (6.30) and the fact that
a2 = 1G we deduce, for all w ∈ Σ ∗ with (w) = n,

  b2 (0w) = b(0a(w)) = 0a2 (w) = 0w,        b2 (1w) = b(1c(w)) = 1c2 (w) = 1w,
  c2 (0w) = c(0a(w)) = 0a2 (w) = 0w,        c2 (1w) = c(1d(w)) = 1d2 (w) = 1w,
  d2 (0w) = d(0w) = 0w,                     d2 (1w) = d(1b(w)) = 1b2 (w) = 1w.

This shows that (6.35) holds for all w ∈ Σ ∗ with (w) = n + 1. This proves
(6.35) for g = b, c, d and (6.33) follows.
   To prove (6.34), we have to show that

                                 ij(w) = k(w)                               (6.37)

for all w ∈ Σ ∗ and all distinct i, j, k ∈ {b, c, d}. Again, we can use induction
on (w). If (w) = 0 then (6.37) follows from (6.29). Suppose by induction
that (6.37) holds when (w) = n. From (6.28),(6.30) and (6.33) we deduce,
for all w ∈ Σ ∗ with (w) = n,

                bc(0w) = b(0a(w)) = 0a2 (w) = 0w = d(0w),
                bc(1w) = b(1d(w)) = 1cd(w) = 1b(w) = d(1w),
                cd(0w) = c(0w) = 0a(w) = b(0w),
                cd(1w) = c(1b(w)) = 1db(w) = 1c(w) = b(1w),
                db(0w) = d(0a(w)) = 0a(w) = c(0w),
                db(1w) = d(1c(w)) = 1bc(w) = 1d(w) = c(1w).

It follows that (6.37) holds for all w ∈ Σ ∗ with (w) = n + 1 whenever
(i, j, k) = (b, c, d), (c, d, b), (d, b, c). Thus, by induction bc = d, cd = b and
db = c. Finally, using (6.33) we deduce cb = cd2 b = (cd)(db) = bc, dc =
db2 c = (db)(bc) = cd and bd = bc2 d = (bc)(cd) = db. This completes the
proof of (6.34).

   It follows from (6.33) that the set S = {a, b, c, d} is a symmetric gener-
ating subset of G. We denote by S : G → N the corresponding word-length
function. Every group element g ∈ G can be expressed in the form

                                 g = s1 s2 · · · sn                         (6.38)
6.9 The Grigorchuk Group and Its Growth                                       181

with s1 , s2 , . . . , sn ∈ S. We say that the expression (6.38) is a reduced form
of g provided that for all i, j = 1, 2, . . . , n − 1 one has that if si = a then
si+1 ∈ {b, c, d}, and if sj ∈ {b, c, d} then sj+1 = a. It immediately follows
from (6.33) and (6.34) that every group element g ∈ G can be expressed (not
necessarily in a unique way) as in (6.38) in reduced form.
   For all n ∈ N we set

                  Hn = {g ∈ G : g(w) = w for all w ∈ Σ n }.                (6.39)

Proposition 6.9.4. For all n ∈ N, the set Hn is a normal subgroup of G
and
                             [G : Hn ] < ∞.                      (6.40)
Moreover,

               G = H0 ⊃ H1 ⊃ H2 ⊃ · · · ⊃ Hn ⊃ Hn+1 ⊃ · · · .              (6.41)

Proof. Since g(Σ n ) ⊂ Σ n for all g ∈ G (cf. (6.32)) we may consider the
(restriction) map θn : G → Sym(Σ n ) deﬁned by θn (g)(w) = g(w) for all
g ∈ G and w ∈ Σ n . Clearly, θn is a homomorphism and ker(θn ) = Hn . This
shows that Hn is a normal subgroup and that [G : Hn ] = |G/Hn | = |θn (G)| ≤
| Sym(Σ n )| < ∞.
    Finally, let n ∈ N, u ∈ Σ n and g ∈ Hn+1 . Let σ ∈ Σ and set w = uσ ∈
Σ  n+1
       so that u  w. From (6.32) we deduce that g(u)  g(w) = uσ and
therefore g(u) = u. This shows that g ∈ Hn . Thus Hn ⊃ Hn+1 and (6.41)
follows.

Corollary 6.9.5. The Grigorchuk group G is residually ﬁnite.

Proof. Let h ∈ ∩n∈N Hn . We have h(w) = w for all w ∈ Σ ∗ and therefore
h = 1G . This shows that ∩n∈N Hn = {1G }. As [G : Hn ] < ∞ for all n ∈ N we
deduce from Proposition 2.1.11 that G is residually ﬁnite.

Proposition 6.9.6. We have:
  (i) the subgroup H1 consists of all group elements g ∈ G which can be ex-
      pressed in the form (6.38) (not necessarily reduced) with an even number
      of occurrences of the generator a;
 (ii) [G : H1 ] = 2;
(iii) the group H1 is generated by the elements b, c, d, aba, aca, ada;
(iv) the group H1 equals the normal closure in G of the elements b, c and d.

Proof. It follows from (6.28) and (6.30) that a generator s ∈ S satisﬁes
s(σ) = σ for all σ ∈ Σ if and only if s ∈ {b, c, d}. Thus, g = s1 s2 · · · sn ,
si ∈ S, belongs to H1 if and only if |{i : si = a}| is an even number. This
also shows that [G : H1 ] = 2. Finally, let g ∈ H1 . Then it can be expressed
in one of the following reduced forms:
182                                                   6 Finitely Generated Amenable Groups

      g = t0 at1 at2 at3 at4 · · · at2k−1 at2k = t0 (at1 a)t2 (at3 a)t4 · · · (at2k−1 a)t2k ,
      g = at1 at2 at3 at 4 · · · at2k−1 at2k = (at1 a)t2 (at3 a)t4 · · · (at2k−1 a)t2k ,
      g = t0 at1 at2 at3 at4 · · · at2k−1 a = t0 (at1 a)t2 (at3 a)t4 · · · (at2k−1 a),
      g = at1 at2 at3 at4 · · · at2k−1 a = (at1 a)t2 (at3 a)t4 · · · (at2k−1 a),

where t0 , t1 , . . . , t2k+1 ∈ {b, c, d} and k ∈ N (observe that the occurrences of
the a’s is 2k). This shows that the set {b, c, d, aba, aca, ada} generates H1 .
Now, the normal closure in G of the generators b, c, d is the subgroup H ⊂ G
generated by all the conjugates gtg −1 with g ∈ G and t ∈ {b, c, d}. Thus
taking g = 1G , a we deduce from (iii) that H1 ⊂ H. On the other hand, since
b, c, d ∈ H1 we also have H ⊂ H1 . Thus H = H1 .
   Let h ∈ H1 . For all w ∈ Σ ∗ there exist w0 , w1 ∈ Σ ∗ , (w0 ) = (w1 ) = (w)
such that h(0w) = 0w0 and h(1w) = 1w1 . Denote by h0 , h1 ∈ Sym(Σ ∗ , )
the maps deﬁned by h0 (w) = w0 and h1 (w) = w1 . We thus have

                        h(0w) = 0h0 (w) and h(1w) = 1h1 (w)

for all w ∈ Σ ∗ . We denote by φ0 : H1 → Sym(Σ ∗ , ) (resp. φ1 : H →
Sym(Σ ∗ , )) the map deﬁned by φ0 (h) = h0 (resp. φ1 (h) = h1 ) and by
φ : H1 → Sym(Σ ∗ , ) × Sym(Σ ∗ , ) the product map φ(h) = (h0 , h1 ).
From (6.30) we immediately deduce

                           φ(b) = (a, c),         φ(aba) = (c, a),
                           φ(c) = (a, d),         φ(aca) = (d, a),                         (6.42)
                           φ(d) = (1G , b),       φ(ada) = (b, 1G ).

Proposition 6.9.7. We have:
  (i) the maps φ0 , φ1 : H1 → G are surjective homomorphisms;
 (ii) the map φ : H1 → G × G is an injective homomorphism.
Proof. Let σ ∈ {0, 1}. For all h, h ∈ H and w ∈ Σ ∗ we have

          σφσ (hh )(w) = hh (σw) = h(σφσ (h )(w)) = σφσ (h)φσ (h )(w).

This shows that φσ (hh ) = φσ (h)φσ (h ). It follows that φ0 and φ1 are ho-
momorphisms. From (6.42) and Proposition 6.9.6(iii) we immediately deduce
that φ0 (H1 ) = φ1 (H1 ) = G. This shows (i).
   To show the injectivity of φ, let h ∈ H1 and suppose that φ(h) = 1G×G =
(1G , 1G ). We have h( ) = and h(σw) = σhσ (w) = σw for all σ ∈ {0, 1} and
w ∈ Σ ∗ . It follows that h = 1G = 1H . This shows (ii).
   As a consequence of Proposition 6.9.7(ii), we can identify each element
h ∈ H1 with its image φ(h) ∈ G × G. Thus, we shall write h = (h0 , h1 ) if
h ∈ H1 and φ(h) = (h0 , h1 ).
   Recall that a group is called periodic if it contains no elements of inﬁnite
order.
6.9 The Grigorchuk Group and Its Growth                                               183

Theorem 6.9.8. The Grigorchuk group G is an inﬁnite ﬁnitely generated
periodic group.

Proof. Since H1 is a proper subset of G and φ0 : H1 → G is surjective (cf.
Proposition 6.9.7(i)), we deduce that G is inﬁnite.
   Let now show that G is a 2–group, that is, that the order of every element
g ∈ G is a power of 2. The proof is by induction on S (g). By (6.33) the
statement is true for S (g) = 1.
   Let us ﬁrst show that every element g ∈ G \ {1G } is conjugate either to an
element in S or to an element g  which can be expressed in a reduced form

                                  g  = at1 at2 · · · atk                          (6.43)

with t1 , t2 , . . . , tk ∈ {b, c, d}, k ≥ 1, and such that S (g  ) ≤ S (g). Indeed,
if g is not conjugate to an element in S, then any element of minimal
S-length in the conjugacy class of g necessarily admits one of the follow-
ing two reduced forms, besides (6.43): t1 at2 · · · atk a and t0 at1 · · · atk with
t0 , t1 , . . . , tk ∈ {b, c, d}, t0 = tk , k ≥ 1. Conjugating by a and t0 respectively
and replacing tk t0 with t ∈ {b, c, d} according to (6.34), we transform the
above two expressions into one of the form (6.43). It is clear that such a
process does not increase the word lengths so that S (g  ) ≤ S (g).
     Suppose ﬁrst that g ∈ H1 and (g) > 1. Since the order of any element
equals the order of all its conjugates, we may suppose, up to conjugacy, that
g admits a reduced expression of the form (6.43) (with k ≥ 2 even, since
g ∈ H1 ). Now, the image of each quadruple at2i−1 at2i , i = 1, 2, . . . , k/2, via
φ0 or φ1 has word-length ≤ 2. Thus, S (g0 ), S (g1 ) ≤ S (g)/2 < S (g). By
induction, g0 e g1 are 2−elements, and thus g = (g0 , g1 ) is a 2−element as
well.
     Suppose now that g ∈         / H1 . As before, we may suppose, up to conjugacy,
that g admits a reduced expression of the form (6.43) (with k odd, since
g ∈ H1 ). We distinguish three cases.
     Case 1. The generator d appears in the expression of g, say d = ti for
some 1 ≤ i ≤ k. Then, up to conjugating by the element ti−1 ati−2 a · · · at1 a,
we can suppose that d = t1 .
     Now g 2 = (adat2 )(at3 at4 ) · · · (atk ad)(at2 at3 ) · · · (atk−1 atk ) ∈ H. The im-
age of each quadruple via φ0 (resp. φ1 ) has length 2, with the only exception
for those of the form atj ad = (atj a)d (resp. adatj = (ada)tj ) since φ0 (d) = 1G
(resp. φ1 (ada) = 1G ). But at least one of these quadruples occurs in g 2 , for
instance for j = k (resp. j = 1), so that S (φ0 (g 2 )) ≤ 2k − 1 < 2k = S (g)
(resp. S (φ1 (g 2 )) < S (g)). By induction, φ0 (g 2 ) and φ1 (g 2 ) are 2-elements
so that g 2 = (φ0 (g 2 ), φ1 (g 2 )) and therefore g are 2-elements as well.
     Case 2. Suppose now that d doesn’t occur in the expression of g but c
does. As before, up to conjugacy, we may suppose that t1 = c. We then have
φ0 (abat ) = ca, φ0 (acat ) = da and φ1 (abat ) = ac, φ1 (acat ) = ad for all
t ∈ {b, c}. It follows that S (φ0 (g 2 )) = S (φ1 (g 2 )) = 2k = (g). Observe that
φ0 (g 2 ) = da · · · a (resp. φ1 (g 2 ) = a · · · ad) so that, by conjugating by a (resp.
184                                              6 Finitely Generated Amenable Groups

ad) we fall into Case 1. This shows that φ0 (g 2 ) and φ1 (g 2 ) are 2-elements.
Thus g 2 = (φ0 (g 2 ), φ1 (g 2 )) and therefore g are 2-elements.
    Case 3. Finally, suppose that neither d nor c appear in (6.43) so that
necessarily g = (ab)2h+1 for some h ≥ 0. We have g 2 = (ab)4h+2 =
((aba)b)2h+1 ∈ H, so that φ0 (g 2 ) = (ca)2h+1 and φ1 (g 2 ) = (ac)2h+1 . Since
S (φ0 (g 2 )) = S (φ1 (g 2 )) = 4h + 2 = S (g), we are in Case 2 and we deduce
that φ0 (g 2 ) and φ1 (g 2 ) are 2-elements. Thus g 2 = (φ0 (g 2 ), φ1 (g 2 )) and there-
fore g itself are 2-elements.
Theorem 6.9.9. The Grigorchuk group G does not have polynomial growth.
   In order to prove this theorem, let us prove some preliminary results.
Lemma 6.9.10. The subgroup of G generated by a and d is dihedral of or-
der 8.
Proof. The dihedral group D8 of order 8 has presentation D8 = x, y :
x2 , y 2 , (xy)4 . Since a2 = d2 = 1G by (6.33), we are only left to verify that
the order of the element ad is 4. We have (ad)2 = (ada)d = (b, 1)(1, b) =
(b, b) = 1G , while (ad)4 = ((ad)2 )2 = (b, b)2 = (b2 , b2 ) = (1G , 1G ) = 1G .
   Recall that two groups G1 and G2 are commensurable if there exist two
subgroups of ﬁnite index K1 ⊂ G1 and K2 ⊂ G2 such that K1 and K2 are
isomorphic.
Lemma 6.9.11. The Grigorchuk group G is commensurable with its own
square G × G.
Proof. Let us start by showing that the index of φ(H1 ) inside G × G is ﬁnite.
  Since b, c, d, aba, aca and ada generate H1 (cf. Proposition 6.9.4), we de-
duce that the elements in (6.42) generate φ(H1 ).
  Denote by B ⊂ G the normal closure in G of b. The quotient G/B is
generated by the images of the generators of G and since cd = b ∈ B, it is
generated by the images of a and d. From Lemma 6.9.10 we deduce

                                [G : B] = |G/B| ≤ 8.                              (6.44)

   Let g ∈ G and consider the element gbg −1 . Since φ0 (resp. φ1 ) is sur-
jective, there exists an element h ∈ H (resp. h ∈ H) such that φ0 (h) = g
(resp. φ1 (h ) = g). It follows that (gbg −1 , 1G ) = φ(hadah−1 ) ∈ φ(H1 ) (resp.
(1G , gbg −1 ) = φ(h d(h )−1 ) ∈ φ(H1 )). As g varies in G the elements (gbg −1 , 1)
(resp. (1, gbg −1 )) generate the subgroup B0 = B × {1G } ⊂ φ(H1 ) (resp.
B1 = {1G } × B ⊂ φ(H1 )). Observe that B0  B1  B and that B0 and
B1 are normal subgroups of G × G. Moreover, B0 ∩ B1 = {1G×G }, so that
(G×G)/(B0 B1 )  G/B ×G/B. From (6.44) and the fact that B0 B1 ⊂ φ(H1 )
we deduce that

              [G × G : φ(H1 )] ≤ [G × G : B0 B1 ] = [G : B]2 = 64.                (6.45)

This shows that φ(H1 ) has ﬁnite index in G × G.
6.9 The Grigorchuk Group and Its Growth                                    185

   On the other hand [G : H1 ] = 2 (Proposition 6.9.6(ii)) and since φ is an
injective homomorphism (Proposition 6.9.7(ii)), we have that H1 and φ(H1 )
are isomorphic. It follows that G and G × G are commensurable.

Proof of Theorem 6.9.9. Since G is inﬁnite (Theorem 6.9.8) we have n  γ(G)
(cf. Proposition 6.4.8). Since G and G×G are commensurable (Lemma 6.9.11)
we deduce from Corollary 6.6.7 that γ(G) = γ(G×G). On the other hand, by
Proposition 6.6.10 we have γ(G × G) = γ(G)2 . Using Lemma 6.6.9 it follows
that n2  γ(G)2 = γ(G). By induction, we have that n2h  γ(G) for all
h ∈ N. Thus G cannot have polynomial growth.

  The remaining of this section is devoted to showing the following:
Theorem 6.9.12. The Grigorchuk group G has subexponential growth.
To prove this theorem we need some preliminaries. We start with a useful
criterion for detecting that certain ﬁnitely generated groups have subexpo-
nential growth.

Lemma 6.9.13. Let G be a ﬁnitely generated group. Let S ⊂ G be a ﬁnite
symmetric generating subset and suppose that there exist an integer M ≥ 2,
two constants 0 < k < 1 and K ≥ 0, and an injective homomorphism

                                 ψ : H → GM
                                     g → (gi )M
                                               i=1

where H ⊂ G is a ﬁnite index subgroup of G, such that
                            M
                                 S (gi ) ≤ kS (g) + K                 (6.46)
                           i=1

for all g ∈ H. Then G has subexponential growth.
                                                 1
Proof. Let us show that λS = limn→∞ γSG (n) n equals 1.
   Fix ε > 0. Then there exists an integer n0 ≥ 1 such that γSG (n) < (λS +ε)n
for all n ≥ n0 . Since λS ≥ 1, it follows that

                          γSG (n) ≤ γSG (n0 )(λS + ε)n                  (6.47)

for all n ∈ N.
   Let
                        γSH (n) = |{h ∈ H : S (h) ≤ n}|
and ﬁx a system T of left coset representatives of H in G. Set C =
maxt∈T S (t). Then, given g ∈ G, there exist unique h ∈ H and t ∈ T
such that g = th. Therefore S (h) ≤ S (t) + S (g) ≤ C + (g), so that
BSG (n) ⊂ T BSH (n + C). We deduce that

                         γSG (n) ≤ [G : H]γSH (n + C).                  (6.48)
186                                           6 Finitely Generated Amenable Groups

  On the other hand, by (6.46) we have

                   γSH (n) ≤     γSG (n1 )γSG (n2 ) · · · γSG (nM )
                                                                          
where the sum runs over all M −tuples n1 , n2 , . . . , nM such that          ni ≤
kn + K.
  From (6.47) we then deduce:

         γSH (n) ≤ γSG (n0 )M   (λS + )n1 (λS + )n2 · · · (λS + )nM

                = γSG (n0 )M    (λS + )n1 +n2 +···+nM
                                        M
                ≤ γSG (n0 )(kn + K)         (λS + )kn+K .

Using (6.48) we then obtain
                                                                      M         
 γSG (n) ≤ [G : H]γSH (n + C) ≤ [G : H] γSG (n0 )(kn + K  )  (λS + ε)kn+K
                                                                        (6.49)
where K  = K +kC. Taking the nth roots and passing to the limit for n → ∞
in (6.49), the ﬁrst term on the left tends to λS , while the last term on the
right tends to (λS + ε)k . Thus λS ≤ (λS + ε)k . Since ε was arbitrary we
deduce that λS ≤ λkS . Since by hypothesis k < 1, we have that λS = 1.
   Finally, from Corollary 6.5.5 we deduce that G has subexponential growth.


Lemma 6.9.14. Let n ≥ 1. Then φσ (Hn+1 ) ⊂ Hn for σ = 0, 1.
Proof. We proceed by induction on n. We have already noticed that φσ (H1 ) ⊂
G = H0 (Proposition 6.9.7(i)). Suppose that φσ (Hn ) ⊂ Hn−1 and let us show
that φσ (Hn+1 ) ⊂ Hn . Let g ∈ Hn+1 and w = σu, with u ∈ Σ n and σ ∈ {0, 1}.
Then
                        σu = w = g(w) = σφσ (g)(u),
so that φσ (g)(u) = u. This shows that φσ (g) ∈ Hn . It follows that
φσ (Hn+1 ) ⊂ Hn .
   As a consequence of the previous lemma, for all n ≥ 1 and w =
σ1 σ2 · · · σn ∈ Σ n the homomorphisms φw : Hn → G deﬁned by

                          φw = φσ1 ◦ φσ2 ◦ · · · ◦ φσn
                                                                    
are well deﬁned. We then deﬁne the homomorphism ψn : Hn → w∈Σ n G
by setting ψn (g) = (φw (g))w∈Σ n for all g ∈ Hn . Note that by Proposi-
 6.9.7(ii) ψn is injective. Thus, identifying Hn with its image ψn (Hn ) ⊂
tion
   w∈Σ n G, we simply write g = (gw )w∈Σ for all g ∈ Hn .
                                          n

   In the following, we consider the alphabet Λ = {α, β, γ, δ} and the monoid
Λ∗ . The map Λ → S given by α → a, β → b, γ → c and δ → d uniquely
extends to a surjective monoid homomorphism π : Λ∗ → G. We say that a
6.9 The Grigorchuk Group and Its Growth                                                     187

word w = λ1 λ2 · · · λn ∈ Λ∗ is reduced if for all i, j = 1, 2, . . . , n − 1 one has
λi = α implies λi+1 ∈ {β, γ, δ} and λj ∈ {β, γ, δ} implies λj+1 = α.
   Consider the following transformation p : Λ2 → Λ∗ deﬁned by setting
                        ⎧
                        ⎪
                        ⎪       if λ = λ
                        ⎪
                        ⎪
                        ⎨δ      if λ = β, λ = γ or λ = γ, λ = β
                    
             p(λλ ) = γ         if λ = β, λ = δ or λ = δ, λ = β              (6.50)
                        ⎪
                        ⎪                                    
                        ⎪
                        ⎪ β     if λ = γ, λ  = δ or λ  = δ, λ   =  γ
                        ⎩ 
                          λλ otherwise.

   Given a word u = λ1 λ2 · · · λn ∈ Λ∗ , and 1 ≤ i ≤ n, we set

                   u(i) = λ1 λ2 · · · λi−1 p(λi λi+1 )λi+2 · · · λn ∈ Λ∗ .

Note that u is reduced if and only if u = u(i) for all i = 1, 2, . . . , n − 1.
By induction we deﬁne u(i1 ,i2 ,...,ik ) = (u(i1 ,i2 ,...,ik−1 ) )ik for 1 ≤ ik ≤
(u(i1 ,i2 ,...,ik−1 ) ) − 1.
   Let now w = λ1 λ2 · · · λn ∈ Λ∗ . If w is reduced we set w = w. Otherwise,
let i1 be the minimal integer such that w = w(i1 ) . If w(i1 ) is reduced we set
w = w(i1 ) . Otherwise, let i2 be the minimal integer such that w(i1 ) = w(i1 ,i2 ) .
If w(i1 ,i2 ) is reduced we set w = w(i1 ,i2 ) . And so on. Since (w) > (w(i1 ) ) >
(w(i1 ,i2 ) > · · · > (w(i1 ,i2 ,...,ik−1 ) ) > (w(i1 ,i2 ,...,ik ) ) > · · · there exists an
integer k such that w(i1 ,i2 ,...,ik ) is reduced. We then set w = w(i1 ,i2 ,...,ik ) . A
transformation w(i1 ,i2 ,...,ij−1 ) → w(i1 ,i2 ,...,ij ) is called a leftmost cancellation.
It follows that every word in Λ∗ can be transformed into a reduced word by
a ﬁnite sequence of leftmost cancellations.
   We denote by Θ1 ⊂ Λ∗ the subset consisting of all reduced words w
on Λ which contain an even number α (w) of occurrences of the letter
α. Thus, a word w ∈ Θ1 is an alternate product of terms of the form
(αλα) and λ , with λ, λ ∈ {β, γ, δ}. Consider the maps Φ0 : Θ1 → Λ∗ and
Φ1 : Θ1 → Λ∗ deﬁned by setting Φσ ((αλ1 α)λ2 · · · ) = Φσ (αλ1 α)Φσ (λ2 ) · · ·
(resp. Φσ (λ1 (αλ2 α) · · · ) = Φσ (λ1 )Φσ (αλ2 α) · · · for all λ1 , λ2 , . . . ∈ {β, γ, δ}
where
            Φ0 (β) = α, Φ0 (αβα) = γ, Φ1 (β) = γ, Φ1 (αβα) = α,
            Φ0 (γ) = α, Φ0 (αγα) = δ, Φ1 (γ) = δ, Φ1 (αβα) = α,
            Φ0 (δ) = , Φ0 (αδα) = β, Φ1 (β) = δ, Φ1 (αβα) = .

For n ≥ 1 we inductively deﬁne Θn+1 ⊂ Λ∗ as the subset consisting of all
reduced words w in Θn such that the reduced words Φ0 (w) and Φ1 (w) belong
to Θn . Also, given w ∈ Θn we recursively set wσ0 σ1 ···σn−1 σ = Φσ (wσ0 σ1 ···σn−1 )
for all σ, σ1 , σ2 , . . . , σn−1 ∈ {0, 1}.

Lemma 6.9.15. For all w ∈ Θ1 one has

                               (w0 ) + (w1 ) ≤ (w) + 1.                              (6.51)
188                                                 6 Finitely Generated Amenable Groups

Proof. Let w ∈ Θ1 . We distinguish a few cases.
  Case 1. Suppose that w starts and ends with α so that w = (αλ1 α)λ2 · · ·
λk−1 (αλk α) with λi ∈ {β, γ, δ}. Note that (w) = 2k + 1. Then wσ = Φσ (w)
and Φσ (w) = Φσ (αλ1 α)Φσ (λ2 ) · · · Φσ (λk−1 )Φσ (αλk α) and therefore

      (wσ ) = (Φσ (w)) ≤ (Φσ (w))
            ≤ (Φσ (αλ1 α)) + (Φσ (λ2 )) + · · · + (Φσ (λk−1 )) + (Φσ (αλk α))
                  (2k + 1) − 1
            ≤k=
                         2
              (w) − 1
            =          .
                 2
   Case 2. Suppose that w starts and ends with letters in {β, γ, δ}, that is,
w = λ1 (αλ2 α)λ3 · · · (αλk−1 α)λk with λi ∈ {β, γ, δ}. Note that (w) = 2k − 1.
Then wσ = Φσ (w) and Φσ (w) = Φσ (λ1 )Φσ (αλ2 α) · · · Φσ (αλk−1 α)Φσ (λk ) and
therefore

      (wσ ) = (Φσ (w)) ≤ (Φσ (w))
            ≤ (Φσ (λ1 )) + (Φσ (αλ2 α)) + · · · + (Φσ (αλk−1 α)) + (Φσ (λk ))
                  (2k − 1) + 1
            ≤k=
                         2
              (w) + 1
            =          .
                 2
   Case 3. Finally, suppose that w starts with α and ends with λ ∈ {β, γ, δ},
or viceversa. To ﬁx ideas, suppose that w = (αλ1 α)λ2 · · · (αλk−1 α)λk with
λi ∈ {β, γ, δ}. Passing to the inverse word w−1 one handles the other possibil-
ity. Note that (w) = 2k. Then wσ = Φσ (w) and Φσ (w) = Φσ (αλ1 α)Φσ (λ2 ) · · ·
Φσ (αλk−1 α)Φσ (λk ) and therefore

      (wσ ) = (Φσ (w)) ≤ (Φσ (w))
            ≤ (Φσ (αλ1 α)) + (Φσ (λ2 )) + · · · + (Φσ (αλk−1 α)) + (Φσ (λk ))
                  2k
            ≤k=
                   2
              (w)
            =      .
                2
This shows (6.51).

Lemma 6.9.16. For all g ∈ H3 one has
                              1
                                                    5
                                     S (gijk ) ≤     S (g) + 8.                (6.52)
                                                    6
                           i,j,k=0
6.9 The Grigorchuk Group and Its Growth                                                      189

Proof. Let g ∈ H3 and let w ∈ Θ3 be such that g = π(w) and S (g) = (w).
As a consequence of Lemma 6.9.15 we have
                               1                      1
                                     (wij ) ≤             ((wi ) + 1)
                             i,j=0                   i=0
                                                      1                                    (6.53)
                                                 =         (wi ) + 2
                                                     i=0

                                                 ≤ (w) + 3

and therefore
                1                     1
                       (wijk ) ≤             ((wij ) + 1)
             i,j,k=0                i,j=0

                                      1
                               ≤              (wij ) + 4
                                    i,j=0                                                  (6.54)
                                         1
                                                                         1
              (by (6.53)) ≤                    (wi ) + 2       +4=           (wi ) + 6
                                        i=0                             i=0

              (by (6.51)) ≤ (w) + 1 + 6 = (w) + 7.

Now we observe that by deﬁnition of the maps Φ0 and Φ1 , the inequalities in
(6.51), (6.53) and (6.54) can be sharpened as follows.

                          (w0 ) + (w1 ) ≤ (w) + 1 − δ (w),                             (6.55)

where δ (w) denotes the number of occurrences of the letter δ in the word
w. Indeed, every such δ, may appear in w either isolated or in a triplet
(αδα). Then, in the ﬁrst case we have Φ0 (δ) = , while in the second one,
Φ1 (αδα) = .
   Similarly, since every letter γ in the word w will give rise via Φ0 or Φ1 to
a letter δ in one of w0 and w1 , the above argument shows that, even if some
cancellation occurs,

        (w00 ) + (w01 ) + (w10 ) + (w11 ) ≤ (w) + 3 − γ (w),                         (6.56)

where γ (w) denotes the number of occurrences of the letter γ in the word w.
   Finally, since every letter β in the word w will give rise via Φ0 or Φ1 to a
letter γ in one of w0 and w1 , and therefore to a letter δ in one of w00 , w01 , w10
and w11 , the above arguments show that indeed, even if some cancellation
occurs,
190                                                           6 Finitely Generated Amenable Groups
                                   1
                                         (wijk ) ≤ (w) + 7 − β (w),                     (6.57)
                               i,j,k=0

where β (w) denotes the number of occurrences of the letter β in the word w.
  Since (w) = α (w)+β (w)+γ (w)+δ (w) and w is reduced, we necessarily
have β (w) + γ (w) + δ (w) ≥ (w)−1
                                   2   and therefore

                                                              (w)
                                         max       λ (w) >        − 1.                    (6.58)
                                       λ∈{β,γ,δ}                6

Taking into account the inequalities in (6.54) we obtain
                             ⎧                               ⎫
          1                  ⎨ 1               1             ⎬
              (wijk ) ≤ min       (wi ) + 6,    (wij ) + 4 .                            (6.59)
                             ⎩                               ⎭
            i,j,k=0                           i=0               i,j=0


Observe that π(wijk ) = gijk so that S (gijk ) ≤ (wijk ) for all i, j, k = 0, 1.
Thus, using ﬁrst (6.59), (6.55), (6.56) and (6.57), and then (6.58) we deduce
   1                       1
          S (gijk ) ≤             (wijk )
i,j,k=0                  i,j,k=0

                      ≤ min{(w) + 7 − β (w), (w) + 7 − γ (w), (w) + 7 − δ (w)}
                      ≤ (w) + 7 − max{β (w), γ (w), δ (w)}
                                            
                                     (w)
                      ≤ (w) + 7 −        −1
                                       6
                        5
                      ≤ (w) + 8
                        6
                        5
                      = (g) + 8.
                        6
This shows (6.52).

Proof of Theorem 6.9.12. Let H = H3 . By Proposition 6.9.4 we have [G :
H] < ∞. Moreover, by Lemma 6.9.16 we can take ψ = ψ3 , M = 8, k = 5/6
and K = 8, and apply Lemma 6.9.13 to obtain that G has subexponential
growth.

   A ﬁnitely generated group G is said to have intermediate growth if G
has subexponential growth but does not have polynomial growth. Note that
every ﬁnitely generated group of intermediate growth contains no subgroups
isomorphic to F2 , by Corollary 6.6.5. From Theorem 6.9.9 and Theorem 6.9.12
we then get:

Theorem 6.9.17. The Grigorchuk group G has intermediate growth.
6.10 The Følner Condition for Finitely Generated Groups                       191

6.10 The Følner Condition for Finitely Generated
     Groups

Let G be a group. As right multiplication by elements in G is bijective we
have, for all A, B, F ⊂ G, F ﬁnite, and g ∈ G,

                                 (A \ B)g = Ag \ Bg,                        (6.60)

                  |F \ F g| = |F g \ F | = |F \ F g −1 | = |F g −1 \ F |.   (6.61)

Lemma 6.10.1. Let A, B, C ⊂ G be three ﬁnite sets. Then we have:

                             |A \ B| ≤ |A \ C| + |C \ B|.                   (6.62)

Proof. Suppose that x ∈ A \ B, that is, (i) x ∈ A and (ii) x ∈  / B. We
distinguish two cases. If x ∈
                            / C, then, by (i), x ∈ A \ C. If x ∈ C, then,
by (ii), x ∈ C \ B. In both cases, x ∈ (A \ C) ∪ (C \ B). It follows that
A \ B ⊂ (A \ C) ∪ (C \ B) and (6.62) follows.

   Let now S ⊂ G be a ﬁnite subset. The isoperimetric constant of G with
respect to S is the nonnegative number

                                                   |F S \ F |
                                 ιS (G) = inf                               (6.63)
                                               F      |F |

where F runs over all non empty ﬁnite subsets of G. Observe that ιS (G) =
ιS∪{1G } (G).

Proposition 6.10.2. Let G be a ﬁnitely generated group and let S ⊂ G be a
ﬁnite generating subset. Then the following conditions are equivalent:
(a) G is amenable;
(b) for all ε > 0 there is a ﬁnite subset F = F (ε) ⊂ G such that

                             |F \F s| < ε|F |         for all s ∈ S;        (6.64)

(c) ιS (G) = 0.

Proof. Suppose (a) and ﬁx ε > 0. By Theorem 4.9.1, G satisﬁes the Følner
conditions. For our convenience, we express the Følner conditions as follows.
Given any ﬁnite subset K ⊂ G and ε > 0 there exists a ﬁnite subset F =
F (K, ε ) ⊂ G such that

                          |F \F k| < ε |F |        for all k ∈ K.          (6.65)

  Taking ε = ε, K = S and F = F (S, ε) in 6.65, we then immediately
obtain (6.64), and the implication (a) ⇒ (b) follows.
192                                                6 Finitely Generated Amenable Groups

  Suppose (b). Taking g = s in (6.61) we immediately deduce

                       |F \F s| < ε|F |      for all s ∈ S ∪ S −1 .                             (6.66)

   Fix a ﬁnite set K ⊂ G and ε > 0. Since S generates G we can ﬁnd n ∈ N
such that K ⊂ (S ∪ S −1 )n . Set ε = ε /n. Let F = F (ε) ⊂ G be a ﬁnite set
such that (6.66) holds. Given k ∈ K we can ﬁnd a1 , a2 , . . . , an ∈ S ∪ S −1
such that k = a1 a2 · · · an . Then, recalling (6.62) and (6.60), we have

      |F \ F k| = |F \ F a1 a2 · · · an |
                ≤ |F \ F an | + |F an \ F an−1 an | + |F an−1 an \ F an−2 an−1 an |
                             + · · · + |F a2 a3 · · · an \ F a1 a2 · · · an |
                = |F \ F an | + |F \ F an−1 | + |F \ F an−2 | + · · · + |F \ F a1 |
                < nε|F |
                ≤ ε |F |

for all k ∈ K. This shows that G satisﬁes the Følner conditions (6.65) and
therefore G is amenable by Theorem 4.9.1. Thus (b) ⇒ (a).
   Finally, the equivalence (b) ⇔ (c) immediately follows from (6.61) and the
inequalities

         |F \ F s| = |F s \ F | ≤ |F S \ F | ≤           |F s \ F | =           |F \ F s |.
                                                 s ∈S                   s ∈S

for any s ∈ S and any ﬁnite subset F ⊂ G.



6.11 Amenability of Groups of Subexponential Growth

In this section we show that every ﬁnitely generated group of subexponential
growth is amenable.
   We ﬁrst prove the following:
Lemma 6.11.1. Let (an )n≥1 be a sequence of positive real numbers. Then
                                       an+1           √
                             lim inf        ≤ lim inf n an .                                    (6.67)
                              n→∞       an     n→∞


Proof. Set α = lim inf n→∞ aan+1n
                                  . If α = 0 there is nothing to prove. Other-
wise, let 0 < β < α. Then, there exists an integer N ≥ 1 such that aan+1n
                                                                          ≥β
for all n ≥ N . Thus, for all p = 1, 2 . . . one has
                     aN +p    aN +p   aN +p−1     aN +1
                           =        ·         ···       ≥ βp.
                      aN     aN +p−1 aN +p−2       aN

This gives aN +p ≥ β p aN . It follows that setting n = N + p, one has, for all
n≥N
6.12 The Theorems of Kesten and Day                                                 193

                      an ≥ β n−N aN = β n (β −N aN ).
                                     √         *
Thus, taking the nth roots we obtain n an ≥ β n β −N aN and therefore,
                                             √
                                   lim inf   n
                                               an ≥ β.                         (6.68)
                                   n→∞
                                                         √                         an+1
As (6.68) holds for all β < α, we have lim inf n→∞           n ≥ α = lim inf n→∞
                                                         n a
                                                                                    an .


  We are now in position to prove the main result of this section.
Theorem 6.11.2. Every ﬁnitely generated group of subexponential growth is
amenable.
Proof. Let G be a ﬁnitely generated group of subexponential growth. Let
S ⊂ G be a ﬁnite symmetric generating subset of G. Then, by
                                                         *  virtue of the
previous lemma we have 1 ≤ lim inf n→∞ γSγ(n+1)
                                          S (n)
                                                ≤ limn→∞
                                                         n
                                                           γ S (n) = 1, so
                   γS (n+1)
that lim inf n→∞    γS (n)    = 1. Fix ε > 0 and let n0 ∈ N be such that

                                 γS (n0 + 1)
                                             < 1 + ε.                          (6.69)
                                   γS (n0 )

Set F = BS (n0 ) and let us show that |F \ F s| < ε|F | for all s ∈ S. Let s ∈ S.
Then, as BS (n0 )s ⊂ BS (n0 + 1) for all s ∈ S, we have

                        |F \ F s| = |F s \ F |
                                  = |BS (n0 )s \ BS (n0 )|
                                  ≤ |BS (n0 + 1) \ BS (n0 )|
                                   = γS (n0 + 1) − γS (n0 )
                                   < εγS (n0 )
                                   = ε|F |,

where the last inequality follows from (6.69). From Proposition 6.10.2 we
deduce that G is amenable.
  From Theorem 6.9.12 and Theorem 6.11.2 we deduce the following:
Corollary 6.11.3. The Grigorchuk group G is amenable.



6.12 The Theorems of Kesten and Day

Let G be a group.
  Let p ∈ [1, +∞). We consider the real Banach space
                                                    +
                     p (G) =     x ∈ RG :          |x(g)|p < ∞
                                              g∈G
194                                                6 Finitely Generated Amenable Groups

consisting of all p-summable real functions on G. For x ∈ p (G), the nonneg-
                                     1
ative number xp =      g∈G |x(g)|
                                    p p
                                        is called the p -norm of x.
   The support of a conﬁguration x ∈ RG is the set {g ∈ G : x(g) = 0}. We
denote by R[G] ⊂ RG the vector subspace consisting of all ﬁnitely supported
conﬁgurations in RG . Note that R[G] is a dense subspace in p (G).
   When p = 2, it is possible to endow 2 (G) with a scalar product ·, ·
deﬁned by setting
                            x, y =     x(g)y(g)
                                           g∈G

for all x,*y ∈ 2 (G). Then, the 2 -norm of an element x ∈ 2 (G) is given by
x2 = x, x. The space (2 (G), ·, ·) is a real Hilbert space.
   The p -norm of a linear map T : p (G) → p (G) is deﬁned by

                                                                 T xp
                 T p→p =        sup T xp =           sup            .
                                   p
                             x∈ (G)                   x∈p
                                                              (G) xp
                              x p ≤1                     x=0


Then, T is continuous if and only if T p→p < ∞. We denote by L(p (G))
the space of all continuous linear maps T : p (G) → p (G) and by I : p (G) →
p (G) the identity map.
    Note that, by density of R[G] in p (G), we have

                                                             T xp
                  T p→p = sup T xp = sup                                    (6.70)
                                 x∈R[G]                x∈R[G] xp
                                  x p ≤1                 x=0


for all T ∈ L(p (G)).
   Let p ∈ [1, +∞) and s ∈ G. For all x ∈ p (G) and g ∈ G we set

                                 (Ts(p) x)(g) = x(gs).

We then have

                 Ts(p) xpp =         |Ts(p) x(g)|p
                                 g∈G

                           =           |x(gs)|p
                                 g∈G

                           =           |x(h)|p (by setting h = gs)
                                 h∈G
                           =     xpp

                                             (p)
for all x ∈ p (G). We deduce that Ts x ∈ p (G) and that the linear map
  (p)
Ts : p (G) → p (G) has p -norm
6.12 The Theorems of Kesten and Day                                                               195

                                          Ts(p) p→p = 1.                                     (6.71)
                     (p)
In particular, Ts ∈ L(p (G)).
                                                           (p)
    Let now S ⊂ G be a non-empty ﬁnite set. We denote by MS : p (G) →
                            (p) 1
                                          (p)
p (G) the map deﬁned by MS = |S|    s∈S Ts . In other words,


                                    (p)              1
                                 (MS x)(g) =                    x(gs)
                                                    |S|
                                                          s∈S

                                                      (p)
for all x ∈ p (G) and g ∈ G. The map MS                    is called the p -Markov operator
on p (G) associated with S.

Proposition 6.12.1. Let G be a group and S ⊂ G a non-empty ﬁnite set.
                              (p)
Then the p -Markov operator MS : p (G) → p (G) is linear and continuous.
Moreover,
                                              (p)
                                        MS p→p ≤ 1.                                          (6.72)
                 (p)                                                   (p)
Proof. Since Ts            ∈ L(p (G)), we deduce that MS                    ∈ L(p (G)). Finally, we
have
               (p)                1                           1
             MS p→p =                     Ts(p) p→p ≤                    Ts(p) p→p = 1
                                 |S|                         |S|
                                       s∈S                         s∈S

where the last equality follows from (6.71).

Proposition 6.12.2. Let G be a group. Let S ⊂ G be a ﬁnite subset contain-
ing 1G . Then, the following conditions are equivalent:
       (2)
(a) MS 2→2 = 1;
                                                                    (2)
(b) given ε > 0 there exists x ∈ R[G] such that x2 = 1 and MS x2 ≥
    1 − ε;
(c) given ε > 0 there exists x ∈ R[G] such that x ≥ 0, x2 = 1 and
        (2)
    MS x2 ≥ 1 − ε;
(d) given ε > 0 there exists x ∈ R[G] such that x ≥ 0, x2 = 1 and

                               x − Ts(2) x2 ≤ ε           for all s ∈ S;                     (6.73)
                                                    (2)            (2)
(e) 1 belongs to the real spectrum σ(MS ) of MS .

Proof. The implication (a) ⇒ (b) follows from the deﬁnition of 2 -norm and
the density of R[G] in 2 (G) (cf. (6.70)).
   Let now x ∈ R[G]. We have
                                             ,       ,
                                    (2)      , (2) ,2
                                  MS x22 ≤ ,MS |x| , .                                       (6.74)
                                                                   2
196                                              6 Finitely Generated Amenable Groups

Indeed,
                                    ,                 ,2
                                    , 1               ,
                        (2)         ,                 ,
                      MS x22    =,          Ts(2) x,
                                    , |S|             ,
                                          s∈S           2
                                                           2
                                            1
                                  =                  x(gs)
                                           |S|
                                    g∈G         s∈S
                                                            2
                                            1
                                  ≤                  |x(gs)|
                                           |S|
                                    g∈G         s∈S
                                    ,                   ,2
                                    , 1                 ,
                                    ,                   ,
                                  =,          Ts |x|,
                                                 (2)
                                    , |S|               ,
                                          s∈S             2
                                    ,          ,2
                                    , (2) ,
                                  = ,MS |x| , .
                                                  2

Thus, replacing x by |x| gives the implication (b) ⇒ (c).
   Suppose that (d) fails to hold, that is, there exists ε0 > 0 such that for all
                                                                    (2)
x ∈ R[G], x ≥ 0, x2 = 1, there exists s0 ∈ S such that x − Ts0 x2 ≥ ε0 .
Since 2 (G) is uniformly convex (Lemma I.4.2) there exists δ0 > 0 such that
                            ,             ,
                            , x + T (2) x ,
                            ,       s0    ,
                            ,             , ≤ 1 − δ0                      (6.75)
                            ,     2       ,
                                            2

for all x ∈ R[G] such that x2 = 1. It then follows
                        ,                ,
                        , 1              ,
               (2)      ,           (2) ,
            MS x2 = ,           Ts x,
                        , |S|            ,
                              s∈S
                        ,     
                                           2
                                                                        ,
                        ,                                                ,
                        , 2            (2)
                                x + Ts0 x          1                     ,
                      =,, |S|                  +                   T (2) ,
                                                                        x,
                        ,            2           |S|                s
                                                                         ,
                                                     s∈S\{1G ,s0 }
                            ,             ,                                2
                            ,        (2) ,
                         2 , x + Ts0 x ,         1
                      ≤     ,             , +                    Ts(2) x2
                        |S| ,      2      ,     |S|
                                             2        s∈S\{1G ,s0 }
                         2               1
          (by (6.75)) ≤     (1 − δ0 ) +     (|S| − 2)
                        |S|             |S|
                             2δ0
                      =1−
                             |S|

for all x ∈ R[G], such that x2 = 1 and x ≥ 0. This clearly contradicts (c).
We have shown (c) ⇒ (d).
   Let us show (d) ⇒ (e). Suppose that (6.73) holds. Then, for every ε > 0
there exists x ∈ R[G] such that
6.12 The Theorems of Kesten and Day                                                   197
                                 ,                    ,
                                 ,                    ,
                         (2)     ,      1             ,
                   x − MS x2 = ,x −          Ts(2) x,
                                 ,     |S|            ,
                                           s∈S          2
                                 ,                      ,
                                 , 1                    ,
                                 ,                (2) ,
                               =,         (x − Ts x),
                                 , |S|                  ,
                                                   s∈S                   2
                                             1
                                          ≤             x − Ts(2) x2
                                            |S|
                                                  s∈S

                                          ≤ ε.
                                                                     (2)
Therefore, by Corollary I.2.3, the linear map I − MS ∈ L(2 (G)) is not
                           (2)
bijective, that is, 1 ∈ σ(MS ).
   Finally, the implication (e) ⇒ (a) follow from (I.14) and the fact that
    (2)
MS 2→2 ≤ 1 (Proposition 6.12.1).

Lemma 6.12.3. Let S ⊂ G be a non-empty ﬁnite subset. The following con-
ditions are equivalent:
            (2)
(a) 1 ∈ σ(MS );
           (2)
(b) 1 ∈ σ(MS∪{1G } ).

Proof. If S contains 1G there is nothing to prove.
                                       |S|
  Suppose that 1G ∈ / S and set α = |S|+1  . Note that 0 < α < 1 and that

                              (2)                              (2)
                        MS∪{1G } = (1 − α)I + αMS .                                 (6.76)

                          (2)                                 (2)             (2)
  We then have I − MS∪{1G } = (1 − α)(I − MS ) so that I − MS∪{1G } is
                                    (2)                                         (2)
bijective if and only if I − MS           is bijective. In other words, 1 ∈ σ(MS∪{1G } )
                        (2)
if and only if 1 ∈ σ(MS ).

   Before stating and proving the main result of this section we need a lit-
tle more work. More precisely, we want to show the equivalence between
the existence of an almost S-invariant positive element x ∈ R[G] of norm
x2 = 1 (cf. condition (d) in Proposition 6.12.2) and the existence of an
almost S-invariant non-empty ﬁnite set F ⊂ G (cf. condition (b) in Proposi-
tion 6.10.2).
   Let F ⊂ G be a ﬁnite set. Denote, as usual, by χF the characteristic map
of F and observe that χF ∈ R[G].

Proposition 6.12.4. Let A, B ⊂ G be two ﬁnite sets. Then

              χA − χB 1 = χA − χB 22 = |A \ B| + |B \ A|.                       (6.77)
198                                              6 Finitely Generated Amenable Groups

Proof. First note that the map χA − χB takes value 1 at each point of A \ B,
value −1 at each point of B \ A, and value 0 everywhere else, that is, outside
of the set (A \ B) ∪ (B \ A) = (G \ (A ∪ B)) ∪ (A ∩ B). We then have

            χA − χB 22 =         |χA (g) − χB (g)|2
                             g∈G

                         =         |χA (g) − χB (g)|
                             g∈G

                         =                      |χA (g) − χB (g)|
                                   g∈G:
                             χA (g)−χB (g)=1


                                 +                          |χA (g) − χB (g)|
                                           g∈G:
                                     χA (g)−χB (g)=−1


                         =         χA\B (g) +          χB\A (g)
                             g∈G                 g∈G

                         = |A \ B| + |B \ A|.



Lemma 6.12.5. Let x, y ∈ 2 (G) such that x2 = y2 = 1. Then, the
following holds:
  (i) x2 ∈ 1 (G) and x2 1 = 1;
 (ii) x2 − y 2 1 ≤ 2x − y2 ;
                                                                       1
(iii) suppose that x, y ≥ 0. Then, x − y2 ≤ x2 − y 2 1             2
                                                                           .
                              
Proof. (i) We have x2 1 = g∈G |x2 (g)| = x22 = 1.
   (ii) We have

                x2 − y 2 1 =         |x2 (g) − y 2 (g)|
                                 g∈G

                             =         |x(g) − y(g)| · |x(g) + y(g)|
                                 g∈G

                             = |x − y|, |x + y|
                             ≤ x − y2 · x + y2
                             ≤ x − y2 · (x2 + y2 )
                             = 2x − y2 ,

where the ﬁrst inequality follows from Cauchy-Schwarz.
6.12 The Theorems of Kesten and Day                                                199

  (iii) We have

                     x − y22 =           (x(g) − y(g))2
                                     g∈G

                                =          |x(g) − y(g)| · |x(g) − y(g)|
                                     g∈G

                                ≤          |x(g) − y(g)| · |x(g) + y(g)|
                                     g∈G

                                =          |x2 (g) − y 2 (g)|
                                     g∈G

                                = x2 − y 2 1 ,

where the inequality follows from the fact that x, y ≥ 0.

Lemma 6.12.6. Let F ⊂ G be a non-empty ﬁnite set and s ∈ G. Then the
following holds:
      (p)
  (i) Ts χF = χF s−1 , for p = 1, 2;
 (ii) χF 1 = χF 22 = |F |;
              (1)                 (2)
(iii) χF − Ts χF 1 = χF − Ts χF 22 = 2|F \ F s|.
                                                                   (s)
Proof. For g ∈ G and p = 1, 2, one has that (Tp χF )(g) = χF (gs) equals 1
if and only if gs ∈ F , that is, if and only if g ∈ F s−1 . This shows (i).
    Moreover, recalling that χF (g) ∈ {0, 1}, for all g ∈ G, on has

 χF 22 =         χF (g)2 =         χF (g) = χF 1 = |{g ∈ G : χF (g) = 1}| = |F |.
             g∈G               g∈G

This shows (ii).
  Finally, (iii) follows from (i), (6.77) (with A = F and B = F s−1 )
and (6.61).

Lemma 6.12.7. Let x ∈ R[G] such that x ≥ 0 and x1 = 1. Then there
exist an integer n ≥ 1, nonempty ﬁnite subsets Ai ⊂ G and real numbers
λi > 0, 1 ≤ i ≤ n, satisfying A1 ⊃ A2 ⊃ · · · ⊃ An and λ1 + λ2 + · · · + λn = 1
such that
                                               n
                                                         χAi
                                       x=           λi         .                (6.78)
                                              i=1
                                                         |Ai |

Proof. Let 0 < α1 < α2 < · · · < αn be the values taken by x. For each
1 ≤ i ≤ n, let us set
                               Ai = {g ∈ G : x(g) ≥ αi }.
200                                                    6 Finitely Generated Amenable Groups

Clearly the sets Ai are nonempty ﬁnite subsets of G such that A1 ⊃ A2 ⊃
· · · ⊃ An . On the other hand, we have

               x = α1 χA1 + (α2 − α1 )χA2 + · · · + (αn − αn−1 )χAn
                        χA1       χA             χA
                 = λ1         + λ2 2 + · · · + λn n ,
                        |A1 |     |A2 |          |An |

by setting λ1 = α1 |A1 | and λi = (αi − αi−1 )|Ai | for 2 ≤ i ≤ n. Thus λi > 0
for 1 ≤ i ≤ n and
           n
                λi = α1 |A1 | + (α2 − α1 )|A2 | + · · · + (αn − αn−1 )|An |
          i=1

                   = α1 (|A1 | − |A2 |) + α2 (|A2 | − |A3 |) + · · · + αn |An |

                   =         x(g) = 1.
                       g∈G




Lemma 6.12.8. With the same notation and hypotheses as in Lemma 6.12.7,
we have
                                   n
                                         2|Ai \ Ai g|
                 x − Tg(1) x1 =     λi                         (6.79)
                                  i=1
                                            |Ai |
for every g ∈ G.

Proof. Equality (6.78) gives us
                                                       n                  (1)
                                                                  χAi − Tg χAi
                                   x−    Tg(1) x   =         λi
                                                       i=1
                                                                       |Ai |
                                                       n
                                                                  χAi − χAi g−1
                 (by Lemma 6.12.6(a))              =         λi                 .
                                                       i=1
                                                                      |Ai |

As we observed before (cf. the proof of Proposition 6.12.4), the map χAi −
χAi g−1 takes value 1 at each point of Ai \ Ai g −1 , value −1 at each point of
Ai g −1 \ Ai , and value 0 everywhere else. Let us set
                   !                                !
           B=          (Ai \ Ai g −1 ) and C =           (Ai g −1 \ Ai ).
                 1≤i≤n                                            1≤i≤n

Note that the sets B and C are disjoint. Indeed, for all 1 ≤ i, j ≤ n, we have
(Ai \ Ai g −1 ) ∩ (Aj \ Aj g −1 ) = ∅ since either Ai ⊂ Aj or Aj ⊂ Ai (which
implies Aj g −1 ⊂ Ai g −1 ).
  It follows that
6.12 The Theorems of Kesten and Day                                                                               201

x − Tg(1) x1 =            |(x − Tg(1) x)(a)|
                   a∈G
                   -                            -
                   - n     (χAi − χAi g−1 )(a) --
                   -
              =    -    λi                      -
                   -              |Ai |         -
                a∈G i=1
                   -                            -                                     -                               -
                   - n     (χAi − χAi g−1 )(a) --                                     -    n
                                                                                                 (χAi − χAi g−1 )(a) --
                   -                                                                  -
              =    -    λi                      -+                                    -       λi                      -
                   -              |Ai |         -                                     -                 |Ai |         -
                   a∈B i=1                                                      a∈C       i=1
                    n                         −1             n                 −1
                                 |Ai \ Ai g        |                    |Ai g \ Ai |
              =             λi                         +           λi
                   i=1
                                     |Ai |                   i=1
                                                                             |Ai |
                    n
                     2|Ai \ Ai g|
(by (6.61)) =     λi              .
              i=1
                        |Ai |



  Let G be a ﬁnitely generated group and let S be a ﬁnite (not necessarily
symmetric) generating subset of G. Consider the combinatorial Laplacian
ΔS : RG → RG (cf. Example 1.4.3(b)). For all x ∈ 2 (G) ⊂ RG and g ∈ G we
have

                            (ΔS x)(g) = |S|x(g) −                             x(gs)
                                                                    s∈S

                                          = |S|x(g) −                         (Ts(2) x)(g)
                                                                    s∈S
                                                                        (2)
                                          = |S|(I − MS )(x)(g).
                                              (2)
This shows that for the map ΔS = ΔS |2 (G) one has
                                  (            )
                           (2)             (2)
                          ΔS = |S| I − MS                                                                     (6.80)

                      (2)
and therefore ΔS ∈ L(2 (G)).
  Let λ ∈ R. From (6.80) we deduce that
                                                                                               
                (2)                                    (2)                          λ         (2)
      λI − ΔS = λI − |S|(I − MS ) = −|S|                                        1−       I − MS     .
                                                                                   |S|

It follows that                                               
                                        (2)                 λ         (2)
                            λ ∈ σ(ΔS ) ⇔                1−       ∈ σ(MS )
                                                           |S|
and therefore
                                               (2)                              (2)
                                   0 ∈ σ(ΔS ) ⇔ 1 ∈ σ(MS ).                                                   (6.81)

Theorem 6.12.9 (Kesten-Day). Let G be a ﬁnitely generated group. Let
S ⊂ G be a ﬁnite (not necessarily symmetric) generating subset of G. Then
202                                                6 Finitely Generated Amenable Groups

the following conditions are equivalent:
(a) G is amenable;
           (2)
(b) 0 ∈ σ(ΔS ).
Proof. Suppose (a). By Theorem 4.9.1 we have that G satisﬁes the Følner
conditions. Fix ε > 0. By Proposition 6.10.2 there exists a ﬁnite subset F ⊂ G
such that |F \ F s| < ε2 |F | for all s ∈ S. Set x = √1 χF and note that
                        2

                                                                     |F |
x2 = 1. We have

                           (2)                     1
                  (I − MS )x2 = x −                        Ts(2) x2
                                                  |S|
                                                        s∈S
                                      1
                                   =                   (x − Ts(2) x)2
                                     |S|
                                                  s∈S
                                      1
                                   ≤                   x − Ts(2) x2
                                     |S|
                                              s∈S
                                                  1
                                   =              *          χF − Ts(2) χF 2
                                       |S| ·        |F | s∈S
                                          1                    1
         (by Lemma 6.12.6(iii)) =         *         2|F \ F s| 2
                                     |S| · |F | s∈S
                                                        1
                                      1         |F \ F s| 2
                                   =        2
                                     |S|           |F |
                                              s∈S
                                          2        1
                                   =          1   ε2
                                     |F |     2


                                   < ε.
                                                        (2)
From Corollary I.2.3 we deduce that I − MS is not bijective, that is, 1 ∈
     (2)                                        (2)
σ(MS ). From (6.81) we deduce that 0 ∈ σ(ΔS ). Thus (a) implies (b).
   To prove the converse implication, ﬁrst observe that, by virtue of Propo-
sition 6.10.2, in order to prove (a), it suﬃces to show that given any ε > 0
there exists a ﬁnite subset F ⊂ G such that

                      |F \ F s| < ε|F |            for all s ∈ S.                (6.82)
                                                                                  (2)
   Fix ε > 0. Suppose (b) and observe that by (6.81) we have 1 ∈ σ(MS ).
Also note that, by Lemma 6.12.3, we can suppose that S  1G . Thus, by
virtue of the implication (e) ⇒ (c) in Proposition 6.12.2, we can ﬁnd a non-
                                                               (2)
negative function xε ∈ R[G] such that xε 2 = 1 and xε − Ts xε 2 ≤ 2|S|ε

for all s ∈ S. Setting x = x2ε , from Lemma 6.12.5 we deduce that x1 = 1
and
                                        ε
                      x − Ts(1) x1 ≤     for all s ∈ S.             (6.83)
                                       |S|
6.12 The Theorems of Kesten and Day                                            203

   By Lemma 6.12.7, there exist an integer n ≥ 1, nonempty ﬁnite subsets
Ai ⊂ G and real numbers λi > 0, 1 ≤ i ≤ n,      nsatisfying A1 ⊃ A2 ⊃ · · · ⊃ An
                                                         χ
and λ1 + λ2 + · · · + λn = 1, such that x = i=1 λi |AAii| .
   Set Ω = {1, 2, . . . , n} and consider the unique probability measure μ on Ω
such that μ({i}) = λi for every i ∈ Ω. Finally, for each g ∈ G, let Ωg denote
the subset of Ω deﬁned by
                                                        
                                          |Ai \ Ai g|
                           Ωg = i ∈ Ω :               ≥ε .
                                             |Ai |

It follows from Lemma 6.12.8 that
                                                            2|Ai \ Ai g|
                      x − Tg(1) x1 =                 λi
                                                               |Ai |
                                                 i∈Ω
                                                              2|Ai \ Ai g|
                                            ≥            λi
                                                                 |Ai |
                                                 i∈Ωg

                                            ≥ 2ε              λi
                                                    i∈Ωg

                                            = 2εμ(Ωg ).

Therefore, we have
                                            (1)
                                 x − Tg x1
                   μ(Ωg ) ≤                                   for all g ∈ G.
                                      2ε
By using (6.83), we deduce
                                            1
                         μ(Ωs ) <                   for all s ∈ S,
                                           |S|

which implies                             
                                !
                        μ             Ωs       ≤         μ(Ωs ) < 1.
                                s∈S                s∈S

Thus                                   !
                                               Ωs = Ω.
                                       s∈S

This means that there is some i0 ∈ Ω such that

                        |Ai0 \ Ai0 s|
                                      <ε                for all s ∈ S.
                           |Ai0 |

Thus, in order to satisfy (6.82), we can take F = Ai0 .
204                                             6 Finitely Generated Amenable Groups

6.13 Quasi-Isometries

Let G and H be two groups.

Deﬁnition 6.13.1. A map ϕ : G → H is called a quasi-isometric embedding
of G into H if the following two conditions hold:
  (i) for every ﬁnite subset K ⊂ G there exists a ﬁnite subset F ⊂ H such
      that

            g1−1 g2 ∈ K =⇒ ϕ(g1 )−1 ϕ(g2 ) ∈ F for all g1 , g2 ∈ G;             (6.84)

 (ii) for every ﬁnite subset F ⊂ H there exists a ﬁnite subset K ⊂ G such
      that

            ϕ(g1 )−1 ϕ(g2 ) ∈ F =⇒ g1−1 g2 ∈ K for all g1 , g2 ∈ G.             (6.85)

Deﬁnition 6.13.2. A quasi-isometry from G to H is a quasi-isometric em-
bedding ϕ of G into H for which there exists a ﬁnite subset C ⊂ H such
that
                             ϕ(G)C = H,                           (6.86)
that is, for all h ∈ H there exists g ∈ G and c ∈ C such that

                                     h = ϕ(g)c.                                 (6.87)

If such a quasi-isometry from G to H exists then one says that G is quasi-
isometric to H.

Example 6.13.3. Let G and H be two groups and let ϕ : G → H be an
injective homomorphism. Then ϕ is a quasi-isometric embedding. Indeed,
given a ﬁnite subset K ⊂ G, the set F = ϕ(K) is a ﬁnite subset of
H. On the other hand, if g1 , g2 ∈ G satisfy g1−1 g2 ∈ K, then we have
ϕ(g1 )−1 ϕ(g2 ) = ϕ(g1−1 g2 ) ∈ F . Conversely, suppose that F  is a ﬁnite subset
of H and consider the set K  = ϕ−1 (F  ) ⊂ G. Note that |K  | ≤ |F  | < ∞,
since ϕ is injective. On the other hand, if g1 , g2 ∈ G satisfy ϕ(g1 )−1 ϕ(g2 ) ∈ F  ,
then we have ϕ(g1−1 g2 ) = ϕ(g1 )−1 ϕ(g2 ) ∈ F  so that g1−1 g2 ∈ K  . This shows
that ϕ is a quasi-isometric embedding.
   Moreover, ϕ is a quasi-isometry if and only if the index of the image
subgroup ϕ(G) is ﬁnite in H. Indeed, suppose ﬁrst that [H : ϕ(G)] < ∞ and
let R ⊂ H be a set of representatives for the right cosets of ϕ(G) in H. Note
that R is ﬁnite and                $
                             H=       ϕ(G)h = ϕ(G)R.                           (6.88)
                                  h∈R

Thus, ϕ is a quasi-isometry. Conversely, if C ⊂ H is a ﬁnite set such that
H = ϕ(G)C one clearly has [H : ϕ(G)] = |H/ϕ(G)| ≤ |C| < ∞.
6.13 Quasi-Isometries                                                       205

Remark 6.13.4. Let G and H be two groups. Observe that if ψ : G → H is
a quasi-isometric embedding (resp. a quasi-isometry) and h0 ∈ H, then the
map ϕ : G → H deﬁned by ϕ(g) = h0 ψ(g) for all g ∈ G is a quasi-isometric
embedding (resp. a quasi-isometry). Indeed, ϕ(g1 )−1 ϕ(g2 ) = ψ(g1 )−1 ψ(g2 )
for all g1 , g2 ∈ G and, if C ⊂ H is a ﬁnite set such that ψ(G)C = H, then
ϕ(G)C = h0 ψ(G)C = h0 H = H. Note that taking h0 = ψ(1G )−1 we have
ϕ(1G ) = 1H . It follows that if there exists a quasi-isometric embedding of
G into H, then there is a quasi-isometric embedding ϕ : G → H such that
ϕ(1G ) = 1H . Similarly, if G is quasi-isometric to H, one can ﬁnd a quasi-
isometry ϕ : G → H such that ϕ(1G ) = 1H .

Proposition 6.13.5. Let G, H and L be three groups and let ϕ : G → H and
ψ : H → L be two quasi-isometric embeddings (resp. quasi-isometries). Then
the composition map ψ ◦ ϕ : G → L is a quasi-isometric embedding (resp.
quasi-isometry).

Proof. Since ϕ is a quasi-isometric embedding, given a ﬁnite subset K ⊂ G,
we can ﬁnd a ﬁnite subset E ⊂ H such that if g1−1 g2 ∈ K, g1 , g2 ∈ G,
then ϕ(g1 )−1 ϕ(g2 ) ∈ E. Similarly, as ψ is a quasi-isometric embedding,
we can ﬁnd a ﬁnite subset F ⊂ L such that if h−1      1 h2 ∈ E, h1 , h2 ∈ H,
then ψ(h1 )−1 ψ(h2 ) ∈ F . It follows that if g1−1 g2 ∈ K, g1 , g2 ∈ G, then
ψ(ϕ(g1 ))−1 ψ(ϕ(g2 )) ∈ F . In the same way one proves that given a ﬁnite sub-
set F ⊂ L one can ﬁnd a ﬁnite set K ⊂ G such that if ψ(ϕ(g1 ))−1 ψ(ϕ(g2 )) ∈
F , g1 , g2 ∈ G, then g1−1 g2 ∈ K. This shows that ψ ◦ ϕ is a quasi-isometric
embedding.
   Let now C ⊂ H and D ⊂ L be two ﬁnite sets such that ϕ(G)C = H and
ψ(H)D = L. As ψ is a quasi-isometric embedding there exists a ﬁnite set
F ⊂ L such that h−1  1 h2 ∈ C implies ψ(h1 )
                                             −1
                                                ψ(h2 ) ∈ F for all h1 , h2 ∈ H.
Let us show that
                                ψ(ϕ(G))F D = L.                           (6.89)
Given  ∈ L there exists h ∈ H such that

                                   ∈ ψ(h)D.                             (6.90)

Let also g ∈ G and c ∈ C be such that h = ϕ(g)c. Set h = ϕ(g) ∈ H and ob-
serve that (h )−1 h = c ∈ C. It follows that ψ(ϕ(g))−1 ψ(h) = ψ(h )−1 ψ(h) ∈
F , that is,
                               ψ(h) ∈ ψ(ϕ(g))F.                          (6.91)
From (6.90) and (6.91) we deduce  ∈ ψ(ϕ(g))F D. This shows (6.89). It
follows that ψ ◦ ϕ : G → L is a quasi-isometry.

Corollary 6.13.6. Let G and H be two groups and let ϕ : G → H be a quasi-
isometric embedding. Let L ⊂ G be a subgroup of G. Then the restriction map
ϕ|L : L → H is a quasi-isometric embedding.
206                                           6 Finitely Generated Amenable Groups

Proof. From Example 6.13.3 we deduce that the inclusion map ι : L → G is
a quasi-isometric embedding. Since ϕ|L = ϕ ◦ ι, the statement follows from
Proposition 6.13.5.

Proposition 6.13.7. Quasi-isometry is an equivalence relation in the class
of groups.

Proof. Every group is quasi-isometric to itself. Indeed, for any group G, the
identity map IdG : G → G is clearly a quasi-isometry (just take F = K
in (6.84) and (6.84), and C = {1G } in (6.86)).
    Suppose that a group G is quasi-isometric to a group H. Let ϕ : G → H
be a quasi-isometry and let C ⊂ H be a ﬁnite subset satisfying (6.86). We
deﬁne a map ϕ : H → G as follows. For every h ∈ H we can ﬁnd c ∈ C and
g ∈ G such that (6.87) holds. We then set ϕ (h) = g. Let us show that ϕ is
a quasi-isometry.
    Let h1 , h2 ∈ H. We set gi = ϕ (hi ) ∈ G and ci = ϕ(gi )−1 hi ∈ C, i = 1, 2.
Note that hi = ϕ(gi )ci , equivalently ϕ(gi ) = hi c−1
                                                     i , i = 1, 2.
    Let now F ⊂ H be a ﬁnite subset and suppose that h−1      1 h2 ∈ F . Consider
the ﬁnite set F  = CF C −1 ⊂ H. As ϕ is a quasi-isometric embedding, we can
ﬁnd a ﬁnite subset K ⊂ G such that if ϕ(g1 )−1 ϕ(g2 ) ∈ F  then g1−1 g2 ∈ K.
But ϕ(g1 )−1 ϕ(g2 ) = c1 h−1        −1
                              1 h2 c2 ∈ CF C
                                              −1
                                                 = F  so that ϕ (h1 )−1 ϕ (h2 ) =
 −1
g1 g2 ∈ K. Conversely, let K ⊂ G be a ﬁnite subset and suppose that
ϕ (h1 )−1 ϕ (h2 ) = g1−1 g2 belongs to K. As ϕ is a quasi-isometric embedding,
we can ﬁnd a ﬁnite set F  ⊂ H such that if g1−1 g2 ∈ K then ϕ(g1 )−1 ϕ(g2 ) ∈
F  . Set F = C −1 F  C. It follows that

                 h−1      −1
                  1 h2 = c1 ϕ(g1 )
                                  −1
                                     ϕ(g2 )c2 ∈ c−1 
                                                 1 F c2 ⊂ F.

This shows that ϕ is a quasi-isometric embedding of H into G.
   Now, as ϕ is a quasi-isometric embedding, we can ﬁnd a ﬁnite set K ⊂ G
such that if ϕ(g1 )−1 ϕ(g2 ) ∈ C then g1−1 g2 ∈ K. Let us show that

                                  G = ϕ (H)K.                               (6.92)

Let g ∈ G. Set h = ϕ(g) ∈ H and g  = ϕ (h) ∈ G. Note that by (6.86)
there exists c ∈ C such that h = ϕ(g  )c. Now ϕ(g  )−1 ϕ(g) = (ch−1 )h =
c ∈ C and therefore (g  )−1 g ∈ K, that is, g ∈ g  K = ϕ (h)K ⊂ ϕ (H)K.
This shows (6.92). We deduce that ϕ is a quasi-isometry. It follows that the
symmetric property of quasi-isometry holds true.
   Finally, the transitivity property of quasi-isometry was proved in Propo-
sition 6.13.5.

  As a consequence, if a group G is quasi-isometric to a group H then H is
quasi-isometric to G and we simply say that G and H are quasi-isometric.

Proposition 6.13.8. Let G be a group and let N be a ﬁnite normal subgroup
of G. Then G and G/N are quasi-isometric.
6.13 Quasi-Isometries                                                               207

Proof. Let ϕ : G → G/N denote the quotient homomorphism. Let us show
that ϕ is a quasi-isometry. Given a ﬁnite subset K ⊂ G, the set F = ϕ(K) is
a ﬁnite subset of G/N . On the other hand, if g1 , g2 ∈ G satisfy g1−1 g2 ∈ K,
then we have ϕ(g1 )−1 ϕ(g2 ) = ϕ(g1−1 g2 ) ∈ F . Conversely, suppose that F  is
a ﬁnite subset of G/N and consider the set K  = ϕ−1 (F  ) ⊂ G. Note that
|K  | = |N |·|F  | < ∞. On the other hand, if g1 , g2 ∈ G satisfy ϕ(g1 )−1 ϕ(g2 ) ∈
F  , then we have ϕ(g1−1 g2 ) = ϕ(g1 )−1 ϕ(g2 ) ∈ F  so that g1−1 g2 ∈ K  . This
shows that ϕ is a quasi-isometric embedding. Since ϕ is surjective, we deduce
that ϕ is indeed a quasi-isometry.

Proposition 6.13.9. Let G be a group and let H be a subgroup of ﬁnite index
of G. Then G and H are quasi-isometric.

Proof. It follows from Example 6.13.3 that the inclusion map ι : H → G is a
quasi-isometry.

Corollary 6.13.10. If two groups are commensurable then they are quasi-
isometric.

Proposition 6.13.11. Let G and H be two groups. Suppose that G and H
are quasi-isometric and that G is ﬁnitely generated. Then H is ﬁnitely gen-
erated.

Proof. Let ϕ : G → H by a quasi-isometry and let C ⊂ H be a ﬁnite subset
such that H = ϕ(G)C. Let S ⊂ G be a ﬁnite symmetric generating subset of
G. Since ϕ is a quasi-isometric embedding, we can ﬁnd a ﬁnite subset F ⊂ H
such that ϕ(g1 )−1 ϕ(g2 ) ∈ F whenever g1 , g2 ∈ G satisfy g1−1 g2 ∈ S. Let us
show that the set T ⊂ H deﬁned by T = {ϕ(1G )} ∪ F ∪ C is a generating
subset for H. Let h ∈ H. As H = ϕ(G)C, we can ﬁnd g ∈ G and c ∈ C such
that h = ϕ(g)c. Since S is a symmetric generating subset of G, there exist
an integer n ≥ 0 and elements s1 , s2 , . . . , sn ∈ S such that g = s1 s2 · · · sn .
Consider the elements g0 , g1 , . . . , gn ∈ G deﬁned by g0 = 1G and gi = gi−1 si
for all 1 ≤ i ≤ n. Observe that gn = g and that ϕ(gi−1 )−1 ϕ(gi ) ∈ F , for all
                  −1
1 ≤ i ≤ n, since gi−1 gi = si ∈ S. Writing

   h = ϕ(g)c = ϕ(1G )(ϕ(g0 )−1 ϕ(g1 )(ϕ(g1 )−1 ϕ(g2 ) · · · (ϕ(gn−1 )−1 ϕ(gn ))c,

we deduce that T generates H. As T is ﬁnite, this shows that H is ﬁnitely
generated.

   In the two following propositions we characterize quasi-isometric embed-
dings and quasi-isometries for ﬁnitely generated groups in terms of the word
metrics associated with ﬁnite symmetric generating subsets of the groups.

Proposition 6.13.12. Let G and H be two ﬁnitely generated groups and
denote by dG and dH the word metric associated with two ﬁnite symmetric
generating subsets SG and SH for G and H respectively. Let ϕ : G → H be a
map. Then the following conditions are equivalent:
208                                                6 Finitely Generated Amenable Groups

(a) ϕ is an isometric embedding;
(b) there exist constants α ≥ 1 and β ≥ 0 such that, for all g, g  ∈ G,
             1
               dG (g, g  ) − β ≤ dH (ϕ(g), ϕ(g  )) ≤ αdG (g, g  ) + β.       (6.93)
             α
Proof. Suppose (a). Let K ⊂ G (resp. F ⊂ H) be a ﬁnite set such that
g1−1 g2 ∈ K (resp. ϕ(g1 )−1 ϕ(g) ∈ F ) whenever ϕ(g1 )−1 ϕ(g) ∈ SH (resp.
g1−1 g2 ∈ SG ) for all g1 , g2 ∈ G. Also let K  ⊂ G be a ﬁnite set such that
g1−1 g2 ∈ K  whenever ϕ(g1 )−1 ϕ(g) ∈ {1H }, equivalently, ϕ(g1 ) = ϕ(g2 ), for
all g1 , g2 ∈ G. We set

                       α = max {diamdG (K), diamdH (F )}                        (6.94)

and
                                       1
                                β=       diamdG (K  ),                        (6.95)
                                       α
where we denoted by diamdG (K) = max{dG (k1 , k2 ) : k1 , k2 ∈ K} (resp.
diamdH (F ) = max{dH (f1 , f2 ) : f1 , f2 ∈ F }) the diameter of K ⊂ G (resp.
F ⊂ H).
    Let now g, g  ∈ G. Note that (6.93) trivially holds if g = g  . Suppose
ﬁrst that dG (g, g  ) = 1. Thus g −1 g  ∈ SG and therefore ϕ(g)−1 ϕ(g  ) ∈ F
so that dH (ϕ(g), ϕ(g  )) ≤ α. Suppose now that dG (g, g  ) = n ≥ 1 and let
g0 , g1 , . . . , gn ∈ G be such that g0 = g, gn = g  and dG (gi , gi+1 ) = 1 for all
i = 0, 1, . . . , n − 1. Using the triangular inequality we have:

                    dH (ϕ(g), ϕ(g  )) = dH (ϕ(g0 ), ϕ(gn ))
                                           n−1
                                       ≤         dH (ϕ(gi ), ϕ(gi+1 ))
                                           i=0
                                       ≤ nα
                                       = αdG (g, g  ).

This shows that
                           dH (ϕ(g), ϕ(g  )) ≤ αdG (g, g  )                   (6.96)
for all g, g  ∈ G and the second inequality in (6.93) follows.
   Arguing as above, we deduce that for all n ≥ 1 the condition dH (ϕ(g),
ϕ(g  )) = n implies dG (g, g  ) ≤ nα. Thus, provided that dH (ϕ(g), ϕ(g  )) = 0,
we have dG (g, g  ) ≤ αdH (ϕ(g), ϕ(g  )), equivalently
                           1
                             dG (g, g  ) ≤ dH (ϕ(g), ϕ(g  )).                 (6.97)
                           α
On the other hand, if ϕ(g) = ϕ(g  ), equivalently, ϕ(g)−1 ϕ(g  ) ∈ {1H }, then
g −1 g  ∈ K  and from (6.95) we deduce that α1 dG (g, g  ) ≤ β. It follows that
6.13 Quasi-Isometries                                                          209

                        1
                          dG (g, g  ) − β ≤ 0 = dH (ϕ(g), ϕ(g  )).        (6.98)
                        α
From (6.97) (for ϕ(g) = ϕ(g  )) and (6.98) (for ϕ(g) = ϕ(g  )) we deduce that
(6.98) holds for all g, g  ∈ G. Thus also the ﬁrst inequality in (6.93) is proved.
This shows (a) ⇒ (b).
   Conversely, suppose (b). Let K ⊂ G be a ﬁnite subset. Consider the
ﬁnite set F = BSHH (1H , δ) ⊂ H where δ = α max{dG (1G , k) : k ∈
K} + β. Let g1 , g2 ∈ G and suppose that g1−1 g2 ∈ K. Using (6.93) we de-
duce that dH (1H , ϕ(g1 )−1 ϕ(g2 )) = dH (ϕ(g1 ), ϕ(g2 )) ≤ αdG (g1 , g2 ) + β =
αdG (1G , g1−1 g2 ) + β ≤ δ, so that ϕ(g1 )−1 ϕ(g2 ) ∈ BSHH (1H , δ) = F . On the
other hand, let F ⊂ H be a ﬁnite set. Consider the ﬁnite set K = BSGG (1G , δ  )
where δ  = α max{dH (1H , f ) : f ∈ F } + αβ. Let g1 , g2 ∈ G and sup-
pose that ϕ(g1 )−1 ϕ(g2 ) ∈ F . From (6.93) it follows that dG (1G , g1−1 g2 ) =
dG (g1 , g2 ) ≤ αdH (ϕ(g1 ), ϕ(g2 )) + αβ = αdH (1H , ϕ(g1 )−1 ϕ(g2 )) + αβ ≤ δ  ,
so that g1−1 g2 ∈ BSGG (1G , δ  ) = K. This shows that ϕ is a quasi-isometric
embedding and the implication (b) ⇒ (a) follows.
Proposition 6.13.13. Let G and H be two ﬁnitely generated groups and
denote by dG and dH the word metric associated with two ﬁnite symmetric
generating subsets SG and SH for G and H respectively. Let ϕ : G → H be
an isometric embedding. Then the following conditions are equivalent:
(a) ϕ is a quasi-isometry;
(b) there exists δ > 0 such that for every h ∈ H there exists g ∈ G such that

                                      dH (ϕ(g), h) ≤ δ.                     (6.99)

Proof. Suppose that ϕ is a quasi-isometric embedding. Let C ⊂ H be a ﬁnite
subset such that H = ϕ(H)C and set δ = max{dH (1H , c) : c ∈ C}. Let
h ∈ H, then there exist c ∈ C and g ∈ G such that h = ϕ(g)c, that is,
ϕ(g)−1 h = c ∈ C. We deduce that dH (ϕ(g), h) ≤ δ and (6.99) follows. This
shows (a) ⇒ (b).
   Conversely, suppose (b) and set C = BSG (1G , δ) ⊂ G. Let h ∈ H. By (6.99)
there exists g ∈ G such that dH (ϕ(g), h) ≤ δ. It follows that ϕ(g)−1 h ∈ C,
equivalently h ∈ ϕ(g)C. This shows that H = ϕ(G)C. Therefore ϕ is a quasi-
isometry and (a) follows.
Proposition 6.13.14. Let G and H be two ﬁnitely generated groups. Suppose
that there is a quasi-isometric embedding ϕ : G → H. Then one has γ(G) 
γ(H).
Proof. By Remark 6.13.4, we can assume ϕ(1G ) = 1H . Denote by dG and dH
the word metric associated with two ﬁnite symmetric generating subsets SG
and SH for G and H respectively. By Proposition 6.13.12, there exist integers
α ≥ 1 and β ≥ 0 such that
          1
            dG (g, g  ) − β ≤ dH (ϕ(g), ϕ(g  )) ≤ αdG (g, g  ) + β      (6.100)
          α
210                                            6 Finitely Generated Amenable Groups

for all g, g  ∈ G. Note that the left inequality in (6.100) implies that ϕ(g) =
ϕ(g  ) whenever g, g  ∈ G satisfy dG (g, g  ) ≥ αβ+1. For n ∈ N, let BSGG (n) ⊂ G
(resp. BSHH (n) ⊂ H) denote the ball of radius n centered at 1G (resp. 1H ).
Choose a subset En ⊂ BSGG (n) of maximal cardinality such that dG (g, g  ) ≥
αβ + 1 for all g, g  ∈ En . Setting C = |BSGG (αβ + 1)|, we have

                                 |BSGG (n)| ≤ C|En |                         (6.101)

for all n ∈ N . Indeed, the balls of radius C centered at the elements of En
cover BSGG (n) by the maximality of En . Now observe that the images by ϕ of
the elements of En are all distinct and belong to BSHH (αn + β) by the right
inequality in (6.100). This implies that

                               |En | ≤ |BSHH (αn + β)|.

By using (6.101), we then deduce that

      |BSGG (n)| ≤ C|BSHH (αn + β)| ≤ C|BSHH (β)||BSHH (αn)| ≤ C  |BSHH (C  n)|

for all n ≥ 1, where C  = Cα|BSHH (β)|. It follows that γ(G)  γ(H).
Corollary 6.13.15. If two ﬁnitely generated groups are quasi-isometric, then
they have the same growth type.
Proof. If G and H are quasi-isometric ﬁnitely generated groups, then there
exist a quasi-isometric embedding from G into H and a quasi-isometric em-
bedding from H into G. It follows that γ(G)  γ(H) and γ(H)  γ(G). Thus
we have γ(G) = γ(H).
Corollary 6.13.16. Let G and H be two quasi-isometric ﬁnitely generated
groups. Then G has exponential (resp. subexponential, resp. polynomial, resp.
intermediate) growth if and only if H has exponential (resp. subexponential,
resp. polynomial, resp. intermediate) growth.
  An important property of quasi-isometric embeddings is the fact that every
quasi-isometric embedding is uniformly ﬁnite-to-one:
Proposition 6.13.17. Let G and H be two groups. Let ϕ : G → H be a
quasi-isometric embedding. Then there exists an integer M ≥ 1 such that
|ϕ−1 (h)| ≤ M for all h ∈ H.
Proof. Since ϕ is a quasi-isometric embedding, we can ﬁnd a ﬁnite set K ⊂ G
such that g1−1 g2 ∈ K whenever g1 , g2 ∈ G satisfy ϕ(g1 )−1 ϕ(g2 ) ∈ {1H }.
Let us set M = |K|. Let h ∈ H. Suppose that g0 ∈ ϕ−1 (h). Then, every
g ∈ ϕ−1 (h) satisﬁes ϕ(g0 )−1 ϕ(g) = h−1 h = 1H and therefore g0−1 g ∈ K.
Thus, we have ϕ−1 (h) ⊂ g0 K and hence |ϕ−1 (h)| ≤ |g0 K| = |K| = M .
Corollary 6.13.18. Let G and H be two groups. Suppose that there exists a
quasi-isometric embedding ϕ : G → H and that H is ﬁnite. Then G is ﬁnite.
6.13 Quasi-Isometries                                                           211

Proof. Taking M as in the preceding proposition, we have |G| ≤ M |H|.

Corollary 6.13.19. Let G and H be two groups. Suppose that H is ﬁnite.
Then G is quasi-isometric to H if and only if G is ﬁnite.

Proof. If G is ﬁnite then it is clear from the deﬁnition that any map from
G to H is a quasi-isometry. On the other hand, if G is quasi-isometric to H
then G is ﬁnite by Corollary 6.13.18.

Proposition 6.13.20. Let G and H be two groups. Suppose that there exists
a quasi-isometric embedding ϕ : G → H and that H is locally ﬁnite. Then G
is locally ﬁnite.

Proof. Let K be a ﬁnitely generated subgroup of G and let S ⊂ K be a ﬁnite
symmetric generating subset of K. Since ϕ is a quasi-isometric embedding,
we can ﬁnd a ﬁnite subset F ⊂ H such that ϕ(g1 )−1 ϕ(g2 ) ∈ F whenever
g1 , g2 ∈ G satisfy g1−1 g2 ∈ S. Let L denote the subgroup of H generated
by {ϕ(1G )} ∪ F . Suppose that k ∈ K. Since S is a symmetric generating
subset of K, there exist an integer n ≥ 0 and elements s1 , s2 , . . . , sn ∈ S
such that k = s1 s2 · · · sn . Consider the elements k0 , k1 , . . . , kn ∈ K deﬁned
by k0 = 1G and ki = ki−1 si for all 1 ≤ i ≤ n. Observe that kn = k and that
                                                  −1
ϕ(ki−1 )−1 ϕ(ki ) ∈ F , for all 1 ≤ i ≤ n, since ki−1 ki = si ∈ S. Thus, we have

   ϕ(k) = ϕ(1G )(ϕ(k0 )−1 ϕ(k1 ))(ϕ(k1 )−1 ϕ(k2 )) · · · (ϕ(kn−1 )−1 ϕ(kn )) ∈ L.

It follows that ϕ(K) ⊂ L. As H is locally ﬁnite, the subgroup L is ﬁnite.
On the other hand, it follows from Proposition 6.13.17 that there exists an
integer M ≥ 1 such that |ϕ−1 (h)| ≤ M for all h ∈ H. We deduce that
|K| ≤ M |L| < ∞. This shows that G is locally ﬁnite.

Corollary 6.13.21. Let G and H be two groups. Suppose that G and H are
quasi-isometric and that the group G is locally ﬁnite. Then H is locally ﬁnite.


Lemma 6.13.22. Let G be a group. Let E, Ω and C be three subsets of G.
Then, for every c0 ∈ C one has

                              ∂Ec0 (Ω) = ∂E (Ωc−1
                                               0 ).                         (6.102)

and
                               ∂EC (Ω) ⊃ ∂Ec0 (Ω).                           (6.103)
                                                                 
Proof. By (5.3) we have Ω +Ec0 = e∈E Ω(ec0 )−1 = e∈E Ωc−1                  0 e
                                                                               −1
                                                                                  =
    −1 +E                                               −Ec0
                                                                             −1
(Ωc0 )      and from (5.2) we deduce that Ω                    =   e∈E Ω(ec0 )    =
        −1 −1         −1 −E                                                 −Ec0
  e∈E Ωc 0  e   =  (Ωc 0  )     . It  follows  that  ∂ Ec0 (Ω)  = Ω +Ec0
                                                                         \ Ω      =
(Ωc−1
    0 )+E
           \ (Ωc −1 −E
                 0 )    =  ∂ E (Ωc  −1
                                    0   ). Similarly, we   have
212                                            6 Finitely Generated Amenable Groups
                !                  !                 !
      Ω +EC =         Ω(ec)−1 =         Ωc−1 e−1 ⊃         Ωc−1
                                                             0 e
                                                                 −1
                                                                    = (Ωc−1
                                                                         0 )
                                                                            +E

                e∈E               e∈E                e∈E
                c∈C               c∈C

and
                                                   
      Ω −EC =         Ω(ec)−1 =         Ωc−1 e−1 ⊂         Ωc−1
                                                             0 e
                                                                 −1
                                                                    = (Ωc−1
                                                                         0 )
                                                                            +E
                                                                               .
                e∈E               e∈E                e∈E
                c∈C               c∈C


We deduce that ∂EC (Ω) = Ω +EC \ Ω −EC ⊃ (Ωc−1        0 )
                                                         +E
                                                             \ (Ωc−10 )
                                                                       −E
                                                                          =
      −1
∂E (Ωc0 ) = ∂Ec0 (Ω), where the last equality follows from (6.102).

Theorem 6.13.23. Let G and H be two quasi-isometric groups. Suppose that
H is amenable. Then G is amenable.

Proof. Let ϕ : G → H be a quasi-isometry and let C ⊂ H be a ﬁnite set such
that                                   !
                        H = ϕ(G)C =       ϕ(G)c.                   (6.104)
                                              c∈C

   Let EG ⊂ G be a ﬁnite set and ε > 0. Let us show that there exists a ﬁnite
set FG ⊂ G such that
                            |∂EG (FG )| < ε|FG |.                     (6.105)
                                                                
Since ϕ is a quasi-isometric embedding, we can ﬁnd a ﬁnite set EH ⊂ H such
that
                      g1−1 g2 ∈ EG ⇒ ϕ(g1 )−1 ϕ(g2 ) ∈ EH
                                                        
                                                                    (6.106)
                                       
for all g1 , g2 ∈ G. We then set EH = EH C. Also, by Proposition 6.13.17 we
can ﬁnd an integer M ≥ 1 such that

                                  |ϕ−1 (F )| ≤ M |F |                          (6.107)

for all ﬁnite sets F ⊂ H. Since H is amenable, it follows from Corollary 5.4.5
                                  
that we can ﬁnd a ﬁnite subset FH    ⊂ H such that

                                             ε
                            |∂EH (FH )| <         |F  |.                      (6.108)
                                             M |C| H

By (6.104) we can ﬁnd c0 ∈ C such that
                                    −1
                                  FH c0 ∩ ϕ(G) = ∅                            (6.109)

and
                           −1             −1
                        |FH c ∩ ϕ(G)| ≤ |FH c0 ∩ ϕ(G)|                         (6.110)
                              −1                            −1
for all c ∈ C. Set FH =     FH ⊂ H and FG = ϕ
                               c0                                 (FH ) ⊂ G. Note that
FG = ∅ by (6.109). Then we have

                           ϕ(FG ) = FH ∩ ϕ(G) ⊂ FH                             (6.111)
6.13 Quasi-Isometries                                                     213

and
                                  ϕ(G \ FG ) ⊂ H \ FH .               (6.112)
Moreover,
                               
                            |FH  | ≤ |C| · |FG |.                  (6.113)
                                       
                                                 
Indeed, from (6.104) we deduce that FH    = c∈C (FH ∩ ϕ(G)c) so that

                                   
                |FH |≤            |FH ∩ ϕ(G)c|
                            c∈C

                                     −1
                        =         |FH c ∩ ϕ(G)|
                            c∈C

                                     −1
                        ≤         |FH c0 ∩ ϕ(G)| (by (6.110))
                            c∈C

                        = |C| · |FH ∩ ϕ(G)|
                        ≤ |C| · |FG | (by the equality in (6.111)).

Let us show that the set FG ⊂ G has the required property. Suppose that
g ∈ ∂EG (FG ). This means that the set gEG meets both FG and G \ FG . Thus,
there exist g1 ∈ FG and g2 ∈ G \ FG such that g −1 g1 ∈ EG and g −1 g2 ∈ EG .
This implies ϕ(g)−1 ϕ(g1 ) ∈ EH
                              
                                and ϕ(g)−1 ϕ(g2 ) ∈ EH
                                                        by applying (6.106).
As ϕ(g1 ) ∈ FH (by (6.111)) and ϕ(g2 ) ∈ H \ FH (by (6.112)), we deduce
                    
that the set ϕ(g)EH   meets both FH and H \ FH . In other words, we have
ϕ(g) ∈ ∂EH (FH ). This shows that



                             ∂EG (FG ) ⊂ ϕ−1 (∂EH
                                                 (FH )).             (6.114)

By taking cardinalities, we ﬁnally get

                  |∂EG (FG )| ≤ |ϕ−1 (∂EH
                                         (FH ))| (by (6.114))



                                  ≤ M |∂EH
                                          (FH )| (by (6.107))


                                                
                                  = M |∂EH
                                          c (F
                                            0   H )| (by (6.102))
                                             
                                  ≤ M |∂EH (FH )| (by (6.103))
                                       ε
                                  ≤      |F  | (by (6.108))
                                      |C| H
                                  ≤ ε|FG | (by (6.113)).

This shows that FG satisﬁes (6.105). From Corollary 5.4.5 we deduce that G
is amenable.
214                                        6 Finitely Generated Amenable Groups

Notes

The idea of looking at a ﬁnitely generated group with a geometer’s eye by
investigating the properties of the family consisting of all its word metrics
is due to M. Gromov ([Gro1, Gro3, Gro4]) and gave birth to the ﬂourishing
branch of mathematics which is commonly known as geometric group theory
in the late 1970s.
   In the 1950s, the notion of growth of a ﬁnitely generated group arose in
group theory in relation to volume growth in Riemannian manifolds. This
line of study was initiated by V.A. Efremovich [Efr] and A.S. Švarc [Sva]
in the USSR and, slightly later and completely independently, by J. Milnor
[Mil1] and J.A. Wolf [Wol] in the USA. In [Mil1] Milnor proved that funda-
mental groups of closed Riemannian manifolds with negative sectional curva-
ture have exponential growth. Wolf [Wol] proved that a polycyclic group has
polynomial growth if it contains a nilpotent subgroup of ﬁnite index and has
exponential growth otherwise. Then, Milnor [Mil2] proved that every ﬁnitely
generated non-polycyclic solvable group has exponential growth. Finally, in
1972 H. Bass [Bas] showed that the growth of a nilpotent group G with a
ﬁnite symmetric generating subset S is exactly polynomial in the sense that
there are positive constants C1 and C2 such that C1 nd ≤ γS (n) ≤ C2 nd , for
all n ≥ 1, where d = d(G) ≥ 0 is an integer which can be computed explicitly
from the lower central series of G (see [Har1, page 201] for more informa-
tion on the history and prehistory of these results). Note that the growth
estimates of Milnor and Bass imply that a ﬁnitely generated solvable group
has either polynomial or exponential growth. It was shown by J. Tits [Tits]
(see also [Har1]) that every ﬁnitely generated linear group either is virtually
nilpotent or contains a free subgroup of rank two. This last result, which is
known as the Tits alternative for linear groups, implies that every ﬁnitely
generated linear group has either polynomial growth or exponential growth.
    The problem of the characterization of ﬁnitely generated groups with poly-
nomial growth remained open until Gromov proved in [Gro2] that a ﬁnitely
generated group with polynomial growth contains a nilpotent subgroup of
ﬁnite index. It follows from the above mentioned result of Bass and Proposi-
tion 6.6.6 that a group of polynomial growth has in fact exactly polynomial
growth. Thus, for ﬁnitely generated groups, the notions of polynomial and
exactly polynomial growth coincide.
    The (general) Burnside problem, posed by W. Burnside in 1902, asked
whether a ﬁnitely generated periodic group is necessarily ﬁnite. It was an-
swered in the negative in 1964 by E.S. Golod and I.R. Shafarevich [GolS],
who gave an example of a ﬁnitely generated inﬁnite p-group. The Grigorchuk
group, also known as the ﬁrst Grigorchuk group, was originally constructed
by R. I. Grigorchuk in 1980 [Gri2] as a new example of a ﬁnitely gener-
ated inﬁnite periodic group, thus providing another counterexample to the
general Burnside problem. In 1984 Grigorchuk [Gri4] proved that this group
has intermediate growth (this was announced by Grigorchuk in 1983 [Gri3]),
Notes                                                                                 215

thus providing a positive answer to the Milnor problem, posed by Milnor
in 1968, about the existence of ﬁnitely generated groups of intermediate
growth. More
           √         precisely, in [Gri4] Grigorchuk proved, among other things,
that exp( n)  γ(G)  exp(ns ), where s = log32 (31) ≈ 0.991. The Grig-
orchuk group also provides the ﬁrst example of an amenable but not ele-
mentary amenable group (the class of elementary amenable groups is the
smallest class of groups containing all ﬁnite and all abelian groups that is
closed under taking subgroups, quotients, extensions, and directed unions),
thus answering a question posed by Day in 1957 [Day1]. Among other inter-
esting properties of the Grigorchuk group G, we mention the following (see
[CMS2], [Har2], [Gri5], [GriP]): (a) G is not ﬁnitely presented (a recursive
set of deﬁning relations for G was found by I.G. Lysënok [Lys]), (b) G is just
inﬁnite (it is inﬁnite but every proper quotient is ﬁnite), (c) G has solvable
word problem, that is, there exists an algorithm that establishes whether,
given s1 , s2 , . . . , sn ∈ {a, b, c, d}, one has s1 s2 · · · sn = 1G or not. Originally,
the Grigorchuk group was deﬁned as a group of Lebesgue measure-preserving
transformations of the unit interval. By representing the elements of Σ ∗ as
the vertices of an inﬁnite binary rooted tree, the Grigorchik group may be also
realized as a subgroup of the full automorphism group of the tree. Another
description of this group was provided by regarding it as a group generated
by a ﬁnite automaton (see [GriNS]).
   Simple random walks on groups were ﬁrst considered by H. Kesten in
[Kes1]. Given a ﬁnitely generated group G and a ﬁnite symmetric generating
subset S ⊂ G, the simple random walk on G relative to S is the G-invariant
Markov chain with state space G and transition probabilities given by
                                           
                                              1
                                                  if g −1 h ∈ S
                               p(g, h) = |S|
                                             0    otherwise.

This can be interpreted as follows: a “random walker” on G moves from a
group element g with equal probability to one of its |S| neighbors gs, where
s ∈ S. For g, h ∈ G, denote by p(n) (g, h) the probability of reaching h from
g after exactly n steps. We then have p(0) (g, h) = δg,h where δg,h is the
Kronecker symbol, p(1) (g, h) = p(g, h) and, more generally,

                        p(n) (g, h) =         p(n−1) (g, k)p(k, h).
                                        k∈G


The quantity p(n) (g, g) does not depend on g ∈ G and is called the return
probability after n steps. The number
                                          .
                        ρ(G, S) = lim sup n p(n) (g, g)            (6.115)
                                         n→∞

is called the spectral radius of the simple random walk on G relative to S.
Kesten [Kes1, Kes2] proved that one always has
216                                         6 Finitely Generated Amenable Groups
                            *
                           2 |S| − 1
                                     ≤ ρ(G, S) ≤ 1
                              |S|

with equality on the right if and only if G is amenable. Moreover, if S contains
no involutions, equality on the left holds if and only if G is a free group
and S is the symmetrization of a free base. Theorem 6.12.9 is just an 2 -
reformulation of the amenability criterion of Kesten’s theorem. Kesten also
proved that if S is a ﬁnite symmetric generating subset of a group G and
N ⊂ G is a normal subgroup, then, denoting by G = G/N (resp S ⊂ G) the
corresponding quotient group (resp. generating subset of G) then ρ(G, S) ≤
ρ(G, S) with equality if and only if N is amenable.
   Day [Day3] extended Kesten’s amenability criterion to non symmetric ran-
dom walks. The associated Markov chain is then determined by a probability
density whose support generates the group. In this setting, the associated
Markov operator on 2 (G) is no more self-adjoint, in general. The key ingre-
dient of this new proof is the uniform convexity (uniform rotundity in Day’s
terminology) of Hilbert spaces (cf. Lemma I.4.2) and more generally of p -
spaces with p > 1 (note that in fact Day considers, more generally, Markov
operators on the Banach spaces p (G), for p > 1). For more on this we refer to
the paper [KaV] by V.A. Kaimanovich and A.M. Vershik and to W. Woess’
review [Woe1] and monograph [Woe2].
   Another important criterion for amenability of ﬁnitely generated groups
has been obtained by R.I. Grigorchuk [Gri1]. Let G be a group with m genera-
tors. Then G is isomorphic to F/N where F is the free group on m generators
and N ⊂ F is a normal subgroup. Let α = α(G; F, N ) be deﬁned by setting
                                           *
                               α = lim sup n w(n),
                                   n→∞

where w(n) equals the number of elements in N at distance at most n from
the identity element 1F in the free group F . The non-negative number α is
called the cogrowth of G relative to the presentation G = F ; N . Grigorchuk
[Gri1] proved that either α = 1 (this holds if and only if N = {1F }) or
                          √
                             2m − 1 ≤ α ≤ 2m − 1.                       (6.116)

He also showed that if ρ = ρ(G, S) is the spectral radius of the simple random
walk on G relative to S (the symmetrization of the image of a free base of
F under the canonical quotient homomorphism F → G = F/N ), then the
following relation holds:
        ⎧√                                          √
        ⎨ 2m−1
             m                           if 1 ≤ α ≤ 2m − 1
    ρ= √          (√                )       √                            (6.117)
        ⎩ 2m−1       2m−1
                          +  √ α         if 2m − 1 ≤ α ≤ 2m − 1.
            2m        α       2m−1

Then, from (6.117) and Kesten’s criterion he deduced that in (6.116) equality
holds on the right if and only if G is amenable. This is called the Grigorchuk
Exercises                                                                                 217

criterion (or the cogrowth criterion) of amenability. Grigorchuk’s criterion
was used by Ol’shanskii [Ols] to show the existence of non-amenable groups
without non-abelian free subgroups and by Adyan [Ady] to show that the
free Burnside groups B(m, n), with m ≥ 2 generators and exponent n ≥ 665
odd, are non-amenable.
   The program of the classiﬁcation of all ﬁnitely generated groups up to
quasi-isometries was posed and initiated by Gromov [Gro4]. The deﬁnition
of quasi-isometry presented here is modeled after Y. Shalom [Sha].



Exercises

6.1. Let S = {s1 , s2 , . . . , sn } be a ﬁnite subset of Z. Show that S generates
Z if and only if gcd(s1 , s2 , . . . , sn ) = 1.
6.2. Let G be a ﬁnitely generated group and let S be a ﬁnite symmetric
generating subset of G. Let x ∈ G and denote by Lx , Rx : G → G the maps
deﬁned by Lx (g) = xg and Rx (g) = gx for all g ∈ G.
   (a) Show that the map g → dS (g, Rx (g)) is constant on G.
   (b) Show that if x is in the center of G, then Rx is an isometry of (G, dS ).
   (c) Show that supg∈G dS (g, Lx (g)) < ∞ if and only if the conjugacy class
of x in G is ﬁnite.
6.3. Suppose that S and S  are two ﬁnite symmetric generating subsets of a
group G with S ⊂ S  . Show that one has: (i) S (g) ≥ S  (g) and dS (g, h) ≥
dS  (g, h) for all g, h ∈ G; (ii) BS (n) ⊂ BS  (n) and γS (n) ≤ γS  (n) for all
n ∈ N; (iii) λS ≤ λS  .
6.4. Let G1 and G2 be two ﬁnitely generated groups and let G = G1 ×G2 . Let
S1 (resp. S2 ) be a ﬁnite symmetric generating subset of G1 (resp. G2 ). Show
that S = (S1 × {1G2 }) ∪ ({1G1 } × S2 ) is a ﬁnite symmetric generating subset
                         S (g) = S1 (g1 ) + S2 (g2 ) for all g = (g1 , g2 ) ∈ G.
                                  G1          G2
of G and that one has G
6.5. Let S1 and S2 be two sets. For i = 1, 2, let Qi = (Qi , Ei ) be an Si -
labeled graph. We deﬁne their direct product Q1 × Q2 as the S-labeled graph
Q = (Q, E) with:
                              
(1) S = S1 S2 , where               denotes the disjoint union;
(2) Q = Q1 × Q2 ;
(3) E = {((q1 , q2 ), s, (q1 , q2 )) : either q1 = q1 and (q2 , s, q2 ) ∈ E2 , or q2 = q2
    and (q1 , s, q1 ) ∈ E1 }.
   Suppose that S1 (resp. S2 ) is endowed with an involution ι1 : S1 → S1
(resp. ι2 : S2 → S2 ) and that Q1 (resp. Q2 ) is edge-symmetric with respect
to such involution. Denote by ι : S → S the map deﬁned by ι(s) = ιi (s) if
s ∈ Si , i = 1, 2, and observe that ι is an involution. Show that Q is edge-
symmetric with respect to ι.
218                                                    6 Finitely Generated Amenable Groups

6.6. Let G1 and G2 be two ﬁnitely generated groups and let S1 ⊂ G1 and
S2 ⊂ G2 be two ﬁnite and symmetric generating subsets such that 1G1 ∈       / S1
and 1G2 ∈ / S2 . Consider the direct product group G = G1 × G2 together with
the (ﬁnite and symmetric) generating subset S = (S1 ×{1G2 })∪({1G1 }×S2 ).
Denote by CS1 (G1 ), CS2 (G2 ) and CS (G) the corresponding Cayley graphs. If
we identify S1 with S1 × {1G2 } (resp. S2 with {1G1 } × S2 ), we may regard
CS1 (G1 ) (resp. CS2 (G2 )) as an (S1 ×{1G2 })-labeled graph (resp. ({1G1 }×S2 )-
labeled graph). Show that CS (G) = CS1 (G1 ) × CS2 (G2 ).

6.7. Let G = Z, S = {1, −1} and S  = {2, −2, 3, −3}. Find the best possible
positive constants C1 and C2 such that C1 S (g) ≤ S  (g) ≤ C2 S (g) for all
g ∈ G. Hint: Check that C1 = 1/3 and C2 = 2.

6.8. Let G = Zm , where m ≥ 1 is an integer. Consider the ﬁnite and sym-
metric generating subset

      S = {±(1, 0, 0, . . . , 0), ±(0, 1, 0, . . . , 0), . . . , ±(0, 0, . . . , 0, 1)} ⊂ Zm .

   (a) Show that if g = (a1 , a2 , . . . , am ) ∈ Zm then S (g) = |a1 | + |a2 | + · · · +
|am |.
   (b) Let n ∈ N. Set P0 (n) = 1 and, for all integers t ≥ 1 denote by Pt (n)
the number of distinct t-tuples (a1 , a2 , . . . , at ) of positive integers such that
a1 + a2 + · · · + at ≤ n. Show that Pt (n) = nt for 1 ≤ t ≤ n. Hint: The map
(a1 , a2 , . . . , at ) → {a1 , a1 + a2 , . . . , a1 + a2 + · · · + at } establishes a bijection
between the set {(a1 , a2 , . . . , at ) ∈ Nt : ai ≥ 1 and a1 + a2 + · · · + at ≤ n}
and the set of all subsets of cardinality t of the set {1, 2, . . . , n}.
   (c) For n, t ∈ N and t ≥           1 denote by Nt (n) the number of all m-tuples
                                            m
(a1 , a2 , . . . , am ) ∈ Zm with          i=1 |ai | ≤ n and exactly t many of the ai ’s
nonzero. Show that γSZ (n) = t=0 Nt (n).
                                 m             m

   (d) Let 0 ≤ t ≤ n and let I be a subset of {1, 2, . . . , n} such that |I| = t.
Show that there are precisely Pt (n) distinct elements g = (a1 , a2 , . . . , am ) ∈
Nm with I = {i : ai > 0} and such that S (g) ≤ n.
   (e) Deduce from (d) that there are exactly m                t
                                                                    n
                                                                    t elements g = (a1 , a2 , . . . ,
am ) ∈ Nm with |{i : ai > 0}| = t such that S (g) ≤ n.
   (f) Deduce from (e) that Nt (n) = 2t m                t
                                                            n
                                                            t .
                                                      Zm            m
   (g) Deduce from (f) and (c) that γS (n) = t=0 2t m                       t
                                                                               n
                                                                               t .

6.9. Suppose that γ, γ  : N → [0,
                               * +∞) are two growth* functions such that
γ  γ  . Show that lim supn→∞ n γ(n) ≤ lim supn→∞ n γ  (n).

6.10. Let α = 21 11 ∈ SL2 (Z). Consider the metabelian group G = Z2 α Z,
that is, the semidirect product of Z2 by the inﬁnite cyclic subgroup of SL2 (Z)
generated by α. Recall that
                                                  
                                  x
                        G=            , z : x, y, z ∈ Z
                                  y
Exercises                                                                        219

with the multiplication deﬁned by
                                              
           x1            x2          x1    z1 x2
                 , z1        , z2 =     +α       , z1 + z2
            y1           y2          y1       y2

for all x1 , x2 , y1 , y2 , z1 , z2 ∈ Z.
   (a) Show that αn 10 = f2n+1             f2n   for all n ∈ N, where (fk )k∈N is the
Fibonacci sequence which is inductively deﬁned by f0 = 0, f1 = 1, and
fk = fk−2 + fk−1 for all k ≥ 2.
   (b) Deduce from (a) that, for any integer n ≥ 1, the set
                    n                                                  +
                                   i−1 1
       A(n) =                 ui α           , 0 : ui ∈ {0, 1} for 1 ≤ i ≤ n ⊂ G
                                         0
                   i=1

has cardinality |A(n)| = 2n .
  (c) Consider the subset S ⊂ G deﬁned by S = {a, b, c, a−1 , b−1 , c−1 }, where
                                             
                    1              0                    0
             a=         ,0 ,b =      , 0 and c =           ,1 .
                    0              1                    0

Show that S is a ﬁnite symmetric generating subset of G and that one has
A(n) ⊂ BSG (3n − 2) for all n ≥ 1.
  (d) Deduce from (b) and (c) that G has exponential growth.

6.11. Let n ≥ 2. Show that GLn (Z) is a ﬁnitely generated group of exponen-
tial growth. Hint: Use Exercise 2.18, Lemma 2.3.2 and Corollary 6.6.5.

6.12. Let F2 denote the free group of rank two. Show that the groups GL2 (Z)
and F2 are commensurable. Hint: Use elementary row operations to show that
the matrices 10 21 and 12 01 generate a ﬁnite index subgroup of GL2 (Z) and
apply Lemma 2.3.2.

6.13. Growth of the Baumslag-Solitar group BS(1, m). Let m be an integer
such that |m| ≥ 2. Prove that the metabelian group G = a, b : aba−1 =
bm  studied in Exercises 2.7 and 4.21 has exponential growth. Hint: Use
an argument similar to the one used for the case m = 2 in the proof of
Proposition 6.7.1. More precisely, take S = {a, b, a−1 , b−1 } and prove that
every element of the form g = bk , where 0 ≤ k ≤ |m|n − 1 and n ≥ 1, has
word length S (g) ≤ |m|n + n − 2 by developing k in base |m|.

6.14. Aﬃne representation of the Baumslag-Solitar group BS(1, m). Let m
be an integer such that |m| ≥ 2. Consider the group G given by the presen-
tation G = a, b : aba−1 = bm  (cf. Exercises 2.7, 4.21 and 6.13).
   (a) Let α, β : R → R be the maps respectively deﬁned by α(x) = mx and
β(x) = x + 1 fro all x ∈ R. Show that there is a unique homomorphism
ϕ : G → Sym(R) satisfying ϕ(a) = α and ϕ(b) = β.
220                                              6 Finitely Generated Amenable Groups

  (b) Show that ϕ is injective. Hint: Use Exercise 2.7(a).
  (c) Let n0 be an integer such that |m|n0 ≥ 3. Consider the elements λ, μ ∈
Sym(R) respectively deﬁned by λ = α−n0 and μ = βλβ −1 . Check that the
open intervals i = (−1/2, 1/2) and J = (1/2, 3/2) satisfy λ(J) ⊂ I and
μ(I) ⊂ J.
  (d) Let n ≥ 1 be an integer and let σ1 , σ2 , . . . , σn ∈ {λ, μ}. Prove that

                                 σ1 σ2 · · · σn = IdR .

Hint: Use (c) and play ping-pong as in the proof of Theorem D.5.1.
  (e) Use (a), (b) and (d) to get another proof of the fact that G has expo-
nential growth.

6.15. Growth of the lamplighter group. Let L = (Z/2Z)  Z denote the lamp-
lighter group (cf. Exercise 4.19). Recall that L is the semidirect product of
a normal subgroup H = ⊕n∈Z An , where each An is a subgroup of order 2,
with an inﬁnite cyclic subgroup N generated by an element t which satisﬁes
tat−1 = (an−1 )n∈Z for all a = (an )n∈Z ∈ H. Let s denote the nontrivial
element of A0 .
   (a) Show that S = {s, t, t−1 } is a symmetric generating subset of L.
   (b) For n ≥ 1, let Bn = ⊕n−1   k=0 Ak . Prove that Bn is a subgroup of H
generated by the elements s, tst−1 , t2 st−2 , . . . , tn−1 st−n+1 and that |Bn | = 2n .
   (c) Deduce from (b) that 2n ≤ γSL (3n − 2) for all n ≥ 1.
   (d) Deduce from (c) that L has exponential growth.

6.16. Growth of the integral Heisenberg group. Let G = HZ denote the Heisen-
berg group over the ring of integers (cf. Example 4.6.5). Recall that G is the
subgroup of SL3 (Z) consisting of all matrices of the form
                                 ⎛       ⎞
                                   1yz
                   M (x, y, z) = ⎝0 1 x⎠ (x, y, z ∈ Z).
                                   001

Let us set A = M (1, 0, 0), B = M (0, 1, 0), C = M (0, 0, 1), and S =
{A, A−1 , B, B −1 , C, C −1 }.
    (a) Verify that M (x, y, z) = Ax B y C z for all x, y, z ∈ Z.
    (b) Show that S is a ﬁnite symmetric generating subset of G.
    (c) Show that C x Ay = Ay C x , C x B y = B y C x , and B x Ay = Ay B x C xy for
all x, y, z ∈ Z.
    (d) Deduce from (c) that if P ∈ G satisﬁes S (P ) ≤ n, then there exist
x, y, z ∈ Z with |x| ≤ n, |y| ≤ n, and |z| ≤ n2 + n, such that P = Ax B y C z .
    (e) Deduce from (d) that there exists a constant C1 > 0 such that γS (n) ≤
C1 n4 for all n ≥ 1.
    (f) Let n, x, y, z be integers such that 0 ≤ x ≤ n, 0 ≤ y ≤ n, and 0 ≤ z ≤
n2 . Show that there exist integers q, r with 0 ≤ q ≤ n and 0 ≤ r ≤ n − 1 such
that
Exercises                                                                           221

                         Ax B y C z = Ax−q B n Aq B y−n C r .
Hint: Use (c) and Euclidean division of z by n.
   (g) Deduce from (f) that γS (5n) ≥ (n + 1)2 (n2 + 1) for all n ≥ 0.
   (h) Deduce from (g) that there exists a constant C2 > 0 such that γS (n) ≥
C2 n4 for all n ≥ 0.
   (i) Deduce from (e) and (h) that γ(G) ∼ n4 .

6.17. Let G be the Grigorchuk group.
   (a) Show that G acts transitively on Σ n for all n ∈ N. Hint: Use induction
on n. More precisely, let w1 , w2 ∈ Σ n and suppose ﬁrst that w1 and w2 start
with the same letter, that is, there exist x ∈ Σ and u1 , u2 ∈ Σ n−1 such that
w1 = xu1 and w2 = xu2 . Use induction and Proposition 6.9.7(i). Otherwise,
if w1 and w2 do not start with the same letter, observe that w1 and a(w2 )
do start with the same letter and reduce to the previous case.
   (b) Use (a) to recover the fact that G is inﬁnite (cf. Theorem 6.9.8).

6.18. Let K1 = Z/2Z = {0, 1} and, for n ≥ 2, deﬁne by induction Kn =
Kn−1  (Z/2Z). Recall that Kn−1  (Z/2Z) = (Kn−1 )Z/2Z  (Z/2Z), so that Kn
consists of the elements (f, a) ∈ (Kn−1 )Z/2Z × (Z/2Z) with the multiplication
deﬁned by (f1 , a1 )(f2 , a2 ) = (f1 f2a1 , a1 + a2 ), for all f1 , f2 ∈ (Kn−1 )Z/2Z and
a1 , a2 ∈ Z/2Z, where f a (a ) = f (a + a ) ∈ Kn−1 for all f ∈ (Kn−1 )Z/2Z and
a, a ∈ Z/2Z. The group Kn is called the Kaloujnine 2-group of degree n. Set
Σ = {0, 1}. For n = 1 and x ∈ Σ, we set 1(x) = 1 − x, and 0(x) = x. For
n ≥ 2 let g = (f, a) ∈ Kn and w = xu ∈ Σ n , where x ∈ Σ and u ∈ Σ n−1 .
We then set g(w) = a(x)f (x)(u) ∈ Σ n (note that a(x) ∈ Σ, f (x) ∈ Kn−1 ,
and f (x)(u) ∈ Σ n−1 is deﬁned by induction).
    (a) Show that the map Kn × Σ n  (g, w) → g(w) ∈ Σ n deﬁnes an action
of the group Kn on Σ n .
    (b) Show that this action is faithful.
    (c) By virtue of (b), we may regard Kn as a subgroup of Sym(Σ n ). Show,
by simple counting arguments, that Kn is a Sylow 2-subgroup of Sym(Σ n ).
    (d) Consider the elements g1,n , g2,n , . . . , gn,n ∈ Kn deﬁned by induction
as follows. First deﬁne g1,1 = 1 ∈ K1 = Z/2Z and then, for 1 ≤ m ≤ n,
set g1,m = (f1,m , 1) ∈ Km , where f1,m : Z/2Z → Km−1 is given by
f1,m (a) = 1Km−1 for all a ∈ Z/2Z. Finally, for 2 ≤ k ≤ m ≤ n, set gk,m =
(fk,m , 0) ∈ Km , where fk,m : Z/2Z → Km−1 is given by fk,m (0) = gk−1,m−1
and fk,m (1) = (f1,m−1 , 0). Show that g1,n , g2,n , . . . , gn,n generate Kn and ver-
ify that gi,n (uxv) = u(1 − x)v ∈ Σ n for all u ∈ Σ i−1 , x ∈ Σ and v ∈ Σ n−i .
    (e) Deﬁne a map πn : Kn → (Z/2Z)n by induction as follows. π1 : K1 =
Z/2Z → Z/2Z    is the identity map, while, for n ≥ 2 and (f, a) ∈ Kn we set
πn (f, a) = ( b∈(Z/2Z) πn−1 (f (b)), a) ∈ (Z/2Z)n−1 ×(Z/2Z) = (Z/2Z)n for all
f ∈ (Kn−1 )Z/2Z and a ∈ Z/2Z. Show that πn is a surjective homomorphism.
Hint:  To prove that πn is a homomorphism
                                                    use induction on n and the fact
that b∈(Z/2Z) πn−1 (f a (b)) = b∈(Z/2Z) πn−1 (f (b)) for all f ∈ (Kn−1 )Z/2Z
222                                              6 Finitely Generated Amenable Groups

and a ∈ Z/2Z. To show surjectivity, look at the πn -images of the elements
g1,n , g2,n , . . . , gn,n ∈ Kn deﬁned in (d).
     (f) Deduce from (e) that Kn /[Kn , Kn ] (the abelianization of Kn ) is iso-
morphic to (Z/2Z)n .
     (g) Consider the map Φn : Σ n → {1, 2, . . . , 2n } given by expansion in
base two, that is, Φn (i1 , i2 , . . . , in ) = i1 + 2i2 + 4i3 + · · · + 2n−1 in , for all
i1 , i2 , . . . , in ∈ Σ. Verify that, modulo the map Φ3 , one has g1,3 = (1 5)(2 6) ×
(3 7)(4 8), g2,3 = (1 3)(2 4), and g3,3 = (1 2).

6.19. Let G be the Grigorchuk group.
   (a) Consider the homomorphism Ψ3 : G → Sym(8) deﬁned by Ψ3 (g) =
g|Σ 3 (observe that the map Ψ3 is well deﬁned since (g(w)) = (w) for all
w ∈ Σ ∗ and g ∈ G). With the notation from Exercise 6.18(f), verify that
Ψ3 (a) = (1 5)(2 6)(3 7)(4 8), Ψ3 (b) = (1 3)(2 4)(5 6), Ψ3 (c) = (1 3)(2 4) and
Ψ3 (d) = (5 6).
   (b) Deduce from (a) and Exercise 6.18(e) that Ψ3 (G) = K3 , where K3 ⊂
Sym(8) is the Kaloujnine group (cf. Exercise 6.18).
   (c) By applying Proposition 6.9.3, deduce from (b) and Exercise 6.18(e)
that G/[G, G] (the abelianization of G) is isomorphic to (Z/2Z) × (Z/2Z) ×
(Z/2Z).

6.20. The word problem for the Grigorchuk group. Let G be the Grigorchuk
group. Describe an algorithm which, given any word w ∈ {a, b, c, d}∗ , deter-
mines whether w represents the identity element 1G or not. Hint: Given a
word w, ﬁrst count the number a (w) of occurrences of the letter a in w.
Prove that if a (w) is odd then w does not represent 1G . If a (w) is even, use
the maps φ0 , φ1 : H1 → G and apply induction on the length of the word w.

6.21. Let us say that a net (xi )i∈I in a set X converges to inﬁnity if, for
every ﬁnite subset F ⊂ X, there exists an element i0 ∈ I such that xi ∈    /F
for all i ≥ i0 . Let ϕ : G → H be a map from a group G into a group H.
Show that ϕ is a quasi-isometric embedding if and only if it satisﬁes the
following condition: for any two nets (ui )i∈I and (vi )i∈I in G having the
same index set, the net (u−1  i vi )i∈I converges to inﬁnity in G if and only if
the net (ϕ(ui )−1 ϕ(vi ))i∈I converges to inﬁnity in H.

6.22. Let G be a group and let E(G) denote the set consisting of all quasi-
isometries ϕ : G → G. Deﬁne a binary relation ∼ in E(G) by declaring that
ϕ1 and ϕ2 ∈ E(G) satisfy ϕ1 ∼ ϕ2 if and only if there exists a ﬁnite subset
F ⊂ G such that ϕ1 (g)−1 ϕ2 (g) ∈ F for all g ∈ G.
   (a) Show that ∼ is an equivalence relation in E(G).
   (b) Show that if ϕ ∈ E(G) then there exists ψ ∈ E(G) such that ϕ ◦ ψ ∼
IdG and ψ ◦ ϕ ∼ IdG .
   (b) Show that the composition of maps in E(G) is compatible with ∼ and
induces a group structure on the quotient set QI(G) = E(G)/ ∼.
   (c) Show that if G is a ﬁnite group then the group QI(G) is trivial.
Exercises                                                                    223

   (d) Show that the group QI(Z) contains a subgroup isomorphic to R×Z/2Z
and is therefore uncountable. Hint: Prove that the map ϕλ : Z → Z deﬁned
by ϕλ (x) = [λx], where λ ∈ R \ {0} and [α] denotes the integral part of α,
that is, the largest integer n such that n ≤ α, is a quasi-isometry and that
one has fλ1 ∼ fλ2 if and only if λ1 = λ2 .
   (e) Show that if G and H are quasi-isometric groups then the groups QI(G)
and QI(H) are isomorphic.

6.23. Let A be a set and let G = (Q, E) be a ﬁnite A-labeled graph. Denote
by λ : E → A the labeling map deﬁned by λ(e) = a for every edge e =
(q, a, q  ) ∈ E. A bi-inﬁnite path in G is a sequence π = (en )n∈Z of edges
en = (qn , an , qn ) ∈ E such that qn = qn+1 for all n ∈ Z. We deﬁne the label
of a bi-inﬁnite path π = (en )n∈Z as being the element λ(π) ∈ AZ given by
λ(π)(n) = λ(en ) for all n ∈ Z.
   (a) Denote by X G the set of the labels λ(π) of all bi-inﬁnite paths π in
G. Show that X G is a subshift of AZ . It is called the subshift deﬁned by the
A-labeled graph G.
   (b) Show that if G is connected then the subshift X G is irreducible.

6.24. Let A = {0, 1} and consider the A-labeled graphs G1 and in G2 in
Fig. 6.18. Check that the associated subshifts X G1 and X G2 are the even
subshift (cf. Exercise 1.38) and the golden mean subshift (cf. Exercise 1.39)
respectively.




Fig. 6.18 The A-labeled graphs G1 and G2



6.25. Let A be a set and let X ⊂ AZ be a subshift of ﬁnite type. Let M
be a positive integer such that {1, 2, . . . , M } ⊂ Z is a memory set for X.
Consider the A-labeled graph G = G(X, M ) = (Q, E) deﬁned as follows:
Q = LM −1 (X) is the set of all X-admissible words of length M − 1, and the
edge set E consists of all triples e = (aw, a, wa ) ∈ Q × A × Q, where a, a ∈ A
and w ∈ AM −2 are such that awa ∈ LM (X).
   (a) Check that X G = X.
   (b) Show that X is irreducible if and only if G is connected (cf. Exer-
cise 6.23).

6.26. Let A be a set and let X ⊂ AZ be a subshift of ﬁnite type. Let also
τ : AZ → AZ be a cellular automaton. Let M be a positive integer such that
{1, 2, . . . , M } ⊂ Z is a memory set for both X and τ , and let μ : AM → A
denote the corresponding local deﬁning map for τ . Consider the A-labeled
224                                              6 Finitely Generated Amenable Groups

graph G = G(X, τ, M ) = (Q, E), where Q = LM −1 (X) is the set of all X-
admissible words of length M − 1 and the edge set E consists of all triples
e = (aw, μ(awa ), wa ) ∈ Q × A × Q, where a, a ∈ A and w ∈ AM −2 are such
that awa ∈ LM (X). Check that X G = τ (X).

6.27. Life on Z. Let A = {0, 1} and consider the cellular automaton τ : AZ →
AZ deﬁned in Exercise 5.3. Let G be the A-labeled graph in Fig. 6.19. Check
that X G = τ (AG ).




Fig. 6.19 The A-labeled graph G = G(A, τ, 3)



6.28. Let A = {0, 1} and let τ : AZ → AZ be the majority action cellular
automaton (cf. Example 1.4.3(c)) associated with the set S = {−1, 0, 1}. Let
                                                       
G  be the A-labeled graph in Fig. 6.20. Check that X G = τ (AG ).




Fig. 6.20 The A-labeled graph G  = G(A, τ, 3)



6.29. Let A be a set and let G = (Q, E) be a ﬁnite A-labeled graph.
   (a) Suppose that for each pair (a, a ) ∈ A2 there exists at most one vertex
q ∈ Q which is both the terminal vertex of an edge with label a and the
Exercises                                                                       225

initial vertex of an edge with label a . Show that the subshift X G ⊂ AZ is of
ﬁnite type. Hint: Show that in fact {0, 1} ⊂ Z is a memory set for X G .
   (b) Show that the hypothesis in (a) is satisﬁed if the labeling map λ : E →
A is injective.

6.30. Let A be a set and let G = (Q, E) be a ﬁnite A-labeled graph. We recall
that given an edge e = (q, a, q  ) ∈ E we denote by α(e) = q ∈ Q (resp. ω(e) =
q  ∈ Q) the initial (resp. terminal) vertex of e. Consider the E-labeled graph
G  = (Q , E  ), where Q = Q and E  = {(α(e), e, ω(e)) ∈ Q × E × Q : e ∈ E}.
Note that the labeling map λ : E  → E on G  is bijective. Identify the set
{λ(e) : e ∈ E} ⊂ A formed by the labels of the edges of G with a subset
of E in an arbitrary way and consider the cellular automaton τ : E Z → E Z
with memory set S = {0} and local deﬁning map μ : E S → E deﬁned by
μ(e) = λ(e) for all e ∈ E S = E. Observe that τ (x) ∈ AZ for all x ∈ E Z and
                    
show that τ (X G ) = X G .

6.31. Let A be a set and X ⊂ AZ a subshift. Show that the following condi-
tions are equivalent:
   (i) there exists a ﬁnite A-labeled graph G such that X = X G .
   (ii) there exists a set B containing A, a subshift Y ⊂ B Z of ﬁnite type and
a cellular automaton τ : B Z → B Z such that X = τ (Y ). A subshift X ⊂ AZ is
said to be soﬁc if it satisﬁes one of the two above equivalent conditions. Hint:
For the implication (i) ⇒ (ii) use Exercise 6.30. For the converse implication,
use Exercise 6.25.

6.32. Let A be a set.
   (a) Show that every subshift X ⊂ AZ of ﬁnite type is soﬁc.
   (b) Suppose that A has at least two distinct elements. Show that there
exists a subshift X ⊂ AZ which is soﬁc but not of ﬁnite type. Hint: The even
subshift is soﬁc (cf. Exercise 6.24) but not of ﬁnite type (cf. Exercise 1.38(c)).

6.33. Let A be a set. Let X ⊂ AG be a soﬁc subshift and let τ : AG → AG
be a cellular automaton. Show that τ (X) ⊂ AG is a soﬁc subshift.

6.34. A subshift which is not soﬁc (cf. [LiM, Example 3.1.7]). Let A =
{0, 1, 2} and consider the subset X ⊂ AZ consisting of all conﬁgurations
x ∈ Z such that if x(n) = 0, x(n + 1) = x(n + 2) = · · · = x(n + h) = 1,
x(n + h + 1) = x(n + h + 2) = · · · = x(n + h + k) = 2 and x(n + h + k + 1) = 0
for some n ∈ Z and h, k ∈ N, then necessarily h = k.
    (a) Show that X is a subshift of AZ . It is called the context-free subshift.
    (b) Show that X is not soﬁc. Hint: Suppose by contradiction that X = X G
for some ﬁnite A-labeled graph G = (Q, E). Let r = |Q|. Observe that w =
01r+1 2r+1 0 ∈ L(X) so that there exists a path π in G such that λ(π) = w.
Let π  denote the subpath of π such that λ(π  ) = 1r+1 . Since (π  ) = r + 1 >
r = |Q|, we can write π  = π1 π2 π3 where π2 is a closed path of length
s = (π2 ) > 0 (and π1 (resp. π3 ) is a possibly empty path). It follows that
π  = π1 π2 π2 π3 is a path in G and its label is λ(π  ) = 01r+1+s 2r+1 0 ∈
                                                                             / L(X).
226                                              6 Finitely Generated Amenable Groups

6.35. Let A be a ﬁnite set and let X ⊂ AZ be a soﬁc subshift. A ﬁnite A-
labeled graph G = (Q, E) is said to be a minimal presentation of X if (i)
X = X G , and (ii) |Q| ≤ |Q | for all A-labeled graphs G  = (Q , E  ) such that
          
X = X G . Suppose that X is irreducible and that G = (Q, E) is a minimal
presentation of X.
    (a) Show that for every vertex q ∈ Q there exists a word wq ∈ L(X) such
that if a path π in G satisﬁes λ(π) = wq , then it passes through q. Hint: By
contradiction, if this is not the case for some q ∈ Q then the A-labeled graph
G  = (Q , E  ) where Q = Q\{q} and E  = E \{e ∈ E : α(e) = q or ω(e) = q}
               
satisﬁes X G = X and |Q | < |Q|, contradicting the minimality of G.
    (b) Deduce from (a) that G is connected. Hint: Let q, q  ∈ Q. Consider
the words wq , wq ∈ L(X) described in (a). Then by irreducibility of X there
exists u ∈ L(X) such that wq uwq ∈ L(X). Let π be a path in G such
that λ(π) = wq uwq ; then π = π1 π2 π3 where λ(π1 ) = wq , λ(π2 ) = u and
λ(π3 ) = wq . By deﬁnition of wq (resp. wq ) the path π1 (resp. π3 ) passes
through q (resp. q  ), say π1 = π1 π1 with (π1 )+ = q = (π1 )− (resp. π3 = π3 π3
with (π3 )+ = q  = (π3 )− ). Then the path π1 π2 π3 connects q to q  .
    (c) Deduce from (b) that for every irreducible soﬁc subshift Y ⊂ AZ there
exists a connected ﬁnite A-labeled graph G such that Y = X G .

6.36. Let A be a ﬁnite set and X ⊂ AZ an irreducible soﬁc subshift.
    (a) Show that the subset Xf consisting of all conﬁgurations in X whose
Z-orbit is ﬁnite (cf. Example 1.3.1(c)) is dense in X. Hint: Let x ∈ X and
let n ∈ N. By virtue of Exercise 6.35, we can ﬁnd a connected A-labeled
graph G = (Q, E) such that X = X G . Let π1 be a ﬁnite path in G such
that λ(π1 ) = x(0)x(1) · · · x(n − 1) and set q = π1− and q  = π1+ . Since G is
connected, we can ﬁnd a ﬁnite path π2 in G connecting q  to q. Let m = (π2 ).
It follows that the path π = π1 π2 is closed and t = (π) = n + m. If w = λ(π)
we deduce that wk ∈ L(X) for all k ∈ N. Since X is closed, there exists a
conﬁguration y ∈ X such that y(ht)y(ht + 1) · · · y((h + 1)t − 1) = w for all
h ∈ Z. In particular, y(0)y(1) · · · y(n − 1) = x(0)x(1) · · · x(n − 1) and y ∈ Xf .
    (b) Deduce from (a) that X is surjunctive. Hint: Cf. Exercise 3.29.

6.37. Show that the Morse subshift is not soﬁc. Hint: An inﬁnite minimal sub-
shift is irreducible (cf. Exercise 3.35(b)) and contains no conﬁguration whose
Z-orbit is ﬁnite (cf. Exercise 3.35(d)). On the other hand, by Exercise 6.36(a),
every irreducible soﬁc subshift contains an abundance of conﬁgurations with
ﬁnite Z-orbit.

6.38. Let A be a ﬁnite set and let X ⊂ AZ be an inﬁnite Toeplitz subshift.
Show that X is not soﬁc. Hint: The same arguments as for Exercise 6.37
apply.

6.39. Let A be a ﬁnite set. Show that there are at most countably many
distinct soﬁc subshifts X ⊂ AZ . Hint: There are at most countably many
ﬁnite A-labeled graphs up to isomorphism.
Exercises                                                                                          227

6.40. Let I be a ﬁnite set. Let B = (bij )i,j∈I be a matrix with real entries
                                                                     (n)
bij ≥ 0 for all i, j ∈ I. For an integer n ≥ 1, we denote by B n = (bij )i,j∈I the
n-th power of B. One says that the matrix B is irreducible if for every i, j ∈ I
                                                      (n)
there exists an integer n = n(i, j) ≥ 1 such that bij > 0. Suppose that B is
irreducible. The period per(i) of i ∈ I is the greatest common divisor of the
                              (n)
integers n ≥ 1 such that bii > 0.
   (a) Show that per(i) = per(j) for all i, j ∈ I. The period per(B) of the
matrix B is deﬁned as the common value of the numbers per(i), i ∈ I. Hint:
                                                  (r)          (s)
Let i, j ∈ I. We can ﬁnd r, s ≥ 1 such that bij > 0 and bji > 0. It follows
       (r+s)       (r) (s)               (r+n+s)         (r) (n) (s)
that bii       ≥ bij bji > 0 and bii                ≥ bij bjj bji > 0 for all n ≥ 1 such
      (n)
that bjj > 0. It follows from the deﬁnition that per(i) divides both r + s and
r + n + s and therefore also divides their diﬀerence n. This shows that per(i)
divides per(j).
   (b) Let n ≥ 1 be an integer. Show that B n is irreducible if and only if n
and per(B) are relatively prime.

6.41. Let A be a set and let G = (Q, E) be a ﬁnite A-labeled graph. The
adjacency matrix of G is the (Q × Q)-matrix BG = (bqq )q,q ∈Q where bqq is
the number of edges in E with initial vertex q and terminal vertex q  .
   (a) Show that G is connected if and only if the matrix BG is irreducible.
   (b) Suppose that G is connected. The period of G is the positive integer
deﬁned by per(G) = per(BG ). Show that per(G) is the greatest common
divisor of the lengths of all closed paths in G.

6.42. Let A be a set. Given a subshift X ⊂ AZ denote by pern (X) =
| Fix(nZ) ∩ X| (cf. Example 1.3.1(c)) the number of nZ-periodic conﬁgu-
rations in X. Let G be a ﬁnite connected A-labeled graph.
   (a) Show that for every integer N there exists an integer n ≥ N such that
pern (X G ) > 0.
   (b) The period per(X G ) of X G is deﬁned as the greatest common divisor
of all integers n ≥ 1 for which pern (X) > 0. Show that per(X G ) = per(G).

6.43. The N th higher block subshift (cf. Exercise 1.15 and Exercise 1.34). Let
A be a set and N a positive integer. Consider the map ΦN : AZ → (AN )Z
deﬁned by ΦN (x)(n) = (x(n), x(n + 1), x(n + 2), . . . , x(n + N − 1)) for all
x ∈ AZ and n ∈ Z. Similarly, consider the map ϕN : A∗ → (AN )∗ deﬁned as
follows: ϕN (w) = ε (the empty word) if (w) < N and

    ϕ(w) = (a1 , a2 , . . . , aN )(a2 , a3 , . . . , aN +1 ) · · · (am+1 , am+2 , . . . , am+N )

if w = a1 a2 · · · am+N , with m ≥ 0. Let X ⊂ AZ be a subshift and set X [N ] =
ΦN (X) ⊂ (AN )Z . Let L ⊂ A∗ be a subset and set L[N ] = ϕN (L) ⊂ (AN )∗ .
   (a) Show that X [N ] is a subshift of (AN )Z (it is called the N th higher block
subshift of X) and that L(X [N ] ) = (L(X))[N ] .
228                                                     6 Finitely Generated Amenable Groups

   (b) Show that X is irreducible (resp. topologically mixing, resp. strongly
irreducible) if and only if X [N ] is irreducible (resp. topologically mixing, resp.
strongly irreducible).
   (c) Show that if X is of ﬁnite type then X [N ] is of ﬁnite type.
   (d) Let Fn = {0, 1, 2, . . . , n − 1} ⊂ Z and let F = (Fn )n∈N . Show that
entF (X) = entF (X [N ] ).

6.44. Let A be a set and let G = (Q, E) be an A-labeled graph. For N a
positive integer, the N -higher edge graph G [N ] associated with G is the AN -
labeled graph (Q[N ] , E [N ] ) deﬁned as follows. For N = 1 one has G [1] = G
and, for N ≥ 2, the vertex set Q[N ] is the set of all paths of length N − 1 in
G and

         E [N ] = {(π,λ(e1 )λ(e2 ) · · · λ(eN ), π  ) ∈ Q[N ] × AN × Q[N ] :
                      π = (e1 , e2 , . . . , eN −1 ), π  = (e2 , e3 , . . . , eN −1 , eN )}.

   (a) Show that X G = (X G )[N ] .
                           [N ]


   (b) Deduce from (b) that if X ⊂ AZ is a soﬁc subshift, then the subshift
X [N ]
       ⊂ (AN )Z is also soﬁc.

6.45. The N th higher power subshift (cf. Exercise 1.16 and Exercise 1.35).
Let A be a set and N a positive integer. Consider the map ΨN : AZ → (AN )Z
deﬁned by ΨN (x)(n) = (x(nN ), x(nN +1), . . . , x((n+1)N −1)) for all x ∈ AZ
and n ∈ Z. Similarly, consider the map ψN : A∗ → (AN )∗ deﬁned as follows:
ψN (w) = ε if w ∈ A∗ \ (∪n≥1 AnN ) and

                   ψN (w) = (a1 , a2 , . . . , aN )(aN +1 , aN +2 , . . . , a2N )
                                  · · · (a(n−1)N +1 , a(n−1)N +2 , . . . , anN )

if w = a1 a2 · · · anN for some n ≥ 1. Let X ⊂ AZ be a subshift and set X (N ) =
ΨN (X) ⊂ (AN )Z . Let L ⊂ A∗ be a subset and set L(N ) = ψN (L) ⊂ (AN )∗ .
   (a) Show that X (N ) is a subshift of (AN )Z (it is called the N th higher
power subshift of X) and that L(X (N ) ) = (L(X))(N ) .
   (b) Show that if X is of ﬁnite type then X (N ) is of ﬁnite type.
   (c) Suppose that X is irreducible. Show that X (N ) is irreducible if and
only if N and per(X) are relatively prime.
   (d) Let Fn = {0, 1, 2, . . . , n − 1} ⊂ Z and let F = (Fn )n∈N . Show that
entF (X) = entF (X (N ) ).

6.46. Let A be a set and let G = (Q, E) be an A-labeled graph. For N a
positive integer, the N -higher power graph G (N ) associated with G is the AN -
labeled graph (Q(N ) , E (N ) ) deﬁned as follows. The vertex set is Q(N ) = Q
and the edge set is

      E (N ) = {(π − , λ(π), π + ) ∈ Q × AN × Q : π a path of length N in G},
Exercises                                                                                    229

where π − ∈ Q (resp. π + ∈ Q) is the initial (resp. terminal) vertex of the
path π. Recall that given a labeled graph H, we denote by BH its adjacency
matrix (cf. Exercise 6.40).
   (a) Show that BG (N ) = (BG )N .
   (b) Show that X G       = (X G )(N ) .
                      (N )


   (c) Deduce from (b) that if X ⊂ AZ is a soﬁc subshift, then the subshift
X (N )
       ⊂ (AN )Z is also soﬁc.
6.47. (cf. [Sca, Lemma]) Let G = (Q, E) be a ﬁnite labeled graph. Suppose
that G is connected and let e ∈ E. Show that there exists a positive in-
teger n0 such that if π is any path in G of length n0 , then there exists a
path π  = (e1 , e2 , . . . , en0 ) of the same length n0 , with the same initial and
terminal vertices as π, and such that ei = e for some 1 ≤ i ≤ n0 . Hint:
Given a path π = (e1 , e2 , . . . , en ) in G, denote by πQ = (q0 , q1 , . . . , qn ) the
associated sequence of visited vertices (cf. Sect. 6.2). We deﬁne a decom-
position of π as follows. Let i1 be the largest index such that the vertices
q0 , q1 , . . . , qi1 −1 are all distinct. Then qi1 = qj1 for a suitable j1 < i1 and we
set r1 = (e1 , e2 , . . . , ej1 ) and c1 = (ej1 +1 , ej1 +2 , . . . , ei1 ). Continuing this way,
we obtain a decomposition of the path π = r1 c1 r2 c2 · · · rk ck rk+1 where the
c1 , c2 , . . . , ck are closed simple paths and r1 , r2 , . . . , rk+1 are simple (possibly
empty) paths. With this notation, for 1 ≤ s ≤ r and a positive integer d,
we say that the path πs = r1 c1 r2 c2 rs rs+1 · · · ck rk is obtained from π by col-
lapsing the sth closed simple path cs . Similarly, if π  is a closed path such
that (π  )− = π − and d is a positive integer, we say that the path (π  )d π is
obtained from π by adding d copies of π  at the beginning of π. Now, since
G is connected, we can ﬁnd a closed path π  with initial (= terminal) vertex
π − containing the edge e. If n0 is large enough then in the decomposition
π = r1 c1 r2 c2 · · · rk ck rk+1 there exists a cycle c that is repeated many times.
If the length of c is , the length of π  is m and the cycle c is repeated at
least m times, then we may collapse the ﬁrst m copies of c and then add 
copies of π  at the beginning of π to obtain the desired path π  .
6.48. Let G = (Q, E) be a ﬁnite labeled graph. We denote by Pn (G) the set
of all paths of length n in G and we deﬁne the entropy of G as

                                                  log |Pn (G)|
                               ent(G) = lim                    .
                                           n→∞         n
Show that the above limit exists and is ﬁnite. Hint: Use Lemma 6.5.1.
6.49. (cf. [Sca, Theorem]) Let G = (Q, E) be a ﬁnite connected labeled graph.
Let e ∈ E and denote by H = (Q , E  ) the labeled subgraph of G were Q = Q
and E  = E \ {e}. Let n0 be the positive integer given by Exercise 6.47 and
set α = |Pn0 (G)|−1 .
   (a) Show that |P(k−1)n0 (G)| ≥ α|Pkn0 (G)| for all k = 1, 2, . . ..
   (b) We express a path π ∈ Pkn0 (G) as the composition π = π1 π2 · · · πk ,
where πi ∈ Pn0 (G), 1 ≤ i ≤ k. Also, for i = 1, 2, . . . , k, we denote by ϕi the set
230                                          6 Finitely Generated Amenable Groups

of all paths π ∈ Pkn0 (G) such that πi contains the edge e. Show that |ϕ1 | ≥
|P(k−1)n0 (G)| and deduce from (a) that |Pkn0 (G)\ϕ1 | ≤ (1−α)|Pn0 (G)|. Hint:
By Exercise 6.47 for any π̃ ∈ P(k−1)n0 (G) there exits a path π  π̃ ∈ Pkn0 (G)
such that π  contains e.                         i−1
    (c) For 1 ≤ i ≤ k we set Pkn
                               i
                                 0
                                   (G) = Pkn0 (G)\ t=1 ϕt , C h = {π ∈ Pkn
                                                                         i
                                                                            0
                                                                              (G) :
πi contains e} and denote by D the set of pairs (σ1 , σ2 ) ∈ P(i−1)n0 (G) ×
                                     h

P(k−i)n0 (G) such that there exists π = σ1 σσ2 ∈ Pkn  i
                                                        0
                                                          (G). Show that |C h | ≥
|Dh | ≥ α|Pkni
               0
                 (G)|. Hint: Use Exercise 6.47 to show that for every (σ1 , σ2 ) ∈
D there exists π = σ1 π  σ2 ∈ Pkn0 (G) such that π  contains e.
  i
                                          k
    (d) Deduce from (c) that |Pkn0 (G) \ i=1 ϕi | ≤ (1 − α)k |Pkn0 (G)|.
                                              k
    (e) Observe that Pkn0 (H) ⊂ Pkn0 (G) \ i=1 ϕi and deduce from (d) that
ent(H) ≤ log(1−α)
               n0    + ent(G).
    (f) Deduce from (e) that ent(H) < ent(G).
6.50. Let A be a ﬁnite set. Let Fn = {0, 1, . . . , n} ⊂ Z and F = (Fn )n∈N . Let
X ⊂ AZ be a subshift and let w ∈ L(X). Set

      Xw = {x ∈ X : x(n + 1)x(n + 2) · · · x(n + N ) = w for all n ∈ Z},

where N = (w).
   (a) Show that Xw ⊂ X is a subshift of AZ .
   (b) Show that (Xw )[N ] = (X [N ] )ΦN (w) (cf. Exercise 6.43).
   (c) Suppose from now on that X is irreducible of ﬁnite type. Let M be
a positive integer such that {1, 2, . . . , M } is a memory set for X, and let G
be the A-labeled graph such that X = X(G, M ) (cf. Exercise 6.25). Let H
denote the labeled subgraph of G [N ] obtained by removing all edges labeled
by ΦN (w). Show that (X [N ] )ΦN (w) = XH .
   (d) Show that entF (Xw ) < entF (X). Hint: Use Exercises 6.49 and 6.43(d).
6.51. Let A be a ﬁnite set. Let Fn = {0, 1, . . . , n} ⊂ Z and F = (Fn )n∈N .
Let X ⊂ AZ be an irreducible subshift of ﬁnite type. Show that if Y ⊂ AZ
is such that Y  X, then entF (Y ) < entF (X). Hint: Show that there exists
w ∈ L(X) \ L(Y ) such that Y ⊂ Xw ⊂ X. Then apply Exercise 6.50(d) and
Proposition 5.7.2(ii).
6.52. (cf. [Hed-3], [CovP], and [LiM, Theorem 8.1.16]). Let A be a ﬁnite set.
Let F = (Fn )n∈N , where Fn = {0, 1, . . . , n} ⊂ Z. Also let X ⊂ AZ an irreducible
subshift of ﬁnite type and τ : X → X a pre-injective cellular automaton.
   (a) Let M be a positive integer such that {1, 2, . . . , M } is a memory set
for X. Set Y = τ (X) and consider the labeled graph G = G(X, τ, M ) (cf.
Exercise 6.26). Note that for every w ∈ L(Y ) there exists a path π ∈ G
such that w = λ(π). Show that, by pre-injectivity of τ , for all q, q  ∈ Q and
w ∈ L(Y ) there exists at most one path π in G with initial (resp. terminal)
vertex π − = q (resp. π + = q  ) such that w = λ(π).
   (b) Deduce from (a) that |Ln (Y )| ≤ |Ln (X)| ≤ |Ln (Y )| · |Q|2 .
   (c) Deduce from (b) that entF (τ (X)) = entF (X).
Exercises                                                                             231

6.53. Let A be a ﬁnite set. Let Fn = {0, 1, . . . , n} ⊂ Z and F = (Fn )n∈N . Let
X, Y ⊂ AZ be two irreducible subshifts of ﬁnite type such that entF (X) =
entF (Y ). Show that every pre-injective cellular automaton τ : X → Y is
surjective. Hint: Use the results of Exercise 6.51 and Exercise 6.52.
6.54. Let A be a ﬁnite set. Let X ⊂ AG be an irreducible subshift of ﬁ-
nite type. Show that every pre-injective cellular automaton τ : X → X is
surjective. Hint: Use Exercise 6.53 with Y = X.
6.55. (cf. [Hed-3], [CovP], and [LiM, Theorem 8.1.16]). Let A be a ﬁnite set
and X ⊂ AZ an irreducible subshift of ﬁnite type. Let Fn = {0, 1, . . . , n} ⊂ Z
and F = (Fn )n∈N . Let τ : X → X be a cellular automaton. Suppose that τ
is not pre-injective.
   (a) Show that there exist a positive integer N and two distinct conﬁgura-
tions x1 , x2 ∈ X such that x1 |Z\{1,2,...,N } = x2 |Z\{1,2,...,N } and τ (x1 ) = τ (x2 ).
   (b) Up to enlarging N if necessary, we may suppose that {1, 2, . . . , N } is
a memory set for both X and τ . Let G = G(X, τ, N ) = (Q, E) (cf. Exer-
cise 6.26). Show that there exist two vertices q, q  ∈ Q and two paths π1 , π2
in G with initial (resp. terminal) vertices π1− = π2− = q (resp. π1+ = π2+ = q  )
such that λ(π1 ) = x1 |{1,2,...,N } and λ(π2 ) = x2 |{1,2,...,N } . One says that the
two paths π1 , π2 constitute a diamond in G (see Fig. 6.21).




Fig. 6.21 A diamond in an A-labeled graph G


   (c) Up to further enlarging N if necessary, we may suppose that N is
relatively prime with per(X) (cf. Exercise 6.40 and Exercise 6.42). By Exer-
cise 6.45(c) the N th power graph G (N ) is also irreducible and π1 and π2 are
edges in G (N ) with the same initial vertex and same terminal vertex. Let H
be the A-labeled subgraph of G (N ) obtained by removing the edge π1 . Deduce
from Exercise 6.49 that entF (XH ) < entF (XG (N ) ).
   (d) Show that XH = Y (N ) , where Y = τ (X).
   (e) Deduce from (c) and (d) and from Exercise 6.45(d) that entF (τ (X)) <
entF (X).
6.56. Let A be a ﬁnite set. Let Fn = {0, 1, . . . , n} ⊂ Z and F = (Fn )n∈N .
Let X, Y ⊂ AZ be two subshifts such that X is irreducible of ﬁnite type and
entF (X) = entF (Y ). Show that every surjective cellular automaton τ : X →
Y is pre-injective. Hint: Use the result of Exercise 6.55.
6.57. The Garden of Eden theorem for irreducible subshifts of ﬁnite type
over Z [Fio1, Corollary 2.19]. Let A be a ﬁnite set and X ⊂ AZ an irreducible
232                                        6 Finitely Generated Amenable Groups

subshift of ﬁnite type. Let τ : X → X be a cellular automaton. Show that
τ is surjective if and only if it is pre-injective. Hint: Combine together the
results from Exercise 6.56 with Y = X and Exercise 6.54.

6.58. Let A = {0, 1}. Consider the subset X ⊂ AZ consisting of all con-
ﬁgurations x ∈ AZ such that {n ∈ Z : x(n) = 1} is an interval of Z. Let
σ : AZ → AZ be the cellular automaton with memory set S = {0, 1} and
local deﬁning map μ : AS → A given by
                         
                          1      if (y(0), y(1)) = (0, 1),
                  μ(y) =
                          y(0) otherwise.

   (a) Show that X is a soﬁc subshift.
   (b) Show that X is neither of ﬁnite type nor irreducible.
   (c) Check that τ (X) ⊂ X
   (d) Show that the cellular automaton τ = σ|X : X → X is injective (and
therefore pre-injective) but not surjective.
   (e) Deduce from (d) that X is not surjunctive.
Chapter 7
Local Embeddability and Soﬁc Groups




In this chapter we study the notions of local embeddability and soﬁcity for
groups. Roughly speaking, a group is locally embeddable into a given class
of groups provided that the multiplicative table of any ﬁnite subset of the
group is the same as the multiplicative table of a subset of some group in the
class (cf. Deﬁnition 7.1.3). In Sect. 7.1 we discuss several stability properties
of local embeddability. Subgroups of locally embeddable groups are locally
embeddable (Proposition 7.1.7). Moreover, as the name suggests, local em-
beddability is a local property, that is, a group is locally embeddable into a
class of groups if and only if all its ﬁnitely generated subgroups are locally
embeddable into the class (Proposition 7.1.8). When the class is closed under
ﬁnite direct products, the class of groups which are locally embeddable in the
class is closed under (possibly inﬁnite) direct products (Proposition 7.1.10).
We also show that a marked group which is a limit of groups belonging to
a given class is locally embeddable into this class (Theorem 7.1.16). Con-
versely, we prove that if the given class is closed under taking subgroups and
the marking group is free, then any marked group which is locally embed-
dable is a limit of marked groups which are in the class (Theorem 7.1.19). If
C is a class of groups which is closed under ﬁnite direct products, then every
group which is residually C is locally embeddable into C (Corollary 7.1.14).
Conversely, under the hypothesis that C is closed under taking subgroups, ev-
ery ﬁnitely presented group which is locally embeddable into C is residually C
(Corollary 7.1.21).
   In Sect. 7.2 we present a characterization of local embeddability in terms
of ultraproducts: a group is locally embeddable into C if and only if it can be
embedded into an ultraproduct of a family of groups in C.
   Section 7.3 is devoted to LEF and LEA-groups. A group is called LEF
(resp. LEA) if it is locally embeddable into the class of ﬁnite (resp. amenable)
groups. As the class of ﬁnite (resp. amenable) groups is closed under taking
subgroups and taking ﬁnite direct products, all the results obtained in the
previous section can be applied. This implies in particular that every locally
residually ﬁnite (resp. locally residually amenable) group is LEF (resp. LEA).

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,       233
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 7, © Springer-Verlag Berlin Heidelberg 2010
234                                        7 Local Embeddability and Soﬁc Groups

We give an example of a ﬁnitely generated amenable group which is LEF but
not residually ﬁnite (Proposition 7.3.9). This group is not ﬁnitely presentable
since every ﬁnitely presented LEF-group is residually ﬁnite.
    The Hamming metric, which is a bi-invariant metric on the symmetric
group of a ﬁnite set, is introduced in Sect. 7.4.
    In Sect. 7.5 we deﬁne the class of soﬁc groups. These groups are the groups
admitting local approximations by ﬁnite symmetric groups equipped with
their Hamming metric. Subgroups and direct products of soﬁc groups are
soﬁc. Every LEA-group is soﬁc (Corollary 7.5.11). In particular, residually
amenable groups, and therefore amenable groups and residually ﬁnite groups,
are soﬁc. A group is soﬁc if and only if it can be embedded into an ultra-
product of a family of ﬁnite symmetric groups equipped with their Hamming
metrics (Theorem 7.6.6). In Sect. 7.7 we give a characterization of ﬁnitely
generated soﬁc groups in terms of their Cayley graphs. More precisely, we
show that a ﬁnitely generated group G with a ﬁnite symmetric generating
subset S ⊂ G is soﬁc if and only if, for every integer r ≥ 0 and every ε > 0,
there exists a ﬁnite S-labeled graph Q such that there is a proportion of at
least 1 − ε of vertices q ∈ Q such that the ball of radius r centered at q in Q
is isomorphic, as a labeled graph, to a ball of radius r in the Cayley graph
of G associated with S (Theorem 7.7.1). The last section of this chapter is
devoted to the proof of the surjunctivity of soﬁc groups (Theorem 7.8.1).



7.1 Local Embeddability

Deﬁnition 7.1.1. Let G and C be two groups. Given a ﬁnite subset K ⊂ G,
a map ϕ : G → C is called a K-almost-homomorphism of G into C if it
satisﬁes the following conditions:
(K-AH-1) ϕ(k1 k2 ) = ϕ(k1 )ϕ(k2 ) for all k1 , k2 ∈ K;
(K-AH-2) the restriction of ϕ to K is injective.

  Note that in the preceding deﬁnition, the map ϕ is not required to be a
homomorphism nor to be globally injective.

Remark 7.1.2. If ϕ : G → C is a K-almost-homomorphism and ϕ : G → C
is a map which coincides with ϕ on K ∪ K 2 , then ϕ is also a K-almost-
homomorphism.

   Let now C be a class of groups, that is, a collection of groups satisfying
the following condition: if C ∈ C and C  is a group which is isomorphic to C,
then C  ∈ C. For example, C might be the class of ﬁnite groups, the class of
nilpotent groups, the class of solvable groups, the class of amenable groups,
or the class of free groups.
7.1 Local Embeddability                                                     235

Deﬁnition 7.1.3. Let C be a class of groups. One says that a group G is
locally embeddable into the class C if, for every ﬁnite subset K ⊂ G, there
exist a group C ∈ C and a K-almost-homomorphism ϕ : G → C.
Examples 7.1.4. (a) Let C be a class of groups and let G be a group in C.
Then G is locally embeddable into C. Indeed, the identity map IdG : G → G
is a K-almost-homomorphism of G into itself for every ﬁnite subset K ⊂ G.
   (b) The group Z is locally embeddable into the class of ﬁnite groups.
Indeed, let K be a ﬁnite subset of Z. Choose an integer n ≥ 0 such that
K ⊂ [−n, n]. Then, the quotient homomorphism ϕ : Z → Z/(2n + 1)Z is a
K-almost-homomorphism.
Remark 7.1.5. Let G be a group and let C be a class of groups which is closed
under taking subgroups. Suppose that G is ﬁnite and it is locally embeddable
into C. Then G ∈ C. Indeed, any G-almost homomorphism ϕ : G → C from
G into a group C ∈ C is an injective homomorphism.
   The following characterization of local embeddability will not be used in
the sequel but it presents some interest on its own.
Proposition 7.1.6. Let G be a group and let C be a class of groups which is
closed under taking subgroups. Then the following conditions are equivalent:
(a) G is locally embeddable into C;
(b) for every ﬁnite subset K ⊂ G, there exist a set L with K ⊂ L ⊂ G and
    a binary operation ! : L × L → L such that (L, !) is a group in C and
    k1 k2 = k1 ! k2 for all k1 , k2 ∈ K.
Proof. Suppose (a). Fix a ﬁnite subset K ⊂ G. If G is ﬁnite, then G ∈ C
by Remark 7.1.5. Therefore, condition (b) is satisﬁed in this case since we
can take as (L, !) the group G itself. So let us assume that G is inﬁnite.
Consider the ﬁnite subset K  ⊂ G deﬁned by K  = K ∪ K 2 . Since G is
locally embeddable into C, we can ﬁnd a group C  ∈ C and a K  -almost-
homomorphism ϕ : G → C  . Note that, as K  is ﬁnite, the subgroup C ⊂ C 
generated by ϕ (K  ) is countable. Since G is inﬁnite, it follows that there
exists a surjective map σ : G → C which coincides with ϕ on K  . Let us
deﬁne a map ψ : C → G as follows. If c ∈ σ(K  ), we set ψ(c) = k , where k
is the unique element in K  such that σ(k  ) = c. For c ∈ C \ σ(K  ), we take
as ψ(c) an arbitrary element in σ −1 (c). Denote by L = ψ(C) ⊂ G the image
of ψ. Observe that K ⊂ K  ⊂ L and that ψ induces a bijection from C onto
L. Let us use this bijection to transport the group structure from C to L. If
we denote by ! the corresponding group operation on L, this means that ψ
induces a group isomorphism from C onto (L, !). It follows that we have

                           1 ! 2 = ψ(σ(1 )σ(2 ))

for all 1 , 2 ∈ L. As C is closed under taking subgroups, C and hence (L, !)
belong to C. Moreover, for all k1 , k2 ∈ K, we have
236                                          7 Local Embeddability and Soﬁc Groups

 k1 ! k2 = ψ(σ(k1 )σ(k2 )) = ψ(ϕ (k1 )ϕ (k2 )) = ψ(ϕ (k1 k2 )) = ψ(σ(k1 k2 )).

Since K 2 ⊂ K  , we deduce that k1 ! k2 = k1 k2 for all k1 , k2 ∈ K. This shows
that condition (b) is satisﬁed.
    Conversely, suppose (b). Fix a ﬁnite subset K ⊂ G. Set C = (L, !),
where L is as in (b). Let ϕ : G → C be any map extending the identity map
ι : L → L. Then ϕ|K = ι|K is injective. On the other hand, for all k1 , k2 ∈ K,
we have k1 k2 = k1 ! k2 ∈ L and therefore

                           ϕ(k1 k2 ) = ι(k1 k2 )
                                    = k1 k2
                                    = k1 ! k2
                                    = ϕ(k1 ) ! ϕ(k2 )

Thus, ϕ is a K-almost-homomorphism of G into the group C in C. This shows
that G is locally embeddable into C.

Proposition 7.1.7. Let C be a class of groups. Every subgroup of a group
which is locally embeddable into C is locally embeddable into C.

Proof. Let G be a group which is locally embeddable into C and let H be
a subgroup of G. Given a ﬁnite subset K ⊂ H, let ϕ : G → C be a K-
almost-homomorphism of G into a group C ∈ C. Then the restriction map
ϕ|H : H → C is a K-almost-homomorphism of H into C. This shows that H
is locally embeddable into C.

As the name suggests, local embeddability is a local property for groups:

Proposition 7.1.8. Let G be a group and let C be a class of groups. Then G
is locally embeddable into C if and only if every ﬁnitely generated subgroup of
G is locally embeddable into C.

Proof. The necessity of the condition follows from Proposition 7.1.7. Con-
versely, suppose that every ﬁnitely generated subgroup of G is locally em-
beddable into C. Let K ⊂ G be a ﬁnite subset and denote by H ⊂ G the
subgroup generated by K. Then, as H is locally embeddable into C, there ex-
ists a K-almost-homomorphism ϕ : H → C of H into a group C ∈ C. Extend
arbitrarily ϕ to G, for example by setting ϕ(g) = 1C for all g ∈ G \ H. Then
ϕ : G → C is a K-almost-homomorphism of G into C. This shows that G is
locally embeddable into C.

  Let C be a class of groups. Denote by C the class consisting of all groups
which are locally embeddable into C.

Proposition 7.1.9. Let C be a class of groups. Then C = C.
7.1 Local Embeddability                                                          237

Proof. Let G be a group in C. Then, given any ﬁnite subset K ⊂ G there
exist a group C  ∈ C and a K-almost-homomorphism ϕ : G → C  . Consider
the ﬁnite subset K  = ϕ(K) ⊂ C  and let ϕ : C  → C be a K  -almost-
homomorphism of C  into a group C ∈ C. Then the composition map Φ =
ϕ ◦ ϕ : G → C is a K-almost-homomorphism. Indeed, for k1 , k2 ∈ K one has

                           Φ(k1 k2 ) = ϕ (ϕ(k1 k2 ))
                                     = ϕ (ϕ(k1 )ϕ(k2 ))
                                     = ϕ (ϕ(k1 ))ϕ (ϕ(k2 ))
                                     = Φ(k1 )Φ(k2 ).

Moreover, as ϕ|K and ϕ |K  are injective, and K  = ϕ(K), one has that Φ|K is
also injective. It follows that G is locally embeddable into C. This shows that
C ⊂ C. The inclusion C ⊂ C follows from the observation in Example 7.1.4(a).
This shows that C = C.
  A class of groups C is said to be closed under ﬁnite direct products if one
has G1 × G2 ∈ C whenever G1 ∈ C and G2 ∈ C.
Proposition 7.1.10. Let C be a class of groups which is closed under ﬁnite
direct products. Let (Gi )i∈I be a family of
                                           groups which are locally embeddable
into C. Then, their direct product G = i∈I Gi is locally embeddable into C.
Proof. For each i ∈ I, let πi : G → Gi denote the projection homomorphism.
Fix a ﬁnite subset K ⊂ G. Then there exists       a ﬁnite subset J⊂ I such
that the projection homomorphism πJ = j∈J πj : G → GJ = j∈J Gj is
injective on K. Since the group Gj is locally embeddable into C, we can ﬁnd,
for each j ∈ J, a πj (K)-almost homomorphism ϕj : Gj → Cj of Gj into a
groupCj ∈ C. As the class C is closed under ﬁnite direct products, the group
C = j∈J Cj   is also in C. Consider the map ϕ : G → C deﬁned by ϕ = ϕJ ◦πJ ,
where ϕJ = j∈J ϕj : GJ → C. For all k = (ki )i∈I , k = (ki )i∈I ∈ K, we
have
                          ϕ(kk ) = ϕJ (πJ (kk ))
                                  = ϕJ ((kj kj )j∈J )
                                  = (ϕj (kj kj ))j∈J
                                  = (ϕj (kj )ϕj (kj ))j∈J
                                  = (ϕj (kj ))j∈J (ϕj (kj ))j∈J
                                  = ϕ(k)ϕ(k ).

Moreover, ϕ|K is injective. Indeed, given k = (ki )i∈I , k = (ki )i∈I ∈ K, if
ϕ(k) = ϕ(k ) then ϕj (kj ) = ϕj (kj ) for all j ∈ J. By injectivity of ϕj |πj (K) ,
we deduce that kj = kj for all j ∈ J. This implies that k = k  since πJ |K
is injective. This shows that ϕ is a K-almost-homomorphism of G into C. It
follows that G is locally embeddable into C.
238                                       7 Local Embeddability and Soﬁc Groups

Corollary 7.1.11. Let C be a class of groups which is closed under ﬁnite
direct products. Let (Gi )i∈I be a family
                                       of groups which are locally embeddable
into C. Then their direct sum G = i∈I Gi is locally embeddable into C.

Proof. This follows immediately from Proposition 7.1.7 and Proposition 7.1.10,
since G is the subgroup of the direct product P = i∈I Gi consisting of all
g = (gi )i∈I ∈ P for which gi = 1Gi for all but ﬁnitely many i ∈ I.

Corollary 7.1.12. Let C be a class of groups which is closed under ﬁnite
direct products. If a group G is the limit of a projective system of groups
which are locally embeddable into C, then G is locally embeddable into C.

Proof. Let (Gi )i∈I be a projective system of groups which are locally embed-
dable into C such that G = lim Gi . By construction
                                                    of a projective limit (see
                             ←−
Appendix E), G is a subgroup of the group i∈I Gi . We deduce that G is
locally embeddable into C by using Proposition 7.1.10 and Proposition 7.1.7.


   Recall that if C is a class of groups, then a group G is called residually
C if for each element g ∈ G with g = 1G , there exist a group C ∈ C and a
surjective homomorphism φ : G → C such that φ(g) = 1C .

Proposition 7.1.13. Let C be a class of groups which is closed under ﬁnite
direct products. Let G be a group which is residually C. Then, for every ﬁnite
subset K ⊂ G, there exist a group C ∈ C and a homomorphism ϕ : G → C
whose restriction to K is injective.

Proof. Fix a ﬁnite subset K ⊂ G and consider the set

                     L = {hk−1 : h, k ∈ K and h = k}.

Since G is residually C, we can ﬁnd, for each g ∈ L, a group Cg ∈     C and a
homomorphism φg : G → Cg such that φg (g) = 1Cg . The group C = g∈L Cg
is in the class C since L is ﬁnite and C is closed
                                                  under ﬁnite direct products.
Consider the group homomorphism ϕ = g∈L φg : G → C. If h and k are
distinct elements in K, then g = hk−1 ∈ L and φg (hk −1 ) = φg (g) = 1Cg . It
follows that ϕ(hk−1 ) = 1C and hence ϕ(h) = ϕ(k). Thus, the restriction of
ϕ to K is injective.

Corollary 7.1.14. Let C be a class of groups which is closed under ﬁnite
direct products. Then every group which is residually C is locally embeddable
into C.

Proof. Let G be a group which is residually C and let K ⊂ G be a ﬁnite subset.
By Proposition 7.1.13, there exist a group C ∈ C and a homomorphism
ϕ : G → C whose restriction to K is injective. Such a ϕ is a K-almost-
homomorphism. Consequently, G is locally embeddable into C.
7.1 Local Embeddability                                                              239

Corollary 7.1.15. Let C be a class of groups which is closed under ﬁnite
direct products. Then every group which is locally residually C is locally em-
beddable into C.
Proof. This immediately follows from Corollary 7.1.14 and Proposition 7.1.8.

   Given a group Γ , let N (Γ ) denote the space of all Γ -marked groups (cf.
Sect. 3.4). Recall that N (Γ ) may be identiﬁed with the set consisting of all
normal subgroups of Γ and that N (Γ ) is a compact Hausdorﬀ space for the
topology induced by the prodiscrete topology on P(Γ ) = {0, 1}Γ .
Theorem 7.1.16. Let Γ be a group and let C be a class of groups. Let N ∈
N (Γ ). Suppose that there exists a net (Ni )i∈I which converges to N in N (Γ )
such that Γ/Ni ∈ C for all i ∈ I. Then the group Γ/N is locally embeddable
into C.
Proof. Denote by ρ : Γ → Γ/N and ρi : Γ → Γ/Ni the quotient homomor-
phisms. Fix a ﬁnite subset K ⊂ Γ/N and let F ⊂ Γ be a ﬁnite symmetric
subset such that 1Γ ∈ F and ρ(F ) = K ∪K −1 ∪{1Γ/N }. Since the net (Ni )i∈I
converges to N , we can ﬁnd i0 ∈ I such that

                                N ∩ F 4 = Ni0 ∩ F 4 .                              (7.1)

Set C = Γ/Ni0 and deﬁne a map ϕ : Γ/N → C by setting
                   
                     ρi0 (f  ) if g = ρ(f  ) for some f  ∈ F 2
            ϕ(g) =                                                                 (7.2)
                     1C         otherwise.

   Note that ϕ is well deﬁned. Indeed, suppose that g = ρ(f1 ) = ρ(f2 ), for
some f1 , f2 ∈ F 2 . Then, from 1Γ/N = ρ(f1 )−1 ρ(f2 ) = ρ((f1 )−1 f2 ), we deduce
that
                                (f1 )−1 f2 ∈ ker(ρ) = N.                          (7.3)
As (f1 )−1 f2 ∈ F 4 , we deduce from (7.3) and (7.1) that (f1 )−1 f2 ∈ Ni0 =
ker(ρi0 ). Therefore, we have ρi0 (f1 ) = ρi0 (f2 ).
    Let us check now that ϕ is a K-almost-homomorphism. Let k1 , k2 ∈ K.
Then, there exist f1 , f2 ∈ F such that ρ(f1 ) = k1 and ρ(f2 ) = k2 . Observe
that f1 , f2 ∈ F 2 since F ⊂ F 2 . Thus, we get ϕ(k1 ) = ρi0 (f1 ) and ϕ(k2 ) =
ρi0 (f2 ) by applying (7.2). On the other hand, we also have f1 f2 ∈ F 2 and
k1 k2 = ρ(f1 )ρ(f2 ) = ρ(f1 f2 ). Therefore, by applying again (7.2), we obtain

                              ϕ(k1 k2 ) = ρi0 (f1 f2 )
                                        = ρi0 (f1 )ρi0 (f2 )
                                        = ϕ(k1 )ϕ(k2 ).

Moreover, if ϕ(k1 ) = ϕ(k2 ), then ρi0 (f1 ) = ρi0 (f2 ) and hence f1−1 f2 ∈
ker(ρi0 ) = Ni0 . As f1−1 f2 ∈ F 2 ⊂ F 4 , we deduce from (7.1) that f1−1 f2 ∈
240                                        7 Local Embeddability and Soﬁc Groups

N = ker(ρ). Therefore k1 = ρ(f1 ) = ρ(f2 ) = k2 . This shows that ϕ is injec-
tive on K. We have shown that ϕ is a K-almost-homomorphism of Γ/N into
the group C ∈ C. Therefore, Γ/N is locally embeddable into C.
Corollary 7.1.17. Let Γ be a group and let C be a class of groups. Then the
set of all N ∈ N (Γ ) such that Γ/N is locally embeddable into C is closed
(and hence compact) in N (Γ ).
Proof. Let (Ni )i∈I be a convergent net in N (Γ ) and suppose that the groups
Γ/Ni are locally embeddable into C for all i ∈ I. Let N = limi∈I Ni . By ap-
plying Theorem 7.1.16, we deduce that Γ/N is locally embeddable into the
class of groups which are locally embeddable into C. It follows from Proposi-
tion 7.1.9 that Γ/N is locally embeddable into C.
   For the next theorem we need some (slightly technical) preliminaries.
   Let n ≥ 2 be an integer and G, C two groups. Given a ﬁnite subset K ⊂ G,
we say that a map ϕ : G → C is an n-K-almost-homomorphism if it satisﬁes
the following conditions:
(n-K-AH-1) ϕ(k1ε1 k2ε2 · · · ktεt ) = ϕ(k1 )ε1 ϕ(k2 )ε2 · · · ϕ(kt )εt
           for all ki ∈ K ∪ {1G }, εi ∈ {−1, 1}, 1 ≤ i ≤ t ≤ n;
(n-K-AH-2) ϕ(1G ) = 1C ;
(n-K-AH-3) the restriction of ϕ to (K ∪ K −1 ∪ {1G })n is injective.
Lemma 7.1.18. Let G be a group and let C be a class of groups. Let n ≥ 2
be an integer. Then, the following conditions are equivalent:
(a) G is locally embeddable into C;
(b) for every ﬁnite subset K ⊂ G, there exist a group C ∈ C and an n-K-
    almost-homomorphism ϕ : G → C.
Proof. It is clear that any n-K-almost-homomorphism is also a K-almost-
homomorphism (take ε1 = ε2 = 1 and t = 2 in (n-K-AH-1), and observe
that K ⊂ (K ∪ K −1 ∪ {1G })n ). Thus, (b) implies (a).
   Conversely, suppose (a). Given a ﬁnite subset K ⊂ G, set K  = (K ∪
K ∪ {1G })n . As G is locally embeddable into C, there exists a K  -almost-
   −1

homomorphism ϕ : G → C of G into a group C ∈ C. Let us show that
ϕ is an n-K-almost-homomorphism. As the restriction of ϕ to K  is injec-
tive, Property (n-K-AH-3) is trivially satisﬁed. On the other hand, we have
ϕ(k1 k2 ) = ϕ(k1 )ϕ(k2 ) for all k1 , k2 ∈ K  . For k1 = k2 = 1G , this gives us
ϕ(1G ) = ϕ(1G )2 , so that Property (n-K-AH-2) also holds. By taking k1 ∈ K 
and k2 = k1−1 , we get 1C = ϕ(1G ) = ϕ(k1 k1−1 ) = ϕ(k1 )ϕ(k1−1 ). This im-
plies that ϕ(k1−1 ) = ϕ(k1 )−1 for all k1 ∈ K  . Then, Property (n-K-AH-1)
immediately follows by induction on t. This shows that ϕ is an n-K-almost-
homomorphism of G into C.
Theorem 7.1.19. Let F be a free group and let C be a class of groups which
is closed under taking subgroups. Let N ∈ N (F ) and suppose that the group
F/N is locally embeddable into C. Then there exists a net (Ni )i∈I which
converges to N in N (F ) such that F/Ni ∈ C for all i ∈ I.
7.1 Local Embeddability                                                    241

Proof. Let X ⊂ F be a free base of F and denote by ρ : F → F/N the
quotient homomorphism. Let I denote the set of all ﬁnite subsets E of F
partially ordered by inclusion. Given E ∈ I, we denote by UE ⊂ X the
subset of X consisting of all elements which appear in the reduced form of
some element in E. Since E is ﬁnite, UE is also ﬁnite and there exists nE ∈ N
such that each w ∈ E may be written in the form

                                w = xε11 xε22 · · · xεt t                 (7.4)

for suitable xi ∈ UE , εi ∈ {−1, 1}, i = 1, 2, . . . , t, and 1 ≤ t ≤ nE . Set
KE = ρ(BnE ) ⊂ F/N , where BnE denotes the ball of radius nE centered at
the identity element 1F in the Cayley graph of the subgroup of F generated
by UE . Since F/N is locally embeddable into C it follows from Lemma 7.1.18
that there exists a group CE ∈ C and an nE -KE -almost-homomorphism
ϕE : F/N → CE . As F is a free group with base X, there exists a unique
homomorphism ρE : F → CE such that ρE (x) = ϕE (ρ(x)) for all x ∈ X.
Setting NE = ker(ρE ) we have NE ∈ N (F ). Moreover, since C is closed under
taking subgroups, we have that the quotient group F/NE , being isomorphic
to ρE (F ), which is a subgroup of CE , also belongs to C.
   Let us show that the net (NE )E∈I converges to N . Fix a ﬁnite subset
E0 ⊂ F . Let E ∈ I be such that E0 ⊂ E. Let us show that

                               N ∩ E0 = NE ∩ E0 .                         (7.5)

Given w ∈ E0 , we can write w as in (7.4). Using the fact that ϕE is an
nE -KE -almost-homomorphism, we get

               ρE (w) = ρE (xε11 xε22 · · · xεt t )
                      = ρE (x1 )ε1 ρE (x2 )ε2 · · · ρE (xt )εt
                      = ϕE (ρ(x1 ))ε1 ϕE (ρ(x2 ))ε2 · · · ϕE (ρ(xt ))εt
                      = ϕE (ρ(x1 )ε1 ρ(x2 )ε2 · · · ρ(xt )εt )
                      = ϕE (ρ(xε11 xε22 · · · xεt t ))
                      = ϕE (ρ(w)).

As ϕE is injective on KE , and ρ(w) ∈ ρ(BE ) = KE , we deduce that ρE (w) =
1F/NE if and only if ρ(w) = 1F/N , equivalently, w ∈ NE if and only if w ∈ N .
Thus (7.5) follows. This shows that N = limE NE .

  From Theorem 7.1.16 (with Γ a free group F ) and Theorem 7.1.19 we
immediately deduce the following.

Corollary 7.1.20. Let F be a free group and let C be a class of groups which
is closed under taking subgroups. Let N ∈ N (F ). Then the following condi-
tions are equivalent.
(a) the group F/N is locally embeddable into C;
242                                        7 Local Embeddability and Soﬁc Groups

(b) there exists a net (Ni )i∈I which converges to N in N (F ) such that F/Ni ∈
    C for all i ∈ I.

Corollary 7.1.21. Let C be a class of groups which is closed under taking
subgroups. Then every ﬁnitely presented group which is locally embeddable
into C is residually C.

Proof. Let G be a ﬁnitely presented group which is locally embeddable into C.
Fix g ∈ G \ {1G }. Since G is ﬁnitely presented, there exists a free group F of
ﬁnite rank and a ﬁnite subset R ⊂ F such that G = F/N , where N ∈ N (F )
denotes the normal closure of R in F . By Theorem 7.1.19, there exists a net
(Ni )i∈I in N (F ) converging to N such that F/Ni ∈ C for all i ∈ I. Let
ρ : F → G denote the quotient homomorphism and choose an element f ∈ F
such that ρ(f ) = g. Since the net (Ni )i∈I converges to N , we can ﬁnd i0 ∈ I
such that
                      N ∩ (R ∪ {f }) = Ni0 ∩ (R ∪ {f }).                  (7.6)
As R ⊂ N , this implies R ⊂ Ni0 and hence N ⊂ Ni0 . Thus, there is a
canonical epimorphism φ : G = F/N → C = F/Ni0 . Observe now that f ∈    /N
and therefore f ∈/ Ni0 by (7.6). It follows that φ(g) = 1C . As C ∈ C, this
shows that G is residually C.

Corollary 7.1.22. Let C be a class of groups which is closed under taking
subgroups and under ﬁnite direct products. Then a ﬁnitely presented group is
locally embeddable into C if and only if it is residually C.

Proof. The fact that every ﬁnitely presented group which is locally embed-
dable into C is residually C follows from the previous corollary. The converse
implication follows from Corollary 7.1.14.

   We end this section by producing an example showing that Theorem 7.1.19
becomes false if we omit the hypothesis that F is free. Let us ﬁrst establish
the following:

Proposition 7.1.23. Let C be a class of groups. Let G be a group. Suppose
that there exists a net (Ni )i∈I which converges to {1G } in N (G) such that
G/Ni ∈ C for all i ∈ I. Then G is residually C.

Proof. Let g ∈ G \ {1G }. Let us set F = {1G , g}. Since the net (Ni )i∈I
converges to {1G } in N (G), there exists i0 ∈ I such that Ni0 ∩ F = {1G } ∩ F .
As F ∩{1G } = {1G }, this implies g ∈
                                    / Ni0 . Thus, the quotient homomorphism
φ : G → G/Ni0 satisﬁes φ(g) = 1G/Ni0 . As G/Ni0 ∈ C, this shows that G is
residually C.

   Now, to exhibit the promised example showing the necessity of the freeness
hypothesis on F in Theorem 7.1.19, we consider the additive group G = Q
of rational numbers and take as C the class of ﬁnite groups. It follows from
Example 2.1.9 that Q is not residually ﬁnite. Thus, by the preceding propo-
7.2 Local Embeddability and Ultraproducts                                       243

sition, there is no net (Ni )i∈I converging to {1G } in N (G) such that G/Ni
is ﬁnite for all i ∈ I. On the other hand, G is locally residually ﬁnite since
every ﬁnitely generated abelian group is residually ﬁnite by Corollary 2.2.4.
Therefore, G is locally embeddable into C by Corollary 7.1.15.



7.2 Local Embeddability and Ultraproducts

Suppose that we are given a family of groups (Gi )i∈I and a ﬁlter ω (cf.
Sect. J.1) on the index set I. Consider the group
                                      
                                 P =     Gi .
                                          i∈I

Let α = (αi )i∈I and β = (βi )i∈I be elements of P . We write α ∼ω β if
{i ∈ I : αi = βi } ∈ ω.

Proposition 7.2.1. One has:
  (i) α ∼ω α;
 (ii) α ∼ω β if   and   only if β ∼ω α;
(iii) if α ∼ω β   and   β ∼ω γ, then α ∼ω γ;
(iv) if α ∼ω β    and   γ ∼ω δ, then αγ ∼ω βδ;
 (v) α ∼ω β if    and   only if α−1 ∼ω β −1 ;
for all α, β, γ, δ ∈ P .

Proof. Let α = (αi )i∈I , β = (βi )i∈I , γ = (γi )i∈I and δ = (δi )i∈I ∈ P . We
have α ∼ω α since {i ∈ I : αi = αi } = I belongs to ω (cf. (F-6) in Sect. J.1).
This shows (i). Also, since {i ∈ I : αi = βi } = {i ∈ I : βi = αi } we deduce
(ii). Suppose now that α ∼ω β and β ∼ω γ. We have {i ∈ I : αi = γi } ⊃
{i ∈ I : αi = βi } ∩ {i ∈ I : βi = γi }. Thus (iii) follows from the fact that
ω, being a ﬁlter, is closed under ﬁnite intersections and taking supersets (cf.
(F-2) and (F-3) in Sect. J.1). Suppose now that α ∼ω β and γ ∼ω δ, that is,
{i ∈ I : αi = βi } and {i ∈ I : γi = δi } both belong to ω. We have

          {i ∈ I : αi γi = βi δi } ⊃ {i ∈ I : αi = βi } ∩ {i ∈ I : γi = δi }.

As ω is closed under ﬁnite intersections and taking supersets, we deduce that
{i ∈ I : αi γi = βi δi } ∈ ω, that is, αγ ∼ω βδ. This shows (iv). Finally, from
{i ∈ I : αi = βi } = {i ∈ I : αi−1 = βi−1 } we deduce (v).

  Note that it follows from (i), (ii) and (iii) in Proposition 7.2.1 that ∼ω is
an equivalence relation in P . Consider now the subset Nω ⊂ P deﬁned by

                        Nω = {α ∈ P : α ∼ω 1P = (1Gi )i∈I }.
244                                         7 Local Embeddability and Soﬁc Groups

Proposition 7.2.2. The set Nω is a normal subgroup of P .
Proof. This is an easy consequence of the properties of ∼ω stated in Propo-
sition 7.2.1. Indeed, we immediately deduce from Proposition 7.2.1(i) that
1P ∈ Nω . Suppose now that α, β ∈ Nω , that is, α ∼ω 1P and β ∼ω 1P . It
follows from Proposition 7.2.1(iv) that αβ ∼ω 1P 1P = 1P , that is, αβ ∈ Nω .
Similarly, from Proposition 7.2.1(v) we deduce that α−1 ∼ω 1−1     P  = 1P ,
that is, α−1 ∈ Nω . Thus, Nω is a subgroup of P . Finally, let γ ∈ P .
Proposition 7.2.1(iv) implies that γαγ −1 ∼ω γ1P γ −1 = 1P . It follows that
γαγ −1 ∈ Nω for all α ∈ Nω and γ ∈ P . This shows that Nω is a normal
subgroup of P .
  Observe that, given α and β in P , one has

                         αNω = βNω ⇐⇒ α ∼ω β.                               (7.7)

Indeed, one has αNω = βNω if and only if αβ −1 ∈ Nω , that is, if and only if
αβ −1 ∼ω 1P . This is equivalent to α ∼ω β by Proposition 7.2.1(iv).
   The quotient group Pω = P/Nω is called the reduced product of the family
of groups (Gi )i∈I with respect to the ﬁlter ω. In the particular case when
ω is an ultraﬁlter, one also says that Pω is the ultraproduct of the family of
groups (Gi )i∈I with respect to the ultraﬁlter ω.
Theorem 7.2.3. Let C be a class of groups, (Gi )i∈I a family of groups such
that Gi ∈ C for all i ∈ I, and ω an ultraﬁlter on the index set I. Then the
ultraproduct Pω of the family of groups (Gi )i∈I with respect to the ultraﬁlter
ω is locally embeddable into C.
Proof. Fix a ﬁnite subset K ⊂ Pω . We want to show that there exist a group
C ∈ C and a K-almost-homomorphism ϕ : Pω → C.
    Choose a representative of each element g ∈ Pω , that is, an element g =
 gi )i∈I ∈ P such that g = gNω . If h and k are arbitrary elements of K, we
(
       # ω =
have hkN       hkNω and therefore hk # ∼ω  hk by (7.7). It follows that the set
                #i = 
Ih,k = {i ∈ I : hk     hi 
                          ki } belongs to ω. Thus, since ω is closed under ﬁnite
intersections (cf.(F-5) in Sect. J.1), we have that
                                         
                                  IK =        Ih,k
                                      h,k∈K

also belongs to ω. On the other hand, if h and k are distinct elements of K,
the subset {i ∈ I : hi = ki } does not belongs to ω. As ω is an ultraﬁlter,
this implies that Ih,k = I \ {i ∈ I : 
                   
                                      hi = 
                                           ki } = {i ∈ I : 
                                                           hi = 
                                                                 ki } belongs to
ω (cf. (UF) in Sect. J.1). Using again the fact that ω is closed under ﬁnite
intersections, we deduce that
                                        
                                            
                                IK =       Ih,k
                                      h,k∈K
                                       h=k
7.2 Local Embeddability and Ultraproducts                                    245

also belongs to ω. Since ω is closed under ﬁnite intersections and ∅ ∈
                                                                     / ω (cf.
(F-1) in Sect. J.1), we can ﬁnd an index i0 ∈ I such that
                                             
                                  i0 ∈ IK ∩ IK .

  Consider the map ϕ : Pω → Gi0 deﬁned by ϕ(g) = gi0 for all g ∈ Pω . The
map ϕ satisﬁes the following properties:
(1) ϕ(hk) = hk #i = 
                    hi 0 
                         ki0 = ϕ(h)ϕ(k) for all h, k ∈ K (because i0 ∈ IK );
                 0
                  
(2) ϕ(h) = hi0 = ki0 = ϕ(k) for all h, k ∈ K such that h = k (because
          
    i0 ∈ IK ).
This shows that ϕ is a K-almost homomorphism. It follows that Pω is locally
embeddable into the class C.
Remark 7.2.4. When the ultraﬁlter ω is principal, then the group Pω itself
belongs to C. Indeed, in this case, there is an element i0 ∈ I such that ω
consists of all subsets of I containing i0 . This implies that α ∼ω β if and only
if αi0 = βi0 for all α = (αi )i∈I , β = (βi )i∈I ∈ P . Therefore, Nω consists of
all α ∈ P such that αi0 = 1Gi0 . It follows that the group Pω is isomorphic to
the group Gi0 and therefore that Pω ∈ C.
Theorem 7.2.5. Let C be a class of groups and let G be a group. The fol-
lowing conditions are equivalent:
(a) G is locally embeddable into C;
(b) there exists a family of groups (Gi )i∈I such that Gi ∈ C for all i ∈ I
    and an ultraﬁlter ω on I such that G is isomorphic to a subgroup of the
    ultraproduct Pω of the family (Gi )i∈I with respect to the ultraﬁlter ω.
Proof. If G satisﬁes (b), then G is locally embeddable into C since Pω is
locally embeddable into C by Theorem 7.2.3 and every subgroup of a group
which is locally embeddable into C is itself locally embeddable into C by
Proposition 7.1.7.
   Conversely, suppose that G is locally embeddable into C. Consider the set
I consisting of all ﬁnite subsets of G.
   For each K ∈ I we deﬁne the set

                           IK = {K  ∈ I : K ⊂ K  }.

Observe that IK = ∅ as K ∈ IK . Moreover, the family of nonempty subsets
(IK )K∈I is closed under ﬁnite intersections, since

                              IK1 ∩ IK2 = IK1 ∪K2

for all K1 , K2 ∈ I. It follows from Proposition J.1.3 and Theorem J.1.6 that
there exists an ultraﬁlter ω on I such that IK ∈ ω for all K ∈ I.
   As G is locally embeddable into C, we can ﬁnd, for each K ∈ I, a group
GK in C and a K-almost-homomorphism ϕK : G → GK .
246                                       7 Local Embeddability and Soﬁc Groups

  Consider the ultraproduct Pω of the family (GK )K∈I with respect
                                                                 to ω. By
Theorem 7.2.3, Pω is locally embeddable
                                       into  C. Let 
                                                     ϕ : G → P =   K∈I GK
denote the product map ϕ  = K∈I ϕK . Thus, we have

                             
                             ϕ(g) = (ϕK (g))K∈I

for all g ∈ G. Let ρ : P → Pω = P/Nω denote the canonical epimorphism.
Let us show that the composite map Φ = ρ ◦ ϕ    : G → Pω is an injective
homomorphism. This will prove that G is isomorphic to a subgroup of Pω .
   Let g, h ∈ G. Consider the element K0 = {g, h} ∈ I. If K ∈ I satisﬁes
K0 ⊂ K, then
                          ϕK (gh) = ϕK (g)ϕK (h)
since ϕK is a K-almost-homomorphism. Thus, the set

                     {K ∈ I : ϕK (gh) = ϕK (g)ϕK (h)}

contains IK0 and therefore belongs to ω. This implies that

                            
                            ϕ(gh) ∼ω ϕ(g)
                                      ϕ(h).
                                          

Therefore, we have Φ(gh) = Φ(g)Φ(h) by (7.7). This shows that Φ is a homo-
morphism.
  On the other hand, if g = h, we have

                               ϕK (g) = ϕK (h)

for all K ∈ I such that K0 ⊂ K. This implies that {K ∈ I : ϕK (g) =
ϕK (h)} ∈ ω. As ω is a ﬁlter, it follows that {K ∈ I : ϕK (g) = ϕK (h)} ∈
                                                                        / ω,
that is,
                                
                                ϕ(g)      
                                      ∼ω ϕ(h).
Therefore we have Φ(g) = Φ(h), again by (7.7).
  Consequently, Φ is injective. This shows that (a) implies (b).

Remark 7.2.6. Suppose that G is a group and that C is a class of groups which
is closed under taking subgroups. If G is locally embeddable into C and G ∈/C
then for any family of groups (Gi )i∈I and any ultraﬁlter ω on the index set I
satisfying condition (b) in Theorem 7.2.5, we deduce from Remark 7.2.4 that
the ultraﬁlter ω is necessarily non-principal.



7.3 LEF-Groups and LEA-Groups

Let us rewrite the results obtained in Sect. 7.1 in the particular case when
C is either the class of ﬁnite groups or the class of amenable groups. Note
that these classes are closed under taking subgroups and taking ﬁnite direct
7.3 LEF-Groups and LEA-Groups                                              247

products (this is trivial for ﬁnite groups and follows from Proposition 4.5.1
and Corollary 4.5.6 for amenable groups), so that all the results established
in Sect. 7.1 apply to these two classes.
   We shall use the following terminology, which is very popular in the ﬁeld.
A group which is locally embeddable into the class of ﬁnite groups is brieﬂy
called an LEF -group. Similarly, a group which is locally embeddable into the
class of amenable groups is called an LEA-group. Note that every LEF-group
is LEA since the class of ﬁnite groups is contained in the class of amenable
groups by Proposition 4.4.6.
   We deduce from Proposition 7.1.6 the following characterization of LEF-
groups.

Proposition 7.3.1. Let G be a group. Then the following conditions are
equivalent:
(a) G is an LEF-group;
(b) for every ﬁnite subset K ⊂ G, there exist a ﬁnite set L with K ⊂ L ⊂ G
    and a binary operation ! : L × L → L such that (L, !) is a group and
    k1 k2 = k1 ! k2 for all k1 , k2 ∈ K.


   Analogously, we deduce from Proposition 7.1.6 the following characteriza-
tion of LEA-groups.

Proposition 7.3.2. Let G be a group. Then the following conditions are
equivalent:
(a) G is an LEA-group;
(b) for every ﬁnite subset K ⊂ G, there exist a set L with K ⊂ L ⊂ G and
    a binary operation ! : L × L → L such that (L, !) is an amenable group
    and k1 k2 = k1 ! k2 for all k1 , k2 ∈ K.


  From Theorem 7.2.5 we deduce the following characterization of LEF (resp.
LEA) groups in terms of ultraproducts.

Corollary 7.3.3. Let G be a group. The following conditions are equivalent:
(a) G is an LEF (resp. LEA) group;
(b) there exists a family of ﬁnite (resp. amenable) groups (Gi )i∈I and an ul-
    traﬁlter ω on I such that G is isomorphic to a subgroup of the ultraproduct
    Pω of the family (Gi )i∈I with respect to the ultraﬁlter ω.


  From Corollary 7.1.15, we get:

Proposition 7.3.4. Every locally residually ﬁnite group is LEF and therefore
LEA.
248                                         7 Local Embeddability and Soﬁc Groups

Corollary 7.3.5. All ﬁnite groups, all residually ﬁnite groups, all proﬁnite
groups, all free groups, all abelian groups, and all locally ﬁnite groups are
LEF and therefore LEA.

Proof. In order to complete the proof, it suﬃces to recall that free groups
(resp. proﬁnite groups) are residually ﬁnite by Theorem 2.3.1 (resp. Corol-
lary 2.2.8) and that abelian groups are locally residually ﬁnite by Corol-
lary 2.2.4.

  Similarly, by applying Corollary 7.1.15 to the class of amenable groups,
we get:

Proposition 7.3.6. Every locally residually amenable group is LEA.

   From Proposition 7.1.7, Proposition 7.1.8, Proposition 7.1.10, Corol-
lary 7.1.11, Corollary 7.1.12, Corollary 7.1.17, and Theorem 7.1.19, we get:

Proposition 7.3.7. The following assertions hold:
   (i) every subgroup of an LEF-group (resp. LEA-group) is an LEF-group
       (resp. LEA-group);
  (ii) a group is LEF (resp. LEA) if and only if all its ﬁnitely generated sub-
       groups are LEF (resp. LEA);
 (iii) let (Gi )i∈I be 
                       a family of LEF-groups (resp. LEA-groups). Then their
       direct product i∈I Gi is an LEF-group (resp. LEA-group);
 (iv) let (Gi )i∈I be a family of LEF-groups (resp. LEA-groups). Then their
       direct sum i∈I Gi is an LEF-group (resp. LEA-group);
  (v) let (Gi )i∈I be a projective system of LEF-groups (resp. LEA-groups).
       Then their projective limit G = lim Gi is an LEF-group (resp. LEA-
                                          ←−
       group);
 (vi) Let Γ be a group. Then the set of all N ∈ N (Γ ) such that Γ/N is LEF
       (resp. LEA) is closed (and hence compact) in N (Γ ).
(vii) let F be a free group and let N ∈ N (F ). Then F/N is an LEF-group
       (resp. LEA-group) if and only if there exists a net (Ni )i∈I in N (F ) with
       F/Ni ﬁnite (resp. amenable) for all i ∈ I such that N = limi Ni .


  Finally, we deduce from Corollary 7.1.21 the following:

Proposition 7.3.8. A ﬁnitely presented group is LEF (resp. LEA) if and
only if it is residually ﬁnite (resp. residually amenable).

   As we have observed at the end of the previous section, the additive group
Q is LEF but not residually ﬁnite. On the other hand, it follows from Propo-
sition 7.3.8 that every ﬁnitely presented LEF-group is residually ﬁnite. The
group Q is not ﬁnitely generated. However, there exist ﬁnitely generated
LEF-groups which are not residually ﬁnite. An example of such a group is
provided by the group G1 introduced in Sect. 2.6:
7.3 LEF-Groups and LEA-Groups                                              249

Proposition 7.3.9. The group G1 of Sect. 2.6 is a ﬁnitely generated amenable
LEF-group which is not residually ﬁnite.

Proof. By construction, the group G1 is ﬁnitely generated since it is deﬁned
as being a subgroup of Sym(Z) generated by two elements, namely the trans-
position (0 1) and the translation n → n + 1.
   The group G1 is not residually ﬁnite by Proposition 2.6.1.
   Recall that, denoting by Sym0 (Z) the normal subgroup of Sym(Z) con-
sisting of all permutations of Z with ﬁnite support, the group G1 is the
semidirect product of Sym0 (Z) with the inﬁnite cyclic group generated by
the translation T : n → n + 1 (see Lemma 2.6.4). Therefore, each ele-
ment g ∈ G1 can be uniquely written in the form g = T i(g) σ(g), where
i(g) ∈ Z and σ(g) ∈ Sym0 (Z). Note that we have i(gh) = i(g) + i(h) and
σ(gh) = T −i(h) σ(g)T i(h) σ(h) for all g, h ∈ G1 .
   To prove that G1 is an LEF-group, consider a ﬁnite subset K ⊂ G1 . Let
us show that there exist a ﬁnite group F and a K-almost-homomorphism of
G1 into F .
   Let  = maxk∈K |i(k)| and choose an integer r ≥  such that the supports
of the elements T −j σ(k)T j ∈ Sym0 (Z) are contained in the interval [−r, r]
for all − ≤ j ≤  and k ∈ K. Let us set R = 4r,

               X = {−R, −R + 1, . . . , −1, 0, 1, . . . , R − 1, R},

and F = Sym(X). Consider the (2R + 1)-cycle γ ∈ F given by

                γ = (−R − R + 1 − R + 2 · · · R − 1 R).

For all σ ∈ Sym0 (Z) whose support is contained in X, let σ ∈ F denote the
element deﬁned by σ(x) = σ(x) for all x ∈ X. Observe that if σ, σ  ∈ Sym0 (Z)
have both their support contained in X, then so does σσ  and that we have

                                   σσ  = σσ  .                         (7.8)

  Moreover, for all k ∈ K and j ∈ Z such that − ≤ j ≤ , the supports of
σ(k) and T −j σ(k)T j are contained in X and we have

                          T −j σ(k)T j = γ −j σ(k)γ j .                  (7.9)

Indeed, suppose ﬁrst that x ∈ [−2r, 2r]. Then x + j ∈ [−3r, 3r] ⊂ X and we
have
                    [T −j σ(k)T j ](x) = [T −j σ(k)](x + j)
                                       = T −j (σ(k)(x + j))
                                       = σ(k)(x + j) − j,

and
250                                               7 Local Embeddability and Soﬁc Groups

                        [γ −j σ(k)γ j ](x) = [γ −j σ(k)](x + j)
                                                  (             )
                                           = γ −j σ(k)(x + j)
                                           = γ −j (σ(k)(x + j))
                                           = σ(k)(x + j) − j.

Suppose now that x ∈ X \ [−2r, 2r]. Then [T −j σ(k)T j ](x) = x since the
support of T −j σ(k)T j is contained in [− + r, r + ] ⊂ [−2r, 2r]. On the other
hand, if we denote, for y ∈ Z, by y the unique element in {y + (2R + 1)n :
n ∈ Z} ∩ [−R, R], we have

                                  x
                                   + j ∈ X \ [−r, r]                               (7.10)

and

                        [γ −j σ(k)γ j ](x) = [γ −j σ(k)](x
                                                          + j)
                                                  (            )
                                           = γ −j σ(k)(x + j)

                            by (7.10) = γ −j (x
                                               + j)
                                      = x.

This shows (7.9).
  Deﬁne a map ϕ : G1 → F by setting ϕ(g) = γ i(g) σ(g) if the support of
σ(g) is contained in X, and ϕ(g) = 1F otherwise. Let us show that ϕ is a
K-almost-homomorphism.
  Let k1 , k2 ∈ K. We have

                ϕ(k1 k2 ) = ϕ[T i(k1 )+i(k2 ) (T −i(k2 ) σ(k1 )T i(k2 ) σ(k2 ))]
                           = γ i(k1 )+i(k2 ) T −i(k2 ) σ(k1 )T i(k2 ) σ(k2 )
            (by (7.8)) = γ i(k1 )+i(k2 ) · T −i(k2 ) σ(k1 )T i(k2 ) σ(k2 )
            (by (7.9)) = γ i(k1 )+i(k2 ) · γ −i(k2 ) σ(k1 )γ i(k2 ) · σ(k2 )
                           = γ i(k1 ) σ(k1 )γ i(k2 ) σ(k2 )
                           = ϕ[T i(k1 ) σ(k1 )]ϕ[T i(k2 ) σ(k2 )]
                           = ϕ(k1 )ϕ(k2 ).

Let us show that ϕ|K is injective. Let k1 , k2 ∈ K and suppose that ϕ(k1 ) =
ϕ(k2 ). This implies that γ i(k1 ) σ(k1 ) = γ i(k2 ) σ(k2 ), that is, γ i(k1 )−i(k2 ) =
              −1                                               −1
σ(k2 ) · σ(k1 ) . But the support of σ(k2 ) · σ(k1 )   is contained in [−r, r]
while the support of γ i , i ∈ Z, is the whole set X if i is not a multiple of
2R + 1. As |i(k1 ) − i(k2 )| ≤ 2 < 2R + 1, we deduce that i(k1 ) − i(k2 ) = 0
                   −1
and σ(k2 ) · σ(k1 ) = 1F . This implies i(k1 ) = i(k2 ) and σ(k1 ) = σ(k2 ), and
therefore k1 = k2 . This shows that the restriction of ϕ to K is injective. It
7.4 The Hamming Metric                                                               251

follows that ϕ is a K-almost homomorphism and therefore that G1 is an LEF
group.
   Finally, observe that the group Sym0 (Z) is locally ﬁnite and therefore
amenable by Corollary 4.5.12. Now, G1 is the semidirect product of the
amenable group Sym0 (Z) with an inﬁnite cyclic (and therefore amenable)
group so that, by Proposition 4.5.5, it is an amenable group as well.
Remarks 7.3.10. (a) From Proposition 7.3.4 and Proposition 7.3.9, we deduce
that the class of locally residually ﬁnite groups is strictly contained in the
class of LEF-groups.
   (b) Proposition 7.3.8 and Proposition 7.3.9 imply that the group G1 is not
ﬁnitely presentable.



7.4 The Hamming Metric

Let G be a group.
   A metric d on G is called left-invariant (resp. right-invariant) if d(hg1 ,
hg2 ) = d(g1 , g2 ) (resp. d(g1 h, g2 h) = d(g1 , g2 )) for all g1 , g2 , h ∈ G. A metric
on G which is both left and right-invariant is called bi-invariant.
   Note that a left-invariant (resp. right-invariant) metric d on G is entirely
determined by the map g → d(1G , g), g ∈ G, since d(h, k) = d(1G , h−1 k)
(resp. d(h, k) = d(1G , kh−1 )) for all h, k ∈ G.
   Let now F be a nonempty ﬁnite set and consider the symmetric group
Sym(F ). For α ∈ Sym(F ), we denote by Fix(α) the set {x ∈ F : α(x) = x} of
ﬁxed points of α. The support of α is the set {x ∈ F : α(x) = x} = F \Fix(α),
so that we have

                      |{x ∈ F : α(x) = x}| = |F | − | Fix(α)|.                   (7.11)

   Consider the map dF : Sym(F ) × Sym(F ) → R deﬁned by

                                       |{x ∈ F : α1 (x) = α2 (x)}|
                     dF (α1 , α2 ) =                                              (7.12)
                                                  |F |

for all α1 , α2 ∈ Sym(F ). Observe that the set {x ∈ F : α1 (x) = α2 (x)} =
{x ∈ F : x = α1−1 α2 (x)} is the support of α1−1 α2 , so that (7.11) gives us

                                               | Fix(α1−1 α2 )|
                         dF (α1 , α2 ) = 1 −                    .                 (7.13)
                                                     |F |
Proposition 7.4.1. Let F be a nonempty ﬁnite set. Then dF is a bi-invariant
metric on Sym(F ).
Proof. It is immediate from the deﬁnition that dF (α1 , α2 ) ≥ 0 and dF (α1 , α2 ) =
dF (α2 , α1 ) for all α1 , α2 ∈ Sym(F ). Moreover, the equality dF (α1 , α2 ) = 0
holds if and only if α1 (x) = α2 (x) for all x ∈ F , that is, if and only if α1 = α2 .
252                                           7 Local Embeddability and Soﬁc Groups

   Let now α1 , α2 , α3 ∈ Sym(F ). If x ∈ F satisﬁes α1 (x) = α2 (x), then
α1 (x) = α3 (x) or α2 (x) = α3 (x). Thus, we have the inclusion

{x ∈ F : α1 (x) = α2 (x)} ⊂ {x ∈ F : α1 (x) = α3 (x)} ∪ {x ∈ F : α2 (x) = α3 (x)}.

This implies
                  1
 dF (α1 , α2 ) =      |{x ∈ F : α1 (x) = α2 (x)}|
                 |F |
                  1
               ≤      |{x ∈ F : α1 (x) = α3 (x)} ∪ {x ∈ F : α2 (x) = α3 (x)}|
                 |F |
                  1
               ≤       (|{x ∈ F : α1 (x) = α3 (x)}| + |{x ∈ F : α2 (x) = α3 (x)}|)
                 |F |
               = dF (α1 , α3 ) + dF (α2 , α3 ).

This shows that dF also satisﬁes the triangle inequality. Therefore, dF is a
metric on Sym(F ).
   It remains to show that dF is bi-invariant. Let α1 , α2 , β ∈ Sym(F ). Since
β is bijective, we have
           {x ∈ F : βα1 (x) = βα2 (x)} = {x ∈ F : α1 (x) = α2 (x)}.
This implies that
                                  1
                dF (βα1 , βα2 ) =     |{x ∈ F : βα1 (x) = βα2 (x)}|
                                 |F |
                                  1
                               =      |{x ∈ F : α1 (x) = α2 (x)}|
                                 |F |
                               = dF (α1 , α2 ).

Thus, dF is left-invariant. On the other hand, we have
        {x ∈ F : α1 β(x) = α2 β(x)} = β −1 ({x ∈ F : α1 (x) = α2 (x)}),
which implies
                                 1
               dF (α1 β, α2 β) =     |{x ∈ F : α1 β(x) = α2 β(x)}|
                                |F |
                                 1 −1
                              =      |β ({x ∈ F : α1 (x) = α2 (x)})|
                                |F |
                                 1
                              =      |{x ∈ F : α1 (x) = α2 (x)}|
                                |F |
                              = dF (α1 , α2 ).
Consequently, dF is also right-invariant.
Deﬁnition 7.4.2. Let F be a nonempty ﬁnite set. The bi-invariant metric
dF is called the (normalized) Hamming metric on Sym(F ).
  Suppose now that m is a positive integer and that F1 , F2 , . . . , Fm are
nonempty ﬁnite sets. Consider the Cartesian product F = F1 × F2 × · · · × Fm
7.4 The Hamming Metric                                                                     253
                                                m
and the natural group homomorphism Φ : i=1 Sym(Fi ) → Sym(F ) deﬁned
by
                     Φ(α)(x) = (α1 (x1 ), α2 (x2 ), . . . , αm (xm ))
                                     m
for all α = (α1 , α2 , . . . , αm ) ∈ i=1 Sym(Fi ) and x = (x1 , x2 , . . . , xm ) ∈ F .
Proposition 7.4.3. With the above notation, one has
                                                
                                                m
                    dF (Φ(α), Φ(β)) = 1 −           (1 − dFi (αi , βi ))                (7.14)
                                                i=1
                                                       m
for all α = (αi )1≤i≤m and β = (βi )1≤i≤m in               i=1 Sym(Fi ).
                                                           m
Proof. First observe
             m      that if α = (αi )1≤i≤m ∈                i=1 Sym(Fi ),       then we have
Fix(Φ(α)) = i=1 Fix(αi ), and therefore

                                           | Fix(α)|
                   dF (IdF , Φ(α)) = 1 −
                                              |F |
                                           m
                                                  | Fix(αi )|
                                      = 1 − i=1m
                                                 i=1 |Fi |
                                           m
                                               | Fix(αi )|
                                      =1−
                                           i=1
                                                   |Fi |
                                              
                                              m
                                      =1−         (1 − dFi (IdFi , αi )).
                                              i=1
                                                                        m
We deduce that, for all α = (αi )1≤i≤m , β = (βi )1≤i≤m ∈                   i=1   Sym(Fi ), we
have
      dF (Φ(α), Φ(β)) = d(IdF , Φ(α)−1 Φ(β))            (by left-invariance of dF )
                                           −1
                        = dF (IdF , Φ(α β))
                              m
                        =1−      (1 − dFi (IdFi , αi−1 βi )
                                i=1
                                m
                        =1−         (1 − dFi (αi , βi ))
                                i=1

where the last equality follows from the left-invariance of dFi .
Corollary 7.4.4. Let m be a positive integer and let F be a nonempty ﬁnite
set. Consider the homomorphism

                              Ψ : Sym(F ) → Sym(F m )                                   (7.15)

deﬁned by

               Ψ (α)(x1 , x2 , . . . , xm ) = (α(x1 ), α(x2 ), . . . , α(xm ))
254                                          7 Local Embeddability and Soﬁc Groups

for all α ∈ Sym(F ) and x1 , x2 , . . . , xm ∈ F . Then one has

                   dF m (Ψ (α), Ψ (β)) = 1 − (1 − dF (α, β))m               (7.16)

for all α, β ∈ Sym(F ).



7.5 Soﬁc Groups

Deﬁnition 7.5.1. Let G be a group, K ⊂ G a ﬁnite subset, and ε > 0. Let
F be a nonempty ﬁnite set. A map ϕ : G → Sym(F ) is called a (K, ε)-almost-
homomorphism if it satisﬁes the following conditions:
((K, ε)-AH-1) for all k1 , k2 ∈ K, one has dF (ϕ(k1 k2 ), ϕ(k1 )ϕ(k2 )) ≤ ε;
((K, ε)-AH-2) for all k1 , k2 ∈ K, k1 = k2 , one has dF (ϕ(k1 ), ϕ(k2 )) ≥ 1 − ε,
where dF denotes the normalized Hamming metric on Sym(F ).

Deﬁnition 7.5.2. A group G is called soﬁc if it satisﬁes the following condi-
tion: for every ﬁnite subset K ⊂ G and every ε > 0, there exist a nonempty
ﬁnite set F and a (K, ε)-almost-homomorphism ϕ : G → Sym(F ).

Proposition 7.5.3. Every ﬁnite group is soﬁc.

Proof. Let G be a ﬁnite group. Consider the map L : G → Sym(G) deﬁned
by L(g)(h) = gh for all g, h ∈ G. As L is a homomorphism (cf. the proof of
Cayley’s theorem (Theorem C.1.2)), we have

                          dG (L(g1 g2 ), L(g1 )L(g2 )) = 0                  (7.17)

for all g1 , g2 ∈ G. Moreover, for all distinct g1 , g2 ∈ G we have L(g1 )(h) =
g1 h = g2 h = L(g2 )(h) for all h ∈ G so that

                             dG (L(g1 ), L(g2 )) = 1.                       (7.18)

This shows that L is a (K, ε)-almost-homomorphism for all K ⊂ G and ε > 0.
It follows that G is soﬁc.

Proposition 7.5.4. Every subgroup of a soﬁc group is soﬁc.

Proof. Let G be a soﬁc group and let H be a subgroup of G. Fix a ﬁnite
subset K ⊂ H and ε > 0. As G is soﬁc, there exists a nonempty ﬁnite set F
and a (K, ε)-almost-homomorphism ϕ : G → Sym(F ). Then the restriction
map ϕ|H : H → Sym(F ) is a (K, ε)-almost-homomorphism. This shows that
H is soﬁc.

Proposition 7.5.5. Every locally soﬁc group is soﬁc.
7.5 Soﬁc Groups                                                             255

Proof. Let G be a locally soﬁc group. Let K ⊂ G be a ﬁnite subset and ε > 0.
Denote by H the subgroup of G generated by K. Then, as H is soﬁc, there
exist a nonempty ﬁnite set F and a (K, ε)-almost-homomorphism ψ : H →
Sym(F ). Extend arbitrarily ψ to a map ϕ : G → Sym(F ), for example by
setting ϕ(g) = IdF for all g ∈ G \ H. It is clear that ϕ is a (K, ε)-almost-
homomorphism. This shows that G is soﬁc.

   From Proposition 7.5.3 and Proposition 7.5.5, we immediately deduce that
every locally ﬁnite group is soﬁc. As any locally ﬁnite group is amenable by
Corollary 4.5.12, this is actually covered by the following:

Proposition 7.5.6. Every amenable group is soﬁc.

Proof. Suppose that G is an amenable group. Let K ⊂ G be a ﬁnite subset
and ε > 0. Set S = ({1G } ∪ K ∪ K −1 )2 . Since G is amenable, it follows from
Theorem 4.9.1 and Proposition 4.7.1(a) that there exists a nonempty ﬁnite
subset F ⊂ G such that
                                            ε
                               |F \ sF | ≤     |F |                     (7.19)
                                           |S|
                                         
for all s ∈ S. Consider the set E = s∈S sF . Observe that E ⊂ F since
1G ∈ S. In fact, as S = S −1 , we get

                                       sE ⊂ F                            (7.20)

for all s ∈ S. Moreover, we have
                                              
                         |F \ E| = |F \             sF |
                                              s∈S
                                        !
                                   =|         (F \ sF )|
                                        s∈S                              (7.21)
                                   ≤         |F \ sF |
                                       s∈S

                                   ≤ ε|F |       by (7.19).

This implies
                               |E| ≥ (1 − ε)|F |.                        (7.22)
For each g ∈ G, we have |F | = |gF | and hence |F \ gF | = |gF \ F |. Therefore,
we can ﬁnd a bijective map αg : gF \ F → F \ gF . Consider the map ϕ : G →
Sym(F ) deﬁned by setting
                                 
                                   gf        if gf ∈ F
                      ϕ(g)(f ) =
                                   αg (gf ) otherwise

for all g ∈ G and f ∈ F (see Fig. 7.1).
256                                          7 Local Embeddability and Soﬁc Groups




Fig. 7.1 The maps αg : gF \ F → F \ gF and ϕ(g) ∈ Sym(F ). We have ϕ(g)(f1 ) = gf1 ,
ϕ(g)(f2 ) = αg (gf2 ) and ϕ(g)(f3 ) = αg (gf3 )




   Now, suppose that k1 , k2 ∈ K and f ∈ E. Then we have k2 , k1 k2 ∈ S,
so that k2 f, k1 k2 f ∈ F by (7.20). This implies ϕ(k1 k2 )(f ) = k1 k2 f and
(ϕ(k1 )ϕ(k2 ))(f ) = ϕ(k1 )(ϕ(k2 )(f )) = ϕ(k1 )(k2 f ) = k1 k2 f . Therefore, the
permutations ϕ(k1 k2 ) and ϕ(k1 )ϕ(k2 ) coincide on E. From (7.21), we deduce
that
                                                    |F \ E|
                     dF (ϕ(k1 k2 ), ϕ(k1 )ϕ(k2 )) ≤         ≤ε
                                                      |F |
for all k1 , k2 ∈ K.
   On the other hand, if k1 , k2 ∈ K, k1 = k2 , and f ∈ E, then we have
k1 f, k2 f ∈ F so that ϕ(k1 )(f ) = k1 f = k2 f = ϕ(k2 )(f ). By using (7.22), we
deduce that
                                               |E|
                        dF (ϕ(k1 ), ϕ(k2 )) ≥       ≥1−ε
                                               |F |
for all k1 , k2 ∈ K with k1 = k2 . Thus, the map ϕ : G → Sym(F ) is a (K, ε)-
almost-homomorphism. This shows that G is a soﬁc group.

   Observe that, when G is ﬁnite, the proof of Proposition 7.5.6 reduces to
that of Proposition 7.5.3 by taking F = G.

Proposition7.5.7. Let (Gi )i∈I be a family of soﬁc groups. Then, their direct
product G = i∈I Gi is soﬁc.

Proof. For each i ∈ I, let πi : G → Gi denote the projection homomorphism.
Fix a ﬁnite subset K ⊂ G and ε > 0. Then there exists a ﬁnite subset J ⊂ I
7.5 Soﬁc Groups                                                                  257
                                                 
such that the projection πJ = j∈J πj : G → GJ = j∈J Gj is injective on
K. Choose a constant 0 < η < 1 small enough so that

                              1 − (1 − η)|J| ≤ ε                              (7.23)

and
                                       η ≤ ε.                                 (7.24)
Since the group Gj is soﬁc for each j ∈ J, we can ﬁnd a nonempty ﬁnite set
                          homomorphism ϕj : Gj → Sym(Fj ). Consider the
Fj and a (πj (K), η)-almost
nonempty ﬁnite set F = j∈J Fj and the map ϕ : G → Sym(F ) deﬁned by

                          ϕ(g)(f ) = (ϕj (gj )(fj ))j∈J

for all g = (gi )i∈I ∈ G, and f = (fj )j∈J ∈ F . Then, for all k, k ∈ K, we
have, by applying (7.14),
                                     
      dF (ϕ(kk ), ϕ(k)ϕ(k )) = 1 −    1 − dFj (ϕj (kj kj ), ϕj (kj )ϕj (kj )
                                    j∈J

                             ≤ 1 − (1 − η)|J|
                             ≤ε    (by (7.23)).

On the other hand, if k and k are distinct elements in K, then there exists
j0 ∈ J such that kj0 = kj 0 . This implies, again by using (7.14),
                                       
             dF (ϕ(k), ϕ(k )) = 1 −         (1 − dFj (ϕj (kj ), ϕj (kj ))
                                       j∈J

                              ≥ 1 − (1 − dFj0 (ϕj0 (kj0 ), ϕj0 (kj 0 ))
                              ≥1−η
                              ≥1−ε           (by (7.24)).

This shows that ϕ is a (K, ε)-almost-homomorphism of G. It follows that G
is soﬁc.

Corollary7.5.8. Let (Gi )i∈I be a family of soﬁc groups. Then their direct
sum G = i∈I Gi is soﬁc.

Proof. This follows immediately from Proposition 7.5.4
                                                      and Proposition 7.5.7,
since G is the subgroup of the direct product P = i∈I Gi consisting of all
g = (gi ) ∈ P for which gi = 1Gi for all but ﬁnitely many i ∈ I.

Corollary 7.5.9. The limit of a projective system of soﬁc groups is soﬁc.

Proof. Let (Gi )i∈I be a projective system of soﬁc groups such that G =
lim Gi . By construction of a projective limit (see Appendix E), G is a sub-
←−
258                                             7 Local Embeddability and Soﬁc Groups
                    
group of the group i∈I Gi . We deduce that G is soﬁc by using Proposi-
tion 7.5.7 and Proposition 7.5.4.

Proposition 7.5.10. Every group which is locally embeddable into the class
of soﬁc groups is soﬁc.

Proof. Let G be a group which is locally embeddable into the class of soﬁc
groups. Let K ⊂ G be a ﬁnite subset and ε > 0. By deﬁnition of local
embeddability, there exists a soﬁc group G and a K-almost-homomorphism
ϕ : G → G . Set K  = ϕ(K). By soﬁcity of G , there exists a nonempty
ﬁnite set F and a (K  , ε)-almost-homomorphism ϕ : G → Sym(F ). Let us
prove that the composite map Φ = ϕ ◦ ϕ : G → Sym(F ) is a (K, ε)-almost-
homomorphism. Let k1 , k2 ∈ K. Then we have

      dF (Φ(k1 k2 ), Φ(k1 )Φ(k2 )) = dF (ϕ (ϕ(k1 k2 )), ϕ (ϕ(k1 ))ϕ (ϕ(k2 )))
                                   = dF (ϕ (ϕ(k1 )ϕ(k2 )), ϕ (ϕ(k1 ))ϕ (ϕ(k2 )))
                                   ≤ ε (as ϕ(k1 ), ϕ(k2 ) ∈ K  ).

Finally, let k1 , k2 ∈ K be such that k1 = k2 . Since ϕ|K is injective, we have
ϕ(k1 ) = ϕ(k2 ) and therefore

              dF (Φ(k1 ), Φ(k2 )) = dF (ϕ (ϕ(k1 )), ϕ (ϕ(k2 ))) ≥ 1 − ε.

Thus, Φ is a (K, ε)-almost-homomorphism. It follows that G is soﬁc.

  Since every amenable group is soﬁc by Proposition 7.5.6, an immediate
consequence of Proposition 7.5.10 is the following:

Corollary 7.5.11. Every LEA-group is soﬁc. In particular, every LEF-
group, every locally residually amenable group, every locally residually ﬁnite
group, every residually amenable group, and every residually ﬁnite group is
soﬁc.

   As the class of soﬁc groups is closed under direct products by Proposi-
tion 7.5.7, it follows from Corollary 7.1.15 that every locally residually soﬁc
group is locally embeddable into the class of soﬁc groups. By applying Propo-
sition 7.5.10, we get:

Corollary 7.5.12. Every locally residually soﬁc group is soﬁc.

   It follows from Proposition 7.5.10 that the class of groups which are locally
embeddable into the class of soﬁc groups coincide with the class of soﬁc
groups. By applying Corollary 7.1.17, we then deduce the following:

Corollary 7.5.13. Let Γ be a group. Then the set of Γ -marked groups N ∈
N (Γ ) such that Γ/N is soﬁc is closed (and hence compact) for the prodiscrete
topology on N (Γ ) ⊂ P(Γ ) = {0, 1}Γ .
7.5 Soﬁc Groups                                                                  259

   We end this section by showing that extensions of soﬁc groups by amenable
groups are soﬁc. This is a generalization of Proposition 7.5.6 since every
amenable group is an extension of the trivial group by itself.
Proposition 7.5.14. Let G be a group. Suppose that G contains a normal
subgroup N such that N is soﬁc and G/N is amenable. Then G is soﬁc.
Proof. Let K ⊂ G be a ﬁnite subset and 0 < ε < 1. Denote by g the image of
an element g ∈ G under the canonical epimorphism of G onto G/N . Fix a set
T ⊂ G of representatives for the cosets of N in G and denote by σ : G/N → T
the map which associates with each element in G/N its representative
                                                                 √          in T .
Note that σ(g)−1 g ∈ N for all g ∈ G. Also set ε = 1 − 1 − ε, so that
0 < ε < ε and (1 − ε )2 = 1 − ε.
   Since G/N is amenable and hence soﬁc by Proposition 7.5.6, there exist
a nonempty ﬁnite set F1 and a (K, ε )-almost-homomorphism ϕ1 : G/N →
Sym(F1 ). In fact, in the proof of Proposition 7.5.6 it is shown that we can take
F1 ⊂ G/N such that there exists a subset E1 ⊂ F1 with |E1 | ≥ (1 − ε )|F1 |
satisfying ϕ1 (k)(f1 ) = kf1 ∈ F1 and ϕ1 (hk)(f1 ) = hkf1 ∈ F1 for all h, k ∈ K
and f1 ∈ E1 .
   Set M = N ∩ (σ(F1 )−1 · K · σ(F1 )) ⊂ N . As N is soﬁc, we can ﬁnd a ﬁnite
set F2 and an (M, ε )-almost-homomorphism ϕ2 : N → Sym(F2 ). Thus, for
all m, m ∈ M we can ﬁnd a set E2 ⊂ F2 such that |E2 | ≥ (1 − ε)|F2 | and

             ϕ2 (mm )(f2 ) = ϕ2 (m)(ϕ2 (m )(f2 )) for all f2 ∈ E2 .         (7.25)

  Set F = F1 × F2 and E = E1 × E2 and observe that

              |E| = |E1 | · |E2 | ≥ (1 − ε )2 |F1 | · |F2 | = (1 − ε)|F |.   (7.26)

  Consider the map Φ : G → Sym(F ) deﬁned by setting

             Φ(g)(f1 , f2 ) = (ϕ1 (g)(f1 ), ϕ2 (σ(gf1 )−1 gσ(f1 ))(f2 ))

for all g ∈ G and (f1 , f2 ) ∈ F . Let us show that Φ is a (K, ε)-almost-
homomorphism.
   Let h, k ∈ K and (f1 , f2 ) ∈ E. Recall that the elements kf1 = ϕ1 (k)(f1 )
and hkf1 = ϕ1 (hk)(f1 ) = ϕ1 (h)(ϕ1 (k)(f1 )) both belong to F1 for all f1 ∈ E1 .
It follows that
 Φ(h)Φ(k)(f1 , f2 ) = Φ(h)(ϕ1 (k)(f1 ), ϕ2 (σ(kf1 )−1 kσ(f1 ))(f2 ))
                    = (ϕ1 (h)(ϕ1 (k)(f1 )), ϕ2 (σ(hϕ1 (k)(f1 ))−1 hσ(ϕ1 (k)(f1 )))
                          (ϕ2 (σ(kf1 )−1 kσ(f1 ))(f2 )))
                    = (ϕ1 (hk)(f1 ), ϕ2 (σ(hkf1 )−1 hσ(kf1 ))
                          (ϕ2 (σ(kf1 )−1 kσ(f1 ))(f2 )))
                    =∗ (ϕ1 (hk)f1 , ϕ2 (σ(hkf1 )−1 hkσ(f1 ))(f2 ))
                    = Φ(hk)(f1 , f2 )
260                                            7 Local Embeddability and Soﬁc Groups

where =∗ follows from (7.25) since m = σ(hkf1 )−1 hσ(kf1 ) and m =
σ(kf1 )−1 kσ(f1 ) both belong to (σ(F1 )−1 Kσ(F1 )) ∩ N = M . It follows from
(7.26) that dF (Φ(hk), Φ(h)Φ(k)) ≤ ε.
   Let now h, k ∈ K be such that h = k. We distinguish two cases.
   If h = k then, as ϕ1 is a (K, ε)-almost-homomorphism, we have dF1 (ϕ1 (h),
ϕ1 (k)) ≥ 1 − ε. It follows that there exists a subset B ⊂ F1 such that |B| ≥
(1 − ε)|F1 | such that ϕ1 (h)(b) = ϕ1 (k)(b) for all b ∈ B. Setting B  = B × F2
we have that

               |B  | = |B| · |F2 | ≥ (1 − ε)|F1 | · |F2 | = (1 − ε)|F |     (7.27)

and
                      Φ(h)(b ) = Φ(k)(b ) for all b ∈ B  .              (7.28)
   Suppose now that h = k. As ϕ2 is an (M, ε)-almost-homomorphism one
has dF2 (ϕ2 (m), ϕ2 (m )) > 1 − ε for all m, m ∈ M such that m = m . It
follows that for all distinct m, m ∈ M there exists a subset D ⊂ F2 such
that |D| ≥ (1 − ε)|F2 | and ϕ2 (m)(d) = ϕ2 (m )(d) for all d ∈ D.
   From h = k we deduce that for all f1 ∈ F1 one has that if m = σ(hf1 )−1 ×
hσ(f1 ) and m = σ(kf1 )−1 kσ(f1 ), then m, m ∈ M and m = σ(hf1 )−1 hσ(f1 ) =
σ(kf1 )−1 hσ(f1 ) = σ(kf1 )−1 kσ(f1 ) = m . Thus ϕ2 (σ(hf1 )−1 hσ(f1 ))(d) =
ϕ2 (σ(kf1 )−1 kσ(f1 ))(d) for all d ∈ D. Set D = D × F2 so that

              |D | = |D| · |F2 | ≥ (1 − ε)|F1 | · |F2 | = (1 − ε)|F |.      (7.29)

It follows that for all d ∈ D one has

                      Φ(h)(d ) = Φ(k)(d ) for all d ∈ D .               (7.30)

From (7.28) and (7.30), and taking into account (7.27) and (7.29) respectively,
we deduce that in either cases dF (Φ(h), Φ(k)) ≥ 1 − ε.
  This shows that Φ : G → Sym(F ) is a (K, ε)-almost-homomorphism. Thus
G is soﬁc.



7.6 Soﬁc Groups and Metric Ultraproducts of Finite
    Symmetric Groups

Suppose that we are given a triple T = (I, ω, F) consisting of the following
data: a set I, an ultraﬁlter ω on I, and a family F = (Fi )i∈I of nonempty
ﬁnite sets indexed by I. Our ﬁrst goal in this section is to associate with such
a triple T a soﬁc group GT . We start by forming the direct product group
                                    
                              PT =      Sym(Fi ).
                                       i∈I
7.6 Soﬁc Groups and Metric Ultraproducts of Finite Symmetric Groups                         261

Let α = (αi )i∈I and β = (βi )i∈I be elements of PT . Since 0 ≤ dFi (αi , βi ) ≤ 1
for all i ∈ I, it follows from Corollary J.2.6 that the Hamming distances
dFi (αi , βi ) have a limit

                           δω (α, β) = lim dFi (αi , βi ) ∈ [0, 1]
                                         i→ω

along the ultraﬁlter ω.

Proposition 7.6.1. One has:
  (i) δω (α, α) = 0;
 (ii) δω (β, α) = δω (α, β);
(iii) δω (α, β) ≤ δω (α, γ) + δω (γ, β);
(iv) δω (γα, γβ) = δω (α, β);
 (v) δω (αγ, βγ) = δω (α, β).
for all α, β, γ ∈ PT .

Proof. Let α = (αi )i∈I , β = (βi )i∈I , γ = (γi )i∈I ∈ PT . For each i ∈ I, we
have dFi (αi , αi ) = 0, dFi (βi , αi ) = dFi (αi , βi ), dFi (αi , βi ) ≤ dFi (αi , γi ) +
dFi (γi , βi ), dFi (γi αi , γi βi ) = dFi (αi , βi ), and dFi (αi γi , βi γi ) = dFi (αi , βi )
since dFi is a bi-invariant metric on Sym(Fi ). This gives us properties (i),
(ii), (iii), (iv), and (v) for δω by taking limits along ω (cf. Corollary J.2.10).


   Consider now the subset NT ⊂ PT deﬁned by

                           NT = {α ∈ PT : δω (1PT , α) = 0}.

Proposition 7.6.2. The set NT is a normal subgroup of PT .

Proof. This is an easy consequence of the properties of δω stated in Proposi-
tion 7.6.1. Indeed, we deduce from Property (i) that δω (1PT , 1PT ) = 0, that
is, 1PT ∈ NT . On the other hand, by using successively (iv), (iii), and (ii), we
get

δω (1PT , α−1 β) = δω (α, β) ≤ δω (α, 1PT )+δω (1PT , β) = δω (1PT , α)+δω (1PT , β)

for all α, β ∈ PT . This implies that α−1 β ∈ NT if α, β ∈ NT . Thus, NT is a
subgroup of PT . Finally, Properties (iv) and (v) imply that

         δω (1PT , γαγ −1 ) = δω (γ −1 , αγ −1 ) = δω (γ −1 γ, α) = δω (1PT , α)

for all α, γ ∈ PT . It follows that γαγ −1 ∈ NT for all α ∈ NT and γ ∈ PT .
This shows that NT is a normal subgroup of PT .

   Observe that, given α = (αi )i∈I and β = (βi )i∈I in PT , one has

                          αNT = βNT          ⇐⇒ δω (α, β) = 0.                          (7.31)
262                                          7 Local Embeddability and Soﬁc Groups

Indeed, one has αNT = βNT if and only if α−1 β ∈ NT , that is, if and only if
δω (1PT , α−1 β) = 0. This is equivalent to δω (α, β) = 0 by the left-invariance
of δω .
Theorem 7.6.3. The group GT = PT /NT is soﬁc.
Proof. Fix a ﬁnite subset K ⊂ GT and ε > 0. We want to show that there
exist a nonempty ﬁnite set F and a (K, ε)-almost-homomorphism ϕ : GT →
Sym(F ).
    Choose a representative of each element g ∈ GT , that is, an element g =
 gi )i∈I ∈ PT such that g = gNT .
(
    We ﬁrst introduce some constants that will be used in the proof. If h and
k are distinct elements in K, then δω (
                                       h, 
                                          k) > 0 by (7.31). Let us set

                                           δω (
                                               h, 
                                                  k)
                               η = min               .                     (7.32)
                                   h,k∈K       2
                                    h=k

Note that 0 < η ≤ 1/2.
  Now choose an integer m ≥ log ε/ log(1 − η), so that

                            1 − (1 − η)m ≥ 1 − ε.                          (7.33)

Finally, choose a real number ξ with 0 < ξ < 1 suﬃciently small to make

                               1 − (1 − ξ)m ≤ ε.                           (7.34)

   If h and k are arbitrary elements of K, we have hkN    # T = 
                                                                hkNT and
              #    
therefore δω (hk, hk) = 0 by (7.31). It follows that the set

                                            # i, 
                    A(h, k) = {i ∈ I : dFi (hk   hi 
                                                    ki ) ≤ ξ}              (7.35)

belongs to ω. On the other hand, if h and k are distinct elements of K, we
have δω (
         h, 
            k) ≥ 2η by (7.32). As η > 0, this implies that the set

                      C(h, k) = {i ∈ I : dFi (
                                              hi , 
                                                   ki ) ≥ η}               (7.36)

belongs to ω. As any ﬁnite intersection of elements of ω is in ω and therefore
nonempty, we deduce that there exists an index j ∈ I such that
                                          ⎛              ⎞
                    ⎛               ⎞
                                      ⎜               ⎟
                 j∈⎝         A(h, k)⎠ ⎜   ⎝      C(h, k)⎟⎠.
                       h,k∈K                    h,k∈K
                                                 h=k

   Consider the map ψ : GT → Sym(Fj ) deﬁned by ψ(g) = gj for all g ∈ GT .
It immediately follows from (7.35) and (7.36) that the map ψ satisﬁes the
following properties:
7.6 Soﬁc Groups and Metric Ultraproducts of Finite Symmetric Groups                     263

(1) dFj (ψ(hk), ψ(h)ψ(k)) ≤ ξ for all h, k ∈ K;
(2) dFj (ψ(h), ψ(k)) ≥ η for all h, k ∈ K such that h = k.
   Consider now the Cartesian product

                               F = Fj × Fj × · · · × Fj
                                   1       23         4
                                             m times

and the homomorphism

                               Ψ : Sym(Fj ) → Sym(F )

deﬁned by

               Ψ (σ)(x1 , x2 , . . . , xm ) = (σ(x1 ), σ(x2 ), . . . , σ(xm ))

for all σ ∈ Sym(Fj ) and (x1 , x2 , . . . , xm ) ∈ F . By Corollary 7.4.4 we have

                     dF (Ψ (σ), Ψ (σ  )) = 1 − (1 − dFj (σ, σ  ))m

for all σ, σ  ∈ Sym(Fj ). It follows that the composite map

                              ϕ = Ψ ◦ ψ : G → Sym(F )

satisﬁes the following properties:
(1’) dF (ϕ(hk), ϕ(h)ϕ(k)) ≤ 1 − (1 − ξ)m for all h, k ∈ K;
(2’) dF (ϕ(h), ϕ(k)) ≥ 1 − (1 − η)m for all h, k ∈ K such that h = k.
As 1−(1−ξ)m ≤ ε by (7.34) and 1−(1−η)m ≥ 1−ε by (7.33), we deduce that
ϕ is a (K, ε)-almost-homomorphism. This shows that GT is a soﬁc group.

Remark 7.6.4. When the ultraﬁlter ω is principal, then the group GT is ﬁnite.
Indeed, in this case, there is an element i0 ∈ I such that ω consists of all
subsets of I containing i0 . This implies that δω (α, β) = dFi0 (αi0 , βi0 ) for all
α = (αi )i∈I , β = (βi )i∈I ∈ PT . Therefore, NT consists of all α ∈ PT such
that αi0 = 1Sym(Fi0 ) . It follows that the group GT is isomorphic to the group
Sym(Fi0 ).

Remark 7.6.5. Let α, α , β, β  ∈ PT such that αNT = α NT and βNT =
β  NT . By applying Proposition 7.6.1(iii) and (7.31), we get

          dω (α, β) ≤ dω (α, α ) + dω (α , β  ) + dω (β  , β) = dω (α , β  ).

By exchanging the roles of α and α and of β and β  , we obtain dω (α , β  ) ≤
dω (α, β). It follows that dω (α, β) = dω (α , β  ). Therefore, if g, h ∈ GT and
α, β ∈ PT are such that g = αNT and h = βNT , the quantity

                                 Δω (g, h) = δω (α, β)                                (7.37)
264                                            7 Local Embeddability and Soﬁc Groups

is well deﬁned. Moreover, the map Δω : GT × GT → [0, 1] given by (7.37) is a
bi-invariant metric on GT . This follows immediately from Proposition 7.6.1
taking into account that NT is a normal subgroup.

Theorem 7.6.6. Let G be a group. The following conditions are equivalent:
(a) G is soﬁc;
(b) there exists a triple T = (I, ω, F), where I is a set, ω is an ultraﬁlter on
    I, and F = (Fi )i∈I is a family of nonempty ﬁnite sets indexed by I, such
    that G is isomorphic to a subgroup of the group GT = PT /NT .

Proof. If G satisﬁes (b), then G is soﬁc since GT is soﬁc by Theorem 7.6.3
and every subgroup of a soﬁc group is itself soﬁc by Proposition 7.5.4.
   Conversely, suppose that G is soﬁc. Consider the set I consisting of all
pairs (K, ε), where K is a ﬁnite subset of G and ε > 0. We partially order
the set I by setting (K, ε)  (K  , ε ) if K ⊂ K  and ε ≤ ε.
   For each i = (K, ε) ∈ I we deﬁne the set

                            Ii = {j ∈ I : i  j} ⊂ I.

Observe that Ii = ∅ as i ∈ Ii . Moreover, the family of nonempty subsets
{Ii }i∈I is closed under ﬁnite intersections, since

                   I(K1 ,ε1 ) ∩ I(K2 ,ε2 ) = I(K1 ∪K2 ,min{ε1 ,ε2 })

for all (K1 , ε1 ), (K2 , ε2 ) ∈ I. It follows from Proposition J.1.3 and Theo-
rem J.1.6 that there exists an ultraﬁlter ω on I such that I(K,ε) ∈ ω for all
(K, ε) ∈ I.
   As G is soﬁc, we can ﬁnd, for each i = (K, ε) ∈ I, a nonempty ﬁnite
set Fi and a (K, ε)-almost-homomorphism ϕi : G → Sym(Fi ). Consider the
triple T = (I, ω, F), where F = (Fi )i∈I , and the associated      soﬁc group
GT = PT /NT . Let ϕ     : G → PT denote the product map ϕ     = i∈I ϕi . Thus,
we have
                                   
                                  ϕ(g)  = (ϕi (g))i∈I
for all g ∈ G. Let ρ : PT → GT = PT /NT denote the canonical epimorphism.
Let us show that the composite map Φ = ρ ◦ ϕ    : G → GT is an injective
homomorphism. This will prove that G is isomorphic to a subgroup of GT .
   Let g, h ∈ G and let η > 0. Consider the element i0 = ({g, h}, η) ∈ I. If
i = (K, ε) ∈ I satisﬁes i0  i, then

                       dFi (ϕi (gh), ϕi (g)ϕi (h)) ≤ ε ≤ η

since ϕi is a (K, ε)-almost-homomorphism. Thus, the set

                     {i ∈ I : dFi (ϕi (gh), ϕi (g)ϕi (h)) ≤ η}

contains Ii0 and therefore belongs to ω. This implies that
7.7 A Characterization of Finitely Generated Soﬁc Groups                   265

                 
             δω (ϕ(gh),  ϕ(h))
                        ϕ(g)   = lim dFi (ϕi (gh), ϕi (g)ϕi (h)) = 0.
                                     i→ω

Therefore, we have Φ(gh) = Φ(g)Φ(h) by (7.31). This shows that Φ is a
homomorphism.
  On the other hand, if g = h, we have

                        dFi (ϕi (g), ϕi (h)) ≥ 1 − ε ≥ 1 − η

for all i ∈ I such that i0  i. This implies that

                       
                   δω (ϕ(g), 
                             ϕ(h)) = lim dFi (ϕi (g), ϕi (h)) = 1.       (7.38)
                                     i→ω

Therefore, we have Φ(g) = Φ(h) by (7.31). Consequently, Φ is injective. This
shows that (a) implies (b).

Remarks 7.6.7. (a) If G is an inﬁnite soﬁc group and T = (I, ω, F) is a triple
satisfying condition (b) in Theorem 7.6.6, then the ultraﬁlter ω is necessarily
non-principal by Remark 7.6.4.
   (b) Let G be a soﬁc group and let Φ : G → GT be as in the proof of
Theorem 7.6.6. Using the notation from Remark 7.6.5, we deduce from (7.38)
that Δω (Φ(g), Φ(h)) = 1 for all g, h ∈ G such that g = h. It follows that the
restriction of the bi-invariant metric Δω to the subgroup Φ(G) ⊂ GT is the
discrete metric.



7.7 A Characterization of Finitely Generated Soﬁc
    Groups

In this section we give a geometric characterization of ﬁnitely generated soﬁc
groups in terms of a ﬁniteness condition on their Cayley graphs.
   Let G be a ﬁnitely generated group and let S be a ﬁnite symmetric gen-
erating subset of G. Given r ∈ N, we denote by BS (r) the ball of radius r
centered at the vertex corresponding to the identity element 1G of G in the
Cayley graph CS (G) of G with respect to S, with the induced S-labeled graph
structure (cf. Sects. 6.1, 6.2 and 6.3).
   Let also Q = (Q, E) be an S-labeled graph. Given q ∈ Q and r ∈ N, we
denote by B(q, r) the ball of radius r centered at q with the induced S-labeled
graph structure.
   Given r ∈ N we denote by Q(r) the set of all q ∈ Q such that there exists
an S-labeled graph isomorphism

                              ψq,r : BS (r) → B(q, r)                    (7.39)

satisfying
                                   ψq,r (1G ) = q.                       (7.40)
266                                         7 Local Embeddability and Soﬁc Groups

Observe that if such a map ψq,r exists it is unique. We have the inclusions

         Q = Q(0) ⊃ Q(1) ⊃ Q(2) ⊃ · · · ⊃ Q(r) ⊃ Q(r + 1) ⊃ · · ·         (7.41)




Fig. 7.2 The inclusions Q ⊃ Q(1) ⊃ Q(2) ⊃ Q(3)


   Note also that since CS (G) (and therefore the induced S-labeled subgraph
BS (r)) is edge-symmetric (with respect to the involution s → s−1 on S
(cf. Sect. 6.3)) and ψq,r is an S-labeled graph isomorphism, then B(q, r) =
ψq,r (BS (r)) is edge-symmetric as well.

Theorem 7.7.1. Let G be a ﬁnitely generated group and let S be a ﬁnite
symmetric generating subset of G. The following conditions are equivalent:
(a) the group G is soﬁc;
(b) for all ε > 0 and r ∈ N, there exists a ﬁnite S-labeled graph Q = (Q, E)
    such that
                               |Q(r)| ≥ (1 − ε)|Q|,                    (7.42)
      where Q(r) ⊂ Q denotes the set consisting of all vertices q ∈ Q for which
      there exists an S-labeled graph isomorphism ψq,r : BS (r) → B(q, r) from
      the ball BS (r) in the Cayley graph CS (G) of G with respect to S onto the
      ball B(q, r) in Q satisfying ψq,r (1G ) = q.

   Before starting the proof of the theorem we present some preliminary
results.

Lemma 7.7.2. Let Q = (Q, E) be an S-labeled graph and r0 , i ∈ N. Suppose
that q0 ∈ Q((i + 1)r0 ). Then B(q0 , r0 ) ⊂ Q(ir0 ).

Proof. Let q  ∈ B(q, r0 ) and let us show that q  ∈ Q(ir0 ). It follows from
the triangle inequality that the ball B(q  , ir0 ) is entirely contained in the
ball B(q0 , (i + 1)r0 ). Moreover, since ψq0 ,(i+1)r0 is isometric, setting g =
7.7 A Characterization of Finitely Generated Soﬁc Groups                                         267

ψq−1
   0 ,(i+1)r0
              (q  ), we have g ∈ BS (r0 ) so that gh ∈ B((i+1)r0 ) for all h ∈ B(ir0 ).
It follows that the map

                              ψq ,ir0 : BS (ir0 ) → B(q  , ir0 )                             (7.43)

deﬁned by ψq ,ir0 (h) = ψq0 ,(i+1)r0 (gh) for all h ∈ BS (ir0 ) yields an S-labeled
graph isomorphism satisfying ψq ,ir0 (1G ) = ψq0 ,(i+1)r0 (g) = q  . This shows
that q  ∈ Q(ir0 ). We deduce that B(q0 , r0 ) ⊂ Q(ir0 ).

Lemma 7.7.3. Let Q = (Q, E) be an S-labeled graph and r0 ∈ N. Let q1 , q2 ∈
Q(2r0 ) such that q1 = q2 and g ∈ BS (r0 ). Then we have

                                  ψq1 ,2r0 (g) = ψq2 ,2r0 (g).                                (7.44)

Proof. If g = 1G we have ψq1 ,2r0 (g) = ψq1 ,2r0 (1G ) = q1 = q2 = ψq2 ,2r0 (1G ) =
ψq2 ,2r0 (g). Suppose now that g = 1G . Suppose by contradiction that
ψq1 ,2r0 (g) = ψq2 ,2r0 (g) = q0 . Since ψq1 ,2r0 is isometric we have q0 ∈ B(q1 , r0 ).
It follows from Lemma 7.7.2 that q0 ∈ Q(r0 ).
   As g ∈ BS (r0 ), we can ﬁnd 1 ≤ r ≤ r0 and s1 , s2 , . . . , sr ∈ S such that
g = s1 s2 · · · sr . Consider the path

           π = ((1G , s1 , s1 ), (s1 , s2 , s1 s2 ), . . . , (s1 s2 · · · sr −1 , sr , g))

and observe that it is contained in BS (r0 ). Now, π is mapped by ψq1 ,2r0 and
ψq2 ,2r0 into two paths π1 and π2 in Q with initial vertices π1− = q1 , π2− = q2
and same terminal vertex π1+ = ψq1 ,2r0 (g) = q0 = ψq2 ,2r0 (g) = π2+ . Note
that since ψq1 ,2r0 and ψq2 ,2r0 are isometric π1 and π2 are both contained in
B(q0 , r0 ). Moreover, since ψq1 ,2r0 and ψq2 ,2r0 are label-preserving, π1 and π2
have the same label s1 s2 · · · sr . The inverse images of π1 and π2 under the
S-label preserving graph isomorphism ψq0 ,r0 : BS (r0 ) → B(q0 , r0 ) are both
equal to π. Indeed in a Cayley graph there exists a unique path which ends at
a given vertex and with a given label. It follows that π1 = π2 and therefore
q1 = π1− = π2− = q2 . This contradicts our assumptions. We deduce that
ψq1 ,2r0 (g) = ψq2 ,2r0 (g).

Lemma 7.7.4. Let Q = (Q, E) be an S-labeled graph and r0 ∈ N. Let h, k ∈
BS (r0 ) and q0 ∈ Q(2r0 ). We have

                                      ψq0 ,2r0 (h) ∈ Q(r0 )                                    (7.45)

and
                             ψq0 ,2r0 (hk) = ψψq0 ,2r0 (h),r0 (k),                             (7.46)
where ψq,r , q ∈ Q(r), r ∈ N, is as in (7.39) and (7.40).

Proof. Since ψq0 ,2r0 is isometric we have ψq0 ,2r0 (h) ∈ B(q0 , r0 ). Then (7.45)
follows from Lemma 7.7.2. Let us show (7.46). First note that (7.46) makes
sense by virtue of (7.45). If k = 1G (7.46) follows from ψq0 ,2r0 (hk) =
268                                                        7 Local Embeddability and Soﬁc Groups

ψq0 ,2r0 (h) = ψψq0 ,2r0 (h),r0 (1G ) = ψψq0 ,2r0 (h),r0 (k). Now suppose that k = 1G .
Then we can ﬁnd 1 ≤ r ≤ r0 and s1 , s2 , . . . , sr ∈ S such that k = s1 s2 · · · sr .
Consider the path

           π1 = ((h, s1 , hs1 ), (hs1 , s2 , hs1 s2 ), . . . , (hs1 s2 · · · sr −1 , sr , hk))

and observe that it is contained in BS (2r0 ), since h, k ∈ BS (r0 ). The path π1
is mapped by ψq0 ,2r0 into the path

      π 1 = ((ψq0 ,2r0 (h),s1 , ψq0 ,2r0 (hs1 )), (ψq0 ,2r0 (hs1 ), s2 , ψq0 ,2r0 (hs1 s2 )), . . .
                           . . . , (ψq0 ,2r0 (hs1 s2 · · · sr −1 ), sr , ψq0 ,2r0 (hk))).

As ψq0 ,2r0 is isometric, we have that q  = ψq0 ,2r0 (h) belongs to B(q0 , r0 ) and
since q0 ∈ Q(2r0 ) we deduce from Lemma 7.7.2 that q  ∈ Q(r0 ). Consider the
inverse image of the path π 1 under the S-labeled graph isomorphism ψq ,r0 .
Since ψq−1   0
                     −     −1
                                 0
                                                    −1
                                                          0
                                                             
          ,r ((π 1 ) ) = ψq  ,r (ψq0 ,2r0 (h)) = ψq  ,r (q ) = 1G and ψq  ,r0 preserves

the label, this inverse image is necessarily equal to the path

              π2 = ((1G , s1 , s1 ), (s1 , s2 , s1 s2 ), . . . , (s1 s2 · · · sr −1 , sr , k)),

since in a Cayley graph there exists a unique path which starts at a given ver-
tex and with a given label. It follows that ψq−1                       −1        +
                                                ,r (ψq0 ,2r0 (hk)) = ψq  ,r (π 1 ) =
                                                   0                         0
π2+ = k, that is, ψq0 ,2r0 (hk) = ψq ,r0 (k). Since q  = ψq0 ,2r0 (h), we de-
duce (7.46).

   We are now in position to prove Theorem 7.7.1.

Proof of Theorem 7.7.1. Suppose that G is soﬁc. Fix ε > 0 and r ∈ N. Set
K = BS (2r + 1) and

                            ε = ε(1 + |BS (r)| · |S| + |BS (r)|2 )−1 .                             (7.47)

Since G is soﬁc, there exists a nonempty ﬁnite set F and a (K, ε )-almost-
homomorphism ϕ : G → Sym(F ). We construct an S-labeled graph Q =
(Q, E) as follows. We take as vertex set Q = F . Then, as set of edges we
take the set E ⊂ Q × S × Q consisting of all the triples (q, s, ϕ(s−1 )(q)), were
q ∈ Q and s ∈ S. Note that Q may have loops and multiple edges and that
Q is not necessarily edge-symmetric with respect to the involution s → s−1
on S. Observe however that, if q ∈ Q and s ∈ S are ﬁxed, then there exists
a unique edge in Q with initial vertex q and label s.
   For each q ∈ Q denote by ψq : G → Q the map deﬁned by setting
ψq (g) = ϕ(g −1 )(q) for all g ∈ G. Denote by Q0 the subset of Q consist-
ing of all q ∈ Q satisfying the following conditions:

(∗)     ψq (1G ) = q,
(∗∗)    ψq (gs) = ψψq (g) (s) for all g ∈ BS (r) and s ∈ S,
(∗ ∗ ∗) ψq (g) = ψq (h) for all g, h ∈ BS (r) with g = h.
7.7 A Characterization of Finitely Generated Soﬁc Groups                                     269

   Suppose that q ∈ Q0 . Let g ∈ BS (r). If g = 1G we have ψq (g) = ψq (1G ) =
q ∈ B(q, r), by (∗). If g = 1G , then there exist 1 ≤ r ≤ r and s1 , s2 , . . . , sr ∈
S such that g = s1 s2 · · · sr . Consider the sequence of edges

           e1 = (q, s1 , ϕ(s−1
                            1 )(q)) = (q, s1 , ψq (s1 )),

           e2 = (ψq (s1 ), s2 , ϕ(s−1
                                   2 )ψq (s1 ))

              = (ψq (s1 ), s2 , ψψq (s1 ) (s2 ))
              = (ψq (s1 ), s2 , ψq (s1 s2 )) (by (∗∗)),
          ······
          er = (ψq (s1 s2 · · · sr −1 ), sr , ϕ(s−1
                                                    r  )(ψq (s1 s2 · · · sr  −1 )))

              = (ψq (s1 s2 · · · sr −1 ), sr , ψψq (s1 s2 ···sr −1 ) (sr ))
              = (ψq (s1 s2 · · · sr −1 ), sr , ψq (s1 s2 · · · sr −1 sr )) (by (∗∗))
              = (ψq (s1 s2 · · · sr −1 ), sr , ψq (g)).

The path π = (e1 , e2 , . . . , er ) connects q to ψq (g) and has length (π) ≤ r.
This shows that the graph distance from q to ψq (g) in Q does not exceed r so
that ψq (BS (r)) ⊂ B(q, r). Conversely, let q  ∈ B(q, r). If q  = q then by (∗)
we have q  = q = ψq (1G ) ∈ ψq (BS (r)). If q = q  then there exist 1 ≤ r ≤ r
and a sequence of edges (q, s1 , q1 ), (q1 , s2 , q2 ), . . . , (qr −1 , sr , q  ) ∈ E. Using
(∗∗) as above, we get q  = ψq (g), where g = s1 s2 · · · sr ∈ BS (r). This shows
that B(q, r) ⊂ ψq (BS (r)). Thus

                                     B(q, r) = ψq (BS (r)).

Moreover, by condition (∗ ∗ ∗), the map ψq |BS (r) is injective. Finally, from
(∗∗) we deduce that if g ∈ BS (r) and s ∈ S then we have

   (ψq (g), s, ψq (gs)) = (ψq (g), s, ψψq (g) (s)) = (ψq (g), s, ϕ(s−1 )ψq (g)) ∈ E.

Thus, the map ψq,r = ψq |BS (r) : BS (r) → B(q, r) is an S-labeled graph iso-
morphism such that ψq,r (1G ) = ψq (1G ) = q, where the last equality follows
from (∗). We deduce that Q0 ⊂ Q(r).
   Let’s now estimate from below the cardinality of Q0 . We denote by dQ the
normalized Hamming metric on Sym(Q).
   In order to estimate the cardinality of the set of q ∈ Q for which condition
(∗) is satisﬁed, let us ﬁrst observe that

                                     dQ (IdQ , ϕ(1G )) ≤ ε .                              (7.48)

Indeed, since ϕ is a (K, ε )-almost-homomorphism, taking k1 = k2 = 1G in
property (i) of Deﬁnition 7.5.1, we deduce that dQ (ϕ(1G ), ϕ(1G )ϕ(1G )) ≤ ε
which, by left-invariance of dQ , implies (7.48). From (7.48) we deduce the
270                                                7 Local Embeddability and Soﬁc Groups

existence of a subset Q ⊂ Q of cardinality |Q | ≤ ε |Q| such that

                                      ϕ(1G )(q) = q                              (7.49)

for all q ∈ Q \ Q . It follows that ψq (1G ) = ϕ(1−1
                                                   G )(q) = ϕ(1G )(q) = q, for all
q ∈ Q \ Q so that condition (∗) is satisﬁed in Q \ Q .
   Let now estimate the cardinality of the set of q ∈ Q for which condi-
tion (∗∗) is satisﬁed. Let g ∈ BS (r) and s ∈ S. As ϕ is a (K, ε )-almost-
homomorphism we have dQ (ϕ(s−1 g −1 ), ϕ(s−1 )ϕ(g −1 )) ≤ ε so that there
exists a subset Q (g, s) ⊂ Q with |Q (g, s)| ≤ ε |Q| such that

                            ψq (gs) = ϕ((gs)−1 )(q)
                                      = ϕ(s−1 g −1 )(q)
                                      = ϕ(s−1 )ϕ(g −1 )(q)
                                      = ϕ(s−1 )(ψq (g))
                                      = ψψq (g) (s)

for all q ∈ Q \ Q (g, s). Setting
                                          !
                              Q =                Q (g, s)
                                       g∈BS (r)
                                         s∈S

we have |Q | ≤ |BS (r)| · |S|ε |Q| and condition (∗∗) holds for all q ∈ Q \ Q .
   Fix now two distinct elements g, h ∈ BS (r). Since ϕ is a (K, ε )-almost-
homomorphism and g −1 , h−1 ∈ K, by property (ii) of Deﬁnition 7.5.1
we deduce that dQ (ϕ(g −1 ), ϕ(h−1 )) ≥ 1 − ε . Thus we can ﬁnd a subset
Q (g, h) ⊂ Q of cardinality |Q (g, h)| ≤ ε |Q| such that

                    ψq (g) = ϕ(g −1 )(q) = ϕ(h−1 )(q) = ψq (h)                  (7.50)

for all q ∈ Q \ Q (g, h).
   Let now g = h vary in BS (r) and set
                                    !
                             Q =      Q (g, h).
                                      g,h∈BS (r)
                                         g=h


Observe that |Q | ≤ |BS (r)|2 ε |Q|. It follows from (7.50) that condition
(∗ ∗ ∗) holds for all q ∈ Q \ Q .
   In conclusion, conditions (∗), (∗∗) and (∗ ∗ ∗) are satisﬁed for all q ∈ Q
outside of Q ∪ Q ∪ Q . We have

         |Q ∪ Q ∪ Q | ≤ (1 + |BS (r)| · |S| + |BS (r)|2 )ε |Q| = ε|Q|,
7.7 A Characterization of Finitely Generated Soﬁc Groups                      271

where the equality follows from (7.47). We deduce that

                           |Q(r)| ≥ |Q0 | ≥ (1 − ε)|Q|.

Thus G satisﬁes condition (b). This shows (a) ⇒ (b).
    Conversely, suppose (b). Fix a ﬁnite set K ⊂ G and ε > 0. Let r0 ∈ N be
such that K ∪ K 2 ⊂ BS (r0 ). Let Q = (Q, E) be the ﬁnite S-labeled graph
given by condition (b) corresponding to r = 2r0 and ε.
    Let g ∈ BS (r0 ). Since the map from Q(2r0 ) into Q deﬁned by q → ψq,2r0 (g)
is injective (by Lemma 7.44), we have that

                      |{ψq,2r0 (g) : q ∈ Q(2r0 )}| = |Q(2r0 )|              (7.51)

and therefore

                 |Q \ {ψq,2r0 (g) : q ∈ Q(2r0 )}| = |Q \ Q(2r0 )|.          (7.52)

As a consequence, there exists a bijection αg : Q \ Q(2r0 ) → Q \ {ψq,2r0 (g) :
q ∈ Q(2r0 )}. Since ψq,2r0 (1G ) = q for all q ∈ Q(2r0 ), we have {ψq,2r0 (1G ) :
q ∈ Q(2r0 )} = Q(2r0 ) and therefore we can take

                                 α1G = IdQ\Q(2r0 ) .                        (7.53)

   Consider now the map ϕ : G → Sym(Q) deﬁned by
              ⎧         −1
              ⎪
              ⎨ψq,2r0 (g )          if g ∈ BS (r0 ) and q ∈ Q(2r0 );
     ϕ(g)(q) = αg−1 (q)             if g ∈ BS (r0 ) and q ∈ Q \ Q(2r0 );    (7.54)
              ⎪
              ⎩
               q                    otherwise.

  Note that ϕ(g) ∈ Sym(Q) for all g ∈ G, by construction.
  Let us show that the map ϕ : G → Sym(Q) is a (K, ε)-almost-homomor-
phism. Let k1 , k2 ∈ K ⊂ BS (r0 ) and q ∈ Q(2r0 ). We have

                 ϕ(k1 k2 )(q) = ψq,2r0 (k2−1 k1−1 )
                              = ψψq,2r       −1       (k1−1 ) (by (7.46))
                                         0 (k2 ),r0

                              = ϕ(k1 )(ψq,2r0 (k2−1 ))
                              = [ϕ(k1 )ϕ(k2 )](q).

This shows that on Q(2r0 ) we have ϕ(k1 k2 ) = ϕ(k1 )ϕ(k2 ). As

                         |Q(2r0 )| = |Q(r)| ≥ (1 − ε)|Q|                    (7.55)

we deduce that dQ (ϕ(k1 k2 ), ϕ(k1 )ϕ(k2 )) ≤ ε.
   Finally, suppose that k1 = k2 . We have ϕ(k1 )(q) = ψq,2r0 (k1−1 ) =
ψq,2r0 (k2−1 ) = ϕ(k2 )(q), since k1−1 , k2−1 ∈ BS (2r0 ) and ψq,2r0 is injective.
272                                       7 Local Embeddability and Soﬁc Groups

From (7.55) we deduce that dQ (ϕ(k1 ), ϕ(k2 )) ≥ 1 − ε. It follows that ϕ
is a (K, ε)-almost-homomorphism. Therefore G is soﬁc. This shows that
(b) ⇒ (a).



7.8 Surjunctivity of Soﬁc Groups

In this section we prove that soﬁc groups are surjunctive. Note that this
result covers the fact that locally residually amenable groups are surjunctive,
which had been previously established in Corollary 5.9.3. Indeed, all locally
residually amenable groups are soﬁc by Corollary 7.5.11.

Theorem 7.8.1 (Gromov-Weiss). Every soﬁc group is surjunctive.

  Let us ﬁrst establish the following:

Lemma 7.8.2. Let G be a group, A a ﬁnite set, and equip AG with the prodis-
crete topology. Let X ⊂ AG be a closed G-invariant subset and let f : X → AG
be a continuous G-equivariant map. Then there exists a cellular automaton
τ : AG → AG such that f = τ |X .

Proof. From the continuity of f we deduce the existence of a ﬁnite set S ⊂ G
such that if two conﬁgurations y, z ∈ X coincide on S then f (y)(1G ) =
f (z)(1G ). Let a0 ∈ A and consider the map μ : AS → A deﬁned by setting
                 
                   f (x)(1G ) if there exists x ∈ X such that x|S = u
        μ(u) =
                   a0         otherwise

for all u ∈ AS . Then μ is well deﬁned and if we denote by τ : AG → AG
the cellular automaton with memory set S and local deﬁning map μ, by G-
equivariance of f we clearly have τ |X = f .

Proof of Theorem 7.8.1. Let G be a soﬁc group. Let A be a ﬁnite set of
cardinality |A| ≥ 2 and let τ : AG → AG be an injective cellular automaton.
We want to show that τ is surjective. Every subgroup of a soﬁc group is soﬁc
by Proposition 7.5.4. On the other hand it follows from Proposition 3.2.2 that
a group is surjunctive if all its ﬁnitely generated subgroups are surjunctive.
Thus we can assume that G is ﬁnitely generated.
    Let then S ⊂ G be a ﬁnite symmetric generating subset of G. As usual,
for r ∈ N, we denote by BS (r) ⊂ G the ball of radius r centered at 1G in the
Cayley graph of G with respect to S. We set Y = τ (AG ). Observe that Y is
G-invariant and, by Lemma 3.3.2, it is closed in AG .
    The inverse map τ −1 : Y → AG is G-equivariant and, by compactness of
  G
A , it is also continuous. By Lemma 7.8.2, there exists a cellular automaton
σ : AG → AG such that σ|Y = τ −1 : Y → AG . Choose r0 large enough so
7.8 Surjunctivity of Soﬁc Groups                                              273

that the ball BS (r0 ) is a memory set for both τ and σ. Let μ : ABS (r0 ) → A
and ν : ABS (r0 ) → A denote the corresponding local deﬁning maps for τ and
σ respectively.
   We proceed by contradiction. Suppose that τ is not surjective, that is,
Y  AG . Then, since Y is closed in AG , there exists a ﬁnite subset Ω ⊂ G such
that πΩ (Y )  AΩ , where, for a subset E ⊂ G, we denote by πE : AG → AE
the projection map. It is not restrictive, up to taking a larger r0 , again if
necessary, to suppose that Ω ⊂ BS (r0 ). Thus, πBS (r0 ) (Y )  ABS (r0 ) .
   Fix ε > 0 such that
                                       |B(2r0 )| · log |A|
               ε<1−                                                     .   (7.56)
                         |B(2r0 )| · log |A| − log(1 − |A|−|BS (r0 )| )

Note that log(1 − |A|−|BS (r0 )| ) < 0, so that the right hand side of (7.56) is
well deﬁned and positive.
   Since G is soﬁc, it follows from Theorem 7.7.1 that we can ﬁnd a ﬁnite
S-labeled graph Q such that

                              |Q(3r0 )| ≥ (1 − ε)|Q|,                       (7.57)

where we recall that Q(r), r ∈ N, denotes the set of all q ∈ Q such that
there exists an S-labeled graph isomorphism ψq,r : BS (r) → B(q, r) satisfying
ψq,r (1G ) = q (cf. Theorem 7.7.1).
   We have the inclusions

             Q(r0 ) ⊃ Q(2r0 ) ⊃ · · · ⊃ Q(ir0 ) ⊃ Q((i + 1)r0 ) ⊃ · · · .

(cf. (7.41); see also Fig. 7.2). Also recall from Lemma 7.7.2 that B(q, r0 ) ⊂
Q(ir0 ) for all Q((i + 1)r0 ) and i ∈ N.
   For each integer i ≥ 1, we deﬁne the map μi : AQ(ir0 ) → AQ((i+1)r0 ) by
setting, for all u ∈ AQ(ir0 ) and q ∈ Q((i + 1)r0 ),

                      μi (u)(q) = μ u|B(q,r0 ) ◦ ψq,r0 (1G ),

where ψq,r0 is the unique isomorphism of S-labeled graphs from BS (r0 ) ⊂ G
to B(q, r0 ) ⊂ Q sending 1G to q.
   Similarly, we deﬁne the map νi : AQ(ir0 ) → AQ((i+1)r0 ) by setting, for all
u ∈ AQ(ir0 ) and q ∈ Q((i + 1)r0 ),

                       νi (u)(q) = ν u|B(q,r0 ) ◦ ψq,r0 (1G ).

   From the fact that σ ◦ τ = σ|Y ◦ τ = τ −1 ◦ τ is the identity map on
A , we deduce that the composite νi+1 ◦ μi : AQ(ir0 ) → AQ((i+2)r0 ) satisﬁes
 G

(νi+1 ◦μi )(u)(q) = u(q) for all u ∈ AQ(ir0 ) and q ∈ Q((i+2)r0 ). In other words,
denoting by ρi : AQ(ir0 ) → AQ((i+2)r0 ) the restriction map, we have that
νi+1 ◦ μi = ρi for all i ≥ 1. In particular, we have ν2 ◦ μ1 = ρ1 . Thus, setting
274                                                     7 Local Embeddability and Soﬁc Groups

Z = μ1 (AQ(r0 ) ) ⊂ AQ(2r0 ) , we deduce that ν2 (Z) = ρ1 (AQ(r0 ) ) = AQ(3r0 ) . It
follows that |Z| ≥ |A||Q(3r0 )| , so that, by taking logarithms, we get

                                log |Z| ≥ |Q(3r0 )| · log |A|.                        (7.58)

   In order to estimate the cardinality of Z from above, we ﬁrst show the
existence of a subset Q ⊂ Q(3r0 ) satisfying

                                                    |Q(3r0 )|
                                          |Q | ≥                                     (7.59)
                                                    |B(2r0 )|

and such that the balls B(q  , r0 ) with q  ∈ Q are all disjoint.
   Indeed, let Q be a maximal subset of Q(3r0 ) such that the balls B(q  , r0 )
with q  ∈ Q are all disjoint. If q ∈ Q(3r0 ) \ Q is at distance greater than
2r0 from Q , then B(q, r0 ) ∩ B(q  , r0 ) = ∅ for all q  ∈ Q , contradicting the
maximality of Q . Therefore Q(3r0 ) is contained in the union of the balls
B(q  , 2r0 ), with q  ∈ Q . This implies

                                 |Q(3r0 )| ≤ |Q | · |B(2r0 )|,

which gives (7.59).                              
   Let then Q ⊂ Q(3r0 ) be as above and set Q = q ∈Q B(q  , r0 ). Note
that Q ⊂ Q(2r0 ) and that

                                    |Q | = |Q | · |BS (r0 )|.                       (7.60)

Given a subset E ⊂ Q we denote by πE : AQ → AE the projection map. Now
observe that, for all q ∈ Q(2r0 ), we have a natural bijection πB(q,r0 ) (Z) →
πBS (r0 ) (Y ) given by u → u ◦ ψq,r0 , where ψq,r0 denotes, as above, the unique
isomorphism of S-labeled graphs from BS (r0 ) to B(q, r0 ) sending 1G to q.
Since πBS (r0 ) (Y )  ABS (r0 ) , this implies that
                     -              - -              -
                     -πB(q ,r ) (Z)- = -πB (r ) (Y )- ≤ |A||BS (r0 )| − 1,           (7.61)
                              0            S  0


for all q  ∈ Q .
   We have
                       Z ⊂ πQ (Z) × πQ(2r0 )\Q (Z)
                           ⎛                     ⎞
                             
                         ⊂⎝       πB(q ,r0 ) (Z)⎠ × πQ(2r0 )\Q (Z)
                               q  ∈Q
                            ⎛                          ⎞
                                
                         ⊂⎝              πB(q ,r0 ) (Z)⎠ × AQ(2r0 )\Q
                                                                         


                               q  ∈Q
Notes                                                                                   275

and we deduce
                 (                  )|Q |                   
            |Z| ≤ |A||BS (r0 )| − 1        · |A||Q(2r0 )|−|Q | (by (7.61))
                 (                  )|Q |              
                ≤ |A||BS (r0 )| − 1        · |A||Q|−|Q | (as Q(2r0 ) ⊂ Q)
                 (                   )|Q |                                 
                = 1 − |A|−|BS (r0 )|         · |A||Q |·|BS (r0 )| · |A||Q|−|Q |
                 (                   )|Q |
                = 1 − |A|−|BS (r0 )|         · |A||Q| (by (7.60)).

  By taking logarithms we get
                                (                  )
           log |Z| ≤ |Q | · log 1 − |A|−|BS (r0 )| + |Q| · log |A|.

As we remarked earlier, we have log(1 − |A|−|BS (r0 )| ) < 0 so that, by (7.59),
we obtain
                    |Q(3r0 )|      (                  )
          log |Z| ≤           · log 1 − |A|−|BS (r0 )| + |Q| · log |A|
                    |B(2r0 )|

and, by (7.58),
                                |Q(3r0 )|
        |Q(3r0 )| · log |A| ≤             · log(1 − |A|−|BS (r0 )| ) + |Q| · log |A|.
                                |B(2r0 )|

This gives us
                                         |B(2r0 )| · log |A|
             |Q(3r0 )| ≤                                                  |Q|
                           |B(2r0 )| · log |A| − log(1 − |A|−|BS (r0 )| )

and, by (7.56),
                                  |Q(3r0 )| < (1 − ε)|Q|
which contradicts (7.57).



Notes

The problem of approximation of inﬁnite groups by ﬁnite ones goes back, in
the framework of purely algebraic constructions, to A.I. Mal’cev [Mal1, Mal3].
These ideas were developed further by A.M. Vershik [Ver] and A.M. Stëpin
[Stë1, Stë2] also in the wider context of operator algebras and ergodic theory.
The notion of local embeddability was introduced by Vershik and E.I. Gordon
in [VeG]. They studied the groups which are locally embeddable into the
class of ﬁnite groups (LEF groups). Among other things, they established
a relationship between this notion of approximation by ﬁnite groups and
276                                        7 Local Embeddability and Soﬁc Groups

the convergence in the topological space of marked groups. Moreover, some
stability properties for the class of LEF groups were presented. They also
showed that ﬁnitely presented LEF groups are residually ﬁnite. Nilpotent
groups and metabelian groups are LEF groups since they are locally residually
ﬁnite [Hall2]. Vershik and Gordon [VeG] gave an example of a solvable (and
therefore amenable) group which is not an LEF group.
   The basic results on general local embeddability presented in Sect. 7.1 are
natural generalizations of those for LEF groups established in [VeG]. Vershik
and Gordon also considered some notions of local approximation for group
actions, namely equivariant approximation of actions on groups, free approxi-
mation of actions on arbitrary sets, and uniform free approximation of actions
on spaces with quasi-invariant measures. Equivariant approximation was used
to show that semi-direct products of LEF groups with equivariantly approx-
imable actions are LEF groups. It was then deduced that the non-residually
ﬁnite group G1 of Sect. 2.6 considered by Mal’cev in [Mal1] is an LEF group.
Also, Vershik and Gordon proved the following characterizations of local em-
beddability into the class of ﬁnite groups. A group admits a (faithful) freely
approximable action if and only if it is an LEF group. A countable group ad-
mits a uniformly freely approximable action on some measurable space if and
only if it is an LEF group (note that the “only if” part was already established
with slightly diﬀerent terminology by A. Stëpin in [Stë1], see also [Stë2]).
   Groups which are locally embeddable into the class of amenable groups
where considered by M. Gromov in [Gro5] under the name of initially suba-
menable groups. More precisely, in Sect. 4.G of [Gro5], a ﬁnitely generated
group G is said to be initially subamenable if for any ﬁnite generating sub-
set S ⊂ G there exists a sequence of F -marked amenable groups converging
to G, where F denotes the free group based on S. The fact that a ﬁnitely
generated group is initially subamenable if and only if it is LEA follows from
Proposition 7.3.7(4). In Sect. 6.E” of [Gro5], Gromov introduced the notion
of an initially subamenable graph (which, for Cayley graphs, reduces to con-
dition (b) in Theorem 7.7.1) and, in the Example in Sect. 6.E”’, he claims
that the Cayley graph of a ﬁnitely generated group is initially subamenable
if and only if the group is initially subamenable. Later, groups whose Cay-
ley graphs are initially subamenable (according with Gromov’s deﬁnition in
Sect. 6.E” of [Gro5]) were called soﬁc groups by B. Weiss [Weiss], this ter-
minology coming from the Hebrew word ‫ סוֹפִי‬which means ﬁnite and derives
from ‫ סוֹ‬which means end.
   Gromov [Gro5] and Weiss [Weiss] proved that soﬁc groups are surjunctive
(Theorem 7.8.1). G. Elek and E. Szabó [ES2] proved that a group is soﬁc if and
only if it is a subgroup of an ultraproduct of ﬁnite symmetric groups equipped
with their Hamming distances (Theorem 7.6.6). They used this result to prove
that any countable soﬁc group can be embedded into a countable simple soﬁc
group. In [ES3] Elek and Szabó proved that the class of soﬁc groups is closed
under taking direct products, subgroups, projective limits and direct limits,
free products, and extensions by amenable groups. Moreover, by modifying
Notes                                                                       277

the example of the group G1 in Sect. 2.6 (which is LEF but not residually
ﬁnite), Elek and Szabó constructed an example of a ﬁnitely generated LEF-
group which is not residually amenable.
    A detailed exposition of the theory of hyperlinear and soﬁc groups is pre-
sented in V.G. Pestov’s survey [Pes] and in the notes by Pestov and A.
Kwiatkowska [PeK]. To deﬁne hyperlinear groups, it suﬃces to replace the
groups Sym(F ), where F is a nonempty ﬁnite set, occurring in the deﬁnition
of soﬁc groups by the unitary groups U(H), where H is a ﬁnite-dimensional
Hilbert space, equipped with their normalized Hilbert-Schmidt metric. This
class of groups has its origin in the theory of operator algebras and is related
to the Connes Embedding Conjecture. Indeed, by a profound result of E.
Kirchberg, F. Radulescu and N. Ozawa, a group is hyperlinear if and only if
it satisﬁes the Connes embedding conjecture for groups, that is, if and only
if its von Neumann algebra embeds into an ultrapower of the hyperﬁnite II1
factor R (see [Pes] and the references therein). Elek and Szabó [ES2] proved
that every soﬁc group is hyperlinear. Thus, we have the implications

    ﬁnite            resid. ﬁnite         LEF


 amenable         resid. amenable         LEA         soﬁc        hyperlinear

    There exist ﬁnitely presented groups which are LEA but not LEF. For
example, the Baumslag-Solitar group BS(2, 3) is known to be residually
solvable. Thus, it is residually amenable and therefore LEA. As the group
BS(2, 3) is ﬁnitely presented and not residually ﬁnite, it is not LEF by Propo-
sition 7.3.8. In [Abe], H. Abels gave an example of a ﬁnitely presented solvable
group which is not residually ﬁnite. Abels’ group is amenable (and therefore
LEA) but not LEF.
    There exist ﬁnitely presented groups which are not LEA. For example, if G
is a ﬁnitely presented non-amenable simple group, such as one of Thompson’s
groups V and T (see [CFP]) or one of the Burger-Mozes groups [BuM], then
G is not residually amenable and therefore not LEA by Proposition 7.3.8.
    Y. de Cornulier [Cor] provided an example of a ﬁnitely presented soﬁc
group which is not LEA. Cornulier’s example is soﬁc because it is an extension
of a locally residually ﬁnite group by an abelian group and it is not LEA
because it is non-amenable and isolated as a free-marked group. A. Thom
[Tho] provided an example of a group which is hyperlinear but not LEA,
but it is unknown whether Thom’s example is soﬁc or not. The existence of
non-soﬁc groups, of non-hyperlinear groups, and of hyperlinear groups which
are not soﬁc, remain open problems.
    L. Bowen [Bow] obtained the following extension of the Kolmogorov-
Ornstein-Weiss theorem for Bernoulli shifts. Recall that given a ﬁnite set
A, a strict probability
                         distribution p = (pa )a∈A on A (that is, pa > 0 for
all a ∈ A and a∈A pa = 1) and a countable group G, then, denoting by
278                                        7 Local Embeddability and Soﬁc Groups
      
μp = g∈G p the corresponding probability measure on the product space
AG , the triple (G, AG , μp ) is called a Bernoulli
                                                   shift. The associated entropy
is the nonnegative number H(p) = − a∈A pa log pa . Two Bernoulli shifts
(G, AG , μp ) and (G, B G , μq ) are said to be isomorphic (or measurably con-
jugate) if there exist two G-invariant subsets X ⊂ AG and Y ⊂ B G such
that μp (AG \ X) = μq (B G \ Y ) = 0 and a G-equivariant bijective measurable
map θ : X → Y with measurable inverse θ−1 : Y → X such that θ∗ μp = μq .
Bowen [Bow, Theorem 1.1] proved that if G is a countable soﬁc group, then
two isomorphic Bernoulli shifts (G, AG , μp ) and (G, B G , μq ) have the same
entropy, i.e. H(p) = H(q). This result had been established when G = Z
by N. Kolmogorov [Ko1, Ko2] in 1958–59 and then extended to countable
amenable groups by D. Ornstein and B. Weiss [OrW] in 1987.
   L. Glebsky and L.M. Rivera [GlR] introduced the concept of a weakly-
soﬁc group. This is a natural extension of the deﬁnition of soﬁcity where
the Hamming metric on symmetric groups is replaced by general bi-invariant
metrics on ﬁnite groups. Glebsky and Rivera showed that the existence of
a non-weakly-soﬁc group is equivalent to a conjecture on the closure in the
proﬁnite topology of products of conjugacy classes in free groups of ﬁnite
rank.



Exercises

7.1. Let G and C be two groups. Suppose that K is a ﬁnite symmetric subset
of G such that 1G ∈ K. Show that a map ϕ : G → C is a K-almost homo-
morphism if and only if it satisﬁes ϕ(k1 k2 ) = ϕ(k1 )ϕ(k2 ) for all k1 , k2 ∈ K
and ϕ(k) = 1C for all k ∈ K \ {1G }.

7.2. Show that every group which is locally embeddable into the class of
abelian groups is itself abelian.

7.3. Show that every group which is locally embeddable into the class of
metabelian groups is itself metabelian.

7.4. Show that every abelian group is locally embeddable into the class of
ﬁnite cyclic groups.

7.5. Let C be a class of groups. Suppose that a group G contains   a family
(Hi )i∈I of subgroups satisfying the following properties: (1) G = i∈I Hi ; (2)
For all i, j ∈ I there exists k ∈ I such that Hi ∪ Hj ⊂ Hk ; (3) Hi is locally
embeddable into C for all i ∈ I. Show that G is locally embeddable into C.

7.6. Let C be a class of groups which is closed under ﬁnite direct products.
Show that every group which is residually locally embeddable into C is locally
embeddable into C.
Exercises                                                                      279

7.7. Let C be a class of groups which is closed under taking subgroups and
taking ﬁnite direct products. Let G be a group which is residually C. Show
that there exists a net (Ni )i∈I which converges to {1G } in N (G) such that
G/Ni ∈ C fro all i ∈ I. Hint: Take as I the set of ﬁnite subsets of G partially
ordered by inclusion and use Proposition 7.1.13.

7.8. Show that if G is a ﬁnitely presented inﬁnite simple group then G is not
LEF.

7.9. Show that if G is a ﬁnitely presented non-amenable simple group then
G is not LEA.

7.10. (cf. [VeG]) Let G1 and G2 be two groups. Recall that, by Proposi-
tion 7.3.1, Gi (i = 1, 2) is an LEF-group if and only if the following holds:
(∗) for every ﬁnite subset Ki ⊂ Gi there exist a ﬁnite set Li such that
   Ki ⊂ Li ⊂ Gi and a binary operation !i : Li × Li → Li such that (Li , !i )
   is a group and ki ki = ki ! ki for all ki , ki ∈ Ki .
Suppose that G1 and G2 are LEF-groups. An action of G2 on G1 by group
automorphisms, i.e., a group homomorphism ϕ : G2 → Aut(G1 ), is said to
be equivariantly approximable, if for all ﬁnite subsets K1 ⊂ G1 and K2 ⊂ G2
there exist ﬁnite groups (L1 , !1 ) and (L2 , !2 ) as in (∗) and an action of L2 on
L1 by group automorphisms ψ : L2 → Aut(L1 ) such that if k1 ∈ K1 , k2 ∈ K2
and ϕ(k2 )(k1 ) ∈ K1 then ϕ(k2 )(k1 ) = ψ(k2 )(k1 ).
   Show that if G1 and G2 are LEF-groups and ϕ : G2 → Aut(G1 ) is an
equivariantly approximable action, then the semidirect product G1 ϕ G2 is
an LEF-group.

7.11. Use the previous exercise to show that the group G1 of Sect. 2.6 is an
LEF-group (cf. Proposition 7.3.9).

7.12. Show that every residually free group is torsion-free.

7.13. A group G is called fully residually free if for any ﬁnite subset K ⊂ G,
there exist a free group F and a group homomorphism φ : G → F whose
restriction to K is injective.
   (a) Show that every fully residually free group is residually free.
   (b) Show that every fully residually free group is locally embeddable into
the class of free groups.
   (c) A group G is called commutative-transitive if whenever a, b, c ∈ G\{1G }
satisfy ab = ba and bc = cb, then ac = ca. Prove that every group which is
locally embeddable into the class of free groups is commutative-transitive.
Hint: First prove that if F is a free group and a, b ∈ F satisfy ab = ba, then
there exist an element x ∈ F and integers m, n ∈ Z such that a = xm and
b = xn .
   (d) Show that if F is a nonabelian free group, then the group F × Z is
residually free but not locally embeddable into the class of free groups.
280                                         7 Local Embeddability and Soﬁc Groups

7.14. Give an example of a ﬁnitely generated LEF-group which is neither
residually ﬁnite nor amenable. Hint: Take for instance the group G = G1 ×F2 ,
where G1 is the group introduced in Sect. 2.6 and F2 denotes a free group of
rank two.
7.15. Let F be a nonempty ﬁnite set. Denote by GL(RF ) the automorphism
group of the real vector space RF = {x : F → R}. For α ∈ Sym(F ), deﬁne
λ(α) : RF → RF by λ(α)(x) = x ◦ α−1 for all x ∈ RF .
   (a) Show that λ(α) ∈ GL(RF ) for all α ∈ Sym(F ).
   (b) Show that the map λ : Sym(F ) → GL(RF ) is an injective group ho-
momorphism.
   (c) Show that the Hamming metric dF on Sym(F ) satisﬁes
                                        1
                         dF (α, β) =        Tr(λ(α−1 β))
                                       |F |

for all α, β ∈ Sym(F ), where Tr(·) denotes the trace.
7.16. Let H be a real or complex Hilbert space of ﬁnite dimension n ≥ 1.
Let L(H) denote the vector space consisting of all linear maps u : H → H.
If u ∈ L(H), we denote by Tr(u) the trace of u and by u∗ its adjoint. For
u, v ∈ L(H), we set
                                        1
                           u, vHS = Tr(u ◦ v ∗ ).
                                        n
   (a) Show that ·, ·HS is a scalar product on L(H). Let  · HS denote the
associated norm.
   (b) Let U(H) = {u ∈ L(H) : u ◦ u∗ = IdH }. Show that U(H) is a group
for the composition of maps.
   (c) Show that the map dHS : U(H) × U(H) → R deﬁned by dHS (u, v) =
u − vHS for all u, v ∈ U(H) is a bi-invariant metric on U(H). (The group
U(H) is called the unitary group of H and dHS is called the normalized
Hilbert-Schmidt metric on U(H).)
7.17. Let G be a group, K ⊂ G a ﬁnite subset, C a ﬁnite group, and
ϕ : G → C a K-almost-homomorphism. Denote by L : C → Sym(C) the
Cayley homomorphism, that is, the map deﬁned by L(g)(h) = gh for all
g, h ∈ C and set Φ = L ◦ ϕ : G → Sym(C). Show that Φ is a (K, ε)-almost-
homomorphism for all ε > 0.
7.18. Let G be a group and let K be a ﬁnite subset of G. Let F be a
nonempty ﬁnite set. Show that if 0 < ε < 2/|F | then every (K, ε)-almost-
homomorphism ϕ : G → Sym(F ) is a K-almost-homomorphism of G into the
group Sym(F ).
7.19. Suppose that a group G contains a family (Hi )i∈I of subgroups satisfy-
ing the following properties: (1) G = i∈I Hi ; (2) For all i, j ∈ I there exists
k ∈ I such that Hi ∪ Hj ⊂ Hk ; (3) Hi is soﬁc for all i ∈ I. Show that G is
soﬁc.
Exercises                                                                 281

7.20. Show that every virtually soﬁc group is soﬁc. Hint: Use Proposi-
tion 7.5.14.

7.21. By using Exercise 6.5 and Exercise 6.6, give a direct proof of the fact
that the direct product of ﬁnitely many groups which satisfy condition (b)
in Theorem 7.7.1 also satisﬁes it.

7.22. Let G be a ﬁnitely generated group and suppose that S and S  are two
ﬁnite symmetric generating subsets of G. Show that the pair (G, S) satisﬁes
condition (b) in Theorem 7.7.1 if and only if (G, S  ) does.

7.23. Give a direct proof of the fact that every ﬁnitely generated residually
ﬁnite group satisﬁes the condition (b) in Theorem 7.7.1.

7.24. Give a direct proof of the fact that every ﬁnitely generated amenable
group satisﬁes the condition (b) in Theorem 7.7.1.
Chapter 8
Linear Cellular Automata




In this chapter we study linear cellular automata, namely cellular automata
whose alphabet is a vector space and which are linear with respect to the
induced vector space structure on the set of conﬁgurations. If the alphabet
vector space and the underlying group are ﬁxed, the set of linear cellular
automata is a subalgebra of the endomorphism algebra of the conﬁguration
space (Proposition 8.1.4). An important property of linear cellular automata
is that the image of a ﬁnitely supported conﬁguration by a linear cellular
automaton also has ﬁnite support (Proposition 8.2.3). Moreover, a linear
cellular automaton is entirely determined by its restriction to the space of
ﬁnitely-supported conﬁgurations (Proposition 8.2.4) and it is pre-injective if
and only if this restriction is injective (Proposition 8.2.5). The algebra of
linear cellular automata is naturally isomorphic to the group algebra of the
underlying group with coeﬃcients in the endomorphism algebra of the al-
phabet vector space (Theorem 8.5.2). Linear cellular automata may be also
regarded as endomorphisms of the space of ﬁnitely-supported conﬁgurations,
viewed as a module over the group algebra of the underlying group with co-
eﬃcients in the ground ﬁeld (Proposition 8.7.5). This representation of linear
cellular automata is always one-to-one and, when the alphabet vector space
is ﬁnite-dimensional, it is also onto (Theorem 8.7.6). The image of a linear
cellular automaton is closed in the space of conﬁgurations for the prodiscrete
topology, provided that the alphabet is ﬁnite dimensional (Theorem 8.8.1).
We exhibit an example showing that if one drops the ﬁnite dimensionality
of the alphabet, then the image of a linear cellular automaton may fail to
be closed. In Sect. 8.9 we prove a linear version of the Garden of Eden theo-
rem. For the proof, we introduce the mean dimension of a vector subspace of
the conﬁguration space. We show that for a linear cellular automaton with
ﬁnite-dimensional alphabet, both pre-injectivity and surjectivity are equiv-
alent to the maximality of the mean dimension of the image of the cellular
automaton (Theorem 8.9.6). We exhibit two examples of linear cellular au-
tomata with ﬁnite-dimensional alphabet over the free group of rank two,
one which is pre-injective but not surjective, and one which is surjective but

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,      283
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 8, © Springer-Verlag Berlin Heidelberg 2010
284                                                      8 Linear Cellular Automata

not pre-injective. This shows that the linear version of the Garden of Eden
theorem fails to hold for groups containing nonabelian free subgroups (see
Sects. 8.10 and 8.11). Provided the alphabet is ﬁnite dimensional, the inverse
of every bijective linear cellular automaton is also a linear cellular automaton
(Corollary 8.12.2). In Sect. 8.13 we study the pre-injectivity and surjectiv-
ity of the discrete Laplacian over the real numbers and prove a Garden of
Eden type theorem (Theorem 8.13.2) for such linear cellular automata with
no amenability assumptions on the underlying group. As an application, we
deduce a characterization of locally ﬁnite groups in terms of real linear cellu-
lar automata (Corollary 8.13.4). In Sect. 8.14 we deﬁne linear surjunctivity
and prove that all soﬁc groups are linearly surjunctive (Theorem 8.14.4).
The notion of stable ﬁniteness for rings is introduced in Sect. 8.15. A sta-
bly ﬁnite ring is a ring for which one-sided invertible square matrices are
also two-sided invertible. It is shown that linear surjunctivity is equivalent
to stable ﬁniteness of the associated group algebra (Corollary 8.15.6). As a
consequence, we deduce that group algebras of soﬁc groups are stably ﬁnite
for any ground ﬁeld (Corollary 8.15.8). In the last section, we prove that the
absence of zero-divisors in the group algebra of an arbitrary group is equiva-
lent to the fact that every non-identically-zero linear cellular automaton with
one-dimensional alphabet is pre-injective (Corollary 8.16.12).
   We recall that in this book all rings are assumed to be associative (but not
necessarily commutative) with a unity element, and that a ﬁeld is a nonzero
commutative ring in which each nonzero element is invertible.



8.1 The Algebra of Linear Cellular Automata

Let G be a group and let V be a vector space over a ﬁeld K.
  The set V G consisting of all conﬁgurations x : G → V over the group G
and the alphabet V has a natural structure of vector space over K in which
addition and scalar multiplication are given by

             (x + x )(g) = x(g) + x (g)      and   (kx)(g) = kx(g)

for all x, x ∈ V G , k ∈ K, and g ∈ G. With the prodiscrete topology, V G
becomes a topological vector space (cf. Sect. F.1). The G-shift (see Sect. 1.1)
is then K-linear and continuous, that is, for each g ∈ G, the map x → gx is
a continuous endomorphism of V G .
   A linear cellular automaton over the group G and the alphabet V is a
cellular automaton τ : V G → V G which is K-linear, i.e., which satisﬁes

               τ (x + x ) = τ (x) + τ (x )   and τ (kx) = kτ (x)

for all x, x ∈ V G and k ∈ K.
8.1 The Algebra of Linear Cellular Automata                                         285

Proposition 8.1.1. Let G be a group and let V be a vector space over a
ﬁeld K. Let τ : V G → V G be a cellular automaton with memory set S ⊂ G
and local deﬁning map μ : V S → V . Then τ is linear if and only if μ is
K-linear.

Proof. Suppose ﬁrst that τ is linear. Let y, y  ∈ V S and k ∈ K. Denote by
x and x two conﬁgurations in V G extending y and y  respectively, i.e., such
that x|S = y and x |S = y  . We then have

  μ(y + y  ) = τ (x + x )(1G ) = (τ (x) + τ (x ))(1G ) = τ (x)(1G ) + τ (x )(1G )
              = μ(y) + μ(y  ).

Similarly, as (kx)|S = ky, we have

                   μ(ky) = τ (kx)(1G ) = kτ (x)(1G ) = kμ(y).

This shows that μ is K-linear.
  Conversely, suppose that μ is K-linear. Then, for all x, x ∈ V G , k ∈ K
and g ∈ G we have

        τ (x + x )(g) = μ((g −1 (x + x ))|S ) = μ((g −1 x)|S + (g −1 x )|S )
                       = μ((g −1 x)|S ) + μ((g −1 x )|S )
                       = τ (x)(g) + τ (x )(g)
                       = (τ (x) + τ (x ))(g)

and

  τ (kx)(g) = μ((g −1 (kx))|S ) = μ(k(g −1 x)|S ) = kμ((g −1 x)|S ) = kτ (x)(g).

This shows that τ (x + x ) = τ (x) + τ (x ) and τ (kx) = kτ (x). It follows that
τ is linear.

  The following result is a linear analogue of the Curtis-Hedlund theorem
(Theorem 1.8.1).

Theorem 8.1.2. Let G be a group and let V be a vector space over a ﬁeld K.
Let τ : V G → V G be a G-equivariant and K-linear map. Then the following
conditions are equivalent:
(a) the map τ is a linear cellular automaton;
(b) the map τ is uniformly continuous (with respect to the prodiscrete uniform
    structure on V G );
(c) the map τ is continuous (with respect to the prodiscrete topology on V G );
(d) the map τ is continuous (with respect to the prodiscrete topology on V G )
    at the constant conﬁguration x = 0.
286                                                    8 Linear Cellular Automata

Proof. The implication (a) ⇒ (b) immediately follows from Theorem 1.9.1.
Since the topology associated with the prodiscrete uniform structure is the
prodiscrete topology (cf. Example B.1.4(a)) and every uniformly continuous
map is continuous (cf. Proposition B.2.2), we also have (b) ⇒ (c). The im-
plication (c) ⇒ (d) is trivial. Therefore, we are only left to show that (d) ⇒
(a). Suppose that τ is continuous at 0. Then, the map V G → V deﬁned by
x → τ (x)(1G ) is continuous at 0 since the projection maps V G → V deﬁned
by x → x(g) are continuous (for the prodiscrete topology) for all g ∈ G and
the composition of continuous maps is continuous. We deduce that there ex-
ists a ﬁnite subset M ⊂ G such that if x ∈ V G satisﬁes x(m) = 0 for all
m ∈ M , then τ (x)(1G ) = 0. By linearity, we have that if two conﬁgurations
x and y coincide on M then τ (x)(1G ) = τ (y)(1G ). Thus there exists a linear
map μ : V M → V such that τ (x)(1G ) = μ(x|M ) for all x ∈ V G . As τ is
G-equivariant, we deduce that τ (x)(g) = τ (g −1 x)(1G ) = μ((g −1 x)|M ) for all
x ∈ V G and g ∈ G. This shows that τ is the (linear) cellular automaton with
memory set M and local deﬁning map μ. Thus (d) implies (a).

Examples 8.1.3. (a) Let G be a group, let S be a nonempty ﬁnite subset of
G, and let K be a ﬁeld. The discrete Laplacian ΔS : KG → KG (cf. Exam-
ple 1.4.3(b)) is a linear cellular automaton.
    (b) Let G be a group, V a vector space over a ﬁeld K, and f ∈ EndK (V ).
Then the map τ : V G → V G deﬁned by τ (x) = f ◦ x for all x ∈ V G is a linear
cellular automaton (cf. Example 1.4.3(d)).
    (c) Let G be a group, V a vector space over a ﬁeld K, and s0 an el-
ement of G. Let Rs0 : G → G be the right multiplication by s0 in G,
that is, the map deﬁned by Rs0 (g) = gs0 for all g ∈ G. Then the map
τ : V G → V G deﬁned by τ (x) = x ◦ Rs0 is a linear cellular automaton (cf.
Example 1.4.3(e)).
    (d) Let G = Z and K be a ﬁeld. Consider the vector space V = K[t] of
all polynomials in the indeterminate t with coeﬃcients in K. A conﬁguration
x ∈ V G may be viewed as a sequence x = (xn )n∈Z , where xn = xn (t) is
a polynomial for all n ∈ Z. Let S = {0, 1} and consider the K-linear map
μ : V S → V deﬁned by μ(p, q) = p − tq  for all (p, q) ∈ V S = V × V ,
where q  ∈ V denotes the derivative of the polynomial q. The linear cellular
automaton τ : V Z → V Z with memory set S and local deﬁning map μ is then
given by τ (x) = y, where yn = xn − txn+1 ∈ V , n ∈ Z, for all x = (xn )n∈Z ∈
V Z.

   We recall that an algebra over a ﬁeld K (or a K-algebra) is a vector space
A over K endowed with a product A × A → A such that A is a ring with
respect to the sum and the product and such that the following associative
law holds for the product and the multiplication by scalars:

                              (ha)(kb) = (hk)(ab)

for all h, k ∈ K and a, b ∈ A.
8.1 The Algebra of Linear Cellular Automata                               287

   A subset B of a K-algebra A is called a subalgebra of A if B is both a
vector subspace and a subring of A.
   If V is a vector space over a ﬁeld K, the set EndK (V ) consisting of all
endomorphisms of the vector space V has a natural structure of a K-algebra
for which
                         (f + f  )(v) = f (v) + f  (v),
                       (f f  )(v) = (f ◦ f  )(v) = f (f  (v))
and
                                 (kf )(v) = kf (v)
           
for all f, f ∈ EndK (V ), k ∈ K, and v ∈ V . The identity map IdV is the unity
element of EndK (V ).
   Given a group G and a vector space V over a ﬁeld K, we denote by
LCA(G; V ) the set of all linear cellular automata over the group G and the
alphabet V . It immediately follows from the deﬁnition of a linear cellular
automaton that LCA(G; V ) ⊂ EndK (V G ).

Proposition 8.1.4. Let G be a group and let V be a vector space over a ﬁeld
K. Then, LCA(G; V ) is a subalgebra of EndK (V G ).

Proof. Let τ1 , τ2 ∈ LCA(G; V ). Let S1 and S2 be memory sets for τ1 and τ2 .
Then, the set S = S1 ∪ S2 is also a memory set for τ1 and τ2 (cf. Sect. 1.5).
Let μ1 : V S → V and μ2 : V S → V be the corresponding local deﬁning maps
and set μ = μ1 + μ2 . For all x ∈ V G and g ∈ G we have

                  (τ1 + τ2 )(x)(g) = τ1 (x)(g) + τ2 (x)(g)
                                   = μ1 (g −1 x|S ) + μ2 (g −1 x|S )
                                   = μ(g −1 x|S ).

This shows that τ1 + τ2 is a cellular automaton with memory set S and
local deﬁning map μ. Since the map τ1 + τ2 is K-linear, we deduce that
τ1 + τ2 ∈ LCA(G; V ).
   On the other hand, let k ∈ K and let τ ∈ LCA(G; V ) with memory set
S and local deﬁning map μ : V S → V . Then, for all x ∈ V G and g ∈ G, we
have
           (kτ )(x)(g) = kτ (x)(g) = kμ(g −1 x|S ) = (kμ)(g −1 x|S ).
Therefore the K-linear map kτ is a cellular automaton with memory set S
and local deﬁning map kμ. It follows that kτ ∈ LCA(G; V ).
   We clearly have IdV G ∈ LCA(G; V ) (cf. Example 1.4.3(d)). Finally, it
follows from Proposition 1.4.9 that if τ1 , τ2 ∈ LCA(G; V ) then the K-linear
map τ1 τ2 = τ1 ◦ τ2 is also a cellular automaton and hence τ1 τ2 ∈ LCA(G; V ).
This shows that LCA(G; V ) is a subalgebra of EndK (V G ).
288                                                      8 Linear Cellular Automata

8.2 Conﬁgurations with Finite Support

Let G be a group and let V be a vector space over a ﬁeld K.
  The support of a conﬁguration x ∈ V G is the set {g ∈ G : x(g) = 0V }. We
denote by V [G] the subset of V G consisting of all conﬁgurations with ﬁnite
support.

Proposition 8.2.1. Let G be a group and let V be a vector space over a ﬁeld
K. Then the set V [G] is a vector subspace of V G . Moreover, V [G] is dense
in V G for the prodiscrete topology.

Proof. If k1 , k2 ∈ K and x1 , x2 ∈ V G , then the support of k1 x1 + k2 x2 is
contained in the union of the support of x1 and the support of x2 . Therefore,
if x1 and x2 have ﬁnite support, so does k1 x1 + k2 x2 . Consequently, V [G] is
a vector subspace of V G .
   Let x ∈ V G and let W ⊂ V G be a neighborhood of x for the prodiscrete
topology. By deﬁnition of the prodiscrete topology, there exists a ﬁnite subset
Ω ⊂ G such that W contains all conﬁgurations which coincide with x on
Ω. It follows that the conﬁguration y ∈ V [G] which coincides with x on
Ω and is identically zero outside of Ω is in W . This shows that V [G] is
dense in V G .

Proposition 8.2.2. Let G be a group and let V be a vector space over a ﬁeld
K. Let x, x ∈ V G . Then the conﬁgurations x and x are almost equal if and
only if x − x ∈ V [G].

Proof. By deﬁnition, x and x are almost equal if and only if the set {g ∈
G : x(g) = x (g)} is ﬁnite. This is equivalent to x − x ∈ V [G] since {g ∈ G :
x(g) = x (g)} = {g ∈ G : (x − x )(g) = 0V }.

Proposition 8.2.3. Let G be a group and let V be a vector space over a ﬁeld
K. Let τ ∈ LCA(G; V ). Then one has τ (V [G]) ⊂ V [G].

Proof. Denote by S ⊂ G a memory set for τ and let μ : V S → V be the corre-
sponding local deﬁning map. Let x ∈ V [G] and let T ⊂ G denote the support
of x. For all g ∈ G, we have τ (x)(g) = μ((g −1 x)|S ). As μ is linear (Proposi-
tion 8.1.1) and the support of g −1 x is g −1 T , we deduce that τ (x)(g) = 0 if
g −1 T ∩ S = ∅. It follows that the support of τ (x) is contained in the ﬁnite
set T S −1 ⊂ G. This shows that τ (x) ∈ V [G].

   Observe that if τ ∈ LCA(G; V ), then the restriction map

                              τ |V [G] : V [G] → V [G]

is K-linear, that is, τ |V [G] ∈ EndK (V [G]).
8.3 Restriction and Induction of Linear Cellular Automata                       289

   Let A and B be two algebras over a ﬁeld K. A map F : A → B is called a
K-algebra homomorphism if F is both a vector space homomorphism (i.e., a
K-linear map) and a ring homomorphism. This is equivalent to the fact that
F satisﬁes F (a + a ) = F (a) + F (a ), F (aa ) = F (a)F (a ), F (ka) = kF (a)
for all a, a ∈ A and k ∈ K, and F (1A ) = 1B .

Proposition 8.2.4. Let G be a group and let V be a vector space over a ﬁeld
K. Then the map Λ : LCA(G; V ) → EndK (V [G]) deﬁned by Λ(τ ) = τ |V [G] ,
where τ |V [G] : V [G] → V [G] is the restriction of τ to V [G], is an injective
K-algebra homomorphism.

Proof. The fact that Λ is an algebra homomorphism immediately follows
from the deﬁnition of the algebra operations on LCA(G; V ) and EndK (V [G]).
Suppose that τ ∈ LCA(G; V ) satisﬁes Λ(τ ) = 0. This means that τ (y) = 0
for all y ∈ V [G]. As τ : V G → V G is continuous by Proposition 1.4.8 and
V [G] is dense in V G by Proposition 8.2.1 for the prodiscrete topology, we
deduce that τ (x) = 0 for all x ∈ V G , that is, τ = 0. This shows that Λ is
injective.

Proposition 8.2.5. Let G be a group and let V be a vector space over a ﬁeld
K. Let τ ∈ LCA(G; V ). Then the following conditions are equivalent:
(a) τ is pre-injective;
(b) τ |V [G] : V [G] → V [G] is injective.

Proof. Suppose that τ is pre-injective. Let x ∈ ker(τ |V [G] ). Then x ∈ V [G]
and τ (x) = τ |V [G] (x) = 0. As the trivial conﬁguration 0 and the conﬁguration
x are almost equal and τ (0) = 0 by linearity of τ , the pre-injectivity of τ
implies that x = 0. This shows that τ |V [G] is injective.
   Conversely, suppose that τ |V [G] is injective. Let x, x ∈ V G be two conﬁgu-
rations which are almost equal and such that τ (x) = τ (x ). Then x−x ∈ V [G]
by Proposition 8.2.2 and we have τ |V [G] (x−x ) = τ (x−x ) = τ (x)−τ (x ) = 0.
As τ |V [G] is injective, this implies x − x = 0, that is, x = x . Therefore, τ is
pre-injective.



8.3 Restriction and Induction of Linear Cellular
    Automata

In this section, we show that the operations of restriction and induction for
cellular automata that were introduced in Sect. 1.7 preserve linearity.
   Let G be a group and let V be a vector space over a ﬁeld K. Let H be
a subgroup of G. We denote by LCA(G, H; V ) = LCA(G; V ) ∩ CA(G, H; V )
the set of all linear cellular automata τ : V G → V G admitting a memory set
S such that S ⊂ H. Recall from Sect. 1.7, that, given a cellular automa-
ton τ : V G → V G with memory set S ⊂ H, we denote by τH : V H → V H
290                                                         8 Linear Cellular Automata

the restriction cellular automaton. Similarly, given a cellular automaton
σ : V H → V H , we denote by σ G : V G → V G the induced cellular automa-
ton.

Proposition 8.3.1. Let τ ∈ CA(G, H; V ). Then, τ ∈ LCA(G, H; V ) if and
only if τH ∈ LCA(H; V ).

Proof. It follows immediately from the deﬁnitions of restriction and induction
that a cellular automaton τ ∈ CA(G, H; V ) is linear if and only if τH ∈
CA(H; V ) is linear.

   Let A and B be two algebras over a ﬁeld K. A map F : A → B is called
a K-algebra isomorphism if F is a bijective K-algebra homomorphism. It is
clear that if F : A → B is a K-algebra isomorphism then its inverse map
F −1 : B → A is also a K-algebra isomorphism.

Proposition 8.3.2. The set LCA(G, H; V ) is a subalgebra of LCA(G; V ).
Moreover, the map τ → τH is a K-algebra isomorphism from LCA(G, H; V )
onto LCA(H; V ) whose inverse is the map σ → σ G .

Proof. Let τ1 , τ2 ∈ LCA(G, H; V ) with memory sets S1 , S2 ⊂ H respec-
tively. Then the linear cellular automaton τ1 + τ2 admits S1 ∪ S2 as a mem-
ory set. As S1 ∪ S2 ⊂ H, we have τ1 + τ2 ∈ LCA(G, H; V ). If k ∈ K and
τ ∈ LCA(G, H; V ), with memory set S ⊂ H, then S is also a memory set
for kτ and therefore kτ ∈ LCA(G, H; V ). This shows that LCA(G, H; V )
is a vector subspace of LCA(G; V ). Since LCA(G, H; V ) is a submonoid of
LCA(G; V ) by Proposition 1.7.1, we deduce that LCA(G, H; V ) is a subalge-
bra of LCA(G; V ).
   To simplify notation, denote by Φ : LCA(G, H; V ) → LCA(H; V ) and
Ψ : LCA(H; V ) → LCA(G, H; V ) the maps deﬁned by Φ(τ ) = τH and Ψ (σ) =
σ G respectively. It is clear from the deﬁnitions that Ψ ◦ Φ : LCA(G, H; V ) →
LCA(G, H; V ) and Φ ◦ Ψ : LCA(H; V ) → LCA(H; V ) are the identity maps.
Therefore, Φ is bijective with inverse Ψ . It remains to show that Φ is a K-
algebra homomorphism.
   Let τ1 , τ2 ∈ LCA(G, H; V ) and k1 , k2 ∈ K. Let x ∈ V H and let x  ∈ VG
extending x. By applying (1.13), we have

      Φ(k1 τ1 + k2 τ2 )(x)(h) = (k1 τ1 + k2 τ2 )(
                                                 x)(h) = k1 τ1 (
                                                                x)(h) + k2 τ2 (
                                                                               x)(h)

for all h ∈ H. We deduce that Φ(k1 τ1 + k2 τ2 )(x) = (k1 Φ(τ1 ) + k2 Φ(τ2 ))(x)
for all x ∈ V H , that is, Φ(k1 τ1 + k2 τ2 ) = k1 Φ(τ1 ) + k2 Φ(τ2 ). This shows that
Φ is K-linear.
   Finally, it follows from Proposition 1.7.2 that Φ(IdV G ) = IdV H and
Φ(τ1 τ2 ) = Φ(τ1 )Φ(τ2 ) for all τ1 , τ2 ∈ LCA(G, H; V ). We have shown that
Φ is a K-algebra isomorphism.
8.4 Group Rings and Group Algebras                                           291

8.4 Group Rings and Group Algebras

Let G be a group and let R be a ring. We denote by 0R (resp. 1R ) the zero
(resp. unity) element of R. We regard R as a left R-module over itself. Then
RG = {α : G → R} has a natural structure of left R-module with addition
and scalar multiplication given by

              (α + β)(g) = α(g) + β(g)           and (rα)(g) = rα(g)

for all α, β ∈ RG , r ∈ R, and g ∈ G. Deﬁne the support of an element α ∈ RG
as being the set {g ∈ G : α(g) = 0R }. Let R[G] denote the set consisting of all
elements α ∈ RG which have ﬁnite support. Then R[G] is a free submodule
of RG . We have                           
                         R[G] =      R⊂       R = RG ,
                                 g∈G         g∈G

so that the elements δg : G → R, g ∈ G, deﬁned by
                                    
                                     1R if h = g
                           δg (h) =                                        (8.1)
                                     0R if h = g

freely generate R[G] as a left R-module. Note that the decomposition of an
element α ∈ R[G] in this basis is simply given by the formula

                                α=          α(g)δg .
                                      g∈G

   Let now α and β be two elements of R[G] and denote their supports by S
and T . The convolution product of α and β is the element αβ ∈ RG deﬁned
by
              (αβ)(g) =     α(h)β(h−1 g) =      α(h)β(h−1 g)         (8.2)
                          h∈G                        h∈S

for all g ∈ G. Note that αβ ∈ R[G] as the support of αβ is contained in
ST = {st : s ∈ S, t ∈ T }. By using the change of variables h1 = h and
h2 = h−1 g, the convolution product (8.2) may be also expressed as follows:

                        (αβ)(g) =                α(h1 )β(h2 ).             (8.3)
                                     h1 ,h2 ∈G
                                     h1 h2 =g

Proposition 8.4.1. Let G be a group and let R be a ring. Then the addition
and the convolution product gives a ring structure to R[G].

Proof. We know that (R[G], +) is an abelian group. Let α, β, γ ∈ R[G] and
g ∈ G. We have
292                                                              8 Linear Cellular Automata

                          [(αβ)γ](g) =            (αβ)(h)γ(h−1 g)
                                            h∈G

                                        =             α(k)β(k−1 h)γ(h−1 g)
                                            h∈G k∈G

          (by setting s = k   −1
                                   h) =               α(k)β(s)γ(s−1 k −1 g)
                                            s∈G k∈G

                                        =         α(k)(        β(s)γ(s−1 k −1 g))
                                            k∈G          s∈G

                                        =         α(k)(βγ)(k−1 g)
                                            k∈G
                                        = [α(βγ)](g).

This shows that (αβ)γ = α(βγ). Thus, the convolution product is associative.
On the other hand, given α ∈ R[G] we have, for all g ∈ G,

 [δ1G α](g) =         δ1G (h)α(h−1 g) = α(g) =             α(k)δ1G (k −1 g) = [αδ1G ](g).
                h∈G                                  k∈G

Thus, δ1G α = αδ1G = α for all α ∈ R[G]. This shows that δ1G is an identity
element for the convolution product. Finally,

            [(α + β)γ](g) =            (α + β)(h)γ(h−1 g)
                                 h∈G

                             =         [α(h) + β(h)]γ(h−1 g)
                                 h∈G

                             =         α(h)γ(h−1 g) +            β(k)γ(k−1 g)
                                 h∈G                       k∈G
                             = (αγ)(g) + (βγ)(g).

Thus, we have (α + β)γ = αγ + βγ. Similarly, one shows that α(β + γ) =
αβ +αγ. It follows that the distributive laws also hold in R[G]. Consequently,
R[G] is a ring with unity element 1R[G] = δ1G .

   The ring R[G] is called the group ring of G with coeﬃcients in R.
   Given a ring R, denote by U (R) the multiplicative group consisting of all
invertible elements in R.

Proposition 8.4.2. Let G be a group and let R be a ring. Then one has
δg ∈ U(R[G]) for all g ∈ G. Moreover the map φ : G → U(R[G]) given by
φ(g) = δg is a group homomorphism.
                                                    
Proof. Let g1 , g2 , g ∈ G. Then (δg1 δg2 )(g) = h∈G δg1 (h)δg2 (h−1 g) equals 1
if g1−1 g = g2 , that is, if g = g1 g2 , and equals 0 otherwise. This shows that

                                    δg1 δg2 = δg1 g2 .                               (8.4)
8.4 Group Rings and Group Algebras                                            293

We deduce that δg δg−1 = δgg−1 = δ1G = 1R[G] and, similarly, δg−1 δg =
1R[G] . This shows that δg belongs to U(R[G]). The fact that φ is a group
homomorphism follows from (8.4).
  Let G be a group and let R be a ring. For α ∈ R[G] deﬁne α∗ : G → R
by setting α∗ (g) = α(g −1 ) for all g ∈ G. If S is the support of α, then the
support of α∗ is S −1 . Thus one has α∗ ∈ R[G].
Proposition 8.4.3. Let G be a group and let R be a ring. Let α, β ∈ R[G].
Then one has
  (i) (1R[G] )∗ = 1R[G] ,
 (ii) (α∗ )∗ = α,
(iii) (α + β)∗ = α∗ + β ∗ .
Moreover, if the ring R is commutative, then one has
(iv) (αβ)∗ = β ∗ α∗ .
Proof. (i) We have (1R[G] )∗ = 1R[G] since the support of 1R[G] = δ1G is {1G }.
  (ii) For all g ∈ G, we have

                         (α∗ )∗ (g) = α((g −1 )−1 ) = α(g).

Therefore (α∗ )∗ = α.
  (iii) For all g ∈ G, we have

(α+β)∗ (g) = (α+β)(g −1 ) = α(g −1 )+β(g −1 ) = α∗ (g)+β ∗ (g) = (α∗ +β ∗ )(g).

Therefore (α + β)∗ = α∗ + β ∗ .
  (iv) Suppose that the ring R is commutative. For all g ∈ G, we have

         (αβ)∗ (g) = (αβ)(g −1 )
                   =          α(h)β(h−1 g −1 )
                        h∈G

                   =          β(h−1 g −1 )α(h)     (since R is commutative)
                        h∈G

                   =          β ∗ (gh)α∗ (h−1 )
                        h∈G

                   =          β ∗ (k)α∗ (k −1 g)
                        k∈G
                   = (β ∗ α∗ )(g).

Therefore (αβ)∗ = β ∗ α∗ .
  If R = (R, +, ·) is a ring, its opposite ring is the ring Rop = (R, +, ∗)
having the same underlying set and addition as R and with multiplication ∗
deﬁned by r ∗ s = sr for all r, s ∈ R.
294                                                        8 Linear Cellular Automata

  From Proposition 8.4.3, we deduce that, if G is a group and R is a com-
mutative ring, then the map α → α∗ is a ring isomorphism between the ring
R[G] and its opposite ring (R[G])op . Thus we have

Corollary 8.4.4. Let G be a group and let R be a commutative ring. Then
the ring R[G] is isomorphic to its opposite ring (R[G])op .

Remarks 8.4.5. Let G be a group and let R be a ring.
   (a) It is immediate to verify that the map R → R[G] deﬁned by r → rδ1G is
an injective ring homomorphism. This is often used to regard R as a subring
of R[G].
   (b) Observe that (rα)β = r(αβ) for all r ∈ R and α, β ∈ R[G]. Therefore,
we can use the notation rαβ = (rα)β = r(αβ). If the ring R is commutative,
then one has the additional property (r1 α)(r2 β) = r1 r2 αβ for all r1 , r2 ∈ R
and α, β ∈ R[G].
   (c) Suppose that the group G is abelian and that the ring R is commuta-
tive. Then the ring R[G] is commutative. Indeed, it immediately follows from
(8.3) that we have αβ = βα for all α, β ∈ R[G] under these hypotheses.

   Suppose now that we are given an algebra A over a ﬁeld K. Then A[G] is
both a K-vector space and a ring; Moreover, we have (k1 α)(k2 β) = k1 k2 αβ
for all k1 , k2 ∈ K and α, β ∈ A[G]. Therefore, A[G] is an algebra over K.
The K-algebra A[G] is called the group algebra of G with coeﬃcients in the
K-algebra A. In the particular case A = K, this gives the K-algebra K[G].



8.5 Group Ring Representation of Linear Cellular
    Automata

Let G be a group and let V be a vector space over a ﬁeld K.
   Consider the K-algebra EndK (V )[G], that is, the group algebra of G with
coeﬃcients in the K-algebra EndK (V ) (see Sect. 8.4).
   For each α ∈ EndK (V )[G], we deﬁne a map τα : V G → V G by setting

                         τα (x)(g) =         α(h)(x(gh))                       (8.5)
                                       h∈G

for all x ∈ V G and g ∈ G. Observe that α(h) ∈ EndK (V ) and x(gh) ∈ V
for all x ∈ V G and g, h ∈ G. Note also that there is only a ﬁnite number of
nonzero terms in the sum appearing in the right hand side of (8.5) since α
has ﬁnite support. It follows that τα is well deﬁned.
   For each v ∈ V , deﬁne the conﬁguration cv ∈ V [G] by
                                    
                                      v if g = 1G ,
                           cv (g) =                                    (8.6)
                                      0 otherwise.
8.5 Group Ring Representation of Linear Cellular Automata                  295

Note that the map from V to V [G] given by v → cv is injective and K-linear.

Proposition 8.5.1. Let α ∈ EndK (V )[G]. Then one has:
  (i) τα ∈ LCA(G; V );
 (ii) α(g)(v) = τα (cv )(g) for all v ∈ V and g ∈ G;
(iii) the support of α is the minimal memory set of τα .

Proof. Let S ⊂ G denote the support of α. Consider the map μ : V S → V
given by
                         μ(y) =    α(s)(y(s))
                                       s∈S

for all y ∈ V . Then, for all x ∈ V
             S                         G
                                           and g ∈ G, we have

                         τα (x)(g) =         α(h)(x(gh))
                                       h∈G

                                   =         α(h)(g −1 x(h))
                                       h∈G                                (8.7)
                                                      −1
                                   =         α(s)(g        x(s))
                                       s∈S

                                   = μ((g −1 x)|S ).

Thus τα is the cellular automaton with memory set S and local deﬁning
map μ. It is clear from (8.5) that τα is a K-linear map. Thus, we have τα ∈
LCA(G; V ). This shows (i).
   Let v ∈ V and let cv ∈ V [G] as in (8.6). By applying (8.5), we get, for all
g ∈ G,
                τα (cv )(g −1 ) =  α(h)(cv (g −1 h)) = α(g)(v).
                                 h∈G

This gives us (ii).
   Finally, let S0 ⊂ G denote the minimal memory set of τα . We have seen
in the proof of (i) that S is a memory set for τα . Therefore, we have S0 ⊂ S.
On the other hand, we deduce from (ii) that, for all v ∈ V and g ∈ G, we
have
                     α(g)(v) = τα (cv )(g) = μ0 ((g −1 cv )|S0 ),
where μ0 : V S0 → V denote the local deﬁning map for τα associated with
S0 . Since the conﬁguration g −1 cv is identically zero on G \ {g}, it follows
that α(g) = 0 if g ∈ / S0 . This implies S ⊂ S0 . Thus, we have S = S0 .
This shows (iii).

Theorem 8.5.2. Let G be a group and let V be a vector space over a ﬁeld K.
Then the map Ψ : EndK (V )[G] → LCA(G; V ) deﬁned by α → τα is a K-
algebra isomorphism.

Proof. Let α, β ∈ EndK (V )[G] and k ∈ K. By applying (8.5), we get
296                                                              8 Linear Cellular Automata

              τα+β (x)(g) =         [(α + β)(h)](x(gh))
                              h∈G

                         =          (α(h) + β(h))(x(gh))
                              h∈G

                         =          [α(h)(x(gh)) + β(h)(x(gh))]
                              h∈G

                         =          α(h)(x(gh)) +               β(h)(x(gh))
                              h∈G                         h∈G
                         = τα (x)(g) + τβ (x)(g)

and, similarly,

                      τkα (x)(g) =            [(kα)(h)](x(gh))
                                        h∈G

                                    =         k[α(h)](x(gh))
                                        h∈G

                                    =k            [α(h)](x(gh))
                                         h∈G
                                    = kτα (x)(g)

for all x ∈ V G and g ∈ G. Thus τα+β = τα + τβ and τkα = kτα . This shows
that Ψ is a K-linear map.
   Let us show that Ψ is a ring homomorphism. Let α, β ∈ EndK (V )[G]. Let
x ∈ V G and set y = τβ (x). For all g, h ∈ G, we have

                         y(gh) =              β(t)(x(ght)).                          (8.8)
                                        t∈G

It follows that
                  τα (τβ (x))(g) = τα (y)(g)
                                    =         α(h)(y(gh))
                                        h∈G
                                                                         
                   (by (8.8)) =               α(h)            β(t)(x(ght))
                                        h∈G             t∈G
                                                                            
           (by setting z = ht) =              α(h)            β(h−1 z)(x(gz))
                                        h∈G             z∈G
                                                                   
                                    =                   α(h)β(h−1 z) (x(gz))
                                        z∈G       h∈G

                                    =         [αβ](z)(x(gz))
                                        z∈G
                                    = ταβ (x)(g).
8.5 Group Ring Representation of Linear Cellular Automata                            297

Thus we have ταβ = τα ◦ τβ , that is, Ψ (αβ) = Ψ (α)Ψ (β). Observe that
1EndK (V )[G] = δ1G , where δ1G : G → EndK (V ) is given by δ1G (h) = IdV if
h = 1G and δ1G (h) = 0 otherwise. Thus, if x ∈ V G we have

                   Ψ (1EndK (V )[G] )(x)(g) = Ψ (δ1G )(x)(g)
                                             =         δ1G (h)(x(gh))
                                                 h∈G
                                             = x(g)

for all g ∈ G. It follows that Ψ (1EndK (V )[G] ) = IdV G . This proves that Ψ is a
ring homomorphism.
   Let us show now that Ψ is injective. Let α ∈ ker(Ψ ). Then,

                                       τα (x) = 0                                   (8.9)

for all x ∈ V G . Taking x = cv in (8.9), where, for v ∈ V , the element
cv ∈ V [G] is as in (8.6), we deduce from Proposition 8.5.1(ii) that α(g)(v) = 0
for all v ∈ V and g ∈ G. Thus, we have α(g) = 0 for all g ∈ G and therefore
α = 0. It follows that ker(Ψ ) = {0}, that is, Ψ is injective.
   Let us show that Ψ is surjective. Suppose that τ ∈ LCA(G; V ) has
memory set S and local deﬁning map μ : V S → V . As μ is K-linear (cf.
          8.1.1), there exist K-linear maps αs : V → V , s ∈ S, such that
Proposition
μ(y) = s∈S αs (y(s)) for all y ∈ V S . For all x ∈ V G and g ∈ G, we have

         τ (x)(g) = μ((g −1 x)|S ) =         αs g −1 x(s) =          αs (x(gs)) .
                                       s∈S                     s∈S

This shows that τ = τα , where α ∈ EndK (V )[G] is deﬁned by
                                
                                  αs if h = s ∈ S,
                         α(h) =
                                  0 otherwise.

Thus Ψ is surjective.

  If the vector space V is one-dimensional over the ﬁeld K, then each endo-
morphism of V is of the form v → kv, for some k ∈ K. It follows that the
K-algebra EndK (V ) is canonically isomorphic to K in this case. Thus, we get:


Corollary 8.5.3. Let G be a group and let V be a one-dimensional vector
space over a ﬁeld K. Then the map Ψ : K[G] → LCA(G; V ) deﬁned by

                          Ψ (α)(x)(g) =            α(h)x(gh)
                                             h∈G

for all α ∈ K[G], x ∈ V G , and g ∈ G, is a K-algebra isomorphism.
298                                                          8 Linear Cellular Automata

   When G is an abelian group, then the K-algebra K[G] is commutative for
any ﬁeld K by Remark 8.4.5(c). Thus, as an immediate consequence of the
preceding corollary, we get:
Corollary 8.5.4. Let G be an abelian group and let V be a one-
dimensional vector space over a ﬁeld K. Then the K-algebra LCA(G; V ) is
commutative.

Examples 8.5.5. (a) Let G be a group, S a nonempty ﬁnite subset of G, and
let K be a ﬁeld. Consider the element

                        α = |S|δ1G −            δs ∈ K[G],
                                          s∈S

Then, taking V = K, we have, for all x ∈ KG and g ∈ G,

            Ψ (α)(x)(g) =         α(h)x(gh) = |S|x(g) −             x(gs).
                            h∈G                               s∈S


It follows that Ψ (α) is the discrete Laplacian ΔS : KG → KG associated with
S (cf. Example 8.1.3(a)).
   (b) Let G be a group, V a vector space over a ﬁeld K and f ∈ EndK (V ).
Consider the element α ∈ EndK (V )[G] deﬁned by α = f δ1G . Let x ∈ V G and
g ∈ G. We have

                 Ψ (α)(x)(g) =          α(h)(x(gh)) = f (x(g)).
                                  h∈G

It follows that Ψ (α) is the linear cellular automaton τ ∈ LCA(G; V ) deﬁned
by τ (x) = f ◦ x for all x ∈ V G (cf. Example 8.1.3(b)).
   (c) Let G be a group, V a vector space over a ﬁeld K, and s0 an element of
G. Consider the group algebra element α ∈ EndK (V )[G] deﬁned by α = δs0 .
For all x ∈ V G and g ∈ G, we have

                  Ψ (α)(x)(g) =          α(h)(x(gh)) = x(gs0 ).
                                   h∈G

It follows that Ψ (α) is the linear cellular automaton τ ∈ LCA(G; V ) deﬁned
by τ (x) = x ◦ Rs0 , where Rs0 : G → G is the right multiplication by s0 (cf.
Example 8.1.3(c)).
   (d) Let G = Z, let K be a ﬁeld, and let V = K[t] be the vector space
consisting of all polynomials in the indeterminate t with coeﬃcients in K.
Denote by D and U the elements in EndK (V ) deﬁned respectively by D(p) =
p and U (p) = tp, for all p ∈ V . Consider the element

                     α = δ0 − (U ◦ D)δ1 ∈ EndK (V )[Z].
8.6 Modules over a Group Ring                                                               299

For all x = (xn )n∈Z ∈ V Z , we have Ψ (α)(x) = (yn )n∈Z ∈ V Z , where

                      yn =         α(m)(xn+m ) = xn − txn+1
                             m∈Z

for all n ∈ Z. It follows that Ψ (α) is the linear cellular automaton τ ∈
LCA(Z; K[t]) described in Example 8.1.3(d).



8.6 Modules over a Group Ring

Let R be a ring and let M be a left R-module. We denote by EndR (M ) the
endomorphism ring of M . Recall that EndR (M ) is the set consisting of all
maps f : M → M satisfying

                f (x + x ) = f (x) + f (x ) and         f (rx) = rf (x)

for all r ∈ R and x, x ∈ M . The ring operations in EndR (M ) are given by

    (f + f  )(x) = f (x) + f  (x)   and       (f f  )(x) = (f ◦ f  )(x) = f (f  (x))

for all f, f  ∈ EndR (M ) and x ∈ M , and the unity element of EndR (M ) is
the identity map IdM .
   Suppose that there is a group G which acts on M by endomorphisms. We
then deﬁne a structure of left R[G]-module on M as follows.
   For α ∈ R[G] and x ∈ M , deﬁne the element αx ∈ M by

                                   αx =         α(g)gx.                                (8.10)
                                          g∈G

Note that this deﬁnition makes sense. Indeed, one has α(g) ∈ R and gx ∈ M
for each g ∈ G. On the other hand, there is only ﬁnitely many nonzero terms
in the right hand side of (8.10) since the support of α is ﬁnite.

Proposition 8.6.1. One has:
  (i) 1R[G] x = x,
 (ii) α(x + x ) = αx + αx ,
(iii) (α + β)x = αx + βx,
(iv) α(βx) = (αβ)x
for all α, β ∈ R[G] and x, x ∈ M .

Proof. (i) We have
                                1R[G] x = δ1G x = x.
300                                                                   8 Linear Cellular Automata

  (ii) We have

          α(x + x ) =         α(g)g(x + x ) =                  (α(g)gx + α(g)gx )
                         g∈G                               g∈G

                    =          α(g)gx +                α(g)gx = αx + αx .
                         g∈G                   g∈G

  (iii) We have

            (α + β)x =             (α + β)(g)gx =                 (α(g) + β(g))gx
                             g∈G                            g∈G

                         =         α(g)gx +                β(g)gx = αx + βx.
                             g∈G                  g∈G

  (iv) We have, by using (8.3),

                  α(βx) =                α(h1 )h1 (βx)
                                 h1 ∈G
                                                                          
                             =           α(h1 )h1                β(h2 )h2 x
                                 h1 ∈G                  h2 ∈G

                             =                  α(h1 )β(h2 )h1 h2 x
                                 h1 ∈G h2 ∈G
                                                                  
                             =                         α(h1 )β(h2 ) gx
                                 g∈G       h1 ,h2 ∈G
                                           h1 h2 =g

                             =         (αβ)(g)gx
                                 g∈G

                             = (αβ)x.



   It follows from Proposition 8.6.1 that the addition on M and the multi-
plication (α, x) → αx deﬁned by (8.10) gives us a left R[G]-module structure
on M . Observe that this R[G]-module structure extends the R-module struc-
ture on M if we regard R as a subring of R[G] via the map r → rδ1G (cf.
Remark 8.4.5(a)).
Proposition 8.6.2. Let f : M → M be a map. Then the following conditions
are equivalent:
(a) f ∈ EndR[G] (M );
(b) f ∈ EndR (M ) and f is G-equivariant.
Proof. Suppose that f satisﬁes (b). Then f (x + x ) = f (x) + f (x ) for all
x, x ∈ M since f ∈ EndR (M ). On the other hand, if α ∈ R[G] and x ∈ M ,
8.7 Matrix Representation of Linear Cellular Automata                        301

we have, by using the G-equivariance and the R-linearity of f ,
                         
   f (αx) = f      α(g)gx =       α(g)f (gx) =     α(g)gf (x) = αf (x).
                 g∈G               g∈G                  g∈G

It follows that f ∈ EndR[G] (M ). This shows that (b) implies (a).
   Conversely, suppose that f satisﬁes (a). Let x, x ∈ M and r ∈ R. Then
we have f (x + x ) = f (x) + f (x ), f (rx) = f (rδ1G x) = rδ1G f (x) = rf (x),
and f (gx) = f (δg x) = δg f (x) = gf (x) since f ∈ EndR[G] (M ). This shows
that f ∈ EndR (M ) and that f is G-equivariant. Thus, (a) implies (b).

Remark 8.6.3. Conversely, suppose that we are given a left R[G]-module M .
Then, by applying the above construction, we recover the initial R[G]-module
structure on M if we start from the R-module structure on M obtained by
restricting the scalars and the R-linear action of G on M deﬁned by gx = δg x
for all g ∈ G and x ∈ M .



8.7 Matrix Representation of Linear Cellular Automata

Let G be a group and let V be a vector space over a ﬁeld K.
  Since the G-shift action on V G is K-linear, it induces a structure of left
K[G]-module on V G which extends the K-vector space structure on V G (see
Sect. 8.6). Note that by applying (8.10) we get, for all α ∈ K[G] and x ∈ V G ,

                                αx =         α(h)hx,                      (8.11)
                                       h∈G

that is,
                           (αx)(g) =         α(h)x(h−1 g)
                                       h∈G

for all g ∈ G. Thus, αx may be regarded as the “convolution product” of α
and x (compare with (8.2)).
   Let τ : V G → V G be a linear cellular automaton. Then τ is K-linear
by deﬁnition. On the other hand, τ is G-equivariant by Proposition 1.4.4.
Thus, it follows from Proposition 8.6.2 that τ is an endomorphism of the
K[G]-module V G . Consequently, we have LCA(G; V ) ⊂ EndK[G] (V G ). It is
clear that EndK[G] (V G ) is a subalgebra of the K-algebra EndK (V G ). Since
LCA(G; V ) is a subalgebra of EndK (V G ) by Proposition 8.1.4, we get:
Proposition 8.7.1. The set LCA(G; V ) is a subalgebra of the K-algebra
EndK[G] (V G ).

Remark 8.7.2. When G is a ﬁnite group, we have LCA(G; V ) = EndK[G] (V G ).
Indeed, in this case, every u ∈ EndK[G] (V G ) is a linear cellular automaton
302                                                                    8 Linear Cellular Automata

with memory set G and local deﬁning map μ : V G → V given by μ(y) =
u(y)(1G ), since u(x)(g) = g −1 u(x)(1G ) = u(g −1 x)(1G ) for all x ∈ V G and
g ∈ G.

   Consider now the vector subspace V [G] ⊂ V G consisting of all conﬁgura-
tions with ﬁnite support. Observe that if x ∈ V G has support Ω ⊂ G and
g ∈ G, then the support of the conﬁguration gx is gΩ. Therefore, V [G] is a
submodule of the K[G]-module V G .
   Recall that, for v ∈ V , the conﬁguration cv ∈ V [G] is deﬁned by
                                    
                                     v if g = 1G ,
                           cv (g) =
                                     0 otherwise.

Note that if g ∈ G and v ∈ V , then gcv = δg cv is the conﬁguration which
takes the value v at g and is identically 0 on G \ {g}. It follows that every
x ∈ V [G] can be written as

                                   x=              gcx(g) .                               (8.12)
                                          g∈G

Proposition 8.7.3. Suppose that (ei )i∈I is a basis of the K-vector space V .
Then the family of conﬁgurations (cei )i∈I is a free basis for the left K[G]-
module V [G].

Proof. Let x ∈ V [G]. As (ei )i∈I is a K-basis for V , we can ﬁnd elements
αi ∈ K[G], i ∈ I, such that

                               x(g) =                  αi (g)ei
                                             i∈I

for all g ∈ G. This gives us

                          x=             gcx(g)
                                   g∈G
                                                                  
                               =         g             αi (g)cei
                                   g∈G           i∈I
                                                                 
                               =                   αi (g)gcei
                                   g∈G       i∈I
                                                                 
                               =                   αi (g)gcei
                                   i∈I    g∈G

                               =         αi cei ,
                                   i∈I
8.7 Matrix Representation of Linear Cellular Automata                             303

where the last equality follows from (8.11). If x = 0 ∈ V [G], then x(g) = 0
for all g ∈ G and therefore αi = 0 for all i ∈ I. This shows that (cei )i∈I is a
basis for the left K[G]-module V [G].

   As every vector space admits a basis, we deduce the following
Corollary 8.7.4. The left K[G]-module V [G] is free.
   If τ : V G → V G is a linear cellular automaton, we have τ (V [G]) ⊂ V [G] by
Proposition 8.2.3. Moreover, it follows from Proposition 8.2.4 that the map
Λ : LCA(G; V ) → EndK (V [G]) which associates with each τ ∈ LCA(G; V ) its
restriction τ |V [G] : V [G] → V [G] is an injective homomorphism of K-algebras.
As we have τ |V [G] ∈ EndK[G] (V [G]) ⊂ EndK (V [G]) for all τ ∈ LCA(G; V ),
we get:
Proposition 8.7.5. Let G be a group and let V be a vector space over a ﬁeld
K. Then the map Φ : LCA(G; V ) → EndK[G] (V [G]) deﬁned by Φ(τ ) = τ |V [G] ,
where τ |V [G] : V [G] → V [G] is the restriction of τ to V [G], is an injective
K-algebra homomorphism.
   When the alphabet is ﬁnite-dimensional, we have the following:
Theorem 8.7.6. Let G be a group and let V be a ﬁnite-dimensional vector
space over a ﬁeld K. Then the map Φ : LCA(G; V ) → EndK[G] (V [G]) deﬁned
by Φ(τ ) = τ |V [G] , where τ |V [G] : V [G] → V [G] is the restriction of τ to V [G],
is a K-algebra isomorphism.

Proof. By the preceding proposition, it suﬃces to show that Φ is surjective.
Let u ∈ EndK[G] (V [G]). Consider an element x ∈ V [G]. We have

                                     x=            gcx(g)
                                           g∈G

by (8.12). This implies
                                                  
                     u(x) = u             gcx(g)       =         gu(cx(g) )
                                    g∈G                    g∈G

Since u is K[G]-linear. We deduce that

                          u(x)(1G ) =            u(cx(g) )(g −1 ).             (8.13)
                                           g∈G

  Suppose now that dimK (V ) = d and let e1 , e2 , . . . , ed be a K-basis for V .
Denote by Ti ⊂ G the support  of u(cei ), 1 ≤ i ≤ d, and consider the ﬁnite
subset S ⊂ G deﬁned by S = 1≤i≤d Ti−1 .
                              d
  If v ∈ V , we can write v = i=1 ki ei with ki ∈ K, 1 ≤ i ≤ d. We then
          d
have cv = i=1 ki cei and hence
304                                                                     8 Linear Cellular Automata

                                      d                     d
                     u(cv ) = u             ki cei       =         ki u(cei ).
                                      i=1                    i=1

We deduce that u(cv )(g −1 ) = 0 if g ∈
                                      / S. Thus, using (8.13), we get

                         u(x)(1G ) =              u(cx(g) )(g −1 ).
                                            g∈S

This shows that u(x)(1G ) only depends on the restriction of x to S. More
precisely, there is a K-linear map μ : V S → V such that

                     u(x)(1G ) = μ(x|S )             for all x ∈ V [G].

Using the K[G]-linearity of u, we get

                           u(x)(g) = (g −1 u(x))(1G )
                                           = u(g −1 x)(1G )
                                           = μ((g −1 x)|S )

for all x ∈ V [G] and g ∈ G. Therefore u is the restriction to V [G] of the linear
cellular automaton τ : V G → V G with memory set S and local deﬁning map
μ. This shows that Φ is surjective.

Remarks 8.7.7. (a) When G is a ﬁnite group and V is a (not necessarily
ﬁnite-dimensional) vector space over a ﬁeld K, one has V [G] = V G and
Φ : LCA(G; V ) → EndK[G] (V [G]) = EndK[G] (V G ) is the identity map by
Remark 8.7.2.
    (b) Suppose now that G is an inﬁnite group and that V is an inﬁnite-
dimensional vector space over a ﬁeld K. Then the map Φ : LCA(G; V ) →
EndK[G] (V [G]) is not surjective. To see this, take a K-basis (ei )i∈I for V . As
G andI are inﬁnite, we can ﬁnd a family (Ti )i∈I of ﬁnite subsets of G such
that i∈I Ti is inﬁnite. Choose, for each i ∈ I, a conﬁguration zi ∈ V [G]
whose support is Ti . It follows from Proposition 8.7.3 that V [G] is a free left
K[G]-module admitting the family (cei )i∈I as a basis. Therefore, there is an
element u ∈ EndK[G] (V [G]) such that u(cei ) = zi for all i ∈ I. Let us show
that u is not in the image of Φ. We proceed by contradiction. Suppose that
u is in the image of Φ. This means that there is a linear cellular automaton
τ : V G → V G such that u = τ |V [G] . If S is a memory set for τ , this implies
that, for x ∈ V [G], the value
                              of u(x)(1G ) depends only on the restriction of x
to S. As S is ﬁnite and i∈I Ti−1 is inﬁnite, we can ﬁnd elements g0 ∈ G and
i0 ∈ I such that g0 ∈  / S and g0 ∈ Ti−1
                                      0
                                         . Consider the conﬁguration x0 ∈ V [G]
which takes the value ei0 at g0 and is identically 0 on G \ {g0 }. Observe that
x0 = g0 cei0 , so that

                    u(x0 ) = u(g0 cei0 ) = g0 u(cei0 ) = g0 zi0 .
8.8 The Closed Image Property                                                          305

Thus, we have
                     u(x0 )(1G ) = (g0 zi0 )(1G ) = zi0 (g0−1 ).
We deduce that u(x0 )(1G ) = 0 as g0−1 is in the support Ti0 of zi0 . This gives
us a contradiction since x0 coincides with the 0 conﬁguration on S. This
shows that Φ is not surjective.
   (c) By combining the two preceding remarks with Theorem 8.7.6, we de-
duce that the map Φ : LCA(G; V ) → EndK[G] (V [G]) is surjective if and only
if G is ﬁnite or V is ﬁnite-dimensional.

   Let us recall the following basic facts from linear algebra. Let R be a ring
and let d ≥ 1 be an integer. We denote by Matd (R) the ring consisting of all
d × d matrices A = (aij )1≤i,j≤d with entries aij ∈ R. Recall that the addition
and the multiplication in Matd (R) are given by
                                                          d             
        A + B = (aij + bij )1≤i,j≤d     and AB =               aik bkj
                                                         k=1                 1≤i,j≤d


for all A = (aij )1≤i,j≤d , B = (bij )1≤i,j≤d ∈ Matd (R). Suppose now that M
is a free left R-module with basis e1 , e2 , . . . , ed . If u ∈ EndR (M ), then we
                d
have u(ei ) =     j=1 aij ej , where aij ∈ R for 1 ≤ i, j ≤ d. Then the map
u → (aij )1≤i,j≤d is a ring isomorphism from EndR (M ) onto Matd (Rop ),
where Rop denotes the opposite ring of R. Moreover, when R is an algebra
over a ﬁeld K, it is an isomorphism of K-algebras.
   Let G be a group and let V be a vector space of ﬁnite dimension d ≥ 1
over a ﬁeld K. By Proposition 8.7.3, the left K[G]-module V [G] admits a free
basis of cardinality d. As the K-algebras K[G] and (K[G])op are isomorphic
by Corollary 8.4.4, we deduce from Theorem 8.7.6 the following:
Corollary 8.7.8. Let G be a group and let V be a vector space over a ﬁeld K
of ﬁnite dimension dimK (V ) = d ≥ 1. Then the K-algebras LCA(G; V ) and
Matd (K[G]) are isomorphic.

Remark 8.7.9. For d = 1, Corollary 8.7.8 tells us that if G is a group and V is
a one-dimensional vector space over a ﬁeld K, then the K-algebras LCA(G; V )
and K[G] are isomorphic. Note that this last result also follows from Corol-
lary 8.5.3.



8.8 The Closed Image Property

As we have seen in Lemma 3.3.2, the image of a cellular automaton τ : AG →
AG is always closed in AG for the prodiscrete topology if the alphabet A is
ﬁnite. When A is inﬁnite, the image of τ may fail to be closed in AG (cf.
Example 8.8.3). However, it turns out that if A = V is a ﬁnite-dimensional
306                                                   8 Linear Cellular Automata

vector space over a ﬁeld K and τ : V G → V G is a linear cellular automaton,
then the image of τ is closed in V G even when the ﬁeld K is inﬁnite.

Theorem 8.8.1. Let G be a group and let V be a ﬁnite-dimensional vector
space over a ﬁeld K. Let τ : V G → V G be a linear cellular automaton. Then
τ (V G ) is closed in V G for the prodiscrete topology.

Proof. We split the proof into two steps. Suppose ﬁrst that G is countable.
Then
      we can ﬁnd a sequence (An )n∈N of ﬁnite subsets of G such that G =
  n∈N n and An ⊂ An+1 for all n ∈ N. Let S be a memory set for τ
       A                                                                and let
Bn = A−S n  denote the S-interior of An (cf. Sect. 5.4). Note that G  =  n∈N Bn
and Bn ⊂ Bn+1 for all n ∈ N.
   It follows from Proposition 5.4.3 that if x and x are elements in V G such
that x and x coincide on An then the conﬁgurations τ (x) and τ (x ) coincide
on Bn . Therefore, given xn ∈ V An and denoting by x     n ∈ V G a conﬁguration
extending xn , the pattern

                                    xn )|Bn ∈ V Bn
                            yn = τ (

does not depend on the particular choice of the extension x n . Thus we can
deﬁne a map τn : V An → V Bn by setting τn (xn ) = yn for all xn ∈ V An . It is
clear that τn is K-linear.
   Let y ∈ V G and suppose that y is in the closure of τ (V G ). Then, for all
n ∈ N there exists zn ∈ V G such that

                               y|Bn = τ (zn )|Bn .                       (8.14)

Consider, for each n ∈ N, the aﬃne subspace Ln ⊂ V An deﬁned by Ln =
τn−1 (y|Bn ). We have Ln = ∅ for all n by (8.14). For n ≤ m, the restriction
map V Am → V An induces an aﬃne map πn,m : Lm → Ln . Consider, for all
n ≤ m, the aﬃne subspace Kn,m ⊂ Ln deﬁned by Kn,m = πn,m (Lm ). We
have Kn,m ⊂ Kn,m for all n ≤ m ≤ m since πn,m = πn,m ◦ πm,m . As
the sequence Kn,m (m = n, n + 1, . . . ) is a decreasing sequence of ﬁnite-
dimensional aﬃne subspaces, it stabilizes, i.e., for each n ∈ N there exist a
non-empty aﬃne subspace Jn ⊂ Ln and an integer m0 = m0 (n) ≥ n such
that Kn,m = Jn if m0 ≤ m. For all n ≤ n ≤ m, we have πn,n (Kn ,m ) ⊂ Kn,m
since πn,n ◦ πn ,m = πn,m . Therefore, πn,n induces by restriction an aﬃne
map ρn,n : Jn → Jn for all n ≤ n . We claim that ρn,n is surjective. To
see this, let u ∈ Jn . Let us choose m large enough so that Jn = Kn,m and
Jn = Kn ,m . Then we can ﬁnd v ∈ Lm such that u = πn,m (v). We have
u = ρn,n (w), where w = πn ,m (v) ∈ Kn ,m = Jn . This proves the claim.
Now, using the surjectivity of ρn,n+1 for all n, we construct by induction
a sequence of elements xn ∈ Jn , n ∈ N, as follows. We start by choosing
an arbitrary element x0 ∈ J0 . Then, assuming xn has been constructed, we
take as xn+1 an arbitrary element in ρ−1 n,n+1 (xn ). Since xn+1 coincides with
xn on An , there exists x ∈ V G such that x|An = xn for all n. We have
8.8 The Closed Image Property                                               307

τ (x)|Bn = τn (xn ) = yn = y|Bn for all n. Since G = ∪n∈N Bn , we deduce that
τ (x) = y. This ends the proof in the case when G is a countable group.
   We now drop the countability assumption on G and prove the theorem in
the general case. Let S ⊂ G be a memory set for τ and denote by H ⊂ G
the subgroup of G generated by S. Then H is countable since it is ﬁnitely
generated. Consider the restriction cellular automaton τH : V H → V H and
observe that, by the ﬁrst step of the proof,

                           τH (V H ) is closed in V H                    (8.15)

for the prodiscrete topology.
   With the notation from Sect. 1.7 we have, by virtue of (1.16), that
                                      
                           τ (V G ) =    τc (V c ).                    (8.16)
                                      c∈G/H


Also, it follows from (1.18) that, for all c ∈ G/H and g ∈ c,

                         τc (V c ) = (φ∗g )−1 τH (V H ) .                (8.17)

As the map φ∗g : V c → V H is a uniform isomorphism and therefore a home-
omorphism, it follows from (8.15) and (8.17) that τc (V c ) is closed in V c for
all c ∈ G/H. As the product of closed subspaces is closed in the product
topology (cf. Proposition A.4.3), we deduce from (8.16) that τ (V G ) is closed
in V G .
Corollary 8.8.2. Let G be a group and let V be a ﬁnite-dimensional vector
space over a ﬁeld K. Let τ : V G → V G be a linear cellular automaton. Suppose
that every conﬁguration with ﬁnite support y ∈ V [G] lies in the image of τ .
Then τ is surjective.
Proof. By our hypothesis, we have V [G] ⊂ τ (V G ) ⊂ V G . As V [G] is dense
in V G by Proposition 8.2.1 and τ (V G ) is closed in V G by Theorem 8.8.1, we
deduce that τ (V G ) = V G . Thus, τ is surjective.
   In the example below we show that if we drop the ﬁnite dimensionality of
the alphabet vector space V , then the image of a linear cellular automaton
may fail to be closed in V G .
Example 8.8.3. Let G = Z and let K be a ﬁeld. Consider the K-algebra V =
K[t] consisting of all polynomials in the indeterminate t with coeﬃcients in K.
A conﬁguration in V Z is therefore a sequence x = (xn )n∈Z , where xn = xn (t)
is a polynomial for all n ∈ Z. Consider the K-linear map τ : V Z → V Z deﬁned
by setting τ (x) = y where y = (yn )n∈Z is given by

                                yn = xn+1 − txn

for all n ∈ Z. Then τ is a linear cellular automaton with memory set {0, 1}
and local deﬁning map μ : V {0,1} → V given by μ(x0 , x1 ) = x1 − tx0 .
308                                                   8 Linear Cellular Automata

  Consider the conﬁguration z = (zn )n∈Z , where zn = 1 for all n ∈ Z.
  Let Ω be a ﬁnite subset of Z and choose an integer M ∈ Z such that
Ω ⊂ [M, ∞). Consider the conﬁguration x = (xn )n∈Z deﬁned by
                      
                        1 + t + · · · + tn−M if n ≥ M,
                 xn =
                        0                     if n < M.

Observe that xn+1 = txn +1 for all n ≥ M , so that the conﬁguration y = τ (x)
coincides with z on [M, ∞) and hence on Ω. Thus z is in the closure of τ (V Z )
in V Z . On the other hand, the conﬁguration z is not in the image of τ .
Indeed, z = τ (x) for some x ∈ V Z would imply xn+1 = txn + 1 and hence
deg(xn+1 ) > deg(xn ) for all n ∈ Z, which is clearly impossible. This shows
that τ (V Z ) is not closed in V Z for the prodiscrete topology.
   Observe that every y ∈ V [Z] is in the image of τ . Indeed, if y = (yn )n∈Z ∈
V [Z] has support contained in [M, ∞) for some M ∈ Z, we can construct
x = (xn )n∈Z ∈ V Z with τ (x) = y inductively by setting xn = 0 for all n ≤ M
and xn+1 = txn + yn for all n ≥ M . This shows that we cannot omit the
hypothesis saying that V is ﬁnite-dimensional in Corollary 8.8.2.



8.9 The Garden of Eden Theorem for Linear Cellular
    Automata

In this section, we present a linear version of Theorem 5.8.1. We ﬁrst in-
troduce the notion of mean dimension, which plays here the role which was
played by the entropy in the ﬁnite alphabet case, and we present some of its
basic properties. In the deﬁnition of mean dimension, the dimension of ﬁnite-
dimensional vector spaces replaces the cardinality of ﬁnite sets. The proof of
the properties of the mean dimension and the proof of the linear version of
the Garden of Eden Theorem follow the same lines as their ﬁnite alphabet
counterparts (see Sects. 5.7 and 5.8).
   From now on, in this section, G is an amenable group, F = (Fj )j∈J a right
Følner net for G, and V a ﬁnite-dimensional vector space over a ﬁeld K.
   For E ⊂ G, we denote by πE : V G → V E the canonical projection (re-
striction map). We thus have πE (x) = x|E for all x ∈ V G . Note that πE is
K-linear so that, if X is a vector subspace of V G , then πE (X) is a vector
subspace of V E .

Deﬁnition 8.9.1. Let X be a vector subspace of V G . The mean dimension
mdimF (X) of X with respect to the right Følner net F = (Fj )j∈J is deﬁned
by
                                         dim(πFj (X))
                  mdimF (X) = lim sup                 ,              (8.18)
                                    j        |Fj |
8.9 The Garden of Eden Theorem for Linear Cellular Automata                309

where dim(πFj (X)) denotes the dimension of the K-vector subspace πFj (X) ⊂
V Fj .

Remark 8.9.2. In the particular case when K is a ﬁnite ﬁeld, every ﬁnite-
dimensional vector space W over K is ﬁnite of cardinality |W | = |K|dim(W ) .
Therefore, in this case, we have
                                           1
                        mdimF (X) =             entF (X)
                                        log |K|

for every vector subspace X ⊂ V G .

  Here are some immediate properties of mean dimension.

Proposition 8.9.3. One has:
  (i) mdimF (V G ) = dim(V );
 (ii) mdimF (X) ≤ mdimF (Y ) if X ⊂ Y are vector subspaces of V G ;
(iii) mdimF (X) ≤ dim V for all vector subspaces X ⊂ V G .

Proof. (i) If X = V G , then, for every j, we have πFj (X) = V Fj and therefore

            dim(πFj (X))   dim(V Fj )   |Fj | dim(V )
                         =            =               = dim(V ).
                |Fj |         |Fj |           |Fj |

This implies that mdimF (X) = dim(V ).
   (ii) If X ⊂ Y are vector subspaces of V G , then πFj (X) ⊂ πFj (Y ) are
vector subspaces of V Fj and hence dim(πFj (X)) ≤ dim(πFj (Y )) for all j.
This implies mdimF (X) ≤ mdimF (Y ).
   (iii) This follows immediately from (i) and (ii).

   An important property of linear cellular automata is the fact that applying
a linear cellular automaton to a vector subspace of conﬁgurations cannot
increase the mean dimension of the subspace. More precisely, we have the
following:
Proposition 8.9.4. Let τ : V G → V G be a linear cellular automaton and let
X be a vector subspace of V G . Then one has

                         mdimF (τ (X)) ≤ mdimF (X).

Proof. Let us set Y = τ (X) and observe that Y is a vector subspace of V G ,
by linearity of τ . Let S ⊂ G be a memory set for τ . After replacing S by
S ∪ {1G }, we can assume that 1G ∈ S. Let Ω be a ﬁnite subset of G. Observe
ﬁrst that τ induces a map

                            τΩ : πΩ (X) → πΩ −S (Y )

deﬁned as follows. If u ∈ πΩ (X), then
310                                                    8 Linear Cellular Automata

                            τΩ (u) = (τ (x))|Ω −S ,

where x is an element of X such that x|Ω = u. Note that the fact that τΩ (u)
does not depend on the choice of such an x follows from Proposition 5.4.3.
Clearly τΩ is surjective. Indeed, if v ∈ πΩ −S (Y ), then there exists x ∈ X
such that (τ (x))|Ω −S = v. Then, setting u = πΩ (x) we have, by construction,
τΩ (u) = v. Since τΩ is K-linear and surjective, we have

                        dim(πΩ −S (Y )) ≤ dim(πΩ (X)).                     (8.19)

Observe now that Ω −S ⊂ Ω, since 1G ∈ S (cf. Proposition 5.4.2(iv)). Thus
                                                  −S
πΩ (Y ) is a vector subspace of πΩ −S (Y ) × V Ω\Ω . This implies
                                                      −S
             dim(πΩ (Y )) ≤ dim(πΩ −S (Y ) × V Ω\Ω         )
                                                                −S
                          = dim(πΩ −S (Y )) + dim(V Ω\Ω              )
                                                       −S
                          = dim(πΩ −S (Y )) + |Ω \ Ω           | dim(V )
                                                      −S
                          ≤ dim(πΩ (X)) + |Ω \ Ω           | dim(V ),

by (8.19). As Ω \ Ω −S ⊂ ∂S (Ω), we deduce that

               dim(πΩ (Y )) ≤ dim(πΩ (X)) + |∂S (Ω)| dim(V ).

By taking Ω = Fj , this gives us

             dim(πFj (Y ))   dim(πFj (X)) |∂S (Fj )|
                           ≤             +           dim(V ).
                 |Fj |           |Fj |      |Fj |

Since
                                    |∂S (Fj )|
                              lim              =0
                               j      |Fj |
by Proposition 5.4.4, we ﬁnally get

                        dim(πFj (Y ))           dim(πFj (X))
 mdimF (Y ) = lim sup                 ≤ lim sup              = mdimF (X).
                  j         |Fj |          j        |Fj |


  By Proposition 8.9.3, the maximal value for the mean dimension of a vector
subspace X ⊂ V G is dim(V ). The following result gives a suﬃcient condition
on X which guarantees that its mean dimension is strictly less than dim(V ).
Proposition 8.9.5. Let X be a G-invariant vector subspace of V G . Suppose
that there exists a ﬁnite subset E ⊂ G such that πE (X)  V E . Then one has
mdimF (X) < dim(V ).
Proof. Let E  = {g1 g2−1 : g1 , g2 ∈ E}. By Proposition 5.6.3, we may ﬁnd an
(E, E  )-tiling T ⊂ G.
8.9 The Garden of Eden Theorem for Linear Cellular Automata                          311

  For each j ∈ J, let us deﬁne, as in Proposition 5.6.4, the subset Tj ⊂ T
by Tj = T ∩ Fj−E = {g ∈ T : gE ⊂ Fj } and set
                                                    $
                                Fj∗ = Fj \                gE.
                                                   g∈Tj


   Since πE (X)  V E and X is G-invariant, we have πgE (X)  V gE for all
g ∈ G. We thus have

     dim(πgE (X)) ≤ dim(V gE ) − 1 = |gE| dim(V ) − 1 for all g ∈ T.             (8.20)

As                                            ∗      
                         πFj (X) ⊂ V Fj ×                  πgE (X),
                                                    g∈Tj

we get
                                 ∗      
        dim(πFj (X)) ≤ dim(V Fj ×                 πgE (X))
                                        g∈Tj

                    = |Fj∗ | dim(V ) +              dim(πgE (X))
                                             g∈Tj

                    ≤ |Fj∗ | dim(V ) +              (|gE| dim(V ) − 1) (by (8.20))
                                             g∈Tj
                                               
                    =    |Fj∗ | +           |gE| dim(V ) − |Tj |
                                     g∈Tj

                    = |Fj | dim(V ) − |Tj |,


since
                  |Fj | = |Fj∗ | +          |gE|      and       |gE| = |E|.
                                     g∈Tj

Now, by Proposition 5.6.4, there exist α > 0 and j0 ∈ J such that |Tj | ≥ α|Fj |
for all j ≥ j0 . Thus

                 dim(πFj (X))
                              ≤ dim(V ) − α                  for all j ≥ j0 .
                     |Fj |

This implies that

                                    dim(πFj (X))
          mdimF (X) = lim sup                    ≤ dim(V ) − α < dim(V ).
                            j           |Fj |
312                                                     8 Linear Cellular Automata

   We are now in position to state the linear version of the Garden of Eden
theorem.

Theorem 8.9.6. Let G be an amenable group and let V be a ﬁnite-dimen-
sional vector space over a ﬁeld K. Let F = (Fj )j∈J be a right Følner net
for G. Let τ : V G → V G be a linear cellular automaton. Then the following
conditions are equivalent:
(a) τ is surjective;
(b) mdimF (τ (V G )) = dim(V );
(c) τ is pre-injective.

  Since every injective cellular automaton is pre-injective, we immediately
deduce the following:

Corollary 8.9.7. Let G be an amenable group and let V be a ﬁnite-dimen-
sional vector space over a ﬁeld K. Then every injective linear cellular au-
tomaton τ : V G → V G is surjective.

  We divide the proof of Theorem 8.9.6 into several lemmas.

Lemma 8.9.8. Let τ : V G → V G be a linear cellular automaton. Suppose
that τ is not surjective. Then mdimF (τ (V G )) < dim(V ).

Proof. Let X = τ (V G ) and choose a conﬁguration y ∈ V G \ X. Since V G \ X
is an open subset of V G for the prodiscrete topology by Theorem 8.8.1, we
can ﬁnd a ﬁnite subset Ω ⊂ G such that πΩ (y) ∈ / πΩ (X). Therefore we have
πΩ (X)  V Ω . Observe that X is a G-invariant vector subspace of V G , as τ
is G-equivariant and linear. By applying Proposition 8.9.5, we deduce that
mdimF (X) < dim(V ).

Lemma 8.9.9. Let τ : V G → V G be a linear cellular automaton. Suppose
that
                       mdimF (τ (V G )) < dim(V ).               (8.21)
Then τ is not pre-injective.

Proof. Let us set X = τ (V G ). Let S be a memory set for τ such that 1G ∈ S.
                                                     +S
  As πF +S (X) is a vector subspace of πFj (X) × V Fj \Fj , we have
        j



            dim(πF +S (X)) ≤ dim(πFj (X)) + |Fj+S \ Fj | dim(V )
                   j

                               ≤ dim(πFj (X)) + |∂S (Fj )| dim(V ).

We thus have
            dim(πF +S (X))         dim(πFj (X)) |∂S (Fj )|
                    j
                               ≤               +           dim(V ).
                  |Fj |                |Fj |      |Fj |
8.9 The Garden of Eden Theorem for Linear Cellular Automata                       313

It follows from (8.21) and Proposition 5.4.4 that we can ﬁnd j0 ∈ J such
that dim(πF +S (X)) < |Fj0 | dim(V ). Let Z denote the (ﬁnite-dimensional)
             j0

vector subspace of V G consisting of all conﬁgurations whose support is con-
tained in Fj0 . Observe that τ (x) vanishes outside of Fj+S
                                                         0
                                                            for every x ∈ Z by
Proposition 5.4.3. Thus we have

            dim(τ (Z)) = dim(πF +S (τ (Z)))
                                   j0

                        ≤ dim(πF +S (X)) < |Fj0 | dim(V ) = dim(Z).
                                   j0


This implies that the restriction of τ to Z is not injective. As all conﬁgu-
rations in Z have ﬁnite support, we deduce that τ is not pre-injective (cf.
Proposition 8.2.5).

Lemma 8.9.10. Let τ : V G → V G be a linear cellular automaton. Suppose
that τ is not pre-injective. Then mdimF (τ (V G )) < dim(V ).

Proof. Since the linear cellular automaton τ is not pre-injective, we can ﬁnd,
by Proposition 8.2.5, an element x0 ∈ V G with nonempty ﬁnite support
Ω ⊂ G such that τ (x0 ) = 0. Let S be a memory set for τ such that 1G ∈ S
and S = S −1 . Let E = Ω +S . By Proposition 5.6.3, we can ﬁnd a ﬁnite subset
                             2


F ⊂ G such that G contains a (E, F )-tiling T . Note that for each g ∈ G,
the support of gx0 is gΩ ⊂ gE. Let us choose, for each g ∈ T , a hyperplane
Hg ⊂ V gΩ which does not contain the restriction to gΩ of gx0 . Consider the
vector subspace X ⊂ V G consisting of all x ∈ V G such that the restriction
of x to gΩ belongs to Hg for each g ∈ T . We claim that τ (V G ) = τ (X).
Indeed, let z ∈ V G . Then, for each g ∈ T , there exists a scalar kg ∈ K such
that the restriction to gΩ of z + kg (gx0 ) belongs to Hg . Let z  ∈ V G be
                 
    that πgΩ (z ) = πgΩ
such                       (z + kg (gx0 )) for each g ∈ T and z  = z outside
of g∈T gΩ. We have z ∈ X by construction. On the other hand, since z 
                         
                                                                  
and z coincide outside g∈T gΩ, we have τ (z  ) = τ (z) outside g∈T gΩ +S .
                                                             2
Now, if h ∈ gΩ +S for some g ∈ T , then hS ⊂ gΩ +S = gE and therefore
τ (z  )(h) = τ (z + kg (gx0 ))(h) = τ (z)(h) since gx0 lies in the kernel of τ . Thus
τ (z) = τ (z  ) and the claim follows.
    We deduce that

          mdimF (τ (V G )) = mdimF (τ (X)) ≤ mdimF (X) < dim(V )

where the ﬁrst inequality follows from Proposition 8.9.4 and the second one
from Proposition 8.9.5.

Proof of Theorem 8.9.6. Condition (a) implies (b) since we have
mdimF (V G ) = dim(V ) by Proposition 8.9.3(i). The converse implication
follows from Lemma 8.9.8. On the other hand, condition (c) implies (b) by
Lemma 8.9.9. Finally, (b) implies (c) by Lemma 8.9.10.
314                                                        8 Linear Cellular Automata

   We end this section by showing that Corollary 8.9.7 as well as both im-
plications (a) ⇒ (c) and (c) ⇒ (a) in Theorem 8.9.6 fail to hold when the
vector space V is inﬁnite-dimensional.

Example 8.9.11. Let G be any group and let V be an inﬁnite-dimensional
vector space over a ﬁeld K. Let us choose a basis subset B for V . Every map
ϕ : B → B uniquely extends to a K-linear map ϕ             : V → V . The product
map τϕ = ϕ    G : V G → V G is a linear cellular automaton with memory set
S = {1G } and local deﬁning map ϕ.       Since B is inﬁnite, we can ﬁnd a map
ϕ1 : B → B which is surjective but not injective and a map ϕ2 : B → B which
is injective but not surjective.
    Consider ﬁrst the cellular automaton τ1 = τϕ1 . Let us show that τ1 is
surjective but not pre-injective. Observe that ϕ     1 is surjective. As a product
of surjective maps is a surjective map, it follows that τ1 is surjective. On the
other hand, as ϕ  1 is not injective, there exists v ∈ ker(ϕ 1 ) \ {0}. Consider the
conﬁguration x ∈ V G deﬁned by x(1G ) = v and x(g) = 0 for all g ∈ G \ {1G }.
Then x ∈ V [G] ∩ ker(τ1 ) and x = 0. This shows that τ1 is not pre-injective.
    Consider now the cellular automaton τ2 = τϕ2 . Let us show that τ2 is
injective (and therefore pre-injective) but not surjective. Suppose that x ∈
ker(τ2 ), that is, 0 = τ2 (x)(g) = ϕ   2 (x(g)) for all g ∈ G. As ϕ   2 is injective,
we deduce that x(g) = 0 for all g ∈ G, in other words, x = 0. This shows
that τ2 is injective. On the other hand, as ϕ     2 is not surjective, there exists
v ∈ V \ϕ  2 (V ). Consider the constant conﬁguration x ∈ V G where x(g) = v
for all g ∈ G. It is clear that x ∈ V G \ τ2 (V G ). This shows that τ2 is not
surjective.



8.10 Pre-injective but not Surjective Linear Cellular
     Automata

In this section, we give examples of linear cellular automata with ﬁnite-
dimensional alphabet which are pre-injective but not surjective. We recall
that the underlying groups for such automata cannot be amenable by Theo-
rem 8.9.6.

Proposition 8.10.1. Let G = F2 be the free group of rank two and let V
be a two-dimensional vector space over a ﬁeld K. Then there exists a linear
cellular automaton τ : V G → V G which is pre-injective but not surjective.

Proof. We may assume V = K2 . Let a and b denote the canonical generators
of G = F2 . Let p1 and p2 be the elements of EndK (V ) deﬁned respectively
by p1 (v) = (k1 , 0) and p2 (v) = (k2 , 0) for all v = (k1 , k2 ) ∈ V . Consider the
linear cellular automaton τ : V G → V G given by

        τ (x)(g) = p1 (x(ga)) + p2 (x(gb)) + p1 (x(ga−1 )) + p2 (x(gb−1 ))
8.11 Surjective but not Pre-injective Linear Cellular Automata                315

for all x ∈ V G and g ∈ G. This cellular automaton is the one described
in Sect. 5.11 for H = K. By Proposition 5.11.1, τ is pre-injective but not
surjective.

   If H is a subgroup of a group G and τ : V H → V H is a linear cellular
automaton over H which is pre-injective and not surjective, then the induced
cellular automaton τ G : V G → V G is also linear, pre-injective and not surjec-
tive (see Proposition 1.7.4 and Proposition 5.2.2). Therefore, an immediate
consequence of Proposition 8.10.1 is the following:

Corollary 8.10.2. Let G be a group containing a free subgroup of rank two
and let V be a two-dimensional vector space over a ﬁeld K. Then there exists
a linear cellular automaton τ : V G → V G which is pre-injective but not sur-
jective.

  This shows that implication (c) ⇒ (a) in Theorem 8.9.6 becomes false if
G is a group containing a free subgroup of rank two.



8.11 Surjective but not Pre-injective Linear Cellular
     Automata

We now present examples of linear cellular automata with ﬁnite-dimensional
alphabet which are surjective but not pre-injective. We recall that, by The-
orem 8.9.6, the underlying groups for such examples are necessarily non-
amenable.

Proposition 8.11.1. Let G = F2 be the free group of rank two and let V
be a two-dimensional vector space over a ﬁeld K. Then there exists a linear
cellular automaton τ : V G → V G which is surjective but not pre-injective.

Proof. Let a, b denote the canonical generators of G. We can assume that
V = K2 . Consider the elements q1 , q2 ∈ EndK (V ) respectively deﬁned by
q1 (v) = (k1 , 0) and q2 (v) = (0, k1 ) for all v = (k1 , k2 ) ∈ V .
    Let τ : V G → V G be the linear cellular automaton given by

         τ (x)(g) = q1 (x(ga)) + q1 (x(ga−1 )) + q2 (x(gb)) + q2 (x(gb−1 ))

for all x ∈ V G , g ∈ G. A memory set for τ is the set S = {a, b, a−1 , b−1 }.
   Let k0 be any nonzero element in K. Consider the conﬁguration x0 ∈ V G
deﬁned by                         
                                   (0, k0 ) if g = 1G
                         x0 (g) =
                                   (0, 0)   otherwise.
Then, x0 is almost equal to 0 but x0 = 0. As τ (x0 ) = 0, we deduce that τ is
not pre-injective.
316                                                             8 Linear Cellular Automata

   However, τ is surjective. To see this, let z = (z1 , z2 ) ∈ KG × KG = V G .
Let us show that there exists x ∈ V G such that τ (x) = z. We deﬁne x(g)
by induction on the graph distance (cf. Sect. 6.2), which we denote by |g|, of
g ∈ G from 1G in the Cayley graph of G. We ﬁrst set x(1G ) = (0, 0).
   Then, for s ∈ S we set
                             ⎧
                             ⎨ (z1 (1G ), 0) if s = a
                     x(s) = (z2 (1G ), 0) if s = b                     (8.22)
                             ⎩
                               (0, 0)         otherwise.

   Suppose that x(g) has been deﬁned for all g ∈ G with |g| ≤ n, for some
n ≥ 1. For g ∈ G with |g| = n, let g  ∈ G and s ∈ S be the unique elements
such that |g  | = n − 1 and g = g  s . Then, for s ∈ S with s s = 1G , we set
                 ⎧
                 ⎪
                 ⎪ (z1 (g) − x1 (g  ), 0) if s ∈ {a, a−1 } and s = s
                 ⎪
                 ⎪
                 ⎨ (z2 (g), 0)              if s ∈ {a, a−1 } and s = b
      x(gs) = (z1 (g), 0)                   if s ∈ {b, b−1 } and s = a       (8.23)
                 ⎪
                 ⎪                                      −1            
                 ⎪
                 ⎪ (z2 (g) −  x2 (g   ), 0) if s  ∈ {b, b    } and s = s
                 ⎩
                   (0, 0)                   otherwise.

   Let us check that τ (x) = z. We have

            τ (x)(1G ) = q1 (x(a)) + q1 (x(a−1 )) + q2 (x(b)) + q2 (x(b−1 ))
        (by (8.22)) = q1 (z1 (1G ), 0) + q1 (0, 0) + q2 (z2 (1G ), 0) + q2 (0, 0)
                    = (z1 (1G ), 0) + (0, 0) + (0, z2 (1G )) + (0, 0)
                    = (z1 (1G ), z2 (1G ))
                    = z(1G ).

Let now g = g  s ∈ G with |g| = |g  | + 1 > 2. Suppose, for instance, that
s = a. We then have:
      τ (x)(g) = τ (x)(g  a)
(by (8.23)) = q1 (x(g  a2 )) + q1 (x(g  )) + q2 (x(g  ab)) + q2 (x(g  ab−1 ))
            = q1 (z1 (g) − x1 (g  ), 0) + q1 (x1 (g  ), x2 (g  )) + q2 (z2 (g), 0) + q2 (0, 0)
               = (z1 (g) − x1 (g  ), 0) + (x1 (g  ), 0) + (0, z2 (g)) + (0, 0)
               = (z1 (g), z2 (g))
               = z(g).

The cases when s = a−1 , b, b−1 are similar. It follows that τ (x) = z. This
shows that τ is surjective.

  If H is a subgroup of a group G, and τ : V H → V H is a linear cellular
automaton over H which is surjective and not pre-injective, then the in-
duced cellular automaton τ G : V G → V G is also linear, surjective and not
8.12 Invertible Linear Cellular Automata                                           317

pre-injective (see Proposition 1.7.4 and Proposition 5.2.2). Therefore, an im-
mediate consequence of Proposition 8.11.1 is the following:
Corollary 8.11.2. Let G be a group containing a free subgroup of rank two
and let V be a two-dimensional vector space over a ﬁeld K. Then there exists
a linear cellular automaton τ : V G → V G which is surjective but not pre-
injective.
  As a consequence, we deduce that implication (a) ⇒ (c) in Theorem 8.9.6
becomes false if the group G contains a free subgroup of rank two.



8.12 Invertible Linear Cellular Automata

Theorem 8.12.1. Let G be a group and let V be a ﬁnite-dimensional vector
space over a ﬁeld K. Let τ : V G → V G be an injective linear cellular automa-
ton. Then there exists a linear cellular automaton σ : V G → V G such that
σ ◦ τ = IdV G .
Proof. We split the proof into two steps. Suppose ﬁrst that G is countable.
Since τ is injective, it induces a bijective map τ : V G → Y where Y = τ (V G )
is the image of τ . The fact that τ is K-linear and G-equivariant implies
that Y is a G-invariant vector subspace of V G and that the inverse map
τ−1 : Y → V G is K-linear and G-equivariant. Let us show that the following
local property is satisﬁed by τ−1 : there exists a ﬁnite subset T ⊂ G such that
(∗) for y ∈ Y , the element τ−1 (y)(1G ) only depends on the restriction
   of y to T .
Let us assume by contradiction that there exists no such T .
    Let S be a memory set for τ such that 1G ∈ S. Since G is countable,             we
can ﬁnd a sequence (An )n∈N of ﬁnite subsets of G such that G = n∈N An ,
                                                              −S
S ⊂ A0 and An ⊂ An+1 for all n ∈ N.           Let Bn = An denote the S-interior
of An (cf. Sect. 5.4). Note that G = n∈N Bn and Bn ⊂ Bn+1 for all n ∈ N.
    Since there exists no ﬁnite subset T ⊂ G satisfying condition (∗), we can
ﬁnd, for each n ∈ N, two conﬁgurations yn , yn ∈ Y such that yn |Bn = yn |Bn
and τ−1 (yn )(1G ) = τ−1 (yn )(1G ). By linearity of τ−1 , the conﬁguration yn =
yn − yn ∈ Y satisﬁes yn |Bn = 0 and τ−1 (yn )(1G ) = 0.
    It follows from Proposition 5.4.3 that if x and x are elements in V G such
that x and x coincide on An then the conﬁgurations τ (x) and τ (x ) coincide
on Bn . Therefore, given xn ∈ V An and denoting by x           n ∈ V G a conﬁguration
extending xn , the pattern

                                       xn )|Bn ∈ V Bn
                               un = τ (

does not depend on the particular choice of the extension xn of xn . Thus we
can deﬁne a map τn : V An → V Bn by setting τn (xn ) = un . It is clear that τn
is K-linear.
318                                                     8 Linear Cellular Automata

    Consider, for each n ∈ N, the vector subspace Ln ⊂ V An deﬁned by
Ln = Ker(τn ). where for n ≤ m, the restriction map V Am → V An induces a
K-linear map πn,m : Lm → Ln . Indeed, if u ∈ Lm , then we have u|An ∈ Ln
since τm (u) = 0 and therefore τn (u|An ) = (τm (u))|Bn = 0. Consider now, for
all n ≤ m, the vector subspace Kn,m ⊂ Ln deﬁned by Kn,m = πn,m (Lm ). We
have Kn,m ⊂ Kn,m for all n ≤ m ≤ m since πn,m = πn,m ◦πm,m . Therefore,
if we ﬁx n, the sequence Kn,m , where m = n, n+1, . . ., is a decreasing sequence
of vector subspaces of Ln . As Ln ⊂ V An is ﬁnite-dimensional, this sequence
stabilizes, i.e., there exist a vector subspace Jn ⊂ Ln and an integer kn ≥ n
such that Kn,m = Jn for all m ≥ kn .
    For all n ≤ n ≤ m, we have πn,n (Kn ,m ) ⊂ Kn,m since πn,n ◦ πn ,m =
πn,m . Therefore, πn,n induces by restriction a linear map ρn,n : Jn → Jn
for all n ≤ n . We claim that ρn,n is surjective. To see this, let u ∈ Jn .
Let us choose m large enough so that Jn = Kn,m and Jn = Kn ,m . Then
we can ﬁnd v ∈ Lm such that u = πn,m (v). We have u = ρn,n (w), where
w = πn ,m (v) ∈ Kn ,m = Jn . This proves the claim.
    Now, using the surjectivity of ρn,n+1 for all n, we construct by induction
a sequence of elements zn ∈ Jn , n ∈ N, as follows. We start by taking as
z0 the restriction of xk0 to A0 . Observe that xk0 ∈ Lk0 and hence z0 =
π0,k0 (xk0 ) ∈ J0 . Then, assuming that zn has been constructed, we take as
zn+1 an arbitrary element in ρ−1    n,n+1 (zn ). Since zn+1 coincides with zn on
An , there exists a unique element z ∈ V G such that z|An = zn for all n.
We have z ∈ Y , since zn ∈ πAn (Y ) for all n and X is closed in V G . As
z(1G ) = z0 (1G ) = xk0 (1G ) = 0, we have z = 0. On the other hand, τ (z) =
0 since τ (z)|Bn = τn (zn ) = 0 for all n by construction. This contradicts
the injectivity of τ . Thus, there exists a ﬁnite subset T ⊂ G satisfying (∗).
Consider the linear map ν : V T → V deﬁned by ν(z) = τ−1 (       z )(1G ), where
z ∈ V G is any conﬁguration extending the pattern z ∈ V T . Then the linear
cellular automaton σ : V G → V G with memory set T and local deﬁning
map ν clearly satisﬁes σ ◦ τ = IdV G . Indeed, if x ∈ V G , then denoting by
y = τ (x) ∈ Y its image by τ , we have x = τ−1 (y) and

                         (σ ◦ τ )(x)(1G ) = σ(y)(1G )
                                          = ν(y|T )
                                         = τ−1 (y)(1G )
                                         = x(1G )

showing that (σ ◦ τ )(x) = x, by G-equivariance of σ ◦ τ . It follows that
σ ◦ τ = IdV G and this proves the statement when G is a countable group.
   We now drop the countability assumption on G and prove the theorem in
the general case. Let S ⊂ G be a memory set for τ and denote by μ : V S → V
the corresponding local deﬁning map. Let H ⊂ G be the subgroup generated
by S. Note that H is countable. Consider the set G/H of all left cosets of H
in G. For c ∈ G/H denote by
8.12 Invertible Linear Cellular Automata                                     319
                                                     
                              πc : V G → V c =             V
                                                     g∈c

                                         
the projection map. We have V G = c∈G/H V c and, for every x ∈ V G we
write x = (xc )c∈G/H , where xc = πc (x) ∈ V c .
    For c ∈ G/H and g ∈ c denote by φg : H → c the linear map deﬁned
by φg (h) = gh for all h ∈ H. Consider the map φ∗g : V c → V H deﬁned by
φ∗g (z) = z ◦ φg . Then, if x = (xc )c∈G/H ∈ V G and c ∈ G/H, we have

         (φg ∗ (xc ))(h) = xc (gh) = x(gh) = (g −1 x)(h) = (g −1 x)H (h)

for all h ∈ H, that is,
                                φ∗g (xc ) = (g −1 x)H .                    (8.24)
   For c ∈ G/H, deﬁne the map τc : V c → V c by setting

                              τc (z)(g) = μ((φ∗g (z))|S )

for all z ∈ V c and g ∈ c. Note that τH : V H → V H is the restriction of τ to
the subgroup H. We then have
                                      
                                τ=          τc .                        (8.25)
                                           c∈G/H
                                                          
    From (8.25) we immediately deduce that Y = c∈G/H Yc , where Yc =
πc (Y ) = τc (V c ), and that τc is injective for all c ∈ G/H.
    By the ﬁrst part of the present proof, there exists a linear cellular automa-
ton σH : V H → V H such that

                                 σH ◦ τH = IdV H .                         (8.26)

Let T ⊂ H be a memory set for σH and let ν : V T → V be the corresponding
local deﬁning map. Consider the linear cellular automaton σ : V G → V G
deﬁned by setting
                         σ(y)(g) = ν((g −1 y)|T )
for all y ∈ V G and g ∈ G. Note that σ = (σH )G is the induced cellular
automaton of σH from H to G, so that, if σc : V c → V c is the map deﬁned
by setting σc (z)(g) = ν((φ∗g (z))|T ) for all z ∈ V c and g ∈ c then
                                            
                                   σ=              σc .                    (8.27)
                                           c∈G/H


Given c ∈ G/H, z ∈ V c and g ∈ c, we have
320                                                         8 Linear Cellular Automata

                       (σc ◦ τc )(z)(g) = σc (τc (z))(g)
                                        = [φ∗g σc (τc (z))](1G )
                          (by (8.24)) = σH (φ∗g (τc (z))(1G )
                   (again by (8.24)) = σH (τH (φ∗g (z)))(1G )
                          (by (8.26)) = (φ∗g (z))(1G )
                                        = z(g).

This shows that (σc ◦ τc )(z) = z for all z ∈ V c . We deduce that σc ◦ τc = IdV c
for all c ∈ C. It follows from (8.25) and (8.27) that σ ◦ τ = IdV G .

   We recall that given a group G and a set A, a cellular automaton τ : AG →
A is said to be invertible if τ is bijective and the inverse map τ −1 : AG → AG
 G

is also a cellular automaton. When A is a ﬁnite set, every bijective cellular
automaton τ : AG → AG is invertible by Theorem 1.10.2. The following is a
linear analogue.

Corollary 8.12.2. Let G be a group and let V be a ﬁnite-dimensional vector
space over a ﬁeld K. Then every bijective linear cellular automaton τ : V G →
V G is invertible.

Proof. Let τ : V G → V G be a bijective linear cellular automaton. It follows
from Theorem 8.12.1 that there exists a linear cellular automaton σ : V G →
V G such that σ◦τ = IdV G . This implies that τ −1 = σ is a cellular automaton.
Thus τ is an invertible cellular automaton.

Remark 8.12.3. Let G = Z and let K be a ﬁeld. Consider the inﬁnite di-
mensional K-vector space V = K[[t]] consisting of all formal power series in
one indeterminate t with coeﬃcients in K. Thus, an element of V is just a
sequence v = (ki )i∈N of elements of K written in the form

                  v = k0 + k1 t + k2 t2 + k3 t3 + · · · =         ki ti .
                                                            i∈N

Consider the map τ : V Z → V Z deﬁned by

                          τ (x)(n) = x(n) − tx(n + 1)

for all x ∈ V Z , n ∈ Z. In Example 1.10.3 we have showed that τ is a bijec-
tive cellular automaton whose inverse map τ −1 : V Z → V Z is not a cellular
automaton. It is clear that τ is K-linear. This shows that Corollary 8.12.2
becomes false if we omit the ﬁnite-dimensionality of the alphabet V .

   Let G be a group and let V be a vector space over a ﬁeld K. We have
seen in Sect. 1.10 that the set ICA(G; V ) consisting of all invertible cellular
automata τ : V G → V G is a group for the composition of maps. The subset of
ICA(G; V ) consisting of all invertible linear cellular automata is a subgroup
8.13 Pre-injectivity and Surjectivity of the Discrete Laplacian             321

of ICA(G; V ) since it is the intersection of ICA(G; V ) with the automorphism
group of the K-vector space V G .
   Given a ring R and an integer d ≥ 1, we denote by GLd (R) the group of
invertible elements of the matrix ring Matd (R).
   An immediate consequence of Corollary 8.12.2 and Corollary 8.7.8 is the
following

Corollary 8.12.4. Let G be a group and let V be a vector space over a ﬁeld K
of ﬁnite dimension dimK (V ) = d ≥ 1. Then the set consisting of all bijective
linear cellular automata τ : V G → V G is a subgroup of ICA(G; V ) isomorphic
to GLd (K[G]).



8.13 Pre-injectivity and Surjectivity of the Discrete
     Laplacian

Let G be a group and let K be a ﬁeld. Given a nonempty ﬁnite subset S of
G, we recall that the discrete Laplacian associated with G and S is the linear
cellular automaton ΔS : KG → KG (with memory set S ∪ {1G }) deﬁned by

                          ΔS (f )(g) = |S|f (g) −          f (gs)
                                                     s∈S

for all f ∈ KG and g ∈ G, where |S| denotes the cardinality of S (cf. Exam-
ple 1.4.3(b) and Example 8.1.3(a)).
   Let us observe that ΔS is never injective since all constant maps f : G → K
are in the kernel of ΔS .

Proposition 8.13.1. Let G be a group and let K be a ﬁeld. Let S ⊂ G be a
non-empty ﬁnite subset and suppose that the subgroup H ⊂ G generated by
S is ﬁnite. Then ΔS is neither pre-injective nor surjective.

Proof. Let (ΔS )H : KH → KH denote the restriction cellular automaton of
ΔS to H. Observe that (ΔS )H is the discrete Laplacian on KH associated
with H and S. As we have seen above, (ΔS )H is not injective. As H is ﬁnite, it
follows that (ΔS )H is not pre-injective. On the other hand, the non-injectivity
of (ΔS )H implies its non-surjectivity since (ΔS )H is K-linear and KH is
ﬁnite-dimensional. By applying Proposition 5.2.2 (resp. Proposition 1.7.4),
we deduce that ΔS is not pre-injective (resp. not surjective).

   In the remaining of this section, we assume that the ﬁeld K is the ﬁeld R
of real numbers. The following result is a Garden of Eden type theorem for
the discrete laplacian. Note that there is no amenability hypothesis for the
underlying group.
322                                                                 8 Linear Cellular Automata

Theorem 8.13.2. Let G be a group and let S be a nonempty ﬁnite subset of
G. Let ΔS : RG → RG denote the associated discrete real laplacian. Then the
following conditions are equivalent:
(a) ΔS is surjective;
(b) the subgroup of G generated by S is inﬁnite;
(c) ΔS is pre-injective.

   Let us ﬁrst establish the following simple fact. Recall that given a group
G, the subsemigroup generated by a subset S ⊂ G is the smallest subset P
of G containing S which is closed under the group operation, i.e., such that
p1 p2 ∈ P for all p1 , p2 ∈ P . Clearly, P consists of all elements of the form
p = s1 s2 · · · sn where n ≥ 1 and si ∈ S for 1 ≤ i ≤ n.

Lemma 8.13.3. Let G be a group and let S be a subset of G. Then the
following conditions are equivalent:
(a) the subsemigroup of G generated by S is inﬁnite;
(b) the subgroup of G generated by S is inﬁnite.

Proof. Let P (resp. H) denote the subsemigroup (resp. subgroup) of G gen-
erated by S. The implication (a) ⇒ (b) is obvious since P ⊂ H.
   Suppose that S is nonempty and that P is ﬁnite. Then, for each s ∈ S,
the set {sn : n ≥ 1} ⊂ P is also ﬁnite. This implies that every element of
S has ﬁnite order. Therefore, for each s ∈ S, we can ﬁnd an integer n ≥ 2
such that sn = 1G . It follows that s−1 = sn−1 ∈ S. Consequently, we have
P −1 = P and 1G ∈ P . This implies H = P , so that H is ﬁnite. This shows
(b) ⇒ (a).

Proof of Theorem 8.13.2. The implication (a) ⇒ (b) immediately follows
from Proposition 8.13.1.
    Suppose that the subgroup generated by S is inﬁnite. Let f be an element
of R[G] such that ΔS (f ) = 0. Let us show that f = 0. Let g0 ∈ G such that
|f (g0 )| = maxg∈G |f (g)|. Note that such a g0 exists since f takes only ﬁnitely
many values. As

                    0 = ΔS (f )(g0 ) = |S|f (g0 ) −                f (g0 s),
                                                           s∈S

we get
                                           1
                            |f (g0 )| ≤               |f (g0 s)|                       (8.28)
                                          |S|
                                                s∈S

by applying the triangle inequality. We deduce from (8.28) and the deﬁnition
of g0 that |f (g0 s)| = |f (g0 )| for all s ∈ S. By iterating the previous argument,
we get |f (g0 p)| = |f (g0 )| for all p ∈ P , where P denotes the subsemigroup
of G generated by S. As P is inﬁnite (cf. Lemma 8.13.3), this implies that
|f (h)| = |f (g0 )| = maxg∈G |f (g)| for inﬁnitely many h ∈ G. Since f has ﬁnite
8.13 Pre-injectivity and Surjectivity of the Discrete Laplacian              323

support, it follows that f = 0. Therefore, ΔS is pre-injective. This proves the
implication (b) ⇒ (c).
   To complete the proof, it suﬃces to prove that (c) implies (a).
   Suppose ﬁrst that G is an amenable group. It follows from the implication
(c) ⇒ (a) in Theorem 8.9.6 that if ΔS is pre-injective, then it is surjective.
This shows the implication (c) ⇒ (a) for G amenable.
   Suppose now that G is non-amenable (and hence inﬁnite) and that S
is a generating subset for G. This implies that G is countable. Consider the
Hilbert space 2 (G) ⊂ RG consisting of all square-summable real functions on
                                   (2)
G and the continuous linear map ΔS : 2 (G) → 2 (G) obtained by restriction
           2
of ΔS to  (G) (cf. Sect. 6.12).
   By the Kesten-Day amenability criterion (Theorem 6.12.9), the nona-
                                                                            (2)
menability of G implies that 0 does not belong to the spectrum σ(ΔS )
     (2)          (2)
of ΔS . Thus, ΔS is bijective and hence
                                   (2)
             R[G] ⊂ 2 (G) = ΔS (2 (G)) = ΔS (2 (G)) ⊂ ΔS (RG ).

By applying Corollary 8.8.2, we deduce that ΔS (RG ) = RG . This shows that
ΔS is surjective in the case when G is non-amenable and S generates G.
   Finally, suppose now that G is an arbitrary non-amenable group and that
ΔS is pre-injective. Denote by H the subgroup of G generated by S. Then
the restriction cellular automaton (ΔS )H : RH → RH , which is the discrete
laplacian associated with H and S, is pre-injective by Proposition 5.2.2. The
subgroup H may be amenable or not. However, it follows from the two preced-
ing cases that (ΔS )H is surjective. By applying Proposition 1.7.4, we deduce
that ΔS is surjective as well. This completes the proof that (a) implies (c).


   As a consequence of Theorem 8.13.2, we obtain the following characteri-
zation of locally ﬁnite groups in terms of real linear cellular automata:

Corollary 8.13.4. Let G be a group and let V be a real vector space of ﬁnite
dimension d ≥ 1. Then the following conditions are equivalent:
(a) G is locally ﬁnite;
(b) every surjective linear cellular automaton τ : V G → V G is injective.

Proof. Suppose (a). Let τ : V G → V G be a surjective linear cellular automa-
ton with memory set S ⊂ G. As G is locally ﬁnite, the subgroup H generated
by S is ﬁnite. Consider the linear cellular automaton τH : V H → V H obtained
from τ by restriction. Observe that τH is surjective by Proposition 1.7.4(ii).
Since V H is ﬁnite-dimensional, it follows that τH is injective. By applying
Proposition 1.7.4(i), we deduce that τ is also injective. This shows that (a)
implies (b).
   Now, suppose that G is not locally ﬁnite. Let us show that there exists a
linear cellular automaton τ : V G → V G which is surjective but not injective.
324                                                    8 Linear Cellular Automata

We can assume that V = Rd . Since G is not locally ﬁnite, we can ﬁnd a
ﬁnite subset S ⊂ G such that the subgroup H generated by S is inﬁnite.
By Theorem 8.13.2, the discrete Laplacian ΔS : RG → RG is surjective. As
mentioned above ΔS is not injective since all constant conﬁgurations are
in its kernel. Consider now the product map τ = (ΔS )d : (Rd )G → (Rd )G ,
where we use the natural identiﬁcation (Rd )G = (RG )d . Clearly, τ is a linear
cellular automaton admitting S ∪ {1G } as a memory set. On the other hand,
τ is surjective but not injective since any product of surjective (resp. non-
injective) maps is a surjective (resp. non-injective) map. This shows that (b)
implies (a).



8.14 Linear Surjunctivity

In analogy with the ﬁnite alphabet case, we introduce the following deﬁnition.

Deﬁnition 8.14.1. A group G is said to be L-surjunctive if, for any ﬁeld
K and any ﬁnite-dimensional vector space V over K, every injective linear
cellular automaton τ : V G → V G is surjective.

Proposition 8.14.2. Every subgroup of an L-surjunctive group is L-surjunc-
tive.

Proof. Suppose that H is a subgroup of a L-surjunctive group G. Let V be
a ﬁnite-dimensional vector space over a ﬁeld K and let τ : V H → V H be an
injective linear cellular automaton over H. Consider the cellular automaton
τ G : V G → V G over G obtained from τ by induction (see Sect. 1.7). The fact
that τ is injective implies that τ G is injective by Proposition 1.7.4(i). Also,
τ G is linear by Proposition 8.3.1. Since G is L-surjunctive, it follows that τ G
is surjective. By applying Proposition 1.7.4(ii), we deduce that τ is surjective.
This shows that H is L-surjunctive.

Proposition 8.14.3. Let G be a group. Then the following conditions are
equivalent:
(a) G is L-surjunctive;
(b) every ﬁnitely generated subgroup of G is L-surjunctive.

Proof. The fact that (a) implies (b) follows from Proposition 8.14.2. Con-
versely, let G be a group all of whose ﬁnitely generated subgroups are L-
surjunctive. Let V be a ﬁnite dimensional vector space over a ﬁeld K and
let τ : V G → V G be an injective linear cellular automaton with memory set
S. Let H denote the subgroup of G generated by S and consider the linear
cellular automaton τH : V H → V H obtained by restriction of τ (see Sect. 1.7
and Proposition 8.3.1). The fact that τ is injective implies that τH is injec-
tive by Proposition 1.7.4(i). As H is ﬁnitely generated, it is L-surjunctive by
8.14 Linear Surjunctivity                                                       325

our hypothesis on G. It follows that τH is surjective. By applying Proposi-
tion 1.7.4(ii), we deduce that τ is also surjective. This shows that (b) im-
plies (a).
   Note that the preceding proposition may be stated by saying that a group
is L-surjunctive if and only if it is locally L-surjunctive.
   Every ﬁnite group is obviously L-surjunctive. Indeed, if G is a ﬁnite group
and V is a ﬁnite-dimensional vector space, then the vector space V G is also
ﬁnite-dimensional and therefore every injective endomorphism of V G is sur-
jective. More generally, it follows from Corollary 8.9.7 that every amenable
group is L-surjunctive. In fact, we have the following result, which is a linear
analogue of Theorem 7.8.1,
Theorem 8.14.4. Every soﬁc group is L-surjunctive.
Proof. Let G be a soﬁc group. Let V be a ﬁnite-dimensional vector space
over a ﬁeld K of dimension dimK (V ) = d ≥ 1 and let τ : V G → V G be an
injective linear cellular automaton. We want to show that τ is surjective.
Every subgroup of a soﬁc group is soﬁc by Proposition 7.5.4. On the other
hand, it follows from Proposition 3.2.2 that a group is L-surjunctive if all its
ﬁnitely generated subgroups are L-surjunctive. Thus we can assume that G
is ﬁnitely generated.
   Let then S ⊂ G be a ﬁnite symmetric generating subset of G. As usual,
for r ∈ N, we denote by BS (r) ⊂ G the ball of radius r centered at 1G in
the Cayley graph associated with (G, S). We set Y = τ (V G ). Observe that
Y is a G-invariant vector subspace of V G . On the other hand, it follows
from Theorem 8.8.1 that Y is closed in V G with respect to the prodiscrete
topology.
   By Theorem 8.12.1, there exists a linear cellular automaton σ : V G → V G
such that
                                σ ◦ τ = IdV G .
   Choose r0 large enough so that the ball BS (r0 ) is a memory set for both
τ and σ. Let μ : V BS (r0 ) → V and ν : V BS (r0 ) → V denote the corresponding
local deﬁning maps for τ and σ respectively.
   We proceed by contradiction. Suppose that τ is not surjective, that is,
Y  V G . Then, since Y is closed in V G , there exists a ﬁnite subset Ω ⊂ G
such that Y |Ω  V Ω . It is not restrictive, up to taking a larger r0 , again if
necessary, to suppose that Ω ⊂ BS (r0 ). Thus, Y |BS (r0 )  V BS (r0 ) .
   Let ε > 0 be such that
                                         1
                               ε<                  .                          (8.29)
                                    d|B(2r0 )| + 1

Note that from (8.29) we have 1 − ε > 1 −            1
                                                d|B(2r0 )|+1   which yields

                                                 1
                            (1 − ε)−1 < 1 +              .                    (8.30)
                                              d|B(2r0 )|
326                                                          8 Linear Cellular Automata

   Since G is soﬁc, we can ﬁnd a ﬁnite S-labeled graph (Q, E, λ) such that

                               |Q(3r0 )| ≥ (1 − ε)|Q|,                          (8.31)

where we recall that Q(r), r ∈ N, denotes the set of all q ∈ Q such that
there exists an S-labeled graph isomorphism ψq,r : BS (r) → B(q, r) satisfying
ψq,r (1G ) = q (cf. Theorem 7.7.1).
   Note the inclusions

             Q(r0 ) ⊃ Q(2r0 ) ⊃ · · · ⊃ Q(ir0 ) ⊃ Q((i + 1)r0 ) ⊃ · · · .

(cf. (7.41); see also Fig. 7.2). Also recall from Lemma 7.7.2 that B(q, r0 ) ⊂
Q(ir0 ) for all Q((i + 1)r0 ) and i ≥ 0.
   For each integer i ≥ 1, we deﬁne the map μi : V Q(ir0 ) → V Q((i+1)r0 ) by
setting, for all u ∈ V Q(ir0 ) and q ∈ Q((i + 1)r0 ),

                       μi (u)(q) = μ u|B(q,r0 ) ◦ ψq,r0 (1G ),

where ψq,2r0 is the unique isomorphism of S-labeled graphs from BS (r0 ) ⊂ G
to B(q, r0 ) ⊂ Q sending 1G to q (cf. 7.39 and 7.40).
   Similarly, we deﬁne the map νi : V Q(ir0 ) → V Q((i+1)r0 ) by setting, for all
u ∈ V Q(ir0 ) and q ∈ Q((i + 1)r0 ),

                       νi (u)(q) = ν u|B(q,r0 ) ◦ ψq,r0 (1G ).

   From the fact that τ −1 ◦ τ is the identity map on V G , we deduce that the
composite νi+1 ◦μi : V Q(ir0 ) → V Q((i+2)r0 ) is the identity on V Q((i+2)r0 ) . More
precisely, denoting by ρi : V Q(ir0 ) → V Q((i+2)r0 ) the restriction map, we have
that νi+1 ◦ μi = ρi for all i ≥ 1. In particular, we have ν2 ◦ μ1 = ρ1 . Thus,
setting Z = μ1 (V Q(r0 ) ) ⊂ V Q(2r0 ) , we deduce that ν2 (Z) = ρ1 (V Q(r0 ) ) =
V Q(3r0 ) . It follows that
                               dim(Z) ≥ d|Q(3r0 )|.                              (8.32)
                                                        
   Let Q ⊂ Q(3r0 ) be as in (7.59) and set Q = q ∈Q B(q  , r0 ). Note that
Q ⊆ Q(2r0 ) so that

                    |Q(2r0 )| = |Q | · |BS (r0 )| + |Q(2r0 ) \ Q |.           (8.33)

   Now observe that, for all q ∈ Q(2r0 ), we have a natural isomorphism of
vector spaces Z|B(q,r0 ) → Y |BS (r0 ) given by u → u◦ψq,r0 , where ψq,r0 denotes
as above the unique isomorphism of S-labeled graphs from BS (r0 ) to B(q, r0 )
such that ψq,r0 (1G ) = q. Since Y |BS (r0 )  V BS (r0 ) , this implies that

              dim Z|B(q,r0 ) = dim(Y |BS (r0 ) ) ≤ d · |BS (r0 )| − 1,          (8.34)

for all q ∈ Q .
   Thus we have
8.15 Stable Finiteness of Group Algebras                                       327

              dim(Z) ≤ dim Z|Q + dim Z|Q(2r0 )\Q
                       ≤ |Q | · (d · |BS (r0 )| − 1) + d · |Q(2r0 ) \ Q |
                          (                |Q | )
                       = d |Q(2r0 )| −
                                            d
where the last equality follows from (8.33). Comparing this with (8.32) we
obtain
                                                 |Q |
                         |Q(3r0 )| ≤ |Q(2r0 )| −       .
                                                  d
Thus,

                                                       |Q |
                     |Q| ≥ |Q(2r0 )| ≥ |Q(3r0 )| +
                                                        d
                                        |Q(3r0 )|
                         ≥ |Q(3r0 )| +             by (7.59),
                                       d|B(2r0 )|
                                    (        1       )
                         = |Q(3r0 )| 1 +
                                          d|B(2r0 )|
                         > |Q(3r0 )|(1 − ε)−1

where the last inequality follows from (8.30). This yields

                               |Q(3r0 )| < (1 − ε)|Q|

which contradicts (8.31). This shows that τ (V G ) = Y = V G , that is, τ is
surjective. It follows that the group G is L-surjunctive.



8.15 Stable Finiteness of Group Algebras

Let R be a ring and denote by 1R its unity element.
   If a, b ∈ R satisfy ab = 1R , then one says that b is a right-inverse of a and
that a is a left-inverse of b. An element a ∈ R is said to be right-invertible
(resp. left-invertible) if it admits a right-inverse (resp. a left-inverse). Every
invertible element in R is both right-invertible and left-invertible. Conversely,
suppose that an element a ∈ R admits a right-inverse b and a left-inverse b .
Then, we have ab = 1R and b a = 1R , so that b = (b a)b = b (ab ) = b .
This shows that a is invertible with inverse a−1 = b = b . Thus, if an element
is both right-invertible and left-invertible, then it is invertible.
   One says that the ring R is directly ﬁnite if every right-invertible element
(or, equivalently, every left-invertible element) is invertible. This is equivalent
to saying that if any two elements a, b ∈ R satisfy ab = 1R , then they also
satisfy ba = 1R .
328                                                    8 Linear Cellular Automata

   The ring R is said to be stably ﬁnite if the matrix ring Matd (R) is directly
ﬁnite for any d ≥ 1. Observe that every stably ﬁnite ring R is directly ﬁnite
since Mat1 (R) = R.

Proposition 8.15.1. Every ﬁnite ring is stably ﬁnite.

Proof. Let R be a ﬁnite ring. Suppose that a, b ∈ R satisfy ab = 1R . Consider
the map f : R → R deﬁned by f (r) = ar. We have f (br) = a(br) = (ab)r =
1R r = r for all r ∈ R. Therefore, the map f is surjective. As R is ﬁnite, this
implies that f is also injective. Since f (ba) = a(ba) = (ab)a = a = f (1R ), we
deduce that ba = 1R . This shows that every ﬁnite ring is directly ﬁnite.
   If the ring R is ﬁnite, then the ring Matd (R) is also ﬁnite for every d ≥ 1.
Consequently, every ﬁnite ring is stably ﬁnite.

Proposition 8.15.2. Every commutative ring is stably ﬁnite.

Proof. Let d ≥ 1 and suppose that a ∈ Matd (R) is right-invertible. Then
there exists b ∈ Matd (R) such that ab = Id . This implies that

                   det(a) det(b) = det(ab) = det(Id ) = 1R .

It follows that det(a) is an invertible element in R. Therefore a is invertible
in Matd (R). This shows that Matd (R) is directly ﬁnite for any d ≥ 1. Conse-
quently, R is stably ﬁnite.

  Let us give an example of a ring which is not directly ﬁnite.

Example 8.15.3. Let R be a nonzero ring and consider the free left R-module
M = ⊕n∈N R. Every element in M can be represented in the form m =
(mn )n∈N where mn ∈ R for all n ∈ N and mn = 0R for all but ﬁnitely many
n ∈ N. Consider the maps a : M → M and b : M → M deﬁned by setting
a(m) = m (resp. b(m) = m ) where mn = mn−1 for n ≥ 1 and m0 = 0R
(resp. mn = mn+1 for all n ∈ N). Then a and b are obviously R-linear,
in other words, a, b ∈ EndR (M ) and ab = IdM = 1EndR (M ) . Consider the
element m ∈ M such that m0 = 1R and mn = 0R for all n ≥ 1. As a(m) = 0
we have ba(m) = 0. This shows that ba = 1EndR (M ) . It follows that the ring
EndR (M ) is not directly ﬁnite.

   Let G be a group and let V be a vector space over a ﬁeld K. Recall that
the set LCA(G; V ) consisting of all linear cellular automata τ : V G → V G
has a natural structure of K-algebra in which the multiplication is given by
the composition of maps.

Proposition 8.15.4. Let G be a group and let V be a vector space over a
ﬁeld K. Let τ : V G → V G be a linear cellular automaton. Then the following
hold:
 (i) if τ is left-invertible in LCA(G; V ), then τ is injective;
8.15 Stable Finiteness of Group Algebras                                     329

 (ii) if τ is right-invertible in LCA(G; V ), then τ is surjective;
(iii) if τ is invertible in LCA(G; V ), then τ is bijective.
If, in addition, the vector space V is ﬁnite-dimensional, then:
(iv) τ is left-invertible in LCA(G; V ) if and only if τ is injective;
 (v) τ is invertible in LCA(G; V ) if and only if τ is bijective.

Proof. (i) Suppose that τ ∈ LCA(G; V ) is left-invertible. This means that
there exists σ ∈ LCA(G; V ) such that σ ◦ τ = IdV G . As IdV G is injective, this
implies that τ is injective.
   (ii) Suppose that τ ∈ LCA(G; V ) is right-invertible. This means that there
exists σ ∈ LCA(G; V ) such that τ ◦ σ = IdV G . As IdV G is surjective, this
implies that τ is surjective.
   (iii) This immediately follows from (i) and (ii).
   (iv) This immediately follows from (i) and Theorem 8.12.1.
   (v) This immediately follows from (iii) and Corollary 8.12.2.

Remarks 8.15.5. (a) If V is inﬁnite-dimensional, it may happen that a bi-
jective linear cellular automaton τ : V G → V G is not left-invertible in
LCA(G; V ). Therefore, the converses of assertions (i) and (iii) in Propo-
sition 8.15.4 are false if we do not add the hypothesis that V is ﬁnite-
dimensional. To see this, consider the bijective linear cellular automaton
τ : V Z → V Z described in Remark 8.12.3. Then, there is no σ ∈ LCA(G; V )
such that σ ◦ τ = IdV G since otherwise the inverse map of τ would coincide
with σ, which is impossible as τ is not an invertible cellular automaton.
    (b) The converse of assertion (ii) in Proposition 8.15.4 does not hold even
under the additional hypothesis that V is ﬁnite-dimensional. For instance,
take an arbitrary ﬁeld K and consider the linear cellular automaton τ : KZ →
KZ deﬁned by τ (x)(n) = x(n + 1) − x(n) for all x ∈ KZ and n ∈ Z. Observe
that τ is surjective. Indeed, given y ∈ KZ , the conﬁguration x ∈ KZ deﬁned
by                    ⎧
                      ⎪
                      ⎨0                                  if n = 0,
             x(n) = y(0) + y(1) + · · · + y(n − 1)        if n > 0,
                      ⎪
                      ⎩
                        y(n) + y(n + 1) + · · · + y(−1) if n < 0,
clearly satisﬁes τ (x) = y. However, τ is not right-invertible in LCA(Z; K).
To see this, observe that, as the K-algebra LCA(Z; K) is commutative by
Corollary 8.5.4, the right-invertibility of τ would imply the bijectivity of τ by
Proposition 8.15.4(iii). But τ is not injective as all constant conﬁgurations
are mapped to 0.

Corollary 8.15.6. Let G be a group and let K be a ﬁeld. Let V be a vector
space over K of ﬁnite dimension dimK (V ) = d ≥ 1. Then the following
conditions are equivalent:
(a) every injective linear cellular automaton τ : V G → V G is surjective;
(b) the K-algebra LCA(G; V ) is directly ﬁnite;
330                                                       8 Linear Cellular Automata

(c) the K-algebra Matd (K[G]) is directly ﬁnite.

Proof. The equivalence between conditions (b) and (c) follow from the fact
that the K-algebras LCA(G; V ) and Matd (K[G]) are isomorphic by Corol-
lary 8.7.8.
   Suppose (a). Let τ ∈ LCA(G; V ) be a left-invertible element in LCA(G; V ).
Then τ is injective by Proposition 8.15.4(i). Condition (a) implies then that
τ is surjective and hence bijective. By applying Proposition 8.15.4(v), we
deduce that τ is invertible in LCA(G; V ). This shows that (a) implies (b).
   Conversely, suppose (b). Let τ : V G → V G be an injective linear cellular
automaton. Then τ is left-invertible in LCA(G; V ) by Proposition 8.15.4(iv).
It follows from condition (b) that τ is invertible in LCA(G; V ). By using
Proposition 8.15.4(ii), we deduce that τ is surjective. This shows that (b)
implies (a).

Corollary 8.15.7. Let G be a group. Then the following conditions are equiv-
alent:
(a) the group G is L-surjunctive;
(b) for any ﬁeld K, the group algebra K[G] is stably ﬁnite.

   From Theorem 8.14.4 and Corollary 8.15.7, we deduce the following:

Corollary 8.15.8. Let G be a soﬁc group and let K be a ﬁeld. Then the group
algebra K[G] is stably ﬁnite.



8.16 Zero-Divisors in Group Algebras
     and Pre-injectivity of One-Dimensional Linear
     Cellular Automata

Let R be a ring.
   A nonzero element a ∈ R is said to be a left zero-divisor (resp. a right
zero-divisor ) if there exists a nonzero element b in R such that ab = 0 (resp.
ba = 0). Note that the existence of a left zero-divisor in R is equivalent to the
existence of a right zero-divisor. One says that the ring R has no zero-divisors
if R admits no left (or, equivalently, no right) zero-divisors.

Examples 8.16.1. (a) Let R = Z/nZ, n ≥ 2, be the (commutative) ring of
integers modulo n. Then R has no zero-divisors if and only if n is a prime
number.
   (b) Let G be a group and let R be a nonzero ring. Suppose that G contains
an element g0 of ﬁnite order n ≥ 2 and let H = {1G , g0 , g02 , . . . , g0n−1 } denote
the subgroup of G generated by g0 . Consider the elements α, β ∈ R[G] deﬁned
respectively by
8.16 Zero-Divisors in Group Algebras                                          331
            ⎧
            ⎪                                           
            ⎨1          if g = 1G ,
                                                         1     if g ∈ H,
      α(g) = −1         if g = g0 ,          and β(g) =
            ⎪
            ⎩                                            0     otherwise.
              0              / {1G , g0 }.
                        if g ∈

One easily checks that α = 0, β = 0, and αβ = βα = 0. Thus, α and β are
both left and right zero-divisors in R[G].

   Let R be a ring. An element x ∈ R is called an idempotent if it satisﬁes
x2 = x. An idempotent x ∈ R is said to be proper if x = 0 and x =
                                                                  1.

Proposition 8.16.2. Let R be a ring. Then the following hold:
  (i) if R has no zero-divisors, then R has no proper idempotents;
 (ii) if R has no proper idempotents, then R is directly ﬁnite.

Proof. (i) Every idempotent x ∈ R satisﬁes x(x − 1) = x2 − x = 0. If R has
no zero-divisors, this implies x = 0 or x = 1.
   (ii) Suppose that R has no proper idempotents. Let a, b ∈ R such that
ab = 1. Then we have (ba)2 = b(ab)a = ba so that ba is an idempotent.
Therefore, ba = 0 or ba = 1. If ba = 0, then a = (ab)a = a(ba) = 0 so that
0 = 1 and R is reduced to 0. Therefore, we have ba = 1 in all cases. This
shows that R is directly ﬁnite.

Remarks 8.16.3. (a) A ring without proper idempotents may admit zero-
divisors. For example, the ring Z/8Z has no proper idempotents. However,
the classes of 2, 4, and 6 are zero-divisors in Z/8Z.
   (b) A directly ﬁnite ring may admit proper idempotents. For example,
take a nonzero commutative ring R. Then the ring Mat2 (R) is directly ﬁ-
nite by Proposition 8.15.2. However, the matrices 10 00 and 00 01 are proper
idempotents in Mat2 (R).

  A group G is called a unique-product group if, given any two non-empty
ﬁnite subsets A, B ⊂ G, there exists an element g ∈ G which can be uniquely
expressed as a product g = ab with a ∈ A and b ∈ B.

Remark 8.16.4. A unique-product group is necessarily torsion-free. Indeed,
suppose that G is a group containing an element g0 of order n ≥ 2. Take
A = B = {1G , g0 , g02 , . . . , g0n−1 }. Then AB = A and there is no g ∈ AB which
can be uniquely written in the form g = ab with a ∈ A and b ∈ B.

   Recall that a total ordering on a set X is a binary relation ≤ on X which
is reﬂexive, antisymmetric, transitive, and such that one has x ≤ y or y ≤ x
for all x, y ∈ X. A group G is called orderable if it admits a left-invariant
total ordering, that is, a total ordering ≤ such that g1 ≤ g2 implies gg1 ≤ gg2
for all g, g1 , g2 ∈ G.
332                                                       8 Linear Cellular Automata

Examples 8.16.5. (a) Every subgroup of an orderable group is orderable. In-
deed, if H is a subgroup of a group G and ≤ is a left-invariant total ordering
on G, then the restriction of ≤ to H is a left-invariant total ordering on H.
   (b) The additive groups Z, Q, and R are orderable since the usual ordering
on R is translation-invariant.
   (c) The direct product of two orderable groups is an orderable group.
Indeed, let G1 and G2 be two groups and suppose that ≤1 and ≤2 are left-
invariant total orderings on G1 and G2 respectively. Then the lexicographic
ordering ≤ on G1 × G2 deﬁned by
                                        ⎧
                                        ⎪
                                        ⎨g1 ≤1 g2
              (g1 , g2 ) ≤ (h1 , h2 ) ⇐⇒ or
                                        ⎪
                                        ⎩
                                         g1 = g2 and h1 ≤2 h2

is a left-invariant total ordering on G1 × G2 .
   (d) More generally, the direct product of any family (ﬁnite or inﬁnite) of
orderable groups is an orderable group. Indeed, let (Gi )i∈I be a family of
orderable groups. Let ≤i be a left-invariant total ordering on Gi for each
i ∈ I. Let us ﬁx a well-ordering on I, i.e., a total ordering such that every
nonempty subset of I admits a minimal element (the fact that any set can
be well-ordered is a basic fact in set theory which may be deduced          from the
Axiom of Choice). Then the lexicographic ordering on G = i∈I Gi , which
is deﬁned by setting g ≤ h for g = (gi ), h = (hi ) ∈ G if and only if g = h or
gi0 < hi0 where i0 = min{i ∈ I   : gi = hi }, is a left-invariant total ordering on
G. As ⊕i∈I Gi is a subgroup of i∈I Gi , it follows that the direct sum of any
family of orderable groups is an orderable group. Since a free abelian group is
isomorphic to a direct sum of copies of Z, we deduce in particular that every
free abelian group is orderable.
   (e) In fact, every torsion-free abelian group is orderable. Indeed, if G is
a torsion-free abelian group then G embeds in the Q-vector space G ⊗Z Q
via the map g → g ⊗ 1. On the other hand, the additive group underlying a
Q-vector space V is isomorphic to a direct sum of copies of Q (since V admits
a Q-basis) and hence orderable.
   (f) Suppose that G is a group containing a normal subgroup N such that
both N and G/N are orderable groups. Then the group G is orderable. In-
deed, let ≤1 (resp. ≤2 ) be a left-invariant total ordering on N (resp. G/N ).
Then one easily checks that the binary relation ≤ on G deﬁned by setting
                              ⎧
                              ⎪
                              ⎨ρ(g) ≤2 ρ(h)
                 g ≤ h ⇐⇒        or
                              ⎪
                              ⎩
                                ρ(g) = ρ(h) and 1G ≤1 g −1 h

is a left-invariant total ordering on G.
   (g) Let R be any ring. Consider the Heisenberg group
8.16 Zero-Divisors in Group Algebras                                       333
                  ⎧              ⎛     ⎞                          ⎫
                  ⎨               1yz                             ⎬
              HR = M (x, y, z) = ⎝0 1 x⎠        :   x, y, z ∈ R       .
                  ⎩                                               ⎭
                                  001

(cf. Example 4.6.5). The kernel of the group homomorphism of HR onto R2
given by M (x, y, z) → (x, y) is the normal subgroup
                              ⎧⎛       ⎞            ⎫
                              ⎨ 10z                 ⎬
                        N = ⎝0 1 0⎠ : z ∈ R .
                              ⎩                     ⎭
                                   001

As the groups N and HR /N are both abelian, it follows from Examples (e)
and (f) above that HR is orderable.
   Given a set X equipped with a total ordering ≤, we denote by Sym(X, ≤)
the group of order-preserving permutations of X, that is, the subgroup of
Sym(X) consisting of all bijective maps f : X → X such that x ≤ y implies
f (x) ≤ f (y) for all x, y ∈ X.
Proposition 8.16.6. Let G be a group. Then the following conditions are
equivalent:
(a) G is orderable;
(b) there exists a set X equipped with a total ordering ≤ such that G is iso-
    morphic to a subgroup of Sym(X, ≤).
Proof. Suppose that ≤ is a left invariant total ordering on G. Then the ac-
tion of G on itself given by left multiplication is order-preserving. Thus G is
isomorphic to a subgroup of Sym(G, ≤). This shows that (a) implies (b).
   Conversely, suppose that X is a set equipped with a total ordering ≤.
Choose a well ordering ≤W on X. Then we can deﬁne a lexicographic ordering
≤L on Sym(X, ≤) by setting f ≤L g for f, g ∈ Sym(X, ≤) if and only if f = g
or f (x0 ) ≤ g(x0 ) where x0 = min{x ∈ X : f (x) = g(x)}. Clearly ≤L is a
left invariant total ordering on Sym(X, ≤). It follows that Sym(X, ≤) is an
orderable group. As any subgroup of an orderable group is orderable, we
conclude that (b) implies (a).
Corollary 8.16.7. The group Homeo+ (R) of orientation-preserving homeo-
morphisms of R is orderable.
Proposition 8.16.8. Every orderable group is a unique-product group.
Proof. Let G be an orderable group and let ≤ be a left-invariant total ordering
on G. Let A and B be nonempty ﬁnite subsets of G. Set bm = min B and
let am ∈ A be the unique element such that am bm = min Abm . Consider the
element g = am bm . For all a ∈ A and b ∈ B, we have am bm ≤ abm ≤ ab.
Thus, if g = ab for some a ∈ A and b ∈ B, then am bm = abm = ab, so that
we get am = a and bm = b after right and left cancellation. This shows that
G is a unique-product group.
334                                                          8 Linear Cellular Automata

Proposition 8.16.9. Let G be a unique-product group and let R be a ring
with no zero-divisors. Then the group ring R[G] has no zero-divisors.

Proof. Let α and β be nonzero elements in R[G], and denote by A and B
their supports. As G is a unique-product group, there is an element g ∈ AB
such that there exists a unique element (a, b) ∈ A × B such that g = ab. Then
we have
                (αβ)(g) =            α(h1 )β(h2 ) = α(a)β(b).
                               h1 ∈A,h2 ∈B
                                 h1 h2 =g

As R has no zero-divisors, this implies (αβ)(g) = 0. Thus, we have αβ = 0.
This shows that R[G] has no zero-divisors.

Corollary 8.16.10. Let G be a unique-product group and let K be a ﬁeld.
Then the group algebra K[G] has no zero-divisors.

   Let G be a group and let K be a ﬁeld. We have seen in Corollary 8.5.3
that the map Ψ : K[G] → LCA(G; K) deﬁned by

                            Ψ (α)(x)(g) =          α(h)x(gh)
                                             h∈G

for all α ∈ K[G], x ∈ KG , and g ∈ G, is a K-algebra isomorphism.

Proposition 8.16.11. Let G be a group and let K be a ﬁeld. Let α be a
nonzero element in K[G]. Then the following conditions are equivalent:
(a) α is not a left zero-divisor in K[G];
(b) the linear cellular automaton Ψ (α) : KG → KG is pre-injective.

Proof. By Proposition 8.2.5, the linear cellular automaton Ψ (α) is not pre-
injective if and only if there exists a nonzero element β ∈ K[G] such that
Ψ (α)(β) = 0. As

      Ψ (α)(β)(g) =         α(h)β(gh) =         α(h)β ∗ (h−1 g −1 ) = (αβ ∗ )(g −1 ),
                      h∈G                 h∈G

for all β ∈ K[G] and g ∈ G, we deduce that Ψ (α) is not pre-injective if and
only if there exists a nonzero element β ∈ K[G] such that αβ ∗ = 0, that is,
if and only if α is a left zero-divisor in K[G]. This shows that conditions (a)
and (b) are equivalent.

Corollary 8.16.12. Let G be a group and let K be a ﬁeld. Then the following
conditions are equivalent:
(a) the group algebra K[G] has no zero-divisors;
(b) every non-identically-zero linear cellular automaton τ : KG → KG is pre-
    injective.
Notes                                                                      335

  From Corollary 8.16.12 and Theorem 8.9.6 we deduce the following.

Corollary 8.16.13. Let G be an amenable group and let K be a ﬁeld such
that K[G] has no zero-divisors. Then every non-identically-zero linear cellular
automaton τ : KG → KG is surjective.

   Observe that it follows from Theorem 4.6.1, Example 8.16.5(e), Proposi-
tion 8.16.8, and Corollary 8.16.10 that torsion-free abelian groups satisfy the
hypotheses of Corollary 8.16.13 for any ﬁeld K. This implies in particular
that if G is a torsion-free abelian group and S is a nonempty subset of G
which is not reduced to the identity element, then the discrete Laplacian
ΔS : KG → KG is surjective for any ﬁeld K.



Notes

In the literature, the term linear is used by some authors with a diﬀerent
meaning, namely to designate a cellular automaton τ : AG → AG for which
the alphabet A is a ﬁnite abelian group and τ is a group endomorphism of
AG . Such cellular automata are also called additive cellular automata.
   Linear cellular automata with vector spaces as alphabets were considered
by the authors in a series of papers starting with [CeC1]. The fact that the
algebra of linear cellular automata over a group G whose alphabet is a d-
dimensional vector space over a ﬁeld K is isomorphic to the algebra of d × d
matrices with coeﬃcients in K[G] (Corollary 8.7.8) was proved in Sect. 6 of
[CeC1] for d = 1 and in Sect. 4 of [CeC2] for all d ≥ 1. The representations
of linear cellular automata both as elements in EndK (V )[G] and as elements
in EndK[G] (V [G]) were given in Sect. 4 of [CeC5].
   Recall that a Laurent polynomial over a ﬁeld K is a polynomial in the
variable t and its inverse t−1 with coeﬃcients in K. The K-algebra of Lau-
rent polynomials is thus denoted by K[t, t−1 ]. Also, a Laurent polynomial
matrix is a matrix whose entries are Laurent polynomials. For d ≥ 1, de-
note by Matd (K[t, t−1 ]) the K-algebra of d × d Laurent polynomial matri-
ces over K. When G = Z, there are canonical isomorphisms of K-algebras
K[Z] ∼ = K(t, t−1 ] and LCA(Z; Kd ) ∼ = Matd (K[t, t−1 ]). In [LiM, Sect. 1.6]
cellular automata τ ∈ LCA(Z; K ) are called (d × d) convolutional en-
                                    d

coders.
   The notion of mean dimension for vector subspaces of V G , where G is an
amenable group and V is a ﬁnite-dimensional vector space, was introduced by
Gromov in [Gro5] and [Gro6]. Mean dimension was used by Elek [Ele] to prove
that, given any amenable group G and any ﬁeld K, there exists a non-trivial
homomorphism from the Grothendieck group of ﬁnitely generated modules
over the group algebra K[G] into the additive group of real numbers. As for
entropy, it can be shown, as an application of the Ornstein-Weiss convergence
336                                                   8 Linear Cellular Automata

theorem (see [OrW], [LiW], [Gro6], [Ele], [Kri]) that the lim sup in (8.18) is
in fact a true limit and does not depend on the Følner net F.
   The fact that the image of a linear cellular automaton with ﬁnite dimen-
sional alphabet is closed (Theorem 8.8.1) was proved in Sect. 3 of [CeC1].
The linear version of the Garden of Eden theorem (Theorem 8.9.6) was ﬁrst
proved for countable amenable groups in [CeC1] and then extended to all
amenable groups in [CeC8] using induction and restriction for linear cellular
automata. The linear version of the Garden of Eden theorem was generalized
to R-linear cellular automata with coeﬃcients in semisimple left R-modules
of ﬁnite length over a ring R and over amenable groups in [CeC4]. Invertibil-
ity of linear cellular automata with ﬁnite dimensional alphabet V was proved
in Sect. 3 of [CeC2] for bijective linear cellular automata τ : X → Y between
closed linear subshifts X, Y ⊂ V G over countable groups and in [CeC8] for
bijective linear cellular automata τ : V G → V G over any group G.
   In [CeC11] it is shown that if G is a non-periodic group, then for every
inﬁnite-dimensional vector space V over a ﬁeld K there exist a bijective cellu-
lar automaton τ : V G → V G which is not invertible (cf. Theorem 8.12.1 and
Remark 8.12.3) and a cellular automaton τ  : V G → V G whose image τ  (V G )
is not closed in V G with respect to the prodiscrete topology (cf. Theorem
8.8.1 and Example 8.8.3).
   Theorem 8.13.2 and Corollary 8.13.4 were proved in [CeC6] and [CeC9].
   Directly ﬁnite rings are sometimes called Dedekind ﬁnite rings or von
Neumann ﬁnite rings. In [Coh], P.M. Cohn constructed, for each integer
d ≥ 1, a ring R such that Matd (R) is directly ﬁnite but Matd+1 (R) is not
directly ﬁnite. I. Kaplansky [Kap2, p. 122], [Kap3, Problem 23] observed that
techniques from the theory of operator algebras could be used to prove that,
for any group G and any ﬁeld K of characteristic 0, the group algebra K[G]
is stably ﬁnite and asked whether this property remains true for ﬁelds of
characteristic p > 0. The stable ﬁniteness of K[G] in arbitrary characteristic
was established for free-by-abelian groups G by P. Ara, K.C. O’Meara and
F. Perera in [AOP]. This was extended to all soﬁc groups by Elek and Szabó
[ES1], using the notion of von Neumann dimension for continuous regular
rings. The proof of Elek and Szabó’s result via linear cellular automata which
is presented in this chapter (cf. Corollary 8.15.8) was given in [CeC2]. The
notion of L-surjunctivity was also introduced in [CeC2] and the equivalence
between L-surjunctivity and stable ﬁniteness was established in Corollary 4.3
therein. In [CeC3], the authors proved that if R is a ring and G is a residually
ﬁnite group, then every injective R-linear cellular automaton over G whose
alphabet is an Artinian left R-module is surjunctive. In [CeC5], it was shown
that if R is a ring, then R-linear cellular automata with coeﬃcients in left
R-modules of ﬁnite length (thus a stronger condition than being Artinian)
over soﬁc groups (thus a weaker condition than being residually ﬁnite) are
surjunctive. This last result was used to show in [CeC5] that the group ring
R[G] is stably ﬁnite whenever R is a left (or right) Artinian ring and G is a
Notes                                                                         337

soﬁc group. This yields an extension of the Elek and Szabó stable ﬁniteness
result since any division ring is Artinian.
   Unique-product groups were introduced by W. Rudin and H. Schneider in
[RuS] under the name of Ω-groups. The question of the existence of a torsion-
free group which is not unique-product was raised by Rudin and Schneider
[RuS, p. 592]. This question was answered in the aﬃrmative by E. Rips and
Y. Segev [RiS] (see also [Pro]). More information on orderable groups may
be found for example in [BoR], [Pas], and [Gla]. A group G is said to be
locally indicable if any nontrivial ﬁnitely generated subgroup of G admits
an inﬁnite cyclic quotient. Every locally indicable group is orderable (see
for example [BoR, Theorem 7.3.1] or [Gla, Lemma 6.9.1]). This implies in
particular that locally nilpotent torsion-free groups, free groups, and fun-
damental groups of surfaces not homeomorphic to the real projective plane
are all orderable groups. It was observed by G.M. Bergman [Ber] that the
universal covering group SL 2 (R) of SL2 (R) is orderable but not locally indi-
cable. The group SL  2 (R) is orderable since it has a natural faithful action by
orientation-preserving homeomorphisms of the real line but it is not locally
indicable since it contains nontrivial ﬁnitely generated perfect groups. By a
recent result due to D.W. Morris [Morr, Theorem B], every amenable order-
able group is locally indicable. The orderability of the braid groups Bn was
established independently by P. Dehornoy [Deh] and W. Thurston. It follows
from a result of E.A. Gorin and V.Ja. Lin [GoL] that the group Bn is not
locally indicable for n ≥ 5.
   A group is called bi-orderable if it admits a total ordering which is both
left and right invariant. All free groups and all locally nilpotent torsion-free
groups are bi-orderable. For n ≥ 3, the braid group Bn is not bi-orderable.
However, the pure braid groups Pn (i.e., the kernel of the natural epimorphism
of Bn onto Symn ) is bi-orderable for all n. A theorem due to A.I. Mal’cev
[Mal2] and B.H. Neumann [Neu1] says that, given a group G equipped with a
total ordering which is both left and right invariant and a ﬁeld K, the vector
subspace of KG consisting of all maps x : G → K whose support is a well-
ordered subset of G is a division K-algebra for the convolution product (see
[Pas, Theorem 2.11 in Chap. 13]). When G = Z, this division algebra is the
ﬁeld of Laurent series with coeﬃcients in K. The Mal’cev-Neumann theorem
implies in particular that, for any bi-orderable group G and any ﬁeld K, the
group algebra K[G] embeds in a division K-algebra and is therefore stably
ﬁnite.
   A famous conjecture attributed to Kaplansky is the zero-divisor conjec-
ture which states that if G is a torsion-free group then the group algebra
K[G] has no zero-divisors for any ﬁeld K (see [Kap1], [Kap2, p. 122], [Pas,
Chap. 13]). The observation that unique-product groups (and hence orderable
groups) satisfy the Kaplansky zero-divisor conjecture (see Corollary 8.16.10)
was made by Rudin and Schneider [RuS, Theorem 3.2]. The class of ele-
mentary amenable groups is the smallest class of groups containing all ﬁnite
338                                                  8 Linear Cellular Automata

and all abelian groups that is closed under taking subgroups, quotients, ex-
tensions, and directed unions. It is known (see [KLM, Theorem 1.4]) that
torsion-free elementary amenable groups satisfy the Kaplansky zero-divisors
conjecture. This implies in particular that all torsion-free virtually solvable
groups satisfy the Kaplansky zero-divisors conjecture. According to Corol-
lary 8.16.12, the zero-divisor conjecture is equivalent to saying that if G is
a torsion-free group and K is a ﬁeld then every non-identically-zero linear
cellular automaton τ : KG → KG is pre-injective. This reformulation of the
Kaplansky zero-divisor conjecture in terms of linear cellular automata was
given in Sect. 6 of [CeC1].



Exercises

8.1. Let G be a group and let R be a nonzero ring. Show that the ring R[G]
is commutative if and only if both G and R are commutative.

8.2. Recall that the center of a ring A is the subring B of A consisting of the
elements x ∈ A which satisfy ax = xa for all a ∈ A. Let G be a group and
let R be a commutative ring. Let α ∈ R[G]. Show that α is in the center of
R[G] if and only if α is constant on each conjugacy class of G.

8.3. One says that a group G has the ICC-property if every conjugacy class
of G except {1G } is inﬁnite.
   (a) Show that if a group G has the ICC-property then the center of G is
reduced to the identity element.
   (b) Show that if a group G has the ICC-property then every normal sub-
group of G which is not reduced to the identity element is inﬁnite.
   (c) Let X be an inﬁnite set. Show that the group Sym0 (X), which consists
of all permutations of X with ﬁnite support, has the ICC-property.
   (d) Show that every nonabelian free group has the ICC-property.
   (e) Let G be a group with the ICC-property and let R be a commutative
ring. Show that the center of R[G] consists of the maps x : G → R which
satisfy x(g) = 0R for all g ∈ G \ {1G }. Hint: Use the result of Exercise 8.2.
   (f) Let G be a group and let R be a nonzero commutative ring. Show that
G has the ICC-property if and only if the center of R[G] is isomorphic to the
ring R.

8.4. Let G be a group, K a ﬁeld, and d ≥ 1 an integer. Show that the K-
algebras Matd (K)[G] and Matd (K[G]) are isomorphic.

8.5. Show that Theorem 8.13.2 remains valid if the ﬁeld R is replaced by the
ﬁeld C of complex numbers. Hint: Write every f ∈ CG in the form f = f0 +if1 ,
where f0 , f1 ∈ RG .
Exercises                                                                  339

8.6. Let G be a group and let S ⊂ G be a non-empty ﬁnite subset. Denote
by ·, · the standard scalar product on R[G] ⊂ 2 (G) and let  ·  denote the
associated norm.
   (a) Show that for all x ∈ R[G] and λ ∈ R, one has
                                 1
            x, ΔS (x) + λx =                 |x(g) − x(gs)|2 + λx2 .
                                 2
                                     g∈G s∈S

   (b) Show that if the subgroup generated by S is inﬁnite then for any
non–empty ﬁnite subset F ⊂ G there exists s ∈ S such that F s ⊂ F .
   (c) Deduce from (a) and (b) that if λ ≥ 0 and the subgroup generated by
S is inﬁnite, then the linear cellular automaton ΔS + λ IdRG : RG → RG is
pre-injective.

8.7. Showthat if (Ri )i∈I is a family of directly ﬁnite rings then the product
ring P = i∈I Ri is directly ﬁnite.

8.8. Show that every subring of a directly ﬁnite (resp. stably ﬁnite) ring is
directly ﬁnite (resp. stably ﬁnite).

8.9. Let K be a ﬁeld and let V be an inﬁnite-dimensional vector space over
K. Show that the K-algebra EndK (V ) is not directly ﬁnite.

8.10. Let R be a ring and let M be a left R-module. One says that the module
M is Hopﬁan if every surjective endomorphism of M is injective. Show that
if M is Hopﬁan, then the ring EndR (M ) is directly ﬁnite.

8.11. Let R be a ring and let M be a left R-module. One says that the module
M is Noetherian if its submodules satisfy the ascending chain condition, i.e.,
every increasing sequence
                               N1 ⊂ N2 ⊂ . . .
of submodules of M stabilizes (there is an integer i0 ≥ 1 such that Ni = Ni0
for all i ≥ i0 ). Show that if M is Noetherian, then M is Hopﬁan. Hint:
Suppose that f is a surjective endomorphism of M and consider the sequence
of submodules Ni = Ker(f i ), i ≥ 1.

8.12. Let R be a ring and let P be a left R-module. One says that the module
P is projective if for every homomorphism f : P → M and every surjective
homomorphism g : M   # → M of left R-modules, there exists a homomorphism
h: P → M# such that f = g ◦ h. Show that if the module P is projective, then
P is Hopﬁan if and only if the ring EndR (P ) is directly ﬁnite.

8.13. Let R be a ring and let d ≥ 1 be an integer. Equip Rd with its natural
structure of left R-module. Show that Rd is Hopﬁan if and only if the ring
Matd (R) is directly ﬁnite.
340                                                    8 Linear Cellular Automata

8.14. One says that a ring R is left Noetherian if R is Noetherian as a left
module over itself.
   (a) Let R be a left Noetherian ring. Show by induction that Rd is Noethe-
rian as a left R-module for each integer d ≥ 1.
   (b) Show that every left Noetherian ring is stably ﬁnite. Hint: Use Exer-
cises 8.11 and 8.13.

8.15. One says that a ring R has the unique rank property if it satisﬁes the
following condition: if m and n are positive integers such that Rm and Rn are
isomorphic as left R-modules, then one has m = n. Show that every stably
ﬁnite ring has the unique rank property.

8.16. Let K be a ﬁeld and let V be an inﬁnite-dimensional vector space over
K. Show that the ring R = EndK (V ) does not have the unique rank property.
Hint: Observe that the vector spaces V and V ⊕ V are isomorphic and then
prove that the set consisting of all K-linear maps f : V ⊕ V → V , with its
natural structure of left R-module, is isomorphic to both R and R2 .

8.17. Show that every division ring is stably ﬁnite.

8.18. A ring R is said to be unit-regular if for any a ∈ R there exists an
invertible element u ∈ R such that a = aua.
   (a) Show that every division ring is unit-regular.
   (b) Show that if K is a ﬁeld then the ring Matd (K) is unit-regular for every
d ≥ 1. Hint: Prove that if A ∈ Matd (K) has rank r then there exist invertible
matrices U, V ∈ GLd (K) such that A = U Dr V , where Dr ∈ Matd (K) is the
diagonal matrix deﬁned by δij = 1 if 1 ≤ i = j ≤ r and δij = 0 otherwise,
and then observe that A = AXA, where X = (U V )−1 .
   (c) Show that every unit-regular ring is directly ﬁnite.
   (d) Prove that the ring Z is not unit-regular.
   (e) A ring R is called a Boolean ring if a2 = a for all a ∈ R. Show that
every Boolean ring is commutative and unit-regular.

8.19. One says that a ring R is a right Ore ring if R has no zero-divisors
and if for any pair a, b of nonzero elements in R there exist nonzero elements
u, v ∈ R such that au = bv. Left Ore rings are deﬁned similarly. Show that
any right (or left) Ore ring is directly ﬁnite.
   Hint: Prove that ab = 1R implies ba = 1R by a direct argument, or show
that R can be embedded as a subring of a division ring by adapting the
construction of the ﬁeld of fractions of an integral domain.

8.20. Let K be a ﬁeld. Show that every ﬁnite-dimensional K-algebra is stably
ﬁnite.

8.21. Let G be an amenable group and let F be a Følner net for G. Let V
be a ﬁnite-dimensional vector space. Suppose that X (resp. Y ) is a vector
subspace of V G . Show that mdimF (X ∪ Y ) ≤ mdimF (X) + mdimF (Y ).
Exercises                                                                    341

8.22. Use Corollary 8.15.7 and the result of Exercise 8.20 to recover the fact
that every ﬁnite group is L-surjunctive.

8.23. Use Proposition 8.15.2 and Corollary 8.15.7 to recover the fact that
every abelian group is L-surjunctive.

8.24. It follows from Theorem 8.14.4 that every residually ﬁnite group is L-
surjunctive. The goal of this exercise is to present an alternative proof of this
result. Let G be a residually ﬁnite group and let V be a ﬁnite-dimensional
vector space over a ﬁeld K. Let τ : V G → V G be an injective linear cellular
automaton. Fix a family (Γi )i∈I of subgroups of ﬁnite index of G such that

  i∈I Γi = {1G } (the existence of such a family follows from the residual
ﬁniteness of G).
   (a) Show that, for each i ∈ I, the set Fix(Γi ) = {x ∈ V G : gx =
x for all g ∈ Γi } is a ﬁnite-dimensional vector subspace of V G .
   (b) Show that τ(Fix(Γi )) = Fix(Γi ) for all i ∈ I.
   (c) Prove that i∈I Fix(Γi ) is dense in V G and conclude.

8.25. Let R be a ring and let x ∈ R. Show that x is an idempotent if and
only if 1R − x is an idempotent.

8.26. Show that any subgroup of a unique-product group is a unique-product
group.

8.27. Let G be a group. Suppose that G contains a normal subgroup N
such that N and G/N are both unique-product groups. Show that G is a
unique-product group. Hint: See for example [RuS, Theorem 6.1].

8.28. Show that every residually orderable group is orderable.

8.29. Show that the limit of a projective system of orderable groups is or-
derable.

8.30. A group G is called bi-orderable if it admits a total ordering ≤ which
is both left and right invariant, i.e., such that g1 ≤ g2 implies gg1 ≤ gg2 and
g1 g ≤ g2 g for all g, g1 , g2 ∈ G. Let G be a bi-orderable group. Suppose that
an element g ∈ G satisﬁes the following property: there exist an integer n ≥ 1
and elements h1 , h2 , · · · , hn ∈ G such that

                       h1 gh−1     −1           −1
                            1 h2 gh2 · · · hn ghn = 1G .

Show that g = 1G .

8.31. Let G be a bi-orderable group. Show that if g, h ∈ G are such that
g n = hn for some integer n ≥ 1, then g = h.

8.32. The Klein bottle group is the group K given by the presentation K =
x, y; xyx−1 y. Thus, K is the quotient group K = F/N , where F is the free
342                                                8 Linear Cellular Automata

group based on x and y, and N is the normal closure of xyx−1 y in F . Let
ρ : F → K denote the quotient homomorphism.
    (a) Let H denote the subgroup of K generated by ρ(y). Show that H is
normal in K and that H and K/H are both inﬁnite cyclic.
    (b) Show that K is an orderable group.
    (c) Show that the group K is not bi-orderable.

8.33. Let G be an amenable group, F a right Følner net for G, and V a ﬁnite-
dimensional vector space over some ﬁeld K. Let X be a vector subspace of V G
and let X denote the closure of X in V G for the prodiscrete topology. Show
that X is a vector subspace of V G and that one has mdimF (X) = mdimF (X).
Appendix A
Nets and the Tychonoﬀ Product
Theorem




A.1 Directed Sets

Recall that a partially ordered set is a set I equipped with a binary relation
≤ which is both reﬂexive (i ≤ i for all i ∈ I) and transitive (i ≤ j and j ≤ k
implies i ≤ k for all i, j, k ∈ I).
   A directed set is a partially ordered set I which satisﬁes the following
condition: for all i, j ∈ I, there exists an element k ∈ I such that i ≤ k and
j ≤ k.

Examples A.1.1. (a) The set Z equipped with the relation ≤ deﬁned by

                              i ≤ j ⇐⇒ i divides j

is a directed set.
   (b) If E is an arbitrary set, then the set P(E) of all subsets of E is a
directed set for inclusion.
   (c)) If X is a topological space and x is a point of X, then the set of
neighborhoods of x, equipped with the relation ≤ deﬁned by

                              V ≤ W ⇐⇒ W ⊂ V,

is a directed set. Indeed, if V and W are neighborhoods of x, then V ∩ W is
a neighborhood of x satisfying V ≤ V ∩ W and W ≤ V ∩ W .



A.2 Nets in Topological Spaces

Let X be a set. A net of points of X (or net in X) is a family (xi )i∈I of
points of X indexed by some directed set I.


T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,      343
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 9, © Springer-Verlag Berlin Heidelberg 2010
344                                      A Nets and the Tychonoﬀ Product Theorem

   Let (xi )i∈I and (yj )j∈J be nets in a set X indexed by directed sets I and
J respectively. One says that the net (yj ) is a subnet of the net (xi ) if there
is a map ϕ : J → I which satisﬁes the following conditions:
(SN-1) yj = xϕ(j) for all j ∈ J;
(SN-2) for each i ∈ I, there exists j ∈ J such that if k ∈ J and j ≤ k then
       i ≤ ϕ(k).
   Let X be a topological space. Let (xi )i∈I be a net in X and let a ∈. One
says that the net (xi ) converges to a, or that a is a limit point of the net
(xi ), if the following condition is satisﬁed: for each neighborhood V of a in
X, there exists an element i0 ∈ I such that xi ∈ V for all i ≥ i0 . One says
that the net (xi ) is convergent if there exists a point a in X such that (xi )
converges to a.
   It is clear that if the net (xi ) converges to a, then every subnet of (xi ) also
converges to a.

Proposition A.2.1. Let X be a topological space, Y ⊂ X and a ∈ X. Let Y
denote the closure of Y in X. Then the following conditions are equivalent:
(a) a ∈ Y ;
(b) there exists a net (yi )i∈I of points of Y which converges to a in X.

Proof. Suppose that (yi )i∈I is a net of points of Y which converges to a.
Then, for each neighborhood V of a, there is an element i0 ∈ I such that
yi ∈ V for all i ≥ i0 . Thus, every neighborhood of a meets Y . This shows
that a ∈ Y .
   Conversely, suppose that a ∈ Y . Let I denote the directed set consisting
of all neighborhoods of a in X partially ordered by reverse inclusion, that is,

                              V ≤ W ⇐⇒ W ⊂ V.

Since a is in the closure of Y , we can ﬁnd for each neighborhood V ∈ I a
point yV in Y such that yV ∈ V . It is clear that the net (yV )V ∈I converges
to a.

Proposition A.2.2. A topological space X is Hausdorﬀ if and only if every
convergent net in X admits a unique limit.

Proof. Suppose that X is Hausdorﬀ. Consider a net (xi )i∈I in X which con-
verges to some point a ∈ X. Let b be a point in X with a = b. Since X is
Hausdorﬀ, there exist a neighborhood V of a and a neighborhood W of b
such that V ∩ W . For i large enough, the point xi is in V and therefore not in
W . Therefore the net (xi )i∈I does not converge to b. This shows that every
convergent net in X has a unique limit.
   Suppose now that X is not Hausdorﬀ. Then there exist distinct points a
and b in X such that each neighborhood of a meets each neighborhood of b.
Consider the set I consisting of all pairs (V, W ), where V is a neighborhood of
A.2 Nets in Topological Spaces                                                   345

a and W is a neighborhood of b. partially ordered by declaring that (V  , W  ) ≤
(V, W ) if and only if V ⊂ V  and W ⊂ W  . Clearly I is a directed set. If we
choose, for each i = (V, W ) ∈ I a point xi ∈ V ∩ W , then the net (xi )i∈I
admits both points a and b as limits. This proves the converse implication.


   Let (xi )i∈I be a net in a topological space X. One says that a point a ∈ X
is a cluster point of the net (xi ) if it satisﬁes the following condition: for each
neighborhood V of a in X and each i ∈ I, there exists an element j ∈ I such
that i ≤ j and xj ∈ V .

Proposition A.2.3. Let X be a topological space, (xi )i∈I a net in X, and
a ∈ X. Then the following conditions are equivalent:
(a) the point a is a cluster point of the net (xi );
(b) the net (xi ) admits a subnet converging to a.

Proof. Suppose that (yj )j∈J is a subnet of the net (xi )i∈I converging to a.
Let ϕ : J → I be a map satisfying conditions (SN-1) and (SN-2) above.
Consider a neighborhood V of a and an element i0 ∈ I. By (SN-2), we may
ﬁnd j0 ∈ J such that i0 ≤ ϕ(k) for all k ∈ J satisfying j0 ≤ k. Since the net
(yj ) converges to a, there exists k0 ∈ J such that j0 ≤ k0 and yk0 ∈ V . Then
we have i0 ≤ ϕ(k0 ) and xϕ(k0 ) = yk0 ∈ V . This shows that a is a cluster
point for the net (xi ). Thus (b) implies (a).
    Conversely, suppose that a is a cluster point for the net (xi ). Denote by
Na the set of all neighborhoods of a, partially ordered by reverse inclusion.
Let J be the subset of the Cartesian product I × Na consisting of all pairs
(i, V ) ∈ I × Na such that xi ∈ V . The fact that a is a cluster point of the net
(xi ) implies that J is a directed set for the partial ordering ≤ deﬁned by
                                      def
                  (i, V ) ≤ (i , V  ) ⇐⇒ (i ≤ i and V ≤ V  ).

Consider the non decreasing map ϕ : J → I given by ϕ((i, V )) = i. If we set
yj = xϕ(j) for all j ∈ J, it is clear that ϕ satisﬁes conditions (SN-1) and
(SN-2) above and that the net (yj )j∈J converges to a. This shows that (a)
implies (b).

   Note that if f : X → Y is a continuous map between topological spaces and
a ∈ X is a limit (resp. cluster) point of the net (xi ), then f (a) is a limit (resp.
cluster) point of the net (f (xi ). This immediately follows from the deﬁnition
and the fact that f −1 (W ) is a neighborhood of a for each neighborhood W
of f (a).
346                                      A Nets and the Tychonoﬀ Product Theorem

A.3 Initial Topology

Let X be a set and let (Yλ )λ∈Λ be a family of topological spaces indexed
by an arbitrary set Λ. Suppose that we are given, for each λ ∈ Λ, a map
fλ : X → Yλ . Then one constructs a topology on X in the following way.
   Let F denote the set of all subsets of X of the form fλ−1 (Uλ ), where λ ∈ Λ
and Uλ is an open subset of Yλ . Let B be the set of all subsets of X which may
be written as a ﬁnite intersection of elements of F. Finally, let T denote the
set of all subsets of X which may be written as a (ﬁnite or inﬁnite) union of
elements of B. It is straightforward to verify that the set T is the set of open
sets of a topology on X which admits B as a base, and that this topology is
the smallest topology on X for which all maps fλ : X → Yλ are continuous.
The topology on X whose open sets are the elements of T is called the initial
topology on X associated with the topological spaces (Yλ )λ∈Λ and the maps
(fλ )λ∈Λ .
   If Z is a topological space and g : Z → X is a map, then g is continuous
with respect to the initial topology on X if and only if all composite maps
fλ ◦g : Z → Yλ , λ ∈ Λ, are continuous. If (xi )i∈I is a net in X and a is a point
in X, then the net (xi )i∈I converges to a if and only if the net (fλ (xi ))i∈I
converges to fλ (a) for every λ ∈ Λ. Similarly, a is a cluster point of the net
(xi )i∈I if and only if fλ (a) is a cluster point of the net (fλ (xi ))i∈I for every
λ ∈ Λ.



A.4 Product Topology

Let (Xλ )λ∈Λ be a family of topological spaces
                                           indexed by a set Λ. The initial
topology on the cartesian product X = λ∈Λ Xλ associated with the pro-
jection maps πλ : X → Xλ is called the product topology on X. Abase for
the product topology on X consists of all subsets of the form V = λ∈Λ Uλ ,
where Uλ is an open subset of Xλ for each λ ∈ Λ and Uλ = Xλ for all but
ﬁnitely many λ ∈ Λ.
                       Xλ is endowed with the discrete topology, the prod-
   In the case when each
uct topology on X = λ∈Λ Xλ is called the prodiscrete topology.

          A.4.1. Let (Xλ )λ∈Λ be a family of Hausdorﬀ topological spaces.
Proposition
Then X = λ∈Λ Xλ is Hausdorﬀ for the product topology.
Proof. Let x = (xλ ) and y = (yλ ) be distinct points of X. Then there exists
λ0 ∈ Λ such that xλ0 = yλ0 . Since Xλ0 is Hausdorﬀ, we may ﬁnd disjoint
open subsets U and V of Xλ0 containing xλ0 and yλ0 respectively. The pull-
backs of U and V by the projection map πλ0 : X → Xλ0 are disjoint open
subsets of X containing x and y respectively. Therefore X is Hausdorﬀ.
  Recall that a topological space X is called totally disconnected if any
nonempty connected subset of X is reduced to a single point.
A.5 The Tychonoﬀ Product Theorem                                            347

Proposition A.4.2. Let (X
                        λ )λ∈Λ be a family of totally disconnected topo-
logical spaces. Then X = λ∈Λ Xλ is totally disconnected for the product
topology.

Proof. Let C be a nonempty connected subset of X. Then, for each λ ∈ Λ,
the image of C by the projection map πλ : X → Xλ is a nonempty connected
subset of Xλ . Since Xλ is totally disconnected, the set πλ (C) is reduced to a
single point for every λ ∈ Λ. This implies that C is reduced to a single point.
Therefore, X is totally disconnected.

Proposition A.4.3. Let (Xλ )λ∈Λ be a family of topological spaces.
                                                                  Suppose
that Fλ is a closed subset
                          of X λ for each λ ∈ Λ. Then F  =    λ∈Λ Fλ is a
closed subset of X = λ∈Λ Xλ for the product topology.

Proof. We have                      
                              F =         πλ−1 (Fλ ).
                                    λ∈Λ

Thus F is closed in X as it is the intersection of a family of closed subsets
of X.



A.5 The Tychonoﬀ Product Theorem

Recall that a topological space X is called compact if every open cover of
X admits a ﬁnite subcover.
                           This means that if (Uα )α∈A is a family of open
subsets of X
             with X =   α∈A Uα , then there exists a ﬁnite subset B ⊂ A such
that X = α∈B Uα . By taking complements, one sees that the compactness
of X is equivalent to the fact that every family (F  α )α∈A of closed subsets
of X with the ﬁnite intersection property,, that is, α∈B Fα = ∅ for every
ﬁnite subset B ⊂ A, has a nonempty intersection.
   It is well known that a metric space X is compact if and only if every
sequence in X admits a convergent subsequence. There is an analogous char-
acterization of compactness for general topological spaces using nets:

Theorem A.5.1. Let X be a topological space. Then the following conditions
are equivalent:
(a) X is compact;
(b) every net in X admits a cluster point;
(c) every net in X admits a convergent subnet.

Proof. The equivalence between conditions (b) and (c) follows from Proposi-
tion A.2.3. Thus, it suﬃces to prove that conditions (a) and (b) are equivalent.
   Suppose ﬁrst that X is compact. Let (xi )i∈I be a net in X. For each i ∈ I,
deﬁne the subset Yi ⊂ X by
348                                        A Nets and the Tychonoﬀ Product Theorem

                           Yi = {xj : j ∈ I and i ≤ j}.

Let J be a ﬁnite subset of I. Since I is a directed set, we may ﬁnd an element
k ∈I   such that  i ≤ k for all i ∈ J. This implies xk ∈ Yi for all i ∈ J and
hence i∈J Yi ⊃ i∈J Yi = ∅. It follows that the family of closed sets (Yi )i∈I
has
 the ﬁnite intersection property.    By compactness of X, we deduce that
  i∈I Yi 
         =   ∅. Let  a be a point in   i∈I Yi . Then, any neighborhood of a meets
Yi for all i ∈ I. This means that a is a cluster point of the net (xi ). Therefore,
(a) implies (b).
   Conversely, suppose that every net in X admits a cluster point. Let
(Fα )α∈A be a family of closed subsets of X with the ﬁnite intersection prop-
erty. Consider the directed set E consisting of all ﬁnite subsets of  A partially
ordered by inclusion. Choose, for each E ∈ E, an element xE ∈ α∈E Fα . By
our hypothesis, the net (xE )E∈E admits a cluster point a ∈ X. Let α0 ∈ A.
If V is a neighborhood of a, then there exists    a ﬁnite set E0 ⊂ A such that
{α0 } ⊂ E0 and xE0 ∈ V . Since xE0 ∈ α∈E0 Fα ⊂ Fα0 , it follows that
any neighborhood of a meets Fα0 . Since the set Fα0 is closed, we deduce     that
a ∈ Fα0 . As α0 was   an arbitrary element   in A, we conclude that a ∈   α∈A Fα .
This shows that i∈I Fi = ∅. Consequently, the space X is compact. This
proves that (b) implies (a).
Theorem A.5.2 (Tychonoﬀ theorem).       Let (Xλ )λ∈Λ be a family of com-
pact topological spaces. Then X = λ∈Λ Xλ is compact for the product topol-
ogy.
Proof. By Theorem A.5.1, it suﬃces to prove that every net in X admits a
cluster point. Let (xi ) be net in X. We shall prove that (xi ) admits a cluster
point by applying Zorn’s Lemma.Let us ﬁrst introduce some notation. Given
a subset A ⊂ Λ, we set X(A) = λ∈A Xλ and equip X(A) with the product
topology. If A and B are subsets of Λ such that A ⊂ B, we denote by πA               B

the projection map X(B) → X(A). Consider the set E consisting of all pairs
(A, a), where A is a subset of Λ and a ∈ X(A) is a cluster point of the net
(πAΛ
     (xi ))i∈I . We partially order E by declaring that two elements (A, a) and
(B, b) satisfy (A, a) ≤ (B, b) if and only if A ⊂ B and πA      B
                                                                  (b) = a. The set E is
not empty since it contains the pair (A, a), where A = ∅ and a is the unique
element of X(∅). On the other hand, E isinductive. Indeed, suppose that F
is a totally ordered subset of E. Let B = (A,a)∈F A and consider the unique
element b ∈ X(B) such that πA       B
                                      (b) = a for all (A, a) ∈ F. Clearly (B, b) ∈ E
and (B, b) is an upper bound for F. By applying Zorn’s Lemma, we deduce
that E admits a maximal element (M, m). To prove that the net (xi ) admits
a cluster point, it suﬃces to show that M = Λ. Suppose not and choose an
element λ0 ∈ Λ\M . Since the space Xλ0 is compact, the net (πλ0 (xi )) admits
a cluster point a0 ∈ Xλ0 . Let us set M  = M ∪ {λ0 } and consider the element
                              M                     M
m ∈ X(M  ) deﬁned by πM         (m ) = m and π{λ    0}
                                                          (m ) = a0 . Clearly m is a
                                                                  
                                  (xi )) and (M, m) ≤ (M , m ). This contradicts
                               Λ
cluster point of the net (πM
the maximality of (M, m) and completes the proof.
Notes                                                                     349

  It follows from the deﬁnition of compactness that if a topological space X
has only ﬁnitely many open subsets, then X is compact. In particular, every
ﬁnite topological space is compact. Therefore, an immediate consequence of
Tychonoﬀ theorem is the following:

Corollary A.5.3 (Tychonoﬀtheorem). Let (Xλ )λ∈Λ be a family of ﬁnite
topological spaces. Then X = λ∈Λ Xλ is compact for the product topology.




Notes

The original Tychonoﬀ theorem was only stated for product of compact in-
tervals. The proof of the general Tychonoﬀ theorem we have presented here
is based on the one given by P. Chernoﬀ in [Che]. Three other proofs may
be found in Kelley’s book [Kel]: a proof using Alexander’s subbase theo-
rem, Bourbaki’s proof [Bou] using ultraﬁlters, and a proof based on universal
nets. There is also another proof using non-standard analysis in the book of
A. Robinson [RobA].
Appendix B
Uniform Structures




B.1 Uniform Spaces

Let X be a set. We shall use the following notation. We denote by ΔX the
diagonal in X × X, that is,

                       ΔX = {(x, x) : x ∈ X} ⊂ X × X.

Suppose that R is a subset of X × X (in other words, R is a binary relation
on X). For y ∈ X, we deﬁne the set R[y] ⊂ X by

                          R[y] = {x ∈ X : (x, y) ∈ R}.
              −1
The inverse R ⊂ X × X of R is deﬁned by
                              −1
                              R = {(x, y) : (y, x) ∈ R}.
                                                −1
One says that R is symmetric if it satisﬁes R = R.
   If R and S are subsets of X × X, we deﬁne their composite R ◦ S ⊂ X × X
by

 R ◦ S = {(x, y) : there exists z ∈ X such that (x, z) ∈ R and (z, y) ∈ S}.

Deﬁnition B.1.1. Let X be a set. A uniform structure on X is a non–empty
set U of subsets of X × X satisfying the following conditions:
(UN-1) if V ∈ U, then ΔX ⊂ V ;
(UN-2) if V ∈ U and V ⊂ V  ⊂ X × X, then V  ∈ U;
(UN-3) if V ∈ U and W ∈ U, then V ∩ W ∈ U;
                         −1
(UN-4) if V ∈ U, then V ∈ U;
(UN-5) if V ∈ U, then there exists W ∈ U such that W ◦ W ⊂ V .

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,       351
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 10, © Springer-Verlag Berlin Heidelberg 2010
352                                                         B Uniform Structures

  A set X equipped with a uniform structure U is called a uniform space
and the elements of U are called the entourages of X (see Fig. B.1).




Fig. B.1 An entourage in a uniform space X



Examples B.1.2. (a) Let X be a set. Then U = {X ×X} is a uniform structure
on X. This uniform structure is called the trivial uniform structure on X. It
is the smallest uniform structure on X.
   (b) The discrete uniform structure on a set X is the uniform structure
whose entourages consist of all subsets of X × X containing ΔX . This is
the largest uniform structure on X. It follows from (UN-2) that the discrete
uniform structure on X is the only uniform structure on X admitting the
diagonal ΔX ⊂ X × X as an entourage.
   (c) Suppose that d is a metric on X. For each ε > 0 let Vε ⊂ X × X denote
the set of pairs (x, y) such that d(x, y) < ε. Let U be the set of all subsets
W ⊂ X × X such that one can ﬁnd ε > 0 for which Vε ⊂ W . Then U is a
uniform structure on X which is called the uniform structure associated with
the metric d.

  A uniform structure U on a set X is said to be metrizable if U is the
uniform structure on X associated with some metric on X.

Example B.1.3. If d is the discrete metric on a set X, that is, the metric given
by d(x, y) = 0 if x = y and d(x, y) = 1 otherwise, then the uniform structure
deﬁned by d is the discrete uniform structure on X. Thus the discrete uniform
structure on X is metrizable.

   Let X be a uniform space. One easily veriﬁes that is possible to deﬁne a
topology on X by taking as open sets the subsets Ω ⊂ X which satisfy the
following property: for each x ∈ Ω, there exists an entourage V ⊂ X × X
such that V [x] = Ω. One says that this topology is the topology associated
with the uniform structure on X. A subset N ⊂ X is a neighborhood of a
point x ∈ X for this topology if and only if there exists an entourage V such
B.2 Uniformly Continuous Maps                                              353

that N = V [x]. This topology is Hausdorﬀ if and only if the intersection of
the entourages of X coincides with the diagonal ΔX ⊂ X × X.

Examples B.1.4. (a) The topology associated with the discrete uniform struc-
ture on a set X is the discrete topology on X (every subset is open).
   (b) If U is the uniform structure associated with a metric d on a set X,
then the topology deﬁned by U coincides with the topology deﬁned by d.

   Let U be a uniform structure on a set X.
   If Y is a subset of X, then UY = {V ∩ (Y × Y ) : V ∈ U} is a uniform struc-
ture on Y , which is said to be induced by U. The topology on Y associated
with UY is the topology induced by the topology on X associated with U.
   A subset B ⊂ U is called a base of U if for each W ∈ U there exists V ∈ B
such that V ⊂ W .

Example B.1.5. If d is a metric on X, then B = {Vε : ε > 0}, where Vε =
{(x, y) ∈ X × X : d(x, y) < ε}, is a base for the uniform structure on X
associated with d.

  The proof of the following statement is straightforward.

Proposition B.1.6. Let X be a set and let B be a nonempty set of subsets
of X × X. Then B is a base for some (necessarily unique) uniform structure
on X if and only if it satisﬁes the following properties:
(BU-1) if V ∈ B, then ΔX ⊂ V ;
(BU-2) if V ∈ B and W ∈ B, then there exists U ∈ B such that U ⊂ V ∩ W ;
                                                           −1
(BU-3) if V ∈ B, then there exists W ∈ B such that W ⊂ V ;
(BU-4) if V ∈ B, then there exists W ∈ B such that W ◦ W ⊂ V .




B.2 Uniformly Continuous Maps

Let X and Y be uniform spaces. A map f : X → Y is called uniformly
continuous if it satisﬁes the following condition: for each entourage W of Y ,
there exists an entourage V of X such that (f ×f )(V ) ⊂ W . Here f ×f denotes
the map from X × X into Y × Y deﬁned by (f × f )(x1 , x2 ) = (f (x1 ), f (x2 ))
for all (x1 , x2 ) ∈ X × X.
   If B (resp. B  ) is a base of the uniform structure on X (resp. Y ), then a
map f : X → Y is uniformly continuous if and only if it satisﬁes the following
condition: for each W ∈ B  , there exists V ∈ B such that (f × f )(V ) ⊂ W .
Note that this condition is equivalent to the fact that (f × f )−1 (W ) is an
entourage of Y for each entourage W of X.
354                                                         B Uniform Structures

Example B.2.1. Let (X, dX ) and (Y, dY ) be metric spaces. Then a map
f : X → Y is uniformly continuous if and only if it satisﬁes the following
condition: for each ε > 0, there exists δ > 0 such that dX (x1 , x2 ) < δ implies
dY (f (x1 ), f (x2 )) < ε.

Proposition B.2.2. Let X and Y be uniform spaces. Then every uniformly
continuous map f : X → Y is continuous (with respect to the topologies on
X and Y associated with the uniform structures).

Proof. Suppose that f : X → Y is uniformly continuous. Let x ∈ X and let
N ⊂ Y be a neighborhood of f (x). Then there exists an entourage W of
Y such that W [f (x)] = N . Since f is uniformly continuous, the set V =
(f × f )−1 (W ) is an entourage of X. The set V [x] is a neighborhood of x and
satisﬁes f (V [x]) ⊂ W [f (x)] = N . This shows that f is continuous.

   A continuous map between uniform spaces may fail to be uniformly con-
tinuous. For example, the map x → x2 is not uniformly continuous on R
(equipped with the uniform structure associated with its usual metric). How-
ever, this is true when the source space is compact:

Theorem B.2.3. Let X and Y be uniform spaces and suppose that X is
compact. Then every continuous map f : X → Y is uniformly continuous.

  Let us ﬁrst establish the following:

Lemma B.2.4 (Lebesgue lemma). Let (Ωi )i∈I be an open cover of a com-
pact uniform space X. Then there exists an entourage Λ of X satisfying the
following property: for each x ∈ X, there exists an index i ∈ I such that
Λ[x] ⊂ Ωi .

Proof. Let us choose, for each x ∈ X, an index i(x) ∈ I such that x ∈ Ωi(x) .
Since Ωi(x) is a neighborhood of x, there is an entourage Vx such that Vx [x] =
Ωi(x) . By (UN-5), we may ﬁnd an entourage Wx such that Wx ◦ Wx ⊂ Vx .
The set Wx [x] is a neighborhood of x for each x ∈ X. By compactness of X,
there exists a ﬁnite subset A ⊂ X such that X = a∈A Wa [a]. Let us show
that the entourage                     
                                 Λ=        Wa
                                       a∈A

has the required property. Let x ∈ X. Choose a point a ∈ A such that
x ∈ Wa [a]. Suppose that y ∈ Λ[x]. Since (x, a) ∈ Wa and (y, x) ∈ Λ ⊂ Wa ,
we have (y, a) ∈ Wa ◦ Wa ⊂ Va . Thus y ∈ Va [a]. Since Va [a] ⊂ Ωi(a) , this
shows that Λ[x] ⊂ Ωi(a) .

Proof of Theorem B.2.3. Let f : X → Y be a continuous map and let W be
an entourage of Y . By (UN-3), (UN-4), and (UN-5), we may ﬁnd a symmetric
entourage S of Y such that S ◦ S ⊂ W . Since f is continuous, there exists,
for each x ∈ X, an open neighborhood Ωx of X such that f (Ωx ) ⊂ S[f (x)].
B.3 Product of Uniform Spaces                                                    355

By Lemma B.2.4, we may ﬁnd an entourage Λ of X such that, for each
y ∈ X, there exists x ∈ X such that Λ[y] ⊂ Ωx . Suppose that (x1 , x2 ) ∈ Λ.
Choose a ∈ X such that Λ[x2 ] ⊂ Ωa . Since x1 and x2 are in Λ[x2 ], we deduce
that the points f (x1 ) and f (x2 ) are in S[f (a)]. It follows that (f (x1 ), f (a))
and (f (a), f (x2 )) are in S, and hence (f (x1 ), f (x2 )) ∈ S ◦ S ⊂ W . Thus
(f × f )(Λ) ⊂ W . This shows that f is uniformly continuous.

  Let X and Y be uniform spaces.
  One says that a map f : X → Y is a uniform isomorphism if f is bijective
and both f and f −1 are uniformly continuous.
  One says that a map f : X → Y is a uniform embedding if f is injective
and induces a uniform isomorphism between X and f (X) ⊂ Y .

Proposition B.2.5. Let X and Y be uniform spaces with X compact and Y
Hausdorﬀ. Suppose that f : X → Y is a continuous injective map. Then f is
a uniform embedding.

Proof. As X is compact and Y is Hausdorﬀ, f induces a homeomorphism
from X onto f (X). This homeomorphism is a uniform isomorphism by The-
orem B.2.3.



B.3 Product of Uniform Spaces

Let X be a set. Suppose that we are given a family (Xλ )λ∈Λ of uniform
spaces and a family (fλ )λ∈Λ of maps fλ : X → Xλ . Then the initial uniform
structure associated with these data is the smallest uniform structure on X
such that all maps fλ : X → Xλ , λ ∈ Λ, are uniformly continuous.
   In the particular case when X = λ∈Λ Xλ and fλ : X → Xλ is the projec-
tion map, the associated initial uniform structure on X is called the product
uniform structure. A base of entourages for the product uniform structure
on X is obtained by taking all subsets of X × X which are of the form
                               
                          Vλ ⊂      Xλ × Xλ
                       λ∈Λ          λ∈Λ
                                                                   
                                                            
                                =           Xλ       ×           Xλ
                                     λ∈Λ                 λ∈Λ
                                = X × X,

where Vλ ⊂ Xλ × Xλ is an entourage of Xλ and Vλ = Xλ × Xλ for all but
ﬁnitely many λ ∈ Λ.
   When each Xλ is endowed with
                              the discrete uniform structure, the prod-
uct uniform structure on X = λ∈Λ Xλ is called the prodiscrete uniform
structure.
356                                                       B Uniform Structures

B.4 The Hausdorﬀ-Bourbaki Uniform Structure
    on Subsets

Let X be a uniform space with uniform structure U. In this section, we
construct a uniform structure on the set P(X) of all subsets of X.
  We shall use the following notation. Suppose that R is a subset of X × X.
Given a subset Y ⊂ X, we set
                !
       R[Y ] =     R[y] = {x ∈ X : (x, y) ∈ R for some y ∈ Y },       (B.1)
               y∈Y


and we deﬁne the subset R ⊂ P(X) × P(X) by

      R = {(Y, Z) ∈ P(X) × P(X) : Y ⊂ R[Z] and Z ⊂ R[Y ]} .             (B.2)

Proposition B.4.1. The set {V : V ∈ U} is a base for a uniform structure
on P(X).
Proof. Let us check that the conditions of Proposition B.1.6 are satisﬁed.
Property (BU-1) follows from the fact that we have Y ⊂ V [Y ] for all Y ∈
P(X) and V ∈ U since ΔX ⊂ V . Then observe that

(V ∩ W )[Y ] = {x ∈ X : (x, y) ∈ V ∩ W for some y ∈ Y }
            ⊂ {x ∈ X : (x, yV ) ∈ V and (x, yW ) ∈ W for some yV , yW ∈ Y }
            = V [Y ] ∩ W [Y ],

for all V, W ∈ U and Y ⊂ X. Therefore we have V ∩ W ⊂ V ∩ W         " for all
V, W ∈ U, so that (BU-2) is satisﬁed. Property (BU-3) follows from the fact
that the set V is a symmetric subset of P(X)×P(X) for each V ∈ U. Finally,
let us verify (BU-4). Let V ∈ U and take W ∈ U such that W ◦ W ⊂ V . We
claim that W "◦W " ⊂ V . To see this, let (Y, Z) ∈ W
                                                   "◦W   " . This means that
                                            "
there exists T ∈ P(X) such that (Y, T ) ∈ W and (T, Z) ∈ W   " . In particular
we have Y ⊂ W [T ] and T ⊂ W [Z]. Thus, given y ∈ Y , there exist t ∈ T and
z ∈ Z such that (y, t) ∈ W and (t, z) ∈ W . We have (y, z) ∈ W ◦W ⊂ V . This
shows that Y ⊂ V [Z]. Similarly, we get Z ⊂ V [Y ] by using Z ⊂ W [T ] and
T ⊂ W [Y ]. We deduce that (Y, Z) ∈ V . This proves the claim. Consequently,
(BU-4) is satisﬁed.
   The uniform structure on P(X) admitting {V : V ∈ U} as a base is called
the Hausdorﬀ-Bourbaki uniform structure on P(X) and the topology asso-
ciated with this uniform structure is called the Hausdorﬀ-Bourbaki topology
on P(X).
Remarks B.4.2. (a) The empty set is an isolated point in P(X).
   (b) One easily checks that the map i : X → P(X) deﬁned by i(x) = {x}
is a uniform embedding.
B.4 The Hausdorﬀ-Bourbaki Uniform Structure on Subsets                    357

Proposition B.4.3. Let X be a uniform space. Let Y and Z be closed subsets
of X. Suppose that there is a net (Ti )i∈I of subsets of X which converges to
both Y and Z with respect to the Hausdorﬀ-Bourbaki topology on P(X). Then
one has Y = Z.

Proof. Let y ∈ Y and let Ω be a neighborhood of y in X. Then there is a
symmetric entourage V of X such that V [y] ⊂ Ω. Choose an entourage W
of X such that W ◦ W ⊂ V . Since the net (Ti )i∈I converges to both Y and
Z, we can ﬁnd an element i0 ∈ I such that ⊂ W [Ti0 ] and Ti0 ⊂ W [Z]. Thus,
there exist t ∈ Ti0 and z ∈ Z such that (y, t) ∈ W and (t, z) ∈ W . This
implies (y, z) ∈ W ◦ W ⊂ V . As V is symmetric, it follows that (z, y) ∈ V
and hence z ∈ V [y] ⊂ Ω. This shows that y is in the closure of Z. Since Z
is closed in X, we deduce that Y ⊂ Z. By symmetry, we also have Z ⊂ Y .
Consequently, Y = Z.

   By using Proposition A.2.2, we immediately deduce from Proposition B.4.3
the following:

Corollary B.4.4. Let X be a uniform space. Then the topology induced by
the Hausdorﬀ-Bourbaki topology on the set of closed subsets of X is Haus-
dorﬀ.

Remark B.4.5. Suppose that (X, d) is a metric space and let Cb (X) denote
the set consisting of all closed bounded subsets of X. For x ∈ X and r > 0,
denote by B(x, r) the open ball of radius r centered at x. Then it is not
diﬃcult to verify that the map δ : Cb (X) × Cb (X) → R deﬁned by
                                    !                   !
         δ(Y, Z) = inf{r > 0 : Z ⊂      B(y, r) and Y ⊂     B(z, r)}
                                    y∈Y                  z∈Z

is a metric on Cb (X) and that the uniform structure associated with δ is the
uniform structure induced by the Hausdorﬀ-Bourbaki structure on the set of
subsets of X. The metric δ is called the Hausdorﬀ metric on Cb (X).

Proposition B.4.6. Let X and Y be uniform spaces and let f : X → Y be
a uniformly continuous map. Then the map f∗ : P(X) → P(Y ) which sends
each subset A ⊂ X to its image f (A) ⊂ Y is uniformly continuous with
respect to the Hausdorﬀ-Bourbaki uniform structures on P(X) and P(Y ).

Proof. Let W be an entourage of Y and let
      " = {(B1 , B2 ) ∈ P(Y ) × P(Y ) : B2 ⊂ W [B1 ] and B1 ⊂ W [B2 ]}
      W

be the associated entourage of P(Y ). Since f is uniformly continuous, there
is an entourage V of X such that

                               (f × f )(V ) ⊂ W.
358                                                          B Uniform Structures

Suppose that (A1 , A2 ) ∈ V , that is, A2 ⊂ V [A1 ] and A1 ⊂ V [A2 ]. If a1 ∈ A1 ,
then there exists a2 ∈ A2 such that (a1 , a2 ) ∈ V and hence (f (a1 ), f (a2 )) ∈
W . Therefore, we have f∗ (A1 ) ⊂ W [f∗ (A2 )]. Similarly, we get f∗ (A2 ) ⊂
                                                     " . This shows that (f∗ ×
W [f∗ (A1 )]. It follows that (f∗ (A1 ), f∗ (A2 )) ∈ W
           " . Consequently, f∗ is uniformly continuous.
f∗ )(V ) ⊂ W



Notes

Uniform structures were introduced by André Weil [Weil]. The reader is re-
ferred to [Bou, Ch. 2], [Kel, Ch. 6], and [Jam] for a detailed exposition of
the general theory of uniform spaces. The Hausdorﬀ-Bourbaki uniform struc-
ture on the set of subsets of a uniform space was introduced in exercises by
Bourbaki (see [Bou, ch. II exerc. 5 p. 34 and exerc. 6 p. 36]).
Appendix C
Symmetric Groups




C.1 The Symmetric Group

Let X be a set. A permutation of X is a bijective map σ : X → X. Let Sym(X)
denote the set of all permutations of X. We equip Sym(X) with a group
structure by deﬁning the product σ1 σ2 of two elements σ1 , σ2 ∈ Sym(X)
as the composite map σ1 ◦ σ2 . The associative property follows from the
associativity of the composition of maps. The identity map IdX : X → X is
the identity element and the inverse of σ ∈ Sym(X) is the inverse map σ −1 .
The group Sym(X) is called the symmetric group on X.

Remark C.1.1. Suppose that f : X → Y is a bijection from a set X onto a
set Y . Then the map f∗ : Sym(X) → Sym(Y ) deﬁned by f∗ (σ) = f ◦ σ ◦ f −1
is a group isomorphism. As a consequence, symmetric groups on equipotent
sets are isomorphic.

Theorem C.1.2 (Cayley’s theorem). Every group G is isomorphic to a
subgroup of Sym(G).

Proof. Let G be a group. Given g ∈ G denote by Lg : G → G the left multi-
plication by g, that is, the map deﬁned by Lg (h) = gh for all h ∈ G. Observe
that Lg ∈ Sym(G). Indeed, Lg is bijective since, given h, h ∈ G, we have
Lg (h) = h if and only if h = g −1 h . Let us show that the map

                                 L : G → Sym(G)
                                     g → Lg

is a group homomorphism. Given g, g  , h ∈ G we have Lgg (h) = gg  h =
Lg (g  h) = Lg (Lg (h)) which shows that Lgg = Lg Lg . Moreover, L is injec-
tive. Indeed, if g ∈ ker(L), that is, Lg = IdG , we have g = g · 1G = Lg (1G ) =
1G . This shows that ker(L) = {1G }, and therefore L is injective. It follows
that G is isomorphic to L(G) ⊂ Sym(G).

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,       359
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 11, © Springer-Verlag Berlin Heidelberg 2010
360                                                           C Symmetric Groups

C.2 Permutations with Finite Support

Let X be a set. The support of a permutation σ ∈ Sym(X) is the set S(σ) ⊂ X
consisting of all x ∈ X such that σ(x) = x.

Proposition C.2.1. Let σ, τ ∈ Sym(X). Then
  (i) σ(S(σ)) = S(σ);
 (ii) S(σ) = S(σ −1 );
(iii) S(στ ) ⊂ S(σ) ∪ S(τ );
(iv) if S(σ) ∩ S(τ ) = ∅, then στ = τ σ;
 (v) S(τ στ −1 ) = τ (S(σ)).

Proof. (i) Let x ∈ X. Then, x ∈ S(σ), that is, σ(x) = x, if and only if
σ(σ(x)) = σ(x), that is, σ(x) ∈ S(σ).
   (ii) This follows from the fact that σ(x) = x if and only if x = σ −1 (x).
   (iii) Suppose that x ∈ X \ (S(σ) ∪ S(τ )). Then σ(x) = x = τ (x) and
therefore (στ )(x) = σ(τ (x)) = σ(x) = x. It follows that x ∈  / S(στ ).
   (iv) Let x ∈ X. Suppose ﬁrst that x ∈ X \ (S(σ) ∪ S(τ )). Then, by (iii),
x∈ / S(στ ) and x ∈ / S(τ σ), so that σ(τ (x)) = x = τ (σ(x)). Suppose now that
x is in the support of one of the two permutations, say x ∈ S(σ). It then
follows from our assumptions that x ∈     / S(τ ) and therefore τ (x) = x. Also,
by (i), σ(x) ∈ S(σ) and therefore, again by our assumptions, σ(x) ∈    / S(τ ), so
that τ (σ(x)) = σ(x). We thus have τ (σ(x)) = σ(x) = σ(τ (x)). It follows that
στ = τ σ.
   (v) Let x ∈ X. Then, x ∈ S(σ), that is σ(x) = x, if and only if,
(τ στ −1 )(τ (x)) = τ (σ(x)) is not equal to τ (x). Thus, x ∈ S(σ) if and only if
τ (x) ∈ S(τ στ −1 ).

   Let Sym0 (X) denote the subset of Sym(X) consisting of all permutations
of X with ﬁnite support.

Proposition C.2.2. Let X be a set. Then the set Sym0 (X) is a normal
subgroup of Sym(X).

Proof. The support of the identity map IdX is the empty set and therefore
IdX ∈ Sym0 (X). By Proposition C.2.1(ii), if σ ∈ Sym0 (X) then σ −1 ∈
Sym0 (X). On the other hand, by Proposition C.2.1(iii), the set Sym0 (X) is
closed under multiplication. Thus Sym0 (X) is a subgroup of Sym(X). Finally,
from Proposition C.2.1(v) we deduce that if σ ∈ Sym0 (X) then τ στ −1 ∈
Sym0 (X) for all τ ∈ Sym(X). It follows that Sym0 (X) is a normal subgroup
of Sym(X).

  Let r ≥ 2 be an integer and let x1 , x2 , . . . , xr be distinct elements in X.
We denote by
                           γ = (x1 x2 · · · xr )
C.2 Permutations with Finite Support                                                   361

the permutation of X that maps x1 to x2 , x2 to x3 , . . . , xr−1 to xr , xr to x1 ,
and maps each element of X \ {x1 , x2 , . . . , xr } to itself. Thus, the support
of γ is the set {x1 , x2 , . . . , xr }. One says that γ is a cycle of length r, or an
r-cycle. A 2-cycle is called a transposition. Observe that

                          γ = (x γ(x) γ 2 (x) · · · γ r−1 (x))

for all x ∈ {x1 , x2 , . . . , xr } and that the inverse of γ is the r-cycle

                             γ −1 = (xr xr−1 · · · x2 x1 ).

Proposition C.2.3. Let X be a set and let σ ∈ Sym0 (X). Then there exists
an integer n ≥ 0 and cycles γ1 , γ2 , . . . , γn with pairwise disjoint supports such
that
                                σ = γ1 γ2 · · · γn .                            (C.1)
Moreover, such a factorization is unique up to a permutation of the factors.

Proof. If σ = IdX then n = 0 and there is nothing to prove.
   Suppose now that σ = IdX . Let S = S(σ) ⊂ X be the support of σ.
We introduce an equivalence relation on S by setting     x     ∼ y ifand only if
there exists k ∈ Z such that y = σ k (x). Let S = X1 X2 · · · Xn be the
partition of S into the equivalence classes of ∼ and let us set ri = |Xi | for
1 ≤ i ≤ n. Note that ri ≥ 2 for all i. For each i = 1, 2, . . . , n, choose a repre-
sentative xi ∈ Xi . Observe that the elements xi , σ(xi ), σ 2 (xi ), . . . , σ ri −1 (xi )
are all distinct since otherwise the class of xi would have less that ri elements.
Consider the cycle

                       γi = (xi σ(xi ) σ 2 (xi ) · · · σ ri −1 (xi )).

The support of γi is Xi . Thus, the cycles γ1 , γ2 , . . . , γn have pairwise disjoint
supports. Clearly σ = γ1 γ2 · · · γn .
   Suppose now that σ = δ1 δ2 · · · δs , where δ1 , δ2 , . . . , δs are cycles with pair-
wise disjoint supports. The supports of the cycles δi are the equivalence classes
of ∼. We deduce that s = n. Moreover, up to a permutation of the fac-
tors, we may suppose that the support of γi equals the support of δi for all
i = 1, 2, . . . , n. We have

                       γi = (xi γi (xi ) γi2 (xi ) · · · γiri −1 (xi ))
                           = (xi σ(xi ) σ 2 (xi ) · · · σ ri −1 (xi ))
                           = (xi δi (xi ) δi2 (xi ) · · · δiri −1 (xi ))
                           = δi

and this completes the proof.

Corollary C.2.4. Every permutation in Sym0 (X) can be expressed as a
product of transpositions.
362                                                                C Symmetric Groups

Proof. First observe that every cycle is a product of transpositions. Indeed,
for all distinct x1 , x2 , . . . , xr ∈ X, we have

             (x1 x2 · · · xr ) = (x1 xr )(x1 xr−1 ) · · · (x1 x3 )(x1 x2 ).    (C.2)

By applying Proposition C.2.3 we deduce that every σ ∈ Sym0 (X) is a prod-
uct of transpositions.



C.3 Conjugacy Classes in Sym0 (X)

Let G be a group and let H ⊂ G be a subgroup. We recall that two elements
h and h in H are said to be conjugate in G (resp. in H) if there exists an
element g ∈ G (resp. g ∈ H) such that h = ghg −1 . Clearly conjugacy in G
(resp. in H) deﬁnes an equivalence relation on H.
Proposition C.3.1. Let X be a set. Let γ ∈ Sym0 (X) be a cycle of length r
and let σ ∈ Sym(X). Then σγσ −1 is also a cycle of length r. More precisely,
if γ = (x1 x2 · · · xr ), then σγσ −1 equals the cycle

                             (σ(x1 ) σ(x2 ) · · · σ(xr )).                     (C.3)

Proof. First observe that, by Proposition C.2.1(v) the support of σγσ −1 is
the set {σ(x1 ), σ(x2 ), . . . , σ(xn )}. Given 1 ≤ i ≤ r, we have

                     (σγσ −1 )(σ(xi )) = (σγ)(xi ) = σ(xi+1 ),

where r + 1 = 1. It follows that σγσ −1 = (σ(x1 ) σ(x2 ) · · · σ(xr )).
   Let σ ∈ Sym0 (X). The type of σ is the sequence t(σ) = (tr )r≥2 where tr
is the number of cycles of length r in the factorization of σ as a product of
cycles with pairwise disjoint supports (cf. Proposition C.2.3).
Proposition C.3.2. Let X be a set and let σ and σ  in Sym0 (X). Then the
following conditions are equivalent:
(a) σ and σ  are conjugate in Sym0 (X);
(b) σ and σ  are conjugate in Sym(X);
(c) σ and σ  have the same type.
Proof. The implication (a) ⇒ (b) is obvious. Suppose (b). let

                                   σ = γ1 γ2 · · · γr                          (C.4)

be the factorization of σ as a product of cycles with disjoint supports and let
α ∈ Sym(X) be a permutation such that σ  = ασα−1 . From (C.4) we deduce
that σ  = (αγ1 α−1 )(αγ2 α−1 ) · · · (αγr α−1 ). It follows from Proposition C.3.1
that t(σ  ) = t(σ). This shows (b) ⇒ (c).
C.4 The Alternating Group                                                                         363

   Finally, suppose that

               σ = (x1 x2 · · · xr1 )(y1 y2 · · · yr2 ) · · · (z1 z2 · · · zr )

and
               σ  = (x1 x2 · · · xr1 )(y1 y2 · · · yr 2 ) · · · (z1 z2 · · · zr  )
are two permutations of the same type. Consider a permutation α, with
support the union of the supports of σ and σ  , which maps xi to xi for all
i = 1, 2, . . . , r1 , yj to yj , for all j = 1, 2, . . . , r2 , . . ., and zk to zk for all k =
1, 2, . . . , r . Note that α ∈ Sym0 (X). Then (cf. the proof of Proposition C.3.1)
ασα−1 = α . It follows that σ and σ  are conjugate in Sym0 (X).



C.4 The Alternating Group

Proposition C.4.1. Let X be a set and let σ ∈ Sym0 (X). Suppose that σ
can be expressed as a product of n transpositions. Then the parity of n only
depends on σ.

Proof. Suppose that σ can be expressed both as a product of an even and as
a product of an odd number of transpositions. Then, the same holds for σ −1 .
It follows that choosing an even writing for σ and an odd one for σ −1 , we
can write the identity element IdX = σσ −1 as a product of an odd number
of transpositions, say
                            IdX = τ1 τ2 · · · τ2m+1 .                 (C.5)
    Let x be an element in X appearing in the support of one of the transpo-
sitions τi in (C.5).
   As transpositions with disjoint support commute (cf. Proposition C.2.1(iv))
and (y z)(x z) = (x y)(y z) for all distinct elements y, z in X \ {x}, we can
move all transpositions of the form (x y) to the left in (C.5). In other words,
we can write the identity IdX as a product of 2m + 1 transpositions

                               IdX = τ1 τ2 · · · τr τr+1
                                                                  
                                                            · · · τ2m+1                         (C.6)

where 1 ≤ r ≤ 2m + 1 and x belongs to the support of τi if and only if
1 ≤ i ≤ r. Let τr = (x y) and observe that it cannot appear only once
in the product (C.6), otherwise the element x would be mapped onto y,
while it has to remain ﬁxed, since that product is the identity. It follows
that there exists 1 ≤ j ≤ r − 1 such that τj = τr and τi = τr for all
i = j + 1, j + 2, . . . , r − 1. Now, for all j + 1 ≤ i ≤ r − 1, if τi = (x z), we
have τi τr = (x z)(x y) = (x y)(y z) = τr (y z). Thus, we can move to the left
the transposition τr next to τj and cancel them out, without changing the
value of the product. Repeating this operation, we reduce every time by 2 the
364                                                             C Symmetric Groups

number of transpositions in (C.6). Eventually, we reach a single transposition.
This clearly yields a contradiction.

   Consider the map
                              ε : Sym0 (X) → {−1, 1}                          (C.7)
deﬁned by setting ε(σ) = 1 if σ is a product of an even number of permu-
tations and ε(σ) = −1 otherwise. Note that ε is well deﬁned by virtue of
Proposition C.4.1. It is obvious that ε is a group homomorphism. Moreover,
ε is surjective if X has at least two elements.
   The normal subgroup ker(ε) ⊂ Sym0 (X) is called the alternating group on
X and it is denoted by Sym+   0 (X).

Proposition C.4.2. Let X be a set. An r-cycle is in Sym+    0 (X) if and only
if r is odd. In particular, every 3-cycle belongs to Sym+
                                                        0 (X).

Proof. We have seen (cf. (C.2)) that and r-cycle is a product of r − 1 trans-
positions.

  Recall that a nontrivial group G is simple if the only normal subgroups of
G are the trivial subgroup {1G } and G itself.

Theorem C.4.3. Let X be a set having at least ﬁve distinct elements. Then
the group Sym+
             0 (X) is simple.

Proof. Every element of Sym+   0 (X) is a product of permutations of the form
(s t)(u v) or (s t)(s u), where s, t, u and v are distinct elements of X. Since
(s t)(u v) = (s u t)(s u v) and (s t)(s u) = (s u t), it follows that Sym+    0 (X)
is generated by the set of all 3-cycles.
   Let x and y be two distinct elements in X. Clearly, any 3-cycle is of one of
the forms (x y s), (x s y), (x s t), (y t u), or (s t u), where s, t, u are distinct
elements in X \ {x, y}. We have

      (x s y) = (x y s)2 ,
      (x s t) = (x y t)(x s y) = (x y t)(x y s)2 ,
      (y s t) = (x t y)(x y s) = (x y t)2 (x y s),
      (s t u) = (x s y)(x y u)(x t y)(x y s) = (x y s)2 (x y u)(x y t)2 (x y s).

This shows that Sym+   0 (X) is generated by the 3-cycles (x y z), where z ∈
X \ {x, y}.
  Let now N ⊂ Sym+    0 (X) be a nontrivial normal subgroup. Let us show that
N = Sym+  0 (X). We distinguish a few cases (corresponding to the diﬀerent
possible cycle structures of a nontrivial element in N ).

Case 1. N contains a 3-cycle (x y s). Then, for any z ∈ X \ {x, y, s} we have
that the 3-cycle
C.4 The Alternating Group                                                      365

  (x y z) = (x y)(s z)(x y s)2 (s z)(x y) = [(x y)(s z)]−1 (x y z)2 [(s z)(x y)]

belongs to N . From the preceding part of the proof, we deduce that N =
Sym+ 0 (x).
Case 2. N contains an element σ whose factorization as product of cycles
with disjoint supports contains a cycle (x1 x2 · · · xr ) of length r ≥ 4. Write
σ = (x1 x2 · · · xr )ρ, where ρ ∈ Sym0 (X) is the product of the remaining
cycles. Consider the cycle γ = (x1 x2 x3 ). Then, σ(γσ −1 γ −1 ) ∈ N , as N is a
normal subgroup. By Proposition C.3.1, we have

      σ(γσ −1 γ −1 ) = (σγσ −1 )γ −1 = (x2 x3 x4 )(x3 x2 x1 ) = (x1 x4 x2 ).

Thus, N contains a 3-cycle and, by Case 1, N = Sym+    0 (X).
Case 3. N contains an element σ whose factorization as a product of cycles
with disjoint supports contains at least two cycles (x1 x2 x3 ) and (x4 x5 x6 )
of length 3. Write σ = (x1 x2 x3 )(x4 x5 x6 )ρ, where ρ ∈ Sym0 (X) is the
product of the remaining cycles. Consider the cycle γ = (x1 x2 x4 ). Then, as
above, σγσ −1 γ −1 ∈ N . But, again by Proposition C.3.1, we have

            σγσ −1 γ −1 = (x2 x3 x5 )(x4 x2 x1 ) = (x1 x4 x3 x5 x2 ).

Thus, N contains a 5-cycle and by Case 2, N = Sym+  0 (X).
Case 4. N contains an element σ which factorizes as a product of one
single 3-cycle (x1 x2 x3 ) and transpositions with disjoint supports. Write
σ = (x1 x2 x3 )ρ, where ρ ∈ Sym0 (X) is the product of the transpositions.
Note that ρ2 = IdX . Then σ 2 ∈ N and

         σ 2 = (x1 x2 x3 )ρ(x1 x2 x3 )ρ = (x1 x2 x3 )2 ρ2 = (x1 x3 x2 ).

Thus, again as in Case 1, N = Sym+  0 (X).
Case 5. N contains an element σ which is the product of an (even) number
of transpositions with disjoint supports. We can write σ = (x1 x2 )(x3 x4 )ρ
where ρ ∈ Sym0 (X) satisﬁes ρ2 = IdX . Consider the cycle γ = (x1 x2 x3 ).
Then, the element π = σγσ −1 γ −1 belongs to N . By Proposition C.3.1,

          π = σγσ −1 γ −1 = (x2 x1 x4 )(x1 x3 x2 ) = (x1 x3 )(x2 x4 ).

Since X has at least ﬁve distinct elements, there exists an element y ∈ X \
{x1 , x2 , x3 , x4 }. Set δ = (x1 x3 y). Then, π(δπ −1 δ −1 ) ∈ N . But, one more
time by Proposition C.3.1,

        π(δπ −1 δ −1 ) = (πδπ −1 )δ −1 = (x3 x1 y)(y x3 x1 ) = (x1 x3 y).

We are again in Case 1, and therefore N = Sym+ 0 (X).
  In all cases, N = Sym+                              +
                        0 (X), and this shows that Sym0 (X) is simple.
366                                                             C Symmetric Groups

   Note that if X is a ﬁnite set, then Sym0 (X) = Sym(X). Given an integer
n ≥ 1, we denote by Symn the symmetric group of the set {1, 2, . . . , n}. The
group Symn is called the symmetric group of degree n. By Remark C.1.1, if
X is a ﬁnite set with |X| = n, we have Symn ∼        = Sym(X).
   The subgroup Sym+  0 ({1, 2, . . . , n}) is called the alternating group of degree
n and it is denoted by Sym+  n.

Remark C.4.4. The groups Sym+                       +
                                1 (= Sym1 ) and Sym2 are trivial groups.
   The group Sym3 = {Id{1,2,3} , (1 2 3), (1 3 2)} is cyclic of order 3 and
                     +

therefore it is a simple group.
   On the other hand, the subgroup

          K = {Id{1,2,3,4} , (1 2)(3 4), (1 3)(2 4), (1 4)(2 3)} ⊂ Sym+
                                                                      4

has index two in Sym+                                                   +
                     4 . It follows that K is a normal subgroup of Sym4 .
              +
Therefore, Sym4 is not a simple group.
  From Theorem C.4.3 we deduce that the group Sym+      n is simple for all
n ≥ 5.
Appendix D
Free Groups




D.1 Concatenation of Words

Let A be a set.
  A word on the alphabet set A is an element of the set
                                    !
                             A∗ =      An ,
                                               n∈N

where An is the Cartesian product of A with itself n times, that is, the set
consisting of all n-tuples (a1 , a2 , . . . , an ) with ak ∈ A for 1 ≤ k ≤ n. The
unique element of A0 is denoted by and is called the empty word .
    The concatenation of two words w = (a1 , a2 , . . . , am ) ∈ Am and w =
(a1 , a2 , . . . , an ) ∈ An is the word ww ∈ Am+n deﬁned by
  


                     ww = (a1 , a2 , . . . , am , a1 , a2 , . . . , an ).

We have w = w = w and (ww )w = w(w w ) for all w, w , w ∈ A∗ . Thus,
A∗ is a monoid for the concatenation product whose identity element is the
empty word .
   Observe that each word w = (a1 , a2 , . . . , an ) ∈ An may be uniquely written
as a product of elements of A = A1 , namely w = a1 a2 · · · an .



D.2 Deﬁnition and Construction of Free Groups

Deﬁnition D.2.1. A based free group is a triple (F, X, i), where F is a group,
X is a set, and i : X → F is a map from X to F satisfying the following
universal property: for every group G and any map f : X → G, there exists
a unique homomorphism φ : F → G such that f = φ ◦ i.


T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,          367
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 12, © Springer-Verlag Berlin Heidelberg 2010
368                                                                   D Free Groups

                                                F
                                        i
                                                    φ

                                    X       f
                                                G

A group F is called free if there exist a set X and a map i : X → F such that
the triple (F, X, i) is a based free group. One then says that (X, i) is a free
base for F and that F is a free group based on (X, i).
Remarks D.2.2. (a) If (F, X, i) is a based free group and α : Y → X is a
bijective map from a set Y onto X, then the triple (F, Y, i ◦ α) is also a based
free group. Indeed, if f : Y → G is a map from Y into a group G, then there
is a unique homomorphism φ : F → G such that f = φ ◦ i ◦ α, namely the
unique homomorphism φ : F → G satisfying f ◦ α−1 = φ ◦ i.
   (b) If (F, X, i) is a based free group and ψ : F → F  is an isomorphism from
F onto a group F  , then the triple (F  , X, ψ ◦ i) is a based free group. Indeed,
if f : X → G is a map from X into a group G, then there exists a unique
homomorphism φ : F  → G such that f = φ ◦ ψ ◦ i, namely the homomor-
phism given by φ = φ ◦ ψ −1 , where φ : F → G is the unique homomorphism
satisfying f = φ ◦ i.
Proposition D.2.3. Let (F, X, i) be a based free group. Then the following
hold:
  (i) the map i is injective;
 (ii) the set i(X) generates the group F ;
(iii) the triple (F, X  , i ), where X  = i(X) and i : X  → F is the inclusion
      map, is also a based free group.
Proof. (i) Let x1 and x2 be two distinct elements in X. Consider the map
f : X → Z/2Z deﬁned by f (x) = 0 if x = x2 and f (x2 ) = 1. Since (F, X, i)
is a based free group, there exists a homomorphism φ : F → Z/2Z such that
f = φ ◦ i. As f (x1 ) = f (x2 ), this implies i(x1 ) = i(x2 ). Therefore, the map i
is injective.
    (ii) Denote by H the subgroup of F generated by i(X). Consider the map
i∗ : X → H deﬁned by i∗ (x) = i(x) for all x ∈ X. Since (F, X, i) is a based
free group, there exists a homomorphism φ : F → H such that i∗ = φ ◦ i.
Consider now the inclusion map ρ : H → F . The homomorphisms IdF and
ρ ◦ φ satisfy IdF ◦i = ρ ◦ φ ◦ i. By uniqueness, we get IdF = ρ ◦ φ. This implies
that ρ is surjective, that is, H = F . Therefore, i(X) generates F .
    (iii) The fact that (F, X  , i ) is a based free group immediately follows from
Remark D.2.2(a) since i = i ◦ j −1 where j : X → X  is the bijective map
deﬁned by j(x) = i(x) for all x ∈ X.
   From Proposition D.2.3(iii), we deduce that if F is a free group then there
exists a subset X ⊂ F such that the triple (F, X, i), where i : X → F is the
inclusion map, is a based free group. Such a subset X ⊂ F is then called a
free base subset, or simply a base, for F .
D.2 Deﬁnition and Construction of Free Groups                                   369

Proposition D.2.4. Let (F, X, i) be a based free group and let Y ⊂ X. Let
K denote the subgroup of F generated by Y and let j : Y → K be the map
deﬁned by j(y) = i(y) for all y ∈ Y . Then (K, Y, j) is a based free group.
Proof. Let G be a group and let f : Y → G be a map. Let us show that there
exists a unique homomorphism φ : K → G satisfying f = φ ◦ j. Uniqueness
follows from the fact that j(Y ) = i(Y ) generates K. Choose a map f  : X → G
extending f . As (F, X, i) is a based free group, there exists a homomorphism
φ : F → G such thatf  = φ ◦ i. Then φ = φ |K : K → G satisﬁes f = φ ◦ j.
This proves that (K, Y, j) is a based free group.
   In the case when i is an inclusion map, this gives us the following:
Corollary D.2.5. Let F be a free group with base X ⊂ F . Let Y ⊂ X and
let K denote the subgroup of F generated by Y . Then K is a free group with
base Y .
Proposition D.2.6. Let (F1 , X1 , i1 ) and (F2 , X2 , i2 ) be two based free groups.
Suppose that there is a bijective map u : X1 → X2 . Then there exists a unique
group isomorphism ϕ : F1 → F2 satisfying ϕ ◦ i1 = i2 ◦ u.
                                         ϕ
                                  F1 −−−−→      F2
                                   5            5
                                   ⏐
                                i1 ⏐
                                                ⏐i
                                                ⏐2
                                 X1 −−−−→ X2
                                         u

Proof. Since (F1 , X1 , i1 ) is a based free group, there exists a unique homo-
morphism ϕ : F1 → F2 such that i2 ◦ u = ϕ ◦ i1 . It suﬃces to show that ϕ
is bijective. To see this, we now use the fact that (F2 , X2 , i2 ) is a based free
group. This implies that there exists a homomorphism ϕ : F2 → F1 such that
i1 ◦u−1 = ϕ ◦i2 . The maps IdF1 and ϕ ◦ϕ are endomorphisms of F1 satisfying
IdF1 ◦i1 = i1 and (ϕ ◦ ϕ) ◦ i1 = i1 . Since (F1 , X1 , i1 ) is a based free group,
it follows that IdF1 = ϕ ◦ ϕ by uniqueness. Similarly, we get ϕ ◦ ϕ = IdF2 .
This shows that ϕ is bijective.
Theorem D.2.7. Let X be a set. Then there exist a group F and a map
i : X → F such that the triple (F, X, i) is a based free group.
Proof. Let X  be a disjoint copy of X, that is, a set X  such that X ∩ X  = ∅
together with a bijective map γ : X → X  . Let A = X ∪ X  . For each a ∈ A,
deﬁne the element  a ∈ A by setting
                               
                                 γ(a)      if a ∈ X,
                           
                           a=
                                 γ (a) if a ∈ X  .
                                  −1



                          a is an involution of A, that is, it satisﬁes 
Observe that the map a →                                              
                                                                        a=a
for all a ∈ A.
370                                                                   D Free Groups

    Consider now the set A∗ consisting of all words on the alphabet set A (see
Sect. D.1). Recall that A∗ is a monoid for the concatenation product whose
identity element is the empty word .
    We say that a word w ∈ A∗ may be obtained from a word w ∈ A∗ by an
elementary reduction if there exist an element a ∈ A and words u, v ∈ A∗
such that w = uv and w = ua    av. Given words w, w ∈ A∗ , we write w ∼ w
if either w may be obtained from w by an elementary reduction or w may
be obtained from w by an elementary reduction. Finally, we deﬁne a relation
≡ on A∗ by writing w ≡ w for w, w ∈ A∗ if and only if there exist an
integer n ≥ 1 and a sequence of words w1 , w2 , . . . , wn ∈ A∗ with w1 = w and
wn = w such that wi ∼ wi+1 for each i = 1, 2, . . . , n − 1. It is immediate to
check that ≡ is an equivalence relation on A∗ . Denote by [w] the equivalence
class of an element w ∈ A∗ and consider the quotient set F = A∗ / ≡, that
is, the set consisting of all equivalence classes [w], w ∈ A∗ . Observe that if
u, u , v ∈ A∗ and u ∼ u then uv ∼ u v and vu ∼ vu . It follows from this
observation that if the words u, v, u , v  ∈ A∗ satisfy u ≡ u and v ≡ v  then
uv ≡ u v  , so that we can deﬁne the product of [u] and [v] in F by setting

                                  [u][v] = [uv].

   Let us show that this product gives a group structure on F . The associativ-
ity immediately follows from the associativity of the concatenation product
in A∗ . Indeed, for all u, v, w ∈ A∗ , we have

      ([u][v])[w] = [uv][w] = [(uv)w] = [u(vw)] = [u][vw] = [u]([v][w]).

On the other hand, for all w ∈ A∗ , we have

                [ ][w] = [ w] = [w] and         [w][ ] = [w ] = [w]

which shows that [ ] is an identity element. Finally, let us show that every
element in F admits an inverse. For w = a1 a2 · · · an ∈ A∗ , where n ≥ 0 and
ak ∈ A for 1 ≤ k ≤ n, deﬁne the word w  ∈ A∗ by

                                = a#
                               w    n an−1 · · · a1 .

Observe that

                           = a1 a2 · · · an a#
                         ww                   n · · · a2 a1
                              ∼ a1 · · · an−1 an−1 · · · a1
                              ..
                               .
                              ∼ a1 a2 a2 a1
                              ∼ a1 a1
                              ∼ .
D.2 Deﬁnition and Construction of Free Groups                                371

Thus, we have ww     ≡ . This gives us [w][w] = [ww]  = [ ]. Similarly, we get
 
[w][w]                           is an inverse of [w] for the product operation
       = [ ]. It follows that [w]
in F . This proves that F is a group.
   Consider the map i : X → F deﬁned by i(x) = [x] for all x ∈ X. If
w = a1 a2 · · · an ∈ A∗ , where ak ∈ A for 1 ≤ k ≤ n, then

                      [w] = [a1 a2 · · · an ] = [a1 ][a2 ] · · · [an ].

Since [a] = i(a) if a ∈ X and [a] = [a]−1 = i(a)−1 if a ∈ X  , we deduce that
i(X) generates the group F .
    Let us show that the triple (F, X, i) is a based free group. Suppose that
f : X → G is a map from X into a group G. We have to prove that there
exists a unique homomorphism φ : F → G such that f = φ ◦ i. Uniqueness
follows from the fact that i(X) generates F . To construct φ, we ﬁrst extend
f to a map g : A → G by setting
                                
                                  f (a)      if a ∈ X,
                         g(a) =        −1
                                  f (
                                     a)      if a ∈ X  .

               a) = g(a)−1 for all a ∈ A. Deﬁne now a map Φ : A∗ → G by
Observe that g(
setting
                       Φ(w) = g(a1 )g(a2 ) · · · g(an )
for all w = a1 a2 · · · an ∈ A∗ . Note that we have

                               Φ(ww ) = Φ(w)Φ(w )                        (D.1)

for all w, w ∈ A∗ . Moreover, if w may be obtained from w by an elementary
reduction, that is, w = uv and w = ua av for some a ∈ A and u, v ∈ A∗ , then

   Φ(w ) = Φ(u)g(a)g(
                      a)Φ(v) = Φ(u)g(a)g(a)−1 Φ(v) = Φ(u)Φ(v) = Φ(w).

It follows that Φ(w) = Φ(w ) whenever w, w ∈ A∗ satisfy w ∼ w . By
induction, we deduce that Φ(w) = Φ(w ) for all w, w ∈ A∗ such that w ≡ w .
Thus, we can deﬁne a map φ : F → G by setting φ([w]) = Φ(w) for all w ∈ A∗ .
By using (D.1), we get

       φ([w][w ]) = φ([ww ]) = Φ(ww ) = Φ(w)Φ(w ) = φ([w])φ([w ]).

Therefore, φ is a group homomorphism. On the other hand, for all x ∈ X,
we have
                      φ ◦ i(x) = φ([x]) = g(x) = f (x),
which shows that φ ◦ i = f . Consequently, the triple (F, X, i) is a based free
group.
   Given an arbitrary set X, it follows from Theorem D.2.7 that there exist
a based free group (F, X, i). Then one often says that F = F (X) is the free
372                                                                     D Free Groups

group based on X (this is a minor abuse of language since if (F  , X, i ) is
another based free group then there is a unique isomorphism ϕ : F → F 
such that ϕ ◦ i = i , by Proposition D.2.6). For k ∈ N, the free group based
on {1, 2, . . . , k} is denoted by Fk .
   We recall that one says that two sets X1 and X2 are equipotent, or that
they have the same cardinality, if there exists a bijective map u : X1 → X2 .

Theorem D.2.8. Let F1 and F2 be two free groups based on X1 ⊂ F1 and
X2 ⊂ F2 . Then the following conditions are equivalent:
(a) the groups F1 and F2 are isomorphic;
(b) the sets X1 and X2 are equipotent.

   For the proof, we shall need a few preliminary results. We use the follow-
ing notation. If G1 and G2 are groups, we denote by Hom(G1 , G2 ) the set
consisting of all homomorphisms φ : G1 → G2 . We denote by P(X) the set
of all subsets of a set X.

Lemma D.2.9. Let F be a free group based on X ⊂ F . Then the sets
Hom(F, Z/2Z) and P(X) are equipotent.

Proof. Since F is free with base X, each map f : X → Z/2Z can be uniquely
extended to a homomorphism φ : F → Z/2Z. Therefore, the restriction map
yields a bijection from Hom(F, Z/2Z) onto the set of maps from X to Z/2Z.
Consequently, the sets Hom(F, Z/2Z) and P(X) are equipotent.

Lemma D.2.10. Let F be a free group based on X ⊂ F . Suppose that the
set X is inﬁnite. Then the sets X and F are equipotent.

Proof. Let A = X ∪ X −1 . Since X generates F , the map ρ : A∗ → F deﬁned
by ρ(a1 , a2 , . . . , an ) = a1 a2 . . . an is surjective. As X is inﬁnite, the sets X,
A, and A∗ are all equipotent. It follows that there is a surjective map from
X onto F and therefore an injective map from F into X. By applying the
Cantor-Bernstein theorem (cf. Corollary H.3.5), we deduce that X and F are
equipotent.

Proof of Theorem D.2.8. The fact that (b) implies (a) immediately follows
from Proposition D.2.6.
   To prove the converse implication, suppose that there exists an isomor-
phism α : F1 → F2 . Then α induces a bijective map between the sets
Hom(F1 , Z/2Z) and Hom(F2 , Z/2Z). It follows that P(X1 ) and P(X2 ) are
equipotent by Lemma D.2.9. If X1 is inﬁnite, this implies that X2 is also
inﬁnite, and we conclude that X1 and X2 are equipotent by applying
Lemma D.2.10. On the other hand, if X1 is ﬁnite, the fact that P(X1 ) and
P(X2 ) are equipotent implies that X2 is also ﬁnite and that 2|X1 | = 2|X2 | .
This gives us |X1 | = |X2 | and we conclude that X1 and X2 are also equipo-
tent in this case.
D.3 Reduced Forms                                                             373

Corollary D.2.11. Let F be a free group and let X1 , X2 ⊂ F be two bases
of F . Then X1 and X2 are equipotent.

   Let F be a free group. The cardinality of a base X ⊂ F depends only on F
by Corollary D.2.11. This cardinality is called the rank of F . Two free groups
are isomorphic if and only if they have the same rank by Theorem D.2.8.
A group is free of ﬁnite rank k ∈ N if and only if it is isomorphic to Fk .



D.3 Reduced Forms

In order to state the ﬁrst result of this section, we use the notation introduced
in the proof of Theorem D.2.7. A word w ∈ A∗ is said to be reduced if it
contains no subword of the form a    a with a ∈ A, that is, if there is no word
w ∈ A∗ which can be obtained from w by applying an elementary reduction.
Note that the empty word is reduced and that every subword of a reduced
word is itself reduced.

Theorem D.3.1. Every equivalence class for ≡ contains a unique reduced
word.

Proof. It is clear that any word w ∈ A∗ can be transformed into a reduced
word by applying a suitable ﬁnite sequence of elementary reductions. This
shows the existence of a reduced word in any equivalence class for ≡.
   Let us prove uniqueness. Consider the subset R ⊂ A∗ consisting of all
reduced words. For a ∈ A and r ∈ R, deﬁne the word αa (r) by
                           
                            w          aw for some w ∈ A∗ ,
                                if r = 
                  αa (r) =
                            ar otherwise.

Note that the word αa (r) is always reduced. Thus, we get a map αa : R → R
deﬁned for each a ∈ A. Let us show that

                           αa ◦ αea = αea ◦ αa = IdR .                      (D.2)

Let a ∈ A and consider an arbitrary element r ∈ R. If r = aw for some
w ∈ A∗ , then αea (r) = w and hence αa (αea (r)) = αa (w) = aw = r (observe
that w cannot start by  a since r is reduced). Otherwise, we have αea (r) =   ar
                                 ar) = r. It follows that αa ◦ αAe = IdR . By
and therefore αa (αea (r)) = αa (
               a in this equality, we get αea ◦ αa = IdR since · is an involution
replacing a by 
on A. This proves (D.2).
   From (D.2), we deduce that αa ∈ Sym(R) for all a ∈ A. By setting

                          ρ(w) = αa1 ◦ αa2 ◦ · · · ◦ αan
374                                                                    D Free Groups

for every word w = a1 a2 · · · an ∈ A∗ , we get a monoid homomorphism
ρ : A∗ → Sym(R). Note that

                           ρ(r)( ) = r       for all r ∈ R.                     (D.3)

On the other hand, it immediately follows from (D.2) that ρ(w) = ρ(w )
whenever w, w ∈ A∗ satisfy w ≡ w . Thus, if r1 an r2 are reduced words in
the same equivalence class for ≡, we have ρ(r1 ) = ρ(r2 ) and therefore r1 = r2
by applying (D.3).

Corollary D.3.2. Let (F, X, i) be a based free group. Then every element
f ∈ F can be uniquely written in the form

                          f = i(x1 )h1 i(x2 )h2 · · · i(xn )hn                  (D.4)

with n ≥ 0, xi ∈ X and hi ∈ Z \ {0} for 1 ≤ i ≤ n, and xi = xi+1 for
1 ≤ i ≤ n − 1.

Deﬁnition D.3.3. The expression (D.4) is called the reduced form of the
element f in the based free group (F, X, i).

Proof of Corollary D.3.2. We can assume that (F, X, i) is the based free group
constructed in the proof of Theorem D.2.7. By construction, the element
f ∈ F is an equivalence class for ≡. This equivalence class contains a unique
reduced word r by Theorem D.3.1. The word r can be uniquely written in
the form
                             r = ak11 ak22 · · · aknn ,
where n ≥ 0, ai ∈ A and ki ∈ N \ {0} for 1 ≤ i ≤ n, and ai = ai+1 for
1 ≤ i ≤ n − 1. This gives us an expression of the form (D.4) with xi = ai and
hi = ki if ai ∈ X, and xi = ai and hi = −ki otherwise. Uniqueness of such an
expression for f follows from the uniqueness of the reduced word r ∈ f .

Corollary D.3.4. Let G be a group. Let U ⊂ G be a subset such that

                               uk11 uk22 · · · uknn = 1G ,                     (D.5)

for all u1 , u2 , . . . , un ∈ U and k1 , k2 , . . . , kn ∈ Z \ {0} with ui =
                                                                             ui+1 for
1 ≤ i ≤ n − 1 and n ≥ 1. Then the subgroup of G generated by U is free with
base U .

Proof. Denote by H the subgroup of G generated by U and by ι : U → H
the inclusion map. Let (F, U, i) be a based free group (cf. Theorem D.2.7).
Then there exists a unique homomorphism φ : F → H such that ι = φ ◦ i.
Note that φ is surjective since φ(i(U )) = ι(U ) = U generates H. Let us show
that φ is also injective. Consider an element f ∈ F written in reduced form,
that is, in the form f = i(u1 )h1 i(u2 )h2 · · · i(un )hn with n ≥ 0, ui ∈ U and
hi ∈ Z \ {0} for 1 ≤ i ≤ n, and ui = ui+1 for 1 ≤ i ≤ n − 1. Then we
D.4 Presentations of Groups                                                    375

have φ(f ) = uh1 1 uh2 2 · · · uhnn since φ(i(ui )) = ι(ui ) = ui for 1 ≤ i ≤ n. It
follows from (D.5) that φ(f ) = 1H if and only if n = 0, that is, if and only if
f = 1F . This shows that φ is an isomorphism. It follows from Remark D.2.2
that (H, U, ι) is a based free group.



D.4 Presentations of Groups

Proposition D.4.1. Let G be a group and let S be a generating subset of G.
Let F denote the free group based on S. Then, the group G is isomorphic to
a quotient of F .
Proof. Let i : S → F and f : S → G denote the inclusion maps. Since F is free
with base S, there exists a homomorphism φ : F → G such that f = φ ◦ i.
This implies that S is contained in the image of φ. Since S generates G,
we deduce that φ is surjective. Therefore, the group G is isomorphic to the
quotient group F/ Ker(φ).
  As every group admits a generating subset (e.g., the group itself), we
deduce the following:
Corollary D.4.2. Every group is isomorphic to a quotient of a free group.


  A group is said to be ﬁnitely generated if it admits a ﬁnite generating
subset. Proposition D.4.1 gives us:
Corollary D.4.3. Every ﬁnitely generated group is isomorphic to a quotient
of a free group of ﬁnite rank.
   Let A be a subset of a group G. The intersection of all normal subgroups of
G containing A is a normal subgroup of G which is called the normal closure
of A in G.
   Let G be a group. By Corollary D.4.2, there exist a free group F and an
epimorphism φ : F → G. Let X be a free base for F . If R is a subset of F
whose normal closure is the kernel of φ, then one says that G admits the
presentation
                                 G = X; R.                            (D.6)
Note that as X generates F (cf. Proposition D.2.3(ii)), we have that φ(X)
generates G. The elements x ∈ X (rather than the φ(x) ∈ G, x ∈ X) are
called, by abuse of language, the generators of the presentation (D.6). The
elements r ∈ R are called the relators of the presentation (D.6). For every
r ∈ R let ur , vr be elements in F such that r = ur (vr )−1 . Then (D.6) is often
expressed as G = X : r = 1, r ∈ R or G = X : ur = vr , r ∈ R.
   Note that G admits a presentation (D.6) with X ﬁnite if and only if G is
ﬁnitely generated (cf. Corollary D.4.3).
376                                                            D Free Groups

  If a group G admits a presentation (D.6) with both X and R ﬁnite, then
G is said to be ﬁnitely presented.



D.5 The Klein Ping-Pong Theorem

The following theorem is often used to prove that a group is free:

Theorem D.5.1. Let G be a group. Let X be a generating subset of G having
at least two distinct elements. Suppose that G acts on a set E and that there
is a family (Ax )x∈X of nonempty pairwise disjoint subsets of E such that
               ⎛            ⎞
                   !
            xk ⎝         Ay ⎠ ⊂ Ax for all x ∈ X and k ∈ Z \ {0}.      (D.7)
               y∈X\{x}


Then G is a free group with base X.

Proof. Consider an element g ∈ G written as a nontrivial reduced word on
the generating subset X, that is, in the form

                               g = xk11 xk22 . . . xknn ,

where n ≥ 1, xi ∈ X and ki ∈ Z \ {0} for 1 ≤ i ≤ n, and xi = xi+1 for
1 ≤ i ≤ n − 1. By Corollary D.3.4, we have to show that g = 1G .
   Suppose ﬁrst that either X contains at least three distinct elements or X
has exactly two elements and x1 = xn . In this case, we can ﬁnd an element
y ∈ X such that y = x1 and y = xn . By successive applications of D.7, we
get
                                             k       k
                     gAy = xk11 xk22 . . . xn−2
                                             n−2   n−1 kn
                                                 xn−1 xn Ay
                                             k       k
                          ⊂ xk11 xk22 . . . xn−2
                                              n−2   n−1
                                                  xn−1  Axn
                                             k
                          ⊂ xk11 xk22 . . . xn−2
                                              n−2
                                                  Axn−1
                          ⊂ xk11 xk22 . . . Axn−2
                         ...
                          ⊂ xk11 xk22 Ax3
                          ⊂ xk11 Ax2
                          ⊂ Ax1 .

As the sets Ay and Ax1 are disjoint and Ay = ∅ by our hypotheses, we
deduce that g = 1G .
D.5 The Klein Ping-Pong Theorem                                            377

  It remains to treat the case when X has exactly two elements and x1 = xn .
Then
                     xk11 gx−k
                            1
                              1
                                = x2k1 k2 k3      kn −k1
                                   1 x2 x3 . . . xn x1

is a reduced form of xk11 gx−k
                            1
                              1
                                . We have xk11 gx−k
                                                 1
                                                   1
                                                     = 1G by the ﬁrst case. We
deduce that we also have g = 1G in this case.

Remark D.5.2. The proof of Theorem D.5.1 shows that the hypotheses on the
family (Ax )x∈X may be relaxed: in fact, it suﬃces that the subsets Ax ⊂ X,
x ∈ X, satisfy D.7 and Ay ⊂ Ax for all distinct elements x, y ∈ X.

Corollary D.5.3. Let F be a free group of rank 2 and let n ≥ 2 be an integer.
Then F contains a free subgroup of rank n.

Proof. Suppose that F is based on the elements a and b. Let G be the sub-
group of F generated by the subset

                        X = {ai ba−i : 0 ≤ i ≤ n − 1}.

Consider the action of G on F given by left multiplication. Deﬁne, for each
x = ai ba−i ∈ X, the subset Ax ⊂ F as being the set of elements of F whose
reduced form starts by ai bk for some k ∈ Z \ {0}. The subsets Ax , x ∈ X,
clearly satisfy the hypotheses of Theorem D.5.1. Therefore G is free with
base X.
Appendix E
Inductive Limits and Projective Limits
of Groups




E.1 Inductive Limits of Groups

Let I be a directed set. An inductive system of groups over I consists of
the following data: (1) a family of groups (Gi )i∈I indexed by I, (2) for each
pair i, j ∈ I such that i ≤ j, a homomorphism ψji : Gi → Gj satisfying the
following conditions:

                   ψii = IdGi (identity map on Gi ) for all i ∈ I,
             ψkj ◦ ψji = ψki for all i, j, k ∈ I such that i ≤ j ≤ k.

Then one speaks of the inductive system (Gi , ψji ) or simply of the inductive
system (Gi ) if the homomorphisms ψji are understood.
   Let (Gi , ψji ) be an inductive system
                                         of groups over I. Consider the relation
∼ on the disjoint union E = i∈I Gi deﬁned as follows. If xi ∈ Gi and
xj ∈ Gj are elements of E, then xi ∼ xj if and only if there is an element
k ∈ I such that i ≤ k, j ≤ k and ψki (xi ) = ψkj (xj ). It easy to check that ∼ is
a equivalence relation on the set E. Let G = E/ ∼ be the set of equivalence
classes of ∼. For xi ∈ Gi , let [xi ] ∈ G denote the class of xi . One deﬁnes a
binary operation on G in the following way. Given xi ∈ Gi and xj ∈ Gj , one
deﬁnes the class [xi ][xj ] by setting

                           [xi ][xj ] = [ψki (xi )ψkj (xj )],

where k ∈ I is such that i ≤ k and j ≤ k. One checks that [xi ][xj ] depends
neither on the choice of the representatives xi and xj , nor on the choice of k.
Moreover, this operation gives a group structure on G. The group G is called
the inductive limit (or the direct limit) of the inductive system (Gi ) and
one writes G = lim Gi . For each i ∈ I, there is a canonical homomorphism
                 −→
hi : Gi → G deﬁned by hi (xi ) =[xi ]. Note that it immediately follows from
the construction of G that G = i∈I hi (Gi ). Moreover, one has

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,        379
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 13, © Springer-Verlag Berlin Heidelberg 2010
380                                 E Inductive Limits and Projective Limits of Groups

                                    hj ◦ ψji = hi

for all i, j ∈ I such that i ≤ j.

Examples E.1.1. (a) Let (Gi )i∈I be a family of groups and, for i, j ∈ I such
that i ≤ j, let ψji : Gi → Gj be the trivial homomorphism, namely, ψji (g) =
1Gj for all g ∈ Gi . Then, (Gi , ψji ) is an inductive system whose inductive
limit is a trivial group.
   (b) Let G be a group and denote by H the setof all ﬁnitely generated
subgroups of G. Then (H, ⊂) is a directed set and H∈H H = G. Moreover,
the set H together with the inclusion maps ψK,H : H → K, for all H, K ∈ H
with H ⊂ K, is an inductive system whose limit is canonically isomorphic
to G.




E.2 Projective Limits of Groups

Let I be a directed set. A projective system of groups over I consists of the
following data: (1) a family of groups (Gi )i∈I indexed by I, (2) for each
pair i, j ∈ I such that i ≤ j, a homomorphism ϕij : Gj → Gi satisfying the
following conditions:

                   ϕii = IdGi (identity map on Gi ) for all i ∈ I,
             ϕij ◦ ϕjk = ϕik for all i, j, k ∈ I such that i ≤ j ≤ k.

Then one speaks of the projective system (Gi , ϕij ) or simply of the projective
system (Gi ) if the homomorphisms ϕij are understood.                   
   Let (Gi , ϕij ) be a projective system of groups over I. Let P = i∈I Gi
denote the direct product of the groups Gi . One immediately checks that

        G = {(xi ) ∈ P : ϕij (xj ) = xi for all i, j ∈ I such that i ≤ j}

is a subgroup of P . The group G is called the projective limit of the projective
system (Gi ), and one writes G = lim Gi . For each i ∈ I, there is a canonical
                                   ←−
homomorphism fi : G → Gi obtained by restriction of the projection map
πi : P → Gi . One has
                                ϕij ◦ fj = fi
for all i, j ∈ I such that i ≤ j.

Examples E.2.1. (a) Let (Gi )i∈I be a family of groups and, for i, j ∈ I such
that i ≤ j, let ϕij : Gj → Gi be the trivial homomorphism. Then, (Gi , ϕij )
is a projective system whose projective limit is a trivial group.
   (b) Let G be a group. Denote by N the set of all normal subgroups
of G. Then (N , ⊃) is a directed set. The family of groups (G/H)H∈N , when
E.2 Projective Limits of Groups                                  381

equipped with the canonical quotient homomorphisms ϕH,K : G/K → G/H
for all H, K ∈ N with H ⊃ K, gives rise to a projective system whose
projective limit is canonically isomorphic to G.
Appendix F
The Banach-Alaoglu Theorem




All vector spaces considered in this appendix are vector spaces over the ﬁeld
R of real numbers.



F.1 Topological Vector Spaces

A topological vector space is a real vector space X endowed with a topology
such that the maps

                                 X ×X →X
                                  (x, y) → x + y

and

                                   R×X →X
                                    (λ, x) → λx

are continuous.

Example F.1.1. Let  ·  be a norm on a real vector space X and let d denote
the metric on X deﬁned by d(x, y) = x − y for all x, y ∈ X. Then the
topology deﬁned by d yields a structure of topological vector space on X.

   Recall that a subset C of a real vector space X is said to be convex if

                                (1 − λ)x + λy ∈ C

for all λ ∈ [0, 1] and x, y ∈ C.
   A topological real vector space X is said to be locally convex if there is a
base of neighborhoods of 0 consisting of convex subsets of X.


T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,       383
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 14, © Springer-Verlag Berlin Heidelberg 2010
384                                                F The Banach-Alaoglu Theorem

F.2 The Weak-∗ Topology

Let X be a real vector space equipped with a norm  · . Recall that a linear
map u : X → R is continuous if and only if u is bounded on the unit ball
B(X) = {x ∈ X : x ≤ 1}, that is, if and only if there is a constant C ≥ 0
such that |u(x)| ≤ C for all x ∈ B(X). The topological dual of X is the vector
space X ∗ consisting of all continuous linear maps u : X → R. The operator
norm on X ∗ is the norm deﬁned by

                              u =    sup |u(x)|.
                                      x∈B(X)

The topology deﬁned by the operator norm is called the strong topology
on X ∗ .
   Given x ∈ X, let ψx : X ∗ → R denote the evaluation map u → u(x) at x.
The weak-∗ topology on X ∗ is the initial topology associated with the family
of all evaluation maps ψx : X ∗ → R, x ∈ X. Thus, the weak-∗ topology is
the smallest topology on X ∗ for which all evaluation maps ψx are continuous.
Observe that every subset of X ∗ which is open for the weak-∗ topology is also
open for the strong topology since all the evaluation maps are continuous for
the strong topology. It follows that convergence with respect to the strong
topology implies convergence with respect to the weak-∗ topology.
   The weak-∗ topology provides a topological vector space structure on X ∗ .
A base of open neighborhoods of 0 for the weak-∗ topology is given by all
subsets of the form

                V (F, ε) = {u ∈ X ∗ : |u(x)| < ε for all x ∈ F },

where F is a ﬁnite subset of X and ε > 0. Since all the sets V (F, ε) are convex,
the topological vector space structure associated with the weak-∗ topology
on X ∗ is locally convex.
   The weak-∗ topology on X ∗ is Hausdorﬀ. Indeed, if u1 and u2 are two
distinct elements in X ∗ , then there exists x ∈ X such that u1 (x) = u2 (x). If
U1 and U2 are disjoint open subsets of R containing u1 (x) and u2 (x) respec-
tively, then ψx−1 (U1 ) and ψx−1 (U2 ) are disjoint open subsets of X ∗ containing
u1 and u2 respectively.



F.3 The Banach-Alaoglu Theorem

In general, the unit ball in X ∗ is not compact for the strong topology (this
follows from the fact that the unit ball in a normed space is never compact
unless the space is ﬁnite-dimensional). However, this ball is always compact
for the weak-∗ topology. This result, which is known as the Banach-Alaoglu
F.3 The Banach-Alaoglu Theorem                                               385

theorem is one of the central results of classical functional analysis and may
be easily deduced from the Tychonoﬀ theorem.

Theorem F.3.1 (Banach-Alaoglu theorem). Let X be a real normed
vector space and let  ·  denote the operator norm on its topological dual X ∗ .
Then the unit ball B(X ∗ ) = {u ∈ X ∗ : u ≤ 1} is compact for the weak-∗
topology on X ∗ .

Proof. Observe ﬁrst that X ∗ is a vector subspace of the vector space RX
consisting of all real-valued functions on X. On the other hand, setting Ix =
[−x, x] ⊂ R for each x ∈ X. We haveB(X ∗ ) ⊂ x∈X Ix by deﬁnition of
the operator norm. Let us equip RX = x∈X       R with the product topology.
Then it is clear that the topology induced on x∈X Ix is the product topology
and that the topology induced on X ∗ is the weak-∗ topology. Let f be an
element of RX which is the limit of a net (ui ) of elements of B(x∗ ). For all
x, y ∈ X and λ ∈ R, we have ui (λx) = λui (x), ui (x + y) = ui (x) + ui (y)
and |ui (x)| ≤ x since ui ∈ B(X ∗ ). By taking limits, we get f (λx) = λf (x),
                                                                             ∗
f (x + y) = f (x) + f (y) and |f (x)| ≤ x.  This shows that f ∈ B(X ).
                     ∗
Consequently, B(X ) is closed in R . Since x∈X Ix is compact by Tychonoﬀ
                                     X

theorem (Theorem A.5.2), we deduce that B(X ∗ ) is compact.
Appendix G
The Markov-Kakutani Fixed Point
Theorem




All vector spaces considered in this appendix are vector spaces over the ﬁeld
R of real numbers.



G.1 Statement of the Theorem

Let C be a convex subset of a real vector space X. A map f : C → C is called
aﬃne if
                 f ((1 − λ)x + λy) = (1 − λ)f (x) + λf (y)
for all λ ∈ [0, 1] and x, y ∈ C.
Theorem G.1.1 (Markov-Kakutani). Let K be a nonempty convex com-
pact subset of a Hausdorﬀ topological vector space X. Let F be a set of con-
tinuous aﬃne maps f : K → K. Suppose that all elements of F commute,
that is, f1 ◦ f2 = f2 ◦ f1 for all f1 , f2 ∈ F. Then there exists a point in K
which is ﬁxed by all the elements of F.



G.2 Proof of the Theorem

In the proof of the Markov-Kakutani theorem, we shall use the following
lemmas.
Lemma G.2.1. Let K be a compact subset of a topological vector space X
and let V be a neighborhood of 0 in X. Then there exists a real number α > 0
such that λK ⊂ V for every real number λ such that |λ| < α.
Proof. Since the multiplication by a scalar R × X → X is continuous, we can
ﬁnd, for each x ∈ X, a real number αx and an open neighborhood Ωx ⊂ X
of x such that
T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,       387
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 15, © Springer-Verlag Berlin Heidelberg 2010
388                                      G The Markov-Kakutani Fixed Point Theorem

                           |λ| < αx ⇒ λx Ωx ⊂ V.                            (G.1)
The sets Ωx , x ∈ K, form an open cover of K. As K is compact, there is a
ﬁnite subset F ⊂ K such that
                                   !
                              K⊂       Ωx .                        (G.2)
                                          x∈F

If we take α = minx∈F αx , then α > 0 and

                              |λ| < α ⇒ λK ⊂ V

by (G.1) and (G.2).
Lemma G.2.2. Let K be a compact subset of a topological vector space X.
Let (xi )i∈I be a net of points in K and let (λi )i∈I be a net of real numbers
converging to 0 in R. Then the net (λi xi )i∈I converges to 0 in X.
Proof. Let V be a neighborhood of 0 in X. By Lemma G.2.1, we can ﬁnd
α > 0 such that λK ⊂ V for every λ such that |λ| < α. As the net (λi )
converges to 0, there exists i0 ∈ I such that i ≥ i0 implies |λi | < α. Thus
we have λi xi ∈ V for all i ≥ i0 . This shows that the net (λi xi ) converges
to 0.
   The following lemma is the theorem of Markov-Kakutani in the particular
case when the set F is reduced to a single element.
Lemma G.2.3. Let K be a nonempty convex compact subset of a Hausdorﬀ
topological vector space X and let f : K → K be an aﬃne continuous map.
Then f has a ﬁxed point in K.
Proof. Let us set C = {y − f (y) : y ∈ K}. The fact that f admits a ﬁxed
point in K is equivalent to the fact that 0 ∈ C. Choose an arbitrary point
x ∈ K and consider the sequence (xn )n≥1 of points of X deﬁned by
                                  n−1
                              1
                       xn =             (f k (x) − f k+1 (x)).
                              n
                                  k=0

We have f k (x) − f k+1 (x) = f k (x) − f (f k (x)) ∈ C for 0 ≤ k ≤ n − 1. On
the other hand, the set C is convex, since K is convex and f is aﬃne. Thus
xn ∈ C for every n ≥ 1.
   As
                                    1      1
                             xn = x − f n (x).
                                    n      n
and f n (x) ∈ K for every n ≥ 1, it follows from Lemma G.2.2 that the
sequence (xn )n≥1 converges to 0. The set C is compact since it is the image
of the compact set K by the continuous map y → y − f (y). As every compact
subset of a Hausdorﬀ space is closed, we deduce that C is closed in X. Thus
0 ∈ C.
Notes                                                                        389

Proof of Theorem G.1.1. Let f ∈ F and consider the set

                         Fix(f ) = {x ∈ K : f (x) = x}

of its ﬁxed points. The set Fix(f ) is not empty by Lemma G.2.3 and it is
compact since it is a closed subset of the compact set K. On the other hand,
Fix(f ) is convex since K is convex and f is aﬃne. If g ∈ F and x ∈ Fix(f ),
then the fact that f and g commute implies that g(x) ∈ Fix(f ) since

                          f (g(x)) = g(f (x)) = g(x).

Therefore we can apply Lemma G.2.3 to the restriction of g to Fix(f ). It
follows that g ﬁxes a point in Fix(f ), that is,

                             Fix(f ) ∩ Fix(g) = ∅.

By induction on n, we get

                    Fix(f1 ) ∩ Fix(f2 ) ∩ · · · ∩ Fix(fn ) = ∅

for all f1 , f2 , . . . , fn ∈ F. Since K is compact, from the ﬁnite intersection
property (see Sect. A.5) we deduce that
                                      
                                         Fix(f ) = ∅.
                                f ∈F

This shows that there is a point in K which is ﬁxed by all elements of F.



Notes

The proof presented here is due to S. Kakutani [Kak] (see [Jac]). In the proof
of A. Markov [Mar], the local convexity of X is needed.
Appendix H
The Hall Harem Theorem




H.1 Bipartite Graphs

A bipartite graph is a triple G = (X, Y, E), where X and Y are arbitrary sets,
and E is a subset of the Cartesian product X × Y . The set X (resp. Y ) is
called the set of left (resp. right) vertices and E is called the set of edges of
the bipartite graph G (see Fig. H.1).




Fig. H.1 The bipartite graph G = (X, Y, E) with X = {x1 , x2 , x3 , x4 , x5 }, Y = {y1 , y2 ,
y3 , y4 } and E = {(x1 , y1 ), (x2 , y1 ), (x2 , y2 ), (x2 , y3 ), (x3 , y4 ), (x5 , y3 ), (x5 , y4 )}


    A bipartite subgraph of a bipartite graph G = (X, Y, E) is a bipartite graph
G  = (X  , Y  , E  ) with X  ⊂ X, Y  ⊂ Y and E  ⊂ E (see Fig. H.2).
    Let G = (X, Y, E) be a bipartite graph.
    Two edges (x, y), (x , y  ) ∈ E are said to be adjacent if x = x or y = y  .
    Given a vertex x ∈ X (resp. y ∈ Y ) the right-neighborhood of x (resp. the
left-neighborhood of y) is the subset NR (x) ⊂ Y (resp. NL (y) ⊂ X) deﬁned
by (see Figs. H.3–H.4):


T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,                            391
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 16, © Springer-Verlag Berlin Heidelberg 2010
392                                                                         H The Hall Harem Theorem




Fig. H.2 The bipartite subgraph G  = (X  , Y  , E  ) of the bipartite graph G in Fig. H.1
with X  = {x1 , x2 , x4 , x5 }, Y  = {y1 , y2 , y3 } and E  = {(x2 , y1 ), (x2 , y2 ), (x2 , y3 ), (x5 , y3 )}




Fig. H.3 The right-neighborhood NR (x2 ) ⊂ Y of the vertex x2 ∈ X in the bipartite
graph G of Fig. H.1



                              NR (x) = NRG (x) = {y ∈ Y : (x, y) ∈ E}
                     (resp. NL (y) = NLG (y) = {x ∈ X : (x, y) ∈ E}).

   For subsets A ⊂ X and B ⊂ Y , we deﬁne the right-neighborhood NR (A)
of A and the left-neighborhood NL (B) of B by
                        !                                  !
    NR (A) = NRG (A) =     NR (a) and NL (B) = NLG (B) =      NL (b).
                                  a∈A                                                       b∈B

  One says that the bipartite graph G = (X, Y, E) is ﬁnite if the sets X and
Y are ﬁnite. One says that G is locally ﬁnite if the sets NR (x) and NR (y) are
ﬁnite for all x ∈ X and y ∈ Y . Note that if G is locally ﬁnite then the sets
NR (A) and NL (B) are ﬁnite for all ﬁnite subsets A ⊂ X and B ⊂ Y .
H.2 Matchings                                                                          393




Fig. H.4 The left-neighborhood NL (y1 ) ⊂ X of the vertex y1 ∈ Y in the bipartite graph G
of Fig. H.1



H.2 Matchings

Let G = (X, Y, E) be a bipartite graph.
   A matching in G is a subset M ⊂ E of pairwise nonadjacent edges. In
other words, a subset M ⊂ E is a matching if and only if both projection
maps p : M → X and q : M → Y are injective.
   A matching M is called left-perfect (resp. right-perfect) if for each x ∈ X
(resp. y ∈ Y ), there exists y ∈ Y (resp. x ∈ X) such that (x, y) ∈ M
(see Fig. H.5). Thus, a matching M is left-perfect (resp. right-perfect) if and
only if the projection map p : M → X (resp. q : M → Y ) is surjective (and
therefore bijective).
   A matching M is called perfect if it is both left-perfect and right-perfect.




Fig. H.5 A right-perfect matching M ⊂ E in the bipartite graph G of Fig. H.1. Note that
there is no left-perfect matching (and therefore no perfect matching) in G since |X| > |Y |


Remarks H.2.1. (a) A subset M ⊂ E is a left-perfect (resp. right-perfect)
matching if and only if there is an injective map ϕ : X → Y (resp. an injective
394                                                     H The Hall Harem Theorem

map ψ : Y → X) such that M = {(x, ϕ(x)) : x ∈ X} (resp. M = {(ψ(y), y) :
y ∈ Y }).
   (b) Similarly, a subset M ⊂ E is a perfect matching if and only if there is
a bijective map ϕ : X → Y such that M = {(x, ϕ(x)) : x ∈ X}.
   Given a bipartite graph G = (X, Y, E), one often regards the set X as a set
of boys and Y as a set of girls. One interprets (x, y) ∈ E as the condition that
x and y know each other. In this context, a matching M ⊂ E is a process of
getting boys and girls that know each other married (no polygamy is allowed
here). The matching is left-perfect (resp. right-perfect) if and only if every
boy (resp. girl) gets married. Finally, M is perfect if and only if there remain
no singles.



H.3 The Hall Marriage Theorem

We use the notation | · | to denote cardinality of sets.
Deﬁnition H.3.1 (Hall conditions). Let G = (X, Y, E) be a bipartite
graph. One says that G satisﬁes the left (resp. right) Hall condition if

                                 |NR (A)| ≥ |A|                              (H.1)

(resp. |NL (B)| ≥ |B|) for every ﬁnite subset A ⊂ X (resp. for every ﬁnite
subset B ⊂ Y ).
   One says that G satisﬁes the Hall marriage conditions if G satisﬁes both
the left and the right Hall conditions.
Theorem H.3.2. Let G = (X, Y, E) be a locally ﬁnite bipartite graph. Then
the following conditions are equivalent.
(a) G satisﬁes the left (resp. right) Hall condition;
(b) G admits a left (resp. right) perfect matching.
Proof. It is obvious that (b) implies (a). Let us prove that (a) implies (b). By
symmetry, it suﬃces to show that if G satisﬁes the left Hall condition then it
admits a left perfect matching.
   We ﬁst treat the case when the set X is ﬁnite by induction on n = |X|. In
the case |X| = 1, the statement is trivially satisﬁed. Suppose that we have
proved the statement whenever |X| ≤ n − 1 and let us prove it for |X| = n.
We distinguish two cases.
   Case (i): Suppose that

                               |NR (A)| ≥ |A| + 1                            (H.2)

for all nonempty proper subsets A ⊂ X. Then ﬁx x0 ∈ X and y0 ∈ Y
such that (x0 , y0 ) ∈ E. Consider the bipartite subgraph G  = (X  , Y  , E  ),
H.3 The Hall Marriage Theorem                                                       395

where X  = X \ {x0 }, Y  = Y \ {y0 }, and E  = E ∩ (X  × Y  ). Then, for
every nonempty subset A ⊂ X  , we have |NR (A )| ≥ |A | + 1 by (H.2), and
                                  
hence |NRG (A )| ≥ |A | since NRG (A ) = NR (A ) \ {y0 }. As |X  | = n − 1, it
follows from our induction hypothesis that G  admits a left-perfect matching
M  ⊂ E  . Then M = M  ∪ {(x0 , y0 )} is a left-perfect matching for G.
   Case (ii): Suppose that we are not in Case (i). This means that there exists
a nonempty proper subset X  ⊂ X such that

                                  |NR (X  )| = |X  |.                          (H.3)

Then the bipartite subgraph G  = (X  , Y  , E  ), where Y  = NR (X  ) and
E  = E ∩ (X  × Y  ) clearly satisﬁes the left Hall condition. As |X  | ≤ n − 1,
there exists, by our induction hypothesis, a left-perfect matching M  ⊂ E 
for G  . Consider now the bipartite subgraph G  = (X  , Y  , E  ), where X  =
X \ X  , Y  = Y \ Y  , and E  = E ∩ (X  × Y  ). We claim that the left Hall
condition also holds for G  . Otherwise, there would be some subset A ⊂ X 
such that,
                                      
                                 |NRG (A )| < |A |,                          (H.4)
and then the left Hall condition for G would be violated by A = X  ∪ A ⊂ X
since

                 |NR (A)| = |NR (X  ∪ A )|
                            = |NR (X  ) ∪ NR (A )|
                                                
                            = |NR (X  ) ∪ NRG (A )|
                                                     
                            ≤ |NR (X  )| + |NRG (A )|
                            < |X  | + |A | (by (H.3) and (H.4))
                            = |X  ∪ A |
                            = |A|.

Therefore, as |X  | < |X| = n, induction applies again yielding a left-perfect
matching M  ⊂ E  for G  . It then follows that M = M  ∪ M  is a left-
perfect matching for G. This completes the proof that (a) implies (b) in the
case when X is ﬁnite.
   To treat the general case, we shall apply the Tychonoﬀ product theorem.
Suppose that G = (X, Y, E) is a (possibly inﬁnite) locally ﬁnite bipartite
graph satisfying the left Hall condition, that is, |NR (A)| ≥ |A|for every ﬁ-
nite subset A ⊂ X. Let us equip the Cartesian product K = x∈X NR (x)
with its prodiscrete topology, that is, with the product topology obtained by
taking the discrete topology on each factor NR (x). As each set NR (x) is ﬁnite,
the space K is compact by the Tychonoﬀ product theorem (Corollary A.5.3).
396                                                     H The Hall Harem Theorem

For each x ∈ X, let πx : K → NR (x) denote the projection map. Let F be the
set consisting of all nonempty ﬁnite subsets of X. Consider, for each F ∈ F,
the set C(F ) ⊂ K consisting of all z ∈ K which satisfy πx1 (z) = πx2 (z) for
all distinct elements x1 and x2 in F . It follows from this deﬁnition and the
continuity of the projection maps πx , that C(F ) is an intersection of closed
subsets of X and hence closed in K. On the other hand, C(F ) is not empty.
Indeed, choose, for each x ∈ X, an element ψ(x) ∈ NR (x) (observe that
NR (x) is not empty by the left Hall condition). Also set G  = (X  , Y  , E  )
where X  = F , Y  = NR (F ) and E  = E ∩ (X  × Y  ). Then, the left Hall
condition for G implies the left Hall condition for the ﬁnite bipartite graph G 
and therefore, by Theorem H.3.2, there exists a perfect matching for G  . By
Remark H.2.1, there exists an injective mapping ϕ : F = X  → Y  = NR (F ).
Then, the element (Φ(x))x∈X ∈ K, deﬁned by Φ(x) = ϕ(x) if x ∈ F and
Φ(x) = ψ(x) if x ∈ X \ F , clearly belongs to C(F ).
   Since

            C(F1 ) ∩ C(F2 ) ∩ · · · ∩ C(Fn ) ⊃ C(F1 ∪ F2 ∪ · · · ∪ Fn )

for all F1 , F2 , . . . , Fn ∈ F, we deduce that the family {C(F ) : F ∈ F} of
subsets of K hasthe ﬁnite intersection property. By compactness of K, there
is a point z0 ∈ F ∈F F . Then M = {(x, πx (z0 )) : x ∈ X} is a left-perfect
matching for G.

Remark H.3.3. The hypothesis of local ﬁniteness for the bipartite graph can
not be removed from the statement of the previous theorem. To see this,
consider the bipartite graph G = (X, Y, E), where X = Y = N and E =
{(0, n + 1) : n ∈ N} ∪ {(n + 1, n) : n ∈ N}. Observe that G is not locally ﬁnite
as |NR (0)| = ∞. Also, it satisﬁes the left Hall condition. Indeed, given a ﬁnite
subset A ⊂ X, the set NR (A) is inﬁnite if 0 ∈ A, while |NR (A)| = |{n − 1 :
n ∈ A}| = |A| if 0 ∈/ A. However, G admits no left perfect matching. Indeed,
for any matching M ⊂ E, either 0 ∈ X remains unmatched, or, if (0, n) ∈ M
for some n ∈ N, then n + 1 ∈ X remains unmatched (see Fig. H.6).

Theorem H.3.4. Let G = (X, Y, E) be a bipartite graph. Suppose that G
admits both a left perfect matching and a right perfect matching. Then G
admits a perfect matching.

Proof. Let MX (resp. MY ) be a left perfect (resp. right perfect) matching
for G. Consider the equivalence relation in M = MX ∪ MY deﬁned by
declaring two edges e and e in relation if there exists a ﬁnite sequence
e = e0 , e1 , . . . , en = e in M such that ei and ei+1 are adjacent for all
0 ≤ i ≤ n − 1. Then, each equivalence class consists of either (see Fig. H.7):

 – a single edge, or
 – a cycle of even length 2n ≥ 4, or
 – an inﬁnite chain which can be bi-inﬁnite, or inﬁnite only in one direction.
H.3 The Hall Marriage Theorem                                                            397




Fig. H.6 The bipartite graph G = (X, Y, E), where X = Y = N and E = {(0, n + 1) : n ∈
N} ∪ {(n + 1, n) : n ∈ N}



    Note that an equivalence class is reduced to a single edge (x, y) if and only
if (x, y) ∈ MX ∩ MY .
    On the other hand, an equivalence class is a cycle of length 2n if and only
if it is of the form

            C ={(x1 , y1 ), (x2 , y2 ), . . . , (xn , yn )} ∪ {(x1 , y2 ), (x2 , y3 ),
               . . . , (xn−1 , yn ), (xn , y1 )}

with xi ∈ X, all distinct, and yj ∈ Y , all distinct, 1 ≤ i, j ≤ n. In this case,
we then set
                  M (C) = {(x1 , y1 ), (x2 , y2 ), . . . , (xn , yn )}.
Also, a bi-inﬁnite chain is an equivalence class of the form

                  C = {(xn , yn ) : n ∈ Z} ∪ {(xn , yn+1 ) : n ∈ Z}

with xi ∈ X, all distinct, and yj ∈ Y , all distinct, i, j ∈ Z. In this case, we
then set
                         M (C) = {(xn , yn ) : n ∈ Z}.
398                                                                          H The Hall Harem Theorem




Fig. H.7 In the bipartite graph G = (X, Y, E), where X = {x0 , x1 , x2 , x3 , x4 , x5 }, Y =
{y0 , y1 , y2 , y3 , y4 , y5 } and E = {(xi , yi ) : i = 0, 1, . . . , 5} ∪ {(xi , yi+1 ) : i = 1, 2, . . . , 4} ∪
{(x5 , y1 )}, we have a left-perfect matching MX = {(xi , yi ) : i = 0, 1, . . . , 5} (which is indeed
perfect) and a right-perfect matching MY = {(x0 , y0 )} ∪ {(xi , yi+1 ) : i = 1, 2, . . . , 4} ∪
{(x5 , y1 )} (which is also perfect). There are two equivalence classes in M = MX ∪ MY ,
namely, MX ∩ MY = {(x0 , y0 )}, which consists of a single edge, and C = {(xi , yi ) : i =
1, 2 . . . , 5} ∪ {(xi , yi+1 ) : i = 1, 2, . . . , 4} ∪ {(x5 , y1 )}, which is a cycle of length 10



   Finally, if the equivalence class is an inﬁnite chain, which is inﬁnite only
in one direction, then it is either of the form

                       C = {(xn , yn ) : n ∈ N} ∪ {(xn , yn+1 ) : n ∈ N}

or
                       C = {(xn , yn ) : n ∈ N} ∪ {(xn+1 , yn ) : n ∈ N}
with xi ∈ X, all distinct, and yj ∈ Y , all distinct, i, j ∈ N. In both cases, we
then set
                          M (C) = {(xn , yn ) : n ∈ N}.
     It is then clear that the set M ⊂ E deﬁned by
                                       !
                                   M=    M (C),
                                                       C

where C runs over all equivalence classes in M , is the required perfect match-
ing for G.

Corollary H.3.5 (Cantor–Bernstein Theorem). Let X and Y be two
sets. Suppose that there exist injective maps f : X → Y and g : Y → X. Then
there exists a bijective map h : X → Y .

Proof. Consider the bipartite graph G = (X, Y, E), where E = {(x, f (x)) :
x ∈ X} ∪ {(g(y), y) : y ∈ Y }. Now, MX = {(x, f (x)) : x ∈ X} and
H.4 The Hall Harem Theorem                                                  399

MY = {(g(y), y) : y ∈ Y } are left perfect and right perfect matchings in
G, respectively (cf. Remark H.2.1(a)). By the previous theorem, there exists
a perfect matching M ⊂ E for G. Then M = {(x, h(x)) : x ∈ X}, where
h : X → Y is bijective (cf. Remark H.2.1(b)).

Theorem H.3.6 (The Hall marriage Theorem). Let G = (X, Y, E) be
a locally ﬁnite bipartite graph. Then the following conditions are equivalent:
(a) G satisﬁes the Hall-marriage conditions;
(b) G admits a perfect matching.

Proof. The left (resp. right) Hall condition implies, by Theorem H.3.2, the
existence of a left- (resp. right-) perfect matching for G. Then, Theorem H.3.4
guarantees the existence of a perfect matching for G. The converse implication
is trivial.



H.4 The Hall Harem Theorem

Let G = (X, Y, E) be a bipartite graph and let k ≥ 1 be an integer.
   A subset M ⊂ E is called a perfect (1, k)-matching if it satisﬁes the fol-
lowing conditions: (1) for each x ∈ X, there are exactly k elements in y ∈ Y
such that (x, y) ∈ M , (2) for each y ∈ Y , there is a unique element x ∈ X
such that (x, y) ∈ M (see Fig. H.8). Thus, a subset M ⊂ E is a perfect (1, k)-
matching if and only if there exists a k-to-one surjective map ψ : Y → X such
that M = {(ψ(y), y) : y ∈ Y } (recall that a surjective map f : S → T from a
set S onto a set T is said to be k-to-one if each element in T has exactly k
preimages in S). Note that when k = 1, a perfect (1, k)-matching is the same
thing as a perfect matching.
   In the language of boys, girls, and marriages, a perfect (1, k)-matching is a
process for marrying each boy with exactly k girls (among the girls he knows)
in such a way that each girl is married with exactly one boy (among the boys
she knows). The girls that are married with a given boy constitute his harem.

Deﬁnition H.4.1. Let G = (X, Y, E) be a locally ﬁnite bipartite graph and
let k ≥ 1 be an integer. One says that G satisﬁes the Hall k-harem conditions
if
       |NR (A)| ≥ k|A| and
                                                                        (H.5)
       |NL (B)| ≥ k1 |B| for all ﬁnite subsets A ⊂ X and B ⊂ Y .

Theorem H.4.2 (The Hall harem Theorem). Let G = (X, Y, E) be a
locally ﬁnite bipartite graph and let k ≥ 1 be an integer. Then, the following
conditions are equivalent.
(a) G satisﬁes the Hall k-harem conditions;
(b) G admits a perfect (1, k)-matching.
400                                                                H The Hall Harem Theorem




Fig. H.8 The bipartite graph G = (X, Y, E), where X = {x1 , x2 }, Y = {y1 , y2 , y3 , y4 } and
E = {(x1 , yi ) : i = 1, 2, 3, 5} ∪ {(x2 , yj ) : j = 1, 2, 4, 5, 6}, with a perfect (1, 3)-matching
M = {(x1 , yi ) : i = 1, 2, 3} ∪ {(x2 , yj ) : j = 4, 5, 6} and the harems H(x1 ) and H(x2 ) of x1
and x2 respectively



Proof. The fact that (b) implies (a) is trivial.
    Let us prove that (a) implies (b). Suppose that the Hall k-harem conditions
are satisﬁed by G. Let X1 , X2 , . . . , Xk be disjoint copies of X and let φi : X →
Xi , i = 1, 2, . . . , k, denote the copy maps. It will be helpful to think of φi (x)
as the clone of x ∈ X in Xi .                                               k
    Consider the new bipartite graph G  = (X  , Y  , E  ), where X  = i=1 Xi ,
Y  = Y , and

             E  = {(φi (x), y) : (x, y) ∈ E, i = 1, 2, . . . , k} ⊂ X  × Y  .

Let A be a ﬁnite subset of X  and denote by A the set of x ∈ X such
                                                                    
                                                                       that
some clone of x belongs to A . Observe that |A | ≤ k|A | and NRG (A ) =
NRG (A ). Thus, using (a), we get
                               
                         |NRG (A )| = |NRG (A )| ≥ k|A | ≥ |A |.                         (H.6)
                                                                                
On the other hand, if B  is a ﬁnite subset of Y  = Y , then NLG (B  ) is the set
consisting of all clones of elements of NLG (B  ) so that
                                                        
                     G           G              1 
                  |NL (B )| = k|NL (B )| ≥ k         |B | = |B  |           (H.7)
                                                   k

by (a). Inequalities H.6 and H.7 say that G  satisﬁes the Hall marriage condi-
tions. Therefore, G  admits a perfect matching M  ⊂ E  by Theorem H.3.6.
Then the set M , consisting of all pairs (x, y) ∈ E such that (x , y) ∈ M  for
some clone x of x, is clearly a perfect (1, k)-matching for G.
Notes                                                                     401

Notes

The Hall marriage theorem was ﬁrst established for ﬁnite bipartite graphs
by P. Hall [Hall1] and then extended to inﬁnite locally ﬁnite bipartite graphs
by M. Hall [Hall-M-1]. The proof of Theorem H.3.2 which is given in this
appendix is based on [Halm].
Appendix I
Complements of Functional Analysis




All vector spaces considered in this appendix are vector spaces over the ﬁeld
R of real numbers.



I.1 The Baire Theorem

Let (X, d) be a metric space. Given x ∈ X and r > 0, we denote by

                        BX (x, r) = {y ∈ X : d(x, y) ≤ r}

the closed ball of radius r centered at x and by

                       OB X (x, r) = {y ∈ X : d(x, y) < r}

the open ball of radius r centered at x. For a subset A ⊂ X we denote by A
(resp. Int A) the closure (resp. the interior) of A.
Theorem I.1.1 (Baire’s Theorem). Let (X, d) be a complete metric space.
Let (Xn )n≥1 be a sequence of closed subsets such that

                                    Int Xn = ∅                               (I.1)

for all n ≥ 1. Then                ⎛         ⎞
                                       !
                               Int ⎝       Xn ⎠ = ∅.                         (I.2)
                                     n≥1

                  An = X \ Xn , so that An is an open dense subset of X.
Proof. Let us set 
Let us show that n≥1 An is dense in X. Let x0 ∈ X and r0 > 0. We have
to show that                        ⎛       ⎞
                                    
                      BX (x0 , r0 ) ⎝    An ⎠ = ∅.                 (I.3)
                                            n≥1

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,        403
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 17, © Springer-Verlag Berlin Heidelberg 2010
404                                           I Complements of Functional Analysis
                                                        
As A1 is dense and open we can ﬁnd x1 ∈ BX (x0 , r0 ) A1 and r1 > 0 such
that                                                
                      BX (x1 , r1 ) ⊂ OB X (x0 , r0 ) A1
                                   r0
                        0 < r1 <   2 .

Continuing this way, we produce by induction a sequence (xn )n≥1 in X and
a sequence (rn )n≥1 in R such that
                                                      
                    BX (xn+1 , rn+1 ) ⊂ OB X (xn , rn ) An+1
                                                                     (I.4)
                    0 < rn+1 < r2n .

Given 0 ≤ n ≤ m we have

                               xm ∈ BX (xn , rn )                            (I.5)

so that d(xn , xm ) < 2rn0 . We deduce that (xn )n≥1 is a Cauchy sequence.
As X is complete, (xn )n≥1 is convergent so that there exists x ∈ X such
that limn→∞ xn = x. Passing to the limit (for m → ∞) in (I.5) we obtain
x ∈ BX (xn , rn ) ⊂ BX (x0 , r0 ) and, by    x ∈ BX (xn , rn ) ⊂ An for all
                                          (I.4),
n ≥ 1. As a consequence, x ∈ Bx0 ,r0 ( n≥1 An ) and (I.3) follows. This
shows that n≥1 An is dense in X.Taking complements, we deduce that

  n≥1 Xn =      n≥1 (X \ An ) = X \     n≥1 An has empty interior, and (I.2)
follows.
Remark I.1.2. We can restate Baire’s theorem in the following two ways.
   (i) Let (X, d) be a nonempty complete
                                        metric space. Let (Xn )n≥1 be a
sequence of closed subsets such that n≥1 Xn = X. Then there exists n0
such that Int Xn0 = ∅.
   (ii) (By passing to complements) Let (X, d) be a nonempty complete
                                                                    metric
space. Let (Ωn )n≥1 be a sequence of open dense subsets in X. Then n≥1 Ωn
is dense in X.



I.2 The Open Mapping Theorem

Recall that if X and Y are two topological spaces, then a map T : X → Y is
said to be open if for any open set A in X the image T (A) is open in Y .
Theorem I.2.1 (Open mapping theorem). Let X and Y be two Banach
spaces. Then every surjective continuous linear map T : X → Y is open.
Proof. Let T : X → Y be a surjective continuous linear map. We need to show
that for every x ∈ X and every neighborhood N of x, the image T (N ) is a
neighborhood of T (x). Since, by linearity, T (x + N ) = T (x) + T (N ), we can
reduce to the case when x = 0. Moreover, since neighborhoods contain open
balls, it is suﬃcient to show that for every r > 0 there exists r > 0 such that
I.2 The Open Mapping Theorem                                                         405

T (OB X (0, r )) ⊃ OB Y (0, r ). Finally, since T (OB X (0, r )) = r T (OB X (0, 1))
and OB Y (0, r ) = r OB Y (0, 1), we are only left to show that there exists
r > 0 such that
                            T (OB X (0, 1)) ⊃ OB Y (0, r).                          (I.6)
For alln ≥ 1 set Yn = nT (OB X (0, 1)) = T (OB X (0, n)). As T is surjective we
have n≥1 Yn = Y . It follows from Theorem I.1.1 that there exists n0 ≥ 1
such that Int Yn0 = ∅. Since Int(n0 T (OB X (0, 1))) = n0 Int(T (OB X (0, 1))),
we deduce that Int(T (OB X (0, 1))) = ∅. Thus we can ﬁnd r > 0 and y ∈ Y
such that
                        OB Y (y, 4r) ⊂ T (OB X (0, 1)).                     (I.7)
It follows that y ∈ T (OB X (0, 1)) and, by symmetry,

                                − y ∈ T (OB X (0, 1)).                             (I.8)

Summing (I.7) and (I.8) we obtain

                  2OB Y (0, 2r) = OB Y (0, 4r)
                                = OB Y (y, 4r) − y
                                 ⊂ T (OB X (0, 1)) + T (OB X (0, 1))
                                 ⊂ 2T (OB X (0, 1)).

We deduce that OB Y (0, 2r) ⊂ T (OB X (0, 1)) so that, for all n ≥ 0,
                              
                             r
                  OB Y 0, n ⊂ T (OB X (0, 1/2n+1 )).                               (I.9)
                            2

Let y0 ∈ OB Y (0, r) and let us show that there exists x ∈ OB X (0, 1) such
that y0 = T (x ). We deduce from (I.9) (with n = 0) that there exists x0 ∈
OB X (0, 12 ) such that y0 − T (x0 ) < 2r . Set y1 = y0 − T (x0 ) and observe that
y1 ∈ OB Y (0, 2r ). Continuing this way, we ﬁnd a sequence (yn )n≥1 in Y and a
sequence (xn )n≥1 in X such that
                                                             
                                                          r
                      yn+1 = yn − T (xn ) ∈ OB Y 0, n+1 ,                     (I.10)
                                                        2
                                                    
                                                  1
                               xn ∈ OB X 0, n+1                               (I.11)
                                                2
and
                                                     r
                               yn − T (xn ) <         .                         (I.12)
                                                   2n+1
Now, (I.11) is equivalent to xn  < 2n+1
                                       1
                                          so that setting xn = x0 +x1 +· · ·+xn ,
the sequence (xn )n≥1 is convergent in X. It follows that there exists x ∈ X
                 

such that limn→∞ xn = x and, moreover x  < 1. On the other hand,
406                                            I Complements of Functional Analysis

(I.10) and (I.12) give y0 − T (xn ) = y0 − T (x0 + x1 + · · · + xn ) = y1 −
T (x1 + x2 + · · · + xn ) = · · · = yn − T (xn ) ≤ 2n+1
                                                         r
                                                            so that, passing to
                                 
the limit, we deduce that T (x ) = y0 , since T is continuous. This shows that
OB Y (0, r) ⊂ T (OB X (0, 1)). It follows that T is an open map.

Corollary I.2.2. Let X and Y be two Banach spaces. Let T : X → Y be a
bijective continuous linear map. Then the inverse linear map T −1 : Y → X
is continuous.

Proof. This follows immediately from Theorem I.2.1 since the inverse map
T −1 : Y → X is continuous if and only if T : X → Y is an open map.

Corollary I.2.3. Let X and Y be two Banach spaces. Let T : X → Y be a
continuous linear map. Suppose that for every ε > 0 there exists x ∈ X such
that x = 1 and T (x) < ε. Then T is not bijective.

Proof. Suppose by contradiction that T is bijective. Then, by Corollary I.2.2,
the inverse linear map T −1 : Y → X is continuous. Thus we can ﬁnd a con-
stant M > 0 such that T −1 (y) ≤ M y for all y ∈ Y . Since T is bijective,
this is equivalent to x ≤ M T (x) for all x ∈ X. This clearly contradicts
the hypotheses. Thus, T is not bijective.



I.3 Spectra of Linear Maps

Let (X, ·) be a Banach space. We denote by L(X) the space of all continuous
linear maps T : X → X endowed with the norm

                                            T (x)
                              T  = sup            .
                                     x∈X     x
                                     x=0

We denote by IdX : X → X the identity map.

Deﬁnition I.3.1. Let T ∈ L(X). The set

                σ(T ) = {λ ∈ R : (T − λ IdX ) is not bijective}             (I.13)

is called the real spectrum of T .

Proposition I.3.2. Let T ∈ L(X). Then the spectrum σ(T ) is a compact set
and
                          σ(T ) ⊂ [−T , T ].                   (I.14)

Proof. Let λ ∈ R and suppose that |λ| > T . For y ∈ X the equation

                              (T − λ IdX )(x) = y                           (I.15)
I.4 Uniform Convexity                                                           407

admits a unique solution x ∈ X. Indeed (I.15) is equivalent to
                                      1
                                 x=     (T (x) − y).                         (I.16)
                                      λ
Moreover,  λ1 (T (x1 )−y)− λ1 (T (x2 )−y) ≤ |λ|
                                               1
                                                  T ·x1 −x2  for all x1 , x2 ∈ X
and |λ| T  < 1. It then follows from the Banach ﬁxed point theorem that
       1

there exists a unique x ∈ X satisfying (I.16). It follows that T − λ IdX is
bijective and therefore λ ∈  / σ(T ). This shows (I.14).
   Let us show that R \ σ(T ) is open. Let λ0 ∈ R \ σ(T ) so that T − λ0 IdX
is bijective. By Corollary I.2.2, we have that the inverse map (T − λ0 IdX )−1
is also continuous so that 0 = (T − λ0 IdX )−1  < ∞. Let λ ∈ R such that
|λ − λ0 | < (T −λ0 1IdX )−1 . For y ∈ X we have that the linear equation (I.15)
can be written as T (x) − λ0 x = y + (λ − λ0 )x, that is,

                        x = (T − λ0 IdX )−1 [y + (λ − λ0 )x].                (I.17)

By applying again the Banach ﬁxed point theorem, we deduce that there
exists a unique x ∈ X satisfying (I.17). This shows that T −λ IdX is bijective,
that is, λ ∈ R\σ(T ). It follows that R\σ(T ) is open. Therefore σ(T ) is closed.




I.4 Uniform Convexity

Deﬁnition I.4.1. A normed space (X,  · ) is said to be uniformly convex
if, for every ε > 0, there exists δ > 0 such that
                                            ,      ,
                                            ,x + y ,
                    x − y > ε implies ,   ,      ,<1−δ
                                                2 ,

for all x, y ∈ X with x, y ≤ 1.

   Let Z be a nonempty set not reduced to a single point. Then the Banach
space 1 (Z) is not uniformly convex. For instance, if z, z  ∈ Z are distinct,
setting x = δz and y = δz , one has x1 = y1 = 1, x − y1 = 2, but
   2 1 = 1.
 x+y
   On the other hand, we have the following:

Proposition I.4.2. Let X be a vector space equipped with a scalar product
·, · and denote by  ·  the associated norm. Then the normed space (X,  · )
is uniformly convex. In particular, every Hilbert space is uniformly convex.

Proof. Let x, y ∈ X such that x, y ≤ 1. Then, we have
408                                        I Complements of Functional Analysis
,       ,
, x + y ,2 1         1
,       ,        2
, 2 , + 4 x − y = 4 (x + y, x + y + x − y, x − y)
                     1
                   = (x, x + y, y + 2x, y + x, x + y, y − 2x, y)
                     4
                     1
                   =    2x2 + 2y2
                     4
                   ≤ 1.

Therefore,                ,       ,
                          , x + y ,2      1
                          ,       ,
                          , 2 , ≤ 1 − 4 x − y .
                                                    2
                                                                       (I.18)
                                     √
  Let now ε > 0 and set δ = 1 − 12 4 − ε2 . Suppose that x − y > ε. This
                               2
implies 1 − 14 x − y2 < 1 − ε4 = (1 − δ)2 . From (I.18) we then deduce that
 2  < 1 − δ. This shows that X is uniformly convex.
 x+y
Appendix J
Ultraﬁlters




J.1 Filters and Ultraﬁlters

Let X be a set. We denote by P(X) the set of all subsets of X.

Deﬁnition J.1.1. A ﬁlter on X is a nonempty set F ⊂ P(X) satisfying the
following conditions:
(F-1) ∅ ∈/ F;
(F-2) if A ∈ F and A ⊂ B ⊂ X, then B ∈ F;
(F-3) if A ∈ F and B ∈ F, then A ∩ B ∈ F.

Examples J.1.2. (a) Let X be a set and let A0 be a nonempty subset of X.
Then the set {A ∈ P(X) : A0 ⊂ A} is a ﬁlter on X. A ﬁlter F on X is said
to be a principal ﬁlter if there exists a nonempty subset A0 of X such that
F = {A ∈ P(X) : A0 ⊂ A}. One then says that F is the principal ﬁlter based
on A0 .
    (b) Let X be a set and Ω ⊂ P(X). Suppose that ∅ ∈       / Ω and that, given
A1 , A2 ∈ Ω, there exists A ∈ Ω such that A ⊂ A1 ∩ A2 . Then the set

     F(Ω) = {A ∈ P(X) : there exists A ∈ Ω such that A ⊂ A}                (J.1)

is a ﬁlter on X and one has Ω ⊂ F(Ω). The ﬁlter F(Ω) is called the ﬁlter
generated by Ω.
   (c) Let (I, ≤) be a nonempty directed set. A subset A ⊂ I is called residual
in I if there exists i ∈ I such that A ⊃ {j ∈ I : i ≤ j}. Clearly, the set Fr (I)
of all residual subsets of I is a ﬁlter on I. It is the ﬁlter generated by the sets
{j ∈ I : i ≤ j}, i ∈ I. The ﬁlter Fr (I) is called the residual ﬁlter on I.
   (d) Let X be an inﬁnite set. Then the set F = {A ∈ P(X) : X \A is ﬁnite}
is a ﬁlter. It is called the Fréchet ﬁlter on X. If we consider the directed
set (N, ≤), a subset A ⊂ N is residual if and only if its complement N \ A is
ﬁnite. Therefore, the residual ﬁlter on N equals the Fréchet ﬁlter on N.


T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,         409
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1 18, © Springer-Verlag Berlin Heidelberg 2010
410                                                                 J Ultraﬁlters

  (e) Let X be a topological space and let x be a point in X. Then, the set
Fx of all neighborhoods of x is a ﬁlter on X.
  (f) Let X be a nonempty uniform space (cf. Appendix B). Then the set
U ⊂ P(X × X) of all entourages of X is a ﬁlter on X × X.

  Note that for a ﬁlter F ⊂ P(X) the following also holds true:

(F-4) if A ⊂ X, then A and X \ A cannotboth belong to F;
                                               n
(F-5) if A1 , A2 , . . . , An ∈ F, n ≥ 1, then i=1 Ai ∈ F;
(F-6) X ∈ F.

   Indeed, (F-4) follows from (F-1) and (F-3) with B = X \ A. From (F-3)
we deduce by induction condition (F-5). Finally, (F-6) follows from the fact
that F = ∅ and (F-2).

Proposition J.1.3. Let X be a set and Ω0 ⊂ P(X). Then, there exists a
ﬁlter on X containing Ω0 if an only if Ω0 has the ﬁnite intersection property,
that is, every ﬁnite family of elements in Ω0 has nonempty intersection.

Proof. Let Ω0 ⊂ P(X) be a set and suppose that there exists a ﬁlter F such
that Ω0 ⊂ F. By (F-1) and (F-5) we have that Ω0 has the ﬁnite intersection
property. Conversely, suppose that Ω0 has the ﬁnite intersection property.
Consider the set Ω consisting of all ﬁnite intersections of elements of Ω0 .
Then, Ω satisﬁes the conditions in Example J.1.2(b), and therefore the ﬁlter
generated by Ω is a ﬁlter containing Ω0 .

Deﬁnition J.1.4. A ﬁlter ω ⊂ P(X) is called an ultraﬁlter on X if it satis-
ﬁes the condition

(UF) if A ⊂ X, then A ∈ ω or (X \ A) ∈ ω.

Example J.1.5. Let X be a set and x ∈ X. Then the principal ﬁlter based on
{x} is an ultraﬁlter. An ultraﬁlter ω on X is called principal if there exists
x ∈ X such that ω is the principal ﬁlter based on {x}. Note that a principal
ﬁlter is an ultraﬁlter if and only if it is based on a singleton. If X is ﬁnite,
then every ultraﬁlter is, clearly, principal.
   An ultraﬁlter which is not principal is called non-principal (or free).

Theorem J.1.6. Let X be a nonempty set. Let F0 be a ﬁlter on X. Then
there exists an ultraﬁlter ω on X containing F0 .

  Let us ﬁrst prove the following:

Lemma J.1.7. Let X be a set. Let F be a ﬁlter on X. Suppose there exists
a set A0 ∈ P(X) such that A0 ∈
                             / F and (X \ A0 ) ∈/ F. Then there exists a
ﬁlter F  on X such that
J.1 Filters and Ultraﬁlters                                                411

(1) F ⊂ F  ;
(2) A0 ∈ F  .
Proof. Consider the principal ﬁlter F0 based on A0 and set

     F  = {B ∈ P(X) : B ⊃ A ∩ A for some A ∈ F and A ∈ F0 }.           (J.2)

Let us show that F  satisﬁes the required conditions. First of all, taking
A = X we have A = A ∩ X ∈ F  for all A ∈ F. This shows (1). On the
other hand, taking A = X and A = A0 we have A0 = X ∩ A0 ∈ F, and this
shows (2).
   We are only left to show that F  is a ﬁlter. Let B ∈ F  and denote by
A ∈ F and A ∈ F0 two sets such that A ∩ A ⊂ B.
   Let us ﬁrst show that A ∩ A = ∅. Suppose the contrary. Then A ⊂
(X \ A ) ⊂ (X \ A0 ). As A belongs to the ﬁlter F, it follows from (F-2) that
(X \ A0 ) ∈ F, contradicting our assumptions. It follows that A ∩ A = ∅ and
therefore B = ∅. This shows (F-1). Suppose now that B  ∈ P(X) contains
B. Then (A ∩ A ) ⊂ B  so that B  ∈ F  . This shows (F-2). Finally, let
B1 , B2 ∈ F  . For i = 1, 2 denote by Ai ∈ F and Ai ∈ F0 two sets such that
Ai ∩ Ai ⊂ Bi . We have
                                                        
         B1 ∩ B2 ⊃ (A1 ∩ A1 ) (A2 ∩ A2 ) = (A1 ∩ A2 ) (A1 ∩ A2 ).

But A1 ∩ A2 belongs to the ﬁlter F, and A1 ∩ A2 ∈ F0 as both A1 and A2
contain A0 . It follows that B1 ∩ B2 ∈ F  . This shows (F-3). It follows that
F  is a ﬁlter.
Proof of Theorem J.1.6. Consider the set Φ0 consisting of all ﬁlters on X
containing F0 . This is a nonempty set, partially orderedby inclusion. Let Φ
be a totally ordered subset of Φ0 . We claim that F = F ∈Φ F is an upper
bound for Φ. We only have to show that F belongs to Φ0 . As ∅ ∈    / F for all
F ∈ Φ we also have ∅ ∈      This shows that F satisﬁes condition (F-1). Let
                         / F.
now A ∈ F and B ⊂ X be such that A ⊂ B. Then there exists F ∈ Φ such
that A ∈ F. As F is a ﬁlter, we have B ∈ F, by (F-2). It then follows that
B ∈ F.  This shows that F satisﬁes condition (F-2). Finally, suppose that
A, B ∈ F. Then there exist FA , FB ∈ Φ such that A ∈ FA and B ∈ FB . As Φ
is totally ordered, up to exchanging A and B we can suppose that FA ⊂ FB .
We then have A, B ∈ FB and therefore A ∩ B ∈ FB , by (F-3). It follows that
A ∩ B ∈ F.  Therefore F satisﬁes condition (F-3) as well. This shows that Φ0
is inductive.
    By Zorn’s lemma, Φ0 contains a maximal element ω. Let us show that ω
is an ultraﬁlter on X. Let A0 ⊂ X. Suppose that A0 , (X \ A0 ) ∈    / ω. Then,
by Lemma J.1.7, there exists a ﬁlter ω  containing A0 and ω. As ω  is in Φ0
and properly contains ω, this contradicts the maximality of ω. It follows that
either A0 or X \ A0 belongs to ω. This shows that ω satisﬁes condition (UF),
and therefore it is an ultraﬁlter.
412                                                                 J Ultraﬁlters

Corollary J.1.8. Let X be a set. Let F be a ﬁlter on X. Then the following
conditions are equivalent.
(a) F is an ultraﬁlter;
(b) F is a maximal ﬁlter, that is, if F  is a ﬁlter containing F, then F  = F.

Proof. Suppose (a) and let F  be a ﬁlter properly containing F. Let A ∈
F  \ F. As F is an ultraﬁlter, (X \ A) ∈ F ⊂ F  . Thus, both A and (X \ A)
belong to F  contradicting (F-4). This shows that F  = F and the implication
(a) ⇒ (b) follows. Suppose now that F is a maximal ﬁlter. By Theorem J.1.6
there exists an ultraﬁlter ω containing F. By maximality we have F = ω,
that is, F is an ultraﬁlter. This shows (b) ⇒ (a).



J.2 Limits Along Filters

Deﬁnition J.2.1. Let X be a topological space. A ﬁlter F on X is said to
be convergent if there exists a point x0 ∈ X such that all neighborhoods of
x0 belong to F. One then says that x0 is a limit of F and that F converges
to x0 .

Remark J.2.2. A topological space X is Hausdorﬀ if and only if every con-
vergent ﬁlter on X has a unique limit point in X. Indeed, suppose that X
is Hausdorﬀ and let F be a ﬁlter converging to two distinct points x, y ∈ X.
Let U ∈ Fx ⊂ F and V ∈ Fy ⊂ F be such that U ∩ V = ∅. As U, V ∈ F
we also have U ∩ V ∈ F and this contradicts (F-1). Conversely, suppose that
X is not Hausdorﬀ. Then there exist two distinct points x, y ∈ X such that
for all U ∈ Fx and V ∈ Fy one has U ∩ V = ∅. It follows that the set
Ω = Fx ∪ Fy ⊂ P(X) has the ﬁnite intersection property. Thus, by Proposi-
tion J.1.3, there exists a ﬁlter F containing both Fx and Fy . It follows that
F converges to both x and y.

Theorem J.2.3. Let X be a topological space. Then the following conditions
are equivalent:
(a) X is compact;
(b) every ultraﬁlter on X is convergent.

Proof. Suppose (a) and let ω be an ultraﬁlter on X. Let A1 , A2 , . . . , An ,
n ≥ 1, be 
           elements in ω and denote by A1 , A2 , . . . , An their closures. As
  n          n
     A
  i=1 i  ⊃   i=1 Ai = ∅ (by (F-1) and (F-5)), we have that the family (A)A∈ω
in X has the ﬁnite intersection property andtherefore, by compactness of X,
it has a nonempty intersection. Let x ∈ A∈ω A. As x ∈ A for all A ∈
ω, it follows that for every V ∈ Fx we have A ∩ V = ∅. Consider the
set Ω = {A ∩ V : A ∈ ω, V ∈ Fx } ⊂ P(X). Observe that Ω has the
ﬁnite intersection property and denote by F(Ω) the ﬁlter generated by Ω
J.2 Limits Along Filters                                                    413

(cf. Example J.1.2(b)). We have ω ⊂ Ω ⊂ F(Ω) and, as ω is an ultraﬁlter,
it follows from Corollary J.1.8 that ω = F(Ω). As Fx ⊂ Ω, we deduce that
Fx ⊂ ω, that is, ω converges to x.
    Conversely, suppose (b). Let (Ci )i∈I be a family of closed subsets of X
with the ﬁnite intersection property. To prove that X is compact we have to
show that                         
                                     Ci = ∅.                           (J.3)
                                  i∈I

By Proposition J.1.3 there exists a ﬁlter F such that Ci ∈ F for all i ∈ I.
By Theorem J.1.6 there exists an ultraﬁlter ω such that F ⊂ ω. By our
assumptions, there exists x ∈ X such that ω converges to x, equivalently,
Fx ⊂ ω. Let i ∈ I. by (F-1) and (F-3), we have Ci ∩ V = ∅ for all V ∈ Fx .
As Ci is closed, we have x ∈ Ci . Thus x ∈ i∈I Ci , and (J.3) follows.
Deﬁnition J.2.4. Let X be a set, Y a topological space, y0 a point of Y ,
f : X → Y a map and F a ﬁlter on X. One says that y0 is a limit of f along
F (or that f (x) converges to y0 along F), and one writes

                                 f (x) −→ y0 ,
                                        x→F

if f −1 (V ) = {x ∈ X : f (x) ∈ V } belongs to F for all neighborhoods V of y0 .
If such a limit point y0 is unique one writes

                                lim f (x) = y0 .
                                x→F

Examples J.2.5. (a) Let X and Y be two topological spaces, f : X → Y a
map, x0 ∈ X and y0 ∈ Y . One has that f (x) converges to y0 in Y for x
tending to x0 if and only if f (x) −→ y0 .
                                  x→Fx0
    (b) Let X be a topological space and f : N → X a map. The sequence
(f (n))n∈N converges to x ∈ X, if and only if x is a limit of f along the
Fréchet ﬁlter on N.
    (c) Let (I, ≤) be a directed set and let F be the residual ﬁlter on I. Let
Y be a topological space and (yi )i∈I a net in Y . Then (yi )i∈I converges to a
point y0 ∈ Y if and only if yi −→ y0 . Note that (b) is a particular case of
                                i→F
the present example.
Corollary J.2.6. Let X be a set, Y a compact topological space, f : X →
Y a map, and ω an ultraﬁlter on X. Then there exists y0 ∈ Y such that
f (x) −→ y0 . Moreover, if X is Hausdorﬀ such an y0 is unique.
     x→F

Proof. The set f (ω) = {f (A) : A ∈ ω} ⊂ P(Y ) has the ﬁnite intersection
property since f (A)∩f (B) ⊃ f (A∩B) = ∅ for all A, B ∈ ω. Let F denote the
ﬁlter generated by f (ω). By Theorem J.1.6, there exists an ultraﬁlter ω  on Y
which contains F. As Y is compact, by Theorem J.2.3 there exists y0 ∈ Y such
that ω  converges to y0 . Let us show that if V is a neighborhood of y0 , then
414                                                                    J Ultraﬁlters

f −1 (V ) belongs to ω. Suppose the contrary. As ω is an ultraﬁlter, by (UF)
we have X \ f −1 (V ) = {x ∈ X : f (x) ∈
                                       / V } ∈ ω. Setting U = f (X \ f −1 (V )),
we have U ∈ f (ω) ⊂ F ⊂ ω . But V ∈ Fy0 ⊂ ω  and, by construction,
                               

U ∩ V = ∅. As U ∩ V ∈ ω  , this contradicts (F-1). This shows that y0 is
a limit of f along ω. If X is Hausdorﬀ, then uniqueness of y0 follows from
Remark J.2.2.
Proposition J.2.7. Let X be a set and let F be a ﬁlter on X. Let Y , Z be
two topological spaces and f : X → Y and g : X → Z be two maps. Equip
Y × Z with the product topology and let F : X → Y × Z be the map deﬁned
by F (x) = (f (x), g(x)) for all x ∈ X. Suppose that there exist y0 ∈ Y and
z0 ∈ Z such that f (x) −→ y0 and g(x) −→ z0 . Then F (x) −→ (y0 , z0 ).
                        x→F                x→F                   x→F

Proof. Let W ⊂ Y × Z be a neighborhood of the point (y0 , z0 ). By deﬁnition
of the product topology, there exist neighborhoods U ⊂ Y of y0 and V ⊂ Z of
z0 such that U × V ⊂ W . As f (x) −→ y0 , we have f −1 (U ) ∈ F. Similarly, as
                                     x→F
g(x) −→ z0 , we have g −1 (V ) ∈ F. It follows that f −1 (U ) ∩ g −1 (V ) belongs
      x→F
to F and as F −1 (W ) ⊃ F −1 (U × V ) = f −1 (U ) ∩ g −1 (V ), we deduce from
(F-2) that F −1 (W ) ∈ F. This shows that F (x) −→ (y0 , z0 ).
                                                    x→F

Proposition J.2.8. Let X be a set and let F be a ﬁlter on X. Let Y , Z be
two topological spaces and f : X → Y and g : Y → Z be two maps. Suppose
that there exists y0 ∈ Y such that f (x) −→ y0 and that g is continuous at
                                            x→F
y0 . Then (g ◦ f )(x) −→ g(y0 ).
                     x→F

Proof. Let W ⊂ Z be a neighborhood of g(y0 ). By continuity of g there exists
a neighborhood V ⊂ Y of y0 such that g −1 (W ) ⊃ V . By deﬁnition of limit,
we have f −1 (V ) ∈ F. As (g ◦ f )−1 (W ) = f −1 (g −1 (W )) ⊃ f −1 (V ), it follows
from (F-2) that (g ◦ f )−1 (W ) ∈ F. This shows that (g ◦ f )(x) −→ g(y0 ).
                                                                   x→F

Proposition J.2.9. Let X be a set and let F be a ﬁlter on X. Let f1 , f2 : X →
R be two maps such that f1 ≤ f2 (i.e. f1 (x) ≤ f2 (x) for all x ∈ X). Suppose
that there exists y1 ∈ R (resp. y2 ∈ R) such that y1 = limx→F f1 (x) (resp.
y2 = limx→F f2 (x)). Then y1 ≤ y2 .
Proof. Suppose, by contradiction, that y1 > y2 . Set r = y1 −y 3
                                                                  2
                                                                    and let V1 =
(y1 −r, y1 +r) and V2 = (y2 −r, y2 +r). Note that V1 ∩V2 = ∅. By deﬁnition of
limit we have f1−1 (V1 ) ∈ F and f2−1 (V2 ) ∈ F. As F is a ﬁlter we deduce that
f1−1 (V1 ) ∩ f2−1 (V2 ) ∈ F. On the other hand we have f1−1 (V1 ) ∩ f2−1 (V2 ) = ∅
since f1 ≤ f2 . This contradicts (F-2). It follows that y1 ≤ y2 .
   Recall that given a set X, we denote by ∞ (X) the Banach space con-
sisting of all bounded real maps f : X → R equipped with the norm
f ∞ = sup{|f (x)| : x ∈ X}. Moreover, a linear map m : ∞ (X) → R
satisfying m(1) = 1 and m(x) ≥ 0 for all x ∈ ∞ (E) such that x ≥ 0, is
called a mean on X (cf. Deﬁnition 4.1.4).
Notes                                                                    415

Corollary J.2.10. Let X be a set and let ω be an ultraﬁlter on X. For every
f ∈ ∞ (X) there exists a unique y0 ∈ R such that f (x) −→ y0 . Moreover,
                                                          x→ω
the map mω : ∞ (X) → R deﬁned by mω (f ) = limx→ω f (x) is a mean on X,
in particular mω is continuous and mω  = 1.

Proof. Let f ∈ ∞ (X). Using the fact that f (x) ∈ Y = [−f ∞ , f ∞ ] for
all x ∈ X and that Y is compact Hausdorﬀ, we deduce from Corollary J.2.6
that there exists a unique y0 ∈ R such that f (x) −→ y0 .
                                                  x→ω
   Let us show that the map mω is linear. Let a ∈ R. Consider the continuous
map g : R → R deﬁned by g(y) = ay for all y ∈ R. Then af = g ◦ f and from
Proposition J.2.8 we deduce

              mω (af ) = lim (af )(x) = a lim f (x) = amω (f ).
                         x→ω              i→ω

   Let now f, g ∈ ∞ (X). Consider the map F : X → R2 deﬁned by setting
F (x) = (f (x), g(x)) for all x ∈ X and the continuous map G : R2 → R deﬁned
by G(y1 , y2 ) = y1 + y2 . Then f + g = G ◦ F and from Proposition J.2.7 and
Proposition J.2.8 we deduce
                                  (         ) (          )
mω (f + g) = lim (f + g)(x) = lim f (x) + lim g(x) = mω (f ) + mω (g).
             x→ω                x→ω             x→ω

This shows that mω is linear.
  Let now f (x) = 1 for all x ∈ X. For every neighborhood V of 1 ∈ R we
have f −1 (V ) = {x ∈ X : f (x) ∈ V } = X ∈ ω, by (F-6). This shows that
mω (1) = mω (f ) = limx→ω f (x) = 1.
  Finally, it follows immediately from Proposition J.2.9 that if f ≥ 0 then
mω (f ) = limx→ω f (x) ≥ 0.
  We have shown that mω is a mean. The last properties of mω follow from
Proposition 4.1.7.



Notes

The deﬁnition of ﬁlter is due to H. Cartan (1937). The full treatment of
convergence along ﬁlters is given in Bourbaki [Bou] as an alternative to the
similar notion of a net developed in 1922 by E. H. Moore and H. L. Smith.
Given a Hausdorﬀ topological space X the set βX of all ultraﬁlters on X
can be given the structure of a compact Hausdorﬀ space, called the Stone-
Čech compactiﬁcation of X. This is the largest compact Hausdorﬀ space
“generated” by X, in the sense that any map from X to a compact Hausdorﬀ
space factors through βX in a unique way. The elements x of X correspond
to the principal ultraﬁlters ω({x}) on X.
   Let now X be any set. With every ultraﬁlter ω on X one associates
the {0, 1}-valued ﬁnitely additive probability measure μω on X deﬁned
416                                                           J Ultraﬁlters

by μω (A) = 1 if A ∈ ω and μω (A) = 0 if A ∈ P(X) \ ω. Conversely,
given a {0, 1}-valued ﬁnitely additive probability measure μ on X, the set
ωμ = {A ∈ P(X) : μ(A) = 1} is an ultraﬁlter on X. This establishes a one-
to-one correspondence between the ultraﬁlters ω on X and the {0, 1}-valued
ﬁnitely additive probability measures on X. In Sect. 4.1 we considered the
set MP(X) (resp. M(X)) of all ﬁnitely additive probability measures (resp.
of all means) on X and we showed that there exists a natural bijective map
Φ : MP(X) → M(X). Then one has Φ−1 (μω ) = mω for all ultraﬁlters ω
on X.
Open Problems




In the list below we collect some open problems related to the topics treated
in this book.

 (OP-1) Let G be an amenable periodic group which is not locally ﬁnite.
        Does there exist a ﬁnite set A and a cellular automaton τ : AG → AG
        which is surjective but not injective?
 (OP-2) Let G be a periodic group which is not locally ﬁnite and let A
        be an inﬁnite set. Does there exist a bijective cellular automaton
        τ : AG → AG which is not invertible?
 (OP-3) Let G be a periodic group which is not locally ﬁnite and let V be
        an inﬁnite-dimensional vector space over a ﬁeld K. Does there exist
        a bijective linear cellular automaton τ : V G → V G which is not
        invertible?
 (OP-4) Is every Gromov-hyperbolic group residually ﬁnite (resp. residually
        amenable, resp. soﬁc, resp. surjunctive)?
 (OP-5) (Gottschalk’s conjecture) Is every group surjunctive?
 (OP-6) Let G be a periodic group which is not locally ﬁnite and let A
        be an inﬁnite set. Does there exist a cellular automaton τ : AG →
        AG whose image τ (AG ) is not closed in AG with respect to the
        prodiscrete topology?
 (OP-7) Let G be a periodic group which is not locally ﬁnite and let V be
        an inﬁnite-dimensional vector space over a ﬁeld K. Does there exist
        a linear cellular automaton τ : V G → V G whose image τ (V G ) is not
        closed in V G with respect to the prodiscrete topology?
 (OP-8) Let G and H be two quasi-isometric groups. Suppose that G is
        surjunctive. Is it true that H is surjunctive?
 (OP-9) Let G be a non-amenable group. Does there exist a ﬁnite set A and
        a cellular automaton τ : AG → AG which is pre-injective but not
        surjective?
(OP-10) Does there exist a non-soﬁc group?
(OP-11) Does there exist a surjunctive group which is non-soﬁc?

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,    417
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1, © Springer-Verlag Berlin Heidelberg 2010
418                                                             Open Problems

(OP-12) Let G and H be two quasi-isometric groups. Suppose that G is soﬁc.
        Is it true that H is soﬁc?
(OP-13) Let G be a non-amenable group and let K be a ﬁeld. Does there
        exist a ﬁnite-dimensional K-vector space V and a linear cellular
        automaton τ : V G → V G which is pre-injective but not surjective?
(OP-14) Let G be a non-amenable group and let K be a ﬁeld. Does there
        exist a ﬁnite-dimensional K-vector space V and a linear cellular
        automaton τ : V G → V G which is surjective but not pre-injective?
(OP-15) (Kaplanski’s stable ﬁniteness conjecture) Is the group algebra K[G]
        stably ﬁnite for any group G and any ﬁeld K? Equivalently, is every
        group L-surjunctive, that is, is it true that, for any group G, any
        ﬁeld K, and any ﬁnite-dimensional K-vector space V , every injective
        linear cellular a automaton τ : V G → V G is surjective?
(OP-16) (Kaplanski’s zero-divisors conjecture) Is it true that the group alge-
        bra K[G] has no zero-divisors for any torsion-free group G and any
        ﬁeld K? Equivalently, is it true that, for any torsion-free group G
        and any ﬁeld K, every non-identically-zero linear cellular automaton
        τ : KG → KG is pre-injective?
(OP-17) Is every unique-product group orderable?



Comments

(OP-1) The answer to this question is aﬃrmative if G is non-periodic, i.e.,
it contains an element of inﬁnite order (see Exercise 3.23), or if G is non-
amenable (Theorem 5.12.1). On the other hand, if G is a locally ﬁnite group
and A is a ﬁnite set, then every surjective cellular automaton τ : AG → AG
is injective (see Exercise 3.21). An example of an amenable periodic group
which is not locally ﬁnite is provided by the Grigorchuck group described in
Sect. 6.9.
    (OP-2) The answer is aﬃrmative if G is not periodic (cf. [CeC11, Corol-
lary 1.2]). On the other hand, if G is locally ﬁnite and A is an arbitrary
set, then every bijective cellular automaton τ : AG → AG is invertible (cf.
Exercise 3.20 or [CeC11, Proposition 4.1]).
    (OP-3) The answer is aﬃrmative if G is not periodic (cf. [CeC11, The-
orem 1.1]). On the other hand, if G is locally ﬁnite and V is an arbitrary
vector space, then every bijective linear cellular automaton τ : V G → V G is
invertible (cf. [CeC11, Proposition 4.1]).
    (OP-5) Every soﬁc group is surjunctive (cf. Theorem 7.8.1).
    (OP-6) When A is a ﬁnite set and G is an arbitrary group, it follows
from Lemma 3.3.2 that the image of every cellular automaton τ : AG → AG
is closed in AG . When A is an inﬁnite set and G is a non-periodic group,
it is shown in [CeC11, Corollary 1.4] that there exists a cellular automaton
τ : AG → AG whose image is not closed in AG . On the other hand, when G
Comments                                                                    419

is locally ﬁnite, then, for any set A, the image of every cellular automaton
τ : AG → AG is closed in AG (cf. Exercise 3.22 or [CeC11, Proposition 4.1]).
    (OP-6) When V is a ﬁnite-dimensional vector space over a ﬁeld K and
G is an arbitrary group, it follows from Theorem 8.8.1 that the image of
every linear cellular automaton τ : V G → V G is closed in V G . When V
is an inﬁnite-dimensional vector space and G is a non-periodic group, it is
shown in [CeC11, Theorem 1.3] that there exists a linear cellular automaton
τ : V G → V G whose image is not closed in V G . On the other hand, when G is
locally ﬁnite, then, for any vector space V , the image of every linear cellular
automaton τ : V G → V G is closed in V G (cf. [CeC11, Proposition 4.1]).
    (OP-9) The answer is aﬃrmative if G contains a nonabelian free subgroup
(cf. Proposition 5.11.1).
    (OP-13) The answer is aﬃrmative if G contains a nonabelian free subgroup
(cf. Corollary 8.10.2).
    (OP-14) The answer is aﬃrmative if G contains a nonabelian free subgroup
(cf. Corollary 8.11.2).
    (OP-15) See the discussion in the notes at the end of Chap. 8.
    (OP-16) See the discussion in the notes at the end of Chap. 8.
References




      [Abe] Abels, H.: An example of a ﬁnitely presented solvable group. In: Homological
             Group Theory Proc. Sympos., Durham, 1977. London Math. Soc. Lecture Note
             Ser., vol. 36, pp. 205–211. Cambridge University Press, Cambridge (1979)
     [Ady] Adyan, S.I.: Random walks on free periodic groups. Math. USSR, Izv. 21,
             425–434 (1983)
       [AlS] Allouche, J.-P., Shallit, J.: Automatic Sequences: Theory, Applications, Gen-
             eralizations. Cambridge University Press, Cambridge (2003)
    [Amo] Amoroso, S., Patt, Y.N.: Decision procedures for surjectivity and injectivity
             of parallel maps for tessellation structures. J. Comput. Syst. Sci. 6, 448–464
             (1972)
    [AOP] Ara, P., O’Meara, K.C., Perera, F.: Stable ﬁniteness of group rings in arbitrary
             characteristic. Adv. Math. 170, 224–238 (2002)
      [Aus] Auslander, L.: On a problem of Philip Hall. Ann. Math. 86, 112–116 (1967)
 [BanMS] Bandini, S., Mauri, G., Serra, R.: Cellular automata: from a theoreticel paral-
             lel computational model to its application to complex systems. Parallel Com-
             put. 27(5), 539–553 (2001). Cellular Automata: From Modeling to Applications
             (Trieste, 1998)
       [Bar] Bartholdi, L.: Gardens of Eden and amenability on cellular automata. J. Eur.
             Math. Soc. 12, 241–248 (2010)
       [Bas] Bass, H.: The degree of polynomial growth of ﬁnitely generated nilpotent
             groups. Proc. Lond. Math. Soc. 25, 603–614 (1972)
      [Bau] Baumslag, G.: Automorphism groups of residually ﬁnite groups. J. Lond. Math.
             Soc. 38, 117–118 (1963)
      [BaS] Baumslag, G., Solitar, D.: Some two-generator one-relator non-Hopﬁan groups.
             Bull. Am. Math. Soc. 68, 199–201 (1962)
    [BDV] Bekka, B., de la Harpe, P., Valette, A.: Kazhdan’s Property (T ). New Mathe-
             matical Monographs, vol. 11. Cambridge University Press, Cambridge (2008)
       [Ber] Bergman, G.M.: Right orderable groups that are not locally indicable. Pac. J.
             Math. 147, 243–248 (1991)
    [BCG] Berlekamp, E.R., Conway, J.H., Guy, R.K.: Winning Ways for Your Mathe-
             matical Plays, vol. 2, 2nd edn. AK Peters, Natick (2003)
   [BKM] Blanchard, F., Kůrka, P., Maass, A.: Topological and measure-theoretic prop-
             erties of one-dimensional cellular automata. Physica D 103(1–4), 86–99 (1997).
             Lattice Dynamics (Paris, 1995)
     [BoR] Botto Mura, R., Rhemtulla, A.: Orderable Groups. Lecture Notes in Pure and
             Applied Mathematics, vol. 27. Dekker, New York (1977)
      [Bou] Bourbaki, N.: Topologie Générale, Chapitres 1 à 4. Hermann, Paris (1971)

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,                 421
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1, © Springer-Verlag Berlin Heidelberg 2010
422                                                                               References

      [Bow] Bowen, L.: Measure conjugacy invariants for actions of countable soﬁc groups.
             J. Amer. Math. Soc. 23, 217–245 (2010)
     [BuM] Burger, M., Mozes, S.: Lattices in product of trees. Publ. Math. IHÉS 92,
             151–194 (2000)
       [Bur] Burks, A.W.: von Neumann’s self-reproducing automata. In: Burks, A.W. (ed.)
             Essays on Cellular Automata, pp. 3–64. University of Illinois Press, Champaign
             (1971)
     [CFP] Cannon, J.W., Floyd, W.J., Parry, W.R.: Introductory notes on Richard
             Thompsons groups. Enseign. Math. 42, 215–256 (1996)
    [CeC1] Ceccherini-Silberstein, T., Coornaert, M.: The Garden of Eden theorem for
             linear cellular automata. Ergod. Theory Dyn. Syst. 26, 53–68 (2006)
    [CeC2] Ceccherini-Silberstein, T., Coornaert, M.: Injective linear cellular automata and
             soﬁc groups. Isr. J. Math. 161, 1–15 (2007)
    [CeC3] Ceccherini-Silberstein, T., Coornaert, M.: On the surjunctivity of Artinian lin-
             ear cellular automata over residually ﬁnite groups. In: Geometric Group Theory.
             Trends in Mathematics, pp. 37–44. Birkhäuser, Basel (2007)
    [CeC4] Ceccherini-Silberstein, T., Coornaert, M.: Amenability and linear cellular au-
             tomata over semisimple modules of ﬁnite length. Commun. Algebra 36, 1320–
             1335 (2008)
    [CeC5] Ceccherini-Silberstein, T., Coornaert, M.: Linear cellular automata over mod-
             ules of ﬁnite length and stable ﬁniteness of group rings. J. Algebra 317, 743–758
             (2007)
    [CeC6] Ceccherini-Silberstein, T., Coornaert, M.: A note on Laplace operators on
             groups. In: Limits of Graphs in Group Theory and Computer Science, pp. 37–
             40. EPFL Press, Lausanne (2009)
    [CeC7] Ceccherini-Silberstein, T., Coornaert, M.: A generalization of the Curtis-
             Hedlund theorem. Theor. Comput. Sci. 400, 225–229 (2008)
    [CeC8] Ceccherini-Silberstein, T., Coornaert, M.: Induction and restriction of cellular
             automata. Ergod. Theory Dyn. Syst. 29, 371–380 (2009)
    [CeC9] Ceccherini-Silberstein, T., Coornaert, M.: On a characterization of locally ﬁnite
             groups in terms of linear cellular automata, J. Cell. Autom., to appear
  [CeC10] Ceccherini-Silberstein, T., Coornaert, M.: Expansive actions on uniform spaces
             and surjunctive maps, arXiv:0810.1295
  [CeC11] Ceccherini-Silberstein, T., Coornaert, M.: On the reversibility and the closed
             image property of linear cellular automata, arXiv:0910.0863
      [CFS] Ceccherini-Silberstein, T., Fiorenzi, F., Scarabotti, F.: The Garden of Eden
             theorem for cellular automata and for symbolic dynamical systems. In:
             Kaimanovich, V.A. (ed.) Random Walks and Geometry, pp. 73–108. de
             Gruyter, Berlin (2004)
  [CGH1] Ceccherini-Silberstein, T., Grigorchuk, R.I., de la Harpe, P.: Amenability and
             paradoxical decompositions for pseudogroups and discrete metric spaces. Proc.
             Steklov Inst. Math. 224, 57–97 (1999)
  [CGH2] Ceccherini-Silberstein, T., Grigorchuk, R.I., de la Harpe, P.: Décompositions
             paradoxales des groupes de Burnside [Paradoxical decompositions of free Burn-
             side groups]. C. R. Acad. Sci., Sér. 1 Math. 327, 127–132 (1998)
   [CMS1] Ceccherini-Silberstein, T.G., Machı̀, A., Scarabotti, F.: Amenable groups and
             cellular automata. Ann. Inst. Fourier 49, 673–685 (1999)
   [CMS2] Ceccherini-Silberstein, T.G., Machı̀, A., Scarabotti, F.: The Grigorchuk group
             of intermediate growth. Rend. Circ. Mat. Palermo 50(1), 67–102 (2001)
       [Cha] Champetier, C.: L’espace des groupes de type ﬁni. Topology 39, 657–680
             (2000)
       [Che] Chernoﬀ, P.R.: A simple proof of Tychonoﬀ’s theorem via nets. Am. Math.
             Mon. 99, 932–934 (1992)
References                                                                                423

      [Coh] Cohn, P.M.: Some remarks on the invariant basis property. Topology 5, 215–228
              (1966)
      [Con] Connell, I.G.: On the group ring. Can. J. Math. 15, 650–685 (1963)
       [Cor] Cornulier, Y.: A soﬁc group away from amenable groups. arXiv:0906.3374
   [CGP] de Cornulier, Y., Guyot, L., Pitsch, W.: On the isolated points in the space of
              groups. J. Algebra 307, 254–277 (2007)
  [CovN] Coven, E.M., Nitecki, Z.W.: On the genesis of symbolic dynamics as we know
              it. Colloq. Math. 110, 227–242 (2008)
  [CovP] Coven, E., Paul, M.: Endomorphisms of irreducible shifts of ﬁnite type. Math.
              Syst. Theory 8, 167–175 (1974)
   [Day1] Day, M.M.: Amenable semigroups. Ill. J. Math. 1, 509–544 (1957)
   [Day2] Day, M.M.: Fixed-point theorems for compact convex sets. Ill. J. Math. 5,
              585–590 (1961)
   [Day3] Day, M.M.: Convolutions, means and spectra. Ill. J. Math. 8, 100–111 (1964)
      [Deh] Dehornoy, P.: Braid groups and left distributive operations. Trans. Am. Math.
              Soc. 345, 115–151 (1994)
        [DS] Dicks, W., Schick, T.: The spectral measure of certain elements of the complex
              group ring of a wreath product. Geom. Dedic. 93, 121–137 (2002)
      [DrS] Druţu, C., Sapir, M.: Non-linear residually ﬁnite groups. J. Algebra 284, 174–
              178 (2005)
        [Efr] Efremovich, V.A.: The geometry of proximity. I. Mat. Sbornik N. S. 31(73),
              189–200 (1952)
        [Ele] Elek, G.: The rank of ﬁnitely generated modules over group algebras. Proc.
              Am. Math. Soc. 131, 3477–3485 (2003)
      [ES1] Elek, G., Szabó, E.: Soﬁc groups and direct ﬁniteness. J. Algebra 280, 426–434
              (2004)
      [ES2] Elek, G., Szabó, E.: Hyperlinearity, essentially free actions and L2 -invariants.
              The soﬁc property. Math. Ann. 332, 421–441 (2005)
      [ES3] Elek, G., Szabó, E.: On soﬁc groups. J. Group Theory 9, 161–171 (2006)
     [Fio1] Fiorenzi, F.: The Garden of Eden theorem for soﬁc shifts. Pure Math. Appl.
              11, 471–484 (2000)
     [Fio2] Fiorenzi, F.: Cellular automata and strongly irreducible shifts of ﬁnite type.
              Theor. Comput. Sci. 299, 477–493 (2003)
        [Føl] Følner, E.: On groups with full Banach mean value. Math. Scand. 3, 245–254
              (1955)
  [Gar-1] Gardner, M.: The game of life. Mathematical games. Sci. Am. 223, 120–123
              (1970)
  [Gar-2] Gardner, M.: Wheels, Life, and Other Mathematical Amusements. W. H. Free-
              man & Co., San Francisco (1983)
       [Gla] Glass, A.M.W.: Partially Ordered Groups. Series in Algebra, vol. 7. World
              Scientiﬁc, River Edge (1999)
     [GlG] Glebsky, L.Yu., Gordon, E.I.: On surjunctivity of the transition functions of
              cellular automata on groups. Taiwan. J. Math. 9, 511–520 (2005)
     [GlR] Glebsky, L., Rivera, L.M.: Soﬁc groups and proﬁnite topology on free groups.
              J. Algebra 320, 3512–3518 (2008)
    [GolS] Golod, E.S., Shafarevich, I.R.: On the class ﬁeld tower. Izv. Akad. Nauk SSSR,
              Ser. Mat. 28, 261–272 (1964)
     [GoL] Gorin, E.A., Lin, V.Ja.: Algebraic equations with continuous coeﬃcients, and
              certain questions of the algebraic theory of braids. Math. USSR Sb. 7, 569–596
              (1969)
      [Got] Gottschalk, W.H.: Some general dynamical systems. In: Recent Advances in
              Topological Dynamics. Lecture Notes in Mathematics, vol. 318, pp. 120–125.
              Springer, Berlin (1973)
424                                                                                 References

      [GoH] Gottschalk, W.H., Hedlund, G.A.: Topological Dynamics. American Mathe-
              matical Society Colloquium Publications, vol. 36. Am. Math. Soc., Providence
              (1955)
        [Gre] Greenleaf, F.P.: Invariant Means on Topological Groups and their Applications.
              Van Nostrand Mathematical Studies, vol. 16. Van Nostrand-Reinhold, New
              York (1969)
      [Gri1] Grigorchuk, R.I.: Symmetrical random walks on discrete groups. In: Multicom-
              ponent Random Systems. Adv. Probab. Related Topics, vol. 6, pp. 285–325.
              Dekker, New York (1980)
      [Gri2] Grigorchuk, R.I.: On Burnside’s problem on periodic groups. Funct. Anal. Appl.
              14, 41–43 (1980)
      [Gri3] Grigorchuk, R.I.: On the Milnor problem of group growth. Sov. Math. Dokl.
              28, 23–26 (1983)
      [Gri4] Grigorchuk, R.I.: Degrees of growth of ﬁnitely generated groups and the theory
              of invariant means. Izv. Akad. Nauk SSSR, Ser. Mat. 48, 939–985 (1984)
      [Gri5] Grigorchuk, R.I.: Solved and unsolved problems around one group. In: Inﬁ-
              nite Groups: Geometric, Combinatorial and Dynamical Aspects. Progr. Math.,
              vol. 248, pp. 117–218. Birkhäuser, Basel (2005)
   [GriNS] Grigorchuk, R.I., Nekrashevych, V.V., Sushchanskii, V.I.: Automata, dynami-
              cal systems, and groups. Proc. Steklov Inst. Math. 231, 128–203 (2000)
     [GriP] Grigorchuk, R.I., Pak, I.: Groups of intermediate growth: an introduction. En-
              seign. Math. 54, 251–272 (2008)
     [Gro1] Gromov, M.: Inﬁnite groups as geometric objects. In: Proceedings of the Inter-
              national Congress of Mathematicians, vol. 1, 2 (Warsaw, 1983), pp. 385–392.
              PWN, Warsaw (1984)
     [Gro2] Gromov, M.: Groups of polynomial growth and expanding maps. Publ. Math.
              IHÉS 53, 53–73 (1981)
     [Gro3] Gromov, M.: Hyperbolic groups. In: Essays in Group Theory. Math. Sci. Res.
              Inst. Publ., vol. 8, pp. 75–263. Springer, New York (1987)
     [Gro4] Gromov, M.: Asymptotic invariants of inﬁnite groups. In: Niblo, G.A., Roller,
              M.A. (eds.) Geometry Group Theory, Sussex 1991, vol. 2. London Math. Soc.
              Lecture Note Ser., vol. 182. Cambridge University Press, Cambridge (1993)
     [Gro5] Gromov, M.: Endomorphisms of symbolic algebraic varieties. J. Eur. Math.
              Soc. 1, 109–197 (1999)
     [Gro6] Gromov, M.: Topological invariants of dynamical systems and spaces of holo-
              morphic maps, Part I. Math. Phys. Anal. Geom. 2, 323–415 (1999)
       [Had] Hadamard, J.: Les surfaces à courbures opposées et leurs lignes géodésiques. J.
              Math. Pures Appl. 4, 27–73 (1898)
[Hall-M-1] Hall, M.: Distinct representatives of subsets. Bull. Am. Math. Soc. 54, 922–926
              (1948)
 [Hal-M-2] Hall, M.: Subgroups of ﬁnite index in free groups. Can. J. Math. 1, 187–190
              (1949)
    [Hall1] Hall, P.: On representatives of subsets. J. Lond. Math. Soc. 10, 26–30 (1935)
    [Hall2] Hall, P.: On the ﬁniteness of certain soluble groups. Proc. Lond. Math. Soc. 9,
              595–622 (1959)
    [Halm] Halmos, P.R., Vaughan, H.E.: The marriage problem. Am. J. Math. 72, 214–
              215 (1950)
     [Har1] de la Harpe, P.: Free groups in linear groups. Enseign. Math. 29, 129–144
              (1983)
     [Har2] de la Harpe, P.: Topics in Geometric Group Theory. Chicago Lectures in Math-
              ematics. University of Chicago Press, Chicago (2000)
     [Har3] de la Harpe, P.: Mesures ﬁniment additives et paradoxes. In: Autour du Cente-
              naire Lebesgue. Panor. Synthèses, vol. 18, pp. 39–61. Soc. Math. France, Paris
              (2004)
References                                                                             425

  [Hed-1] Hedlund, G.A.: Sturmian minimal sets. Am. J. Math. 66, 605–620 (1944)
  [Hed-2] Hedlund, G.A.: Transformations commuting with the shift. In: Gottschalk,
              W.H., Auslander, J. (eds) Topological Dynamics. Benjamin, New York (1968)
  [Hed-3] Hedlund, G.A.: Endormorphisms and automorphisms of the shift dynamical
              system. Math. Syst. Theory 3, 320–375 (1969)
       [Hig] Higman, G.: A ﬁnitely related group with an isomorphic proper factor group.
              J. Lond. Math. Soc. 26, 59–61 (1951)
       [Hir] Hirsch, K.A.: On inﬁnite soluble groups. IV. J. Lond. Math. Soc. 27, 81–85
              (1952)
      [Hun] Hungerford, T.W.: Algebra. Graduate Texts in Mathematics. Springer, New
              York (1987)
        [Isb] Isbell, J.R.: Uniform Spaces. Mathematical Surveys, vol. 12. Am. Math. Soc.,
              Providence (1964)
       [Jac] Jachymski, J.R.: Another proof of the Markov-Kakutani theorem, and an ex-
              tension. Math. Jpn. 47, 19–20 (1998)
      [Jam] James, I.M.: Introduction to Uniform Spaces. London Mathematical Society
              Lecture Note Series, vol. 144. Cambridge University Press, Cambridge (1990)
     [KaV] Kaimanovich, V.A., Vershik, A.M.: Random walks on discrete groups: bound-
              ary and entropy. Ann. Probab. 11, 457–490 (1983)
      [Kak] Kakutani, S.: Two ﬁxed-point theorems concerning bicompact convex sets.
              Proc. Imp. Acad. (Tokyo) 14, 242–245 (1938)
   [Kap1] Kaplansky, I.: Problems in the theory of rings. Report of a conference on lin-
              ear algebras, June 1956, 1–3, National Academy of Sciences-National Research
              Council, Washington, Publ. 502 (1957)
   [Kap2] Kaplansky, I.: Fields and Rings. Chicago Lectures in Math. University of
              Chicago Press, Chicago (1969)
   [Kap3] Kaplansky, I.: “Problems in the theory of rings” revisited. Am. Math. Mon.
              77, 445–454 (1970)
    [Kar1] Kari, J.: Reversibility of 2D cellular automata is undecidable. Physica D 45,
              379–385 (1990)
    [Kar2] Kari, J.: Reversibility and surjectivity problems of cellular automata. J. Com-
              put. Syst. Sci. 48, 149–182 (1994)
    [Kar3] Kari, J.: Theory of cellular automata: a survey. Theor. Comput. Sci. 334, 3–33
              (2005)
       [Kel] Kelley, J.L.: General Topology. Graduate Texts in Mathematics, vol. 27.
              Springer, New York (1975)
    [Kes1] Kesten, H.: Symmetric random walks on groups. Trans. Am. Math. Soc. 92,
              336–354 (1959)
    [Kes2] Kesten, H.: Full Banach mean values on countable groups. Math. Scand. 7,
              146–156 (1959)
       [Kit] Kitchens, B.P.: Symbolic dynamics. One-sided, two-sided and countable state
              Markov shifts. Universitext. Springer, Berlin (1998)
      [Ko1] Kolmogorov, A.N.: A new metric invariant of transient dynamical systems and
              automorphisms in Lebesgue spaces. Dokl. Akad. Nauk SSSR 119, 861–864
              (1958)
      [Ko2] Kolmogorov, A.N.: Entropy per unit time as a metric invariant of automor-
              phisms. Dokl. Akad. Nauk SSSR 124, 754–755 (1959)
       [Kri] Krieger, F.: Le lemme d’Ornstein-Weiss d’après Gromov. In: Dynamics, Er-
              godic Theory, and Geometry. Math. Sci. Res. Inst. Publ., vol. 54, pp. 99–111.
              Cambridge University Press, Cambridge (2007)
   [KLM] Kropoholler, P.H., Linnell, P.A., Moody, J.A.: Applications of a new K-
              theoretic theorem to soluble group rings. Proc. Am. Math. Soc. 104, 675–684
              (1988)
426                                                                            References

      [Kur] Kůrka, P.: Topological and Symbolic Dynamics. Cours Spécialisés, vol. 11.
             Société Mathématique de France, Paris (2003)
      [Law] Lawton, W.: Note on symbolic transformation groups. Not. Am. Math. Soc.
             19, A-375 (1972) (abstract)
       [Lev] Levi, F.: Über die Untergruppen der freien Gruppen. II. Math. Z. 37, 90–97
             (1933)
      [LiM] Lind, D., Marcus, B.: An Introduction to Symbolic Dynamics and Coding.
             Cambridge University Press, Cambridge (1995)
     [LiW] Lindenstrauss, E., Weiss, B.: Mean topological dimension. Isr. J. Math. 115,
             1–24 (2000)
        [LS] Lyndon, R.C., Schupp, P.E., Combinatorial Group Theory. Reprint of the 1977
             edition. Classics in Mathematics. Springer, Berlin (2001)
       [Lys] Lysënok, I.G.: A set of deﬁning relations for the Grigorchuk group. Mat. Za-
             metki 38, 503–516, 634 (1985)
   [MaM] Machı̀, A., Mignosi, F.: Garden of Eden conﬁgurations for cellular automata
             on Cayley graphs of groups. SIAM J. Discrete Math. 6, 44–56 (1993)
     [Mag] Magnus, W.: Residually ﬁnite groups. Bull. Am. Math. Soc. 75, 305–316 (1969)
  [MaKS] Magnus, W., Karras, A., Solitar, D., Combinatorial Group Theory, Presenta-
             tions of Groups in Terms of Generators and Relations. Reprint of the 1976
             second edition. Dover, New York (2004)
    [Mal1] Mal’cev, A.I.: On isomorphic matrix representations of inﬁnite groups. Rec.
             Math. [Mat. Sb.] 8(50), 405–422 (1940)
    [Mal2] Mal’cev, A.I.: On the embedding of group algebras in division algebras. Dokl.
             Akad. Nauk SSSR 60, 1499–1501 (1948)
    [Mal3] Mal’cev, A.I.: On homomorphisms onto ﬁnite groups. In: A.I. Mal’cev, Selected
             Works, Vol. 1. Classical Algebra, pp. 450–462. Nauka, Moscow (1976)
      [Mar] Markov, A.: Quelques théorèmes sur les ensembles abéliens. C.R. (Doklady)
             Acad. Sci. URSS 1, 311–313 (1936)
      [Mes] Meskin, S.: Nonresidually ﬁnite one-relator groups. Trans. Am. Math. Soc. 164,
             105–114 (1972)
     [Mil1] Milnor, J.: A note on curvature and fundamental group. J. Diﬀer. Geom. 2,
             1–7 (1968)
     [Mil2] Milnor, J.: Growth of ﬁnitely generated solvable groups. J. Diﬀer. Geom. 2,
             447–449 (1968)
     [Moo] Moore, E.F.: Machine Models of Self-Reproduction. In: Proc. Symp. Appl.
             Math., vol. 14, pp. 17–34. Am. Math. Soc., Providence (1963)
    [Morr] Morris, D.W.: Amenable groups that act on the line. Algebraic Geom. Topol.
             6, 2509–2518 (2006)
    [Mors] Morse, M.: Recurrent geodesics on a surface of negative curvature. Trans. Am.
             Math. Soc. 22, 84–100 (1921)
     [Myh] Myhill, J.: The converse of Moore’s Garden of Eden Theorem. Proc. Am. Math.
             Soc. 14, 685–686 (1963)
    [Nam] Namioka, I.: Følner’s conditions for amenable semi-groups. Math. Scand. 15,
             18–28 (1964)
     [NaB] Narici, L., Beckenstein, E.: Topological Vector Spaces. Monographs and Text-
             books in Pure and Applied Mathematics, vol. 95. Dekker, New York (1985)
   [Neu1] Neumann, B.H.: On ordered division rings. Trans. Am. Math. Soc. 66, 202–252
             (1949)
   [Neu2] Neumann, B.H.: A two-generator group isomorphic to a proper factor group.
             J. Lond. Math. Soc. 25, 247–248 (1950)
  [vNeu1] von Neumann, J.: Zur allgemeine theorie des masses. Fundam. Math. 13, 73–
             116 (1929)
  [vNeu2] von Neumann, J.: In: Burks, A.W. (ed.) The Theory of Self-reproducing Au-
             tomata. University of Illinois Press, Urbana (1966)
References                                                                               427

       [Ols] Ol’shanskii, A.Yu.: On the question of the existence of an invariant mean on a
             group. Usp. Mat. Nauk 35, 199–200 (1980)
      [OlS] Ol’shanskii, A.Yu., Sapir, M.: Non-amenable ﬁnitely presented torsion-by-cyclic
             groups. Publ. Math. IHÉS 96, 43–169 (2002) (2003)
   [OrW] Ornstein, D.S., Weiss, B.: Entropy and isomorphism theorems for actions of
             amenable groups. J. Anal. Math. 48, 1–141 (1987)
      [Pas] Passman, D.S.: The Algebraic Structure of Group Rings. Reprint of the 1977
             original. Krieger, Melbourne (1985)
      [Pat] Paterson, A.: Amenability. AMS Mathematical Surveys and Monographs,
             vol. 29. Am. Math. Soc., Providence (1988)
      [Pes] Pestov, V.G.: Hyperlinear and soﬁc groups: a brief guide. Bull. Symb. Log. 14,
             449–480 (2008)
     [PeK] Pestov, V.G., Kwiatkowska, A.: An introduction to hyperlinear and soﬁc
             groups. arXiv:0911.4266
      [Pro] Promislow, S.D.: A simple example of a torsion-free, nonunique product group.
             Bull. Lond. Math. Soc. 20, 302–304 (1988)
    [RhR] Rhemtulla, A., Rolfsen, D.: Local indicability in ordered groups: braids and
             elementary amenable groups. Proc. Am. Math. Soc. 130, 2569–2577 (2002)
      [RiS] Rips, E., Segev, Y.: Torsion-free group without unique product property. J.
             Algebra 108, 116–126 (1987)
  [RobA] Robinson, A.: Non-standard analysis. North-Holland, Amsterdam (1966)
  [RobD] Robinson, D.J.S.: A Course in the Theory of Groups, 2nd edn. Graduate Texts
             in Mathematics, vol. 80. Springer, New York (1996)
      [Rot] Rotman, J.J.: An Introduction to the Theory of Groups, 4th edn. Graduate
             Texts in Mathematics, vol. 148. Springer, New York (1995)
     [Rud] Rudin, W.: Functional Analysis. McGraw-Hill Series in Higher Mathematics.
             McGraw-Hill, New York (1973)
     [RuS] Rudin, W., Schneider, H.: Idempotents in group rings. Duke Math. J. 31, 585–
             602 (1964)
      [San] Sanov, I.N.: A property of a representation of a free group. Dokl. Akad. Nauk
             SSSR 57, 657–659 (1947)
      [Sca] Scarabotti, F.: On a lemma of Gromov and the entropy of a graph. Eur. J.
             Comb. 23, 631–633 (2002)
      [Sha] Shalom, Y.: Harmonic analysis, cohomology, and the large-scale geometry of
             amenable groups. Acta Math. 192, 119–185 (2004)
     [Stë1] Stëpin, A.M.: Approximability of groups and group actions. Russ. Math. Surv.
             38, 131–132 (1983)
     [Stë2] Stëpin, A.M.: Approximations of groups and group actions, the Cayley topol-
             ogy. In: Ergodic Theory of Zd -Actions. London Math. Soc. Lecture Note Ser.,
             vol. 228, pp. 475–484. Cambridge University Press, Cambridge (1996)
      [Sva] Švarc, A.S.: A volume invariant of coverings. Dokl. Akad. Nauk SSSR 105,
             32–34 (1955)
    [Tar1] Tarski, A.: Sur les fonctions additives dans les classes abstraites et leur appli-
             cation au problème de la mesure. Comptes Rendus des Séances de la Société
             des Sciences et des Lettres de Varsovie, Classe III 22, 243–248 (1929)
    [Tar2] Tarski, A.: Algebraische fassung des massproblems. Fundam. Math. 31, 47–66
             (1938)
     [Tho] Thom, A.: Examples of hyperlinear groups without factorization property.
             Groups Geom. Dyn. 4, 195–208 (2010)
     [Tits] Tits, J.: Free subgroups in linear groups. J. Algebra 20, 250–270 (1972)
      [Ver] Vershik, A.M.: Amenability and approximation of inﬁnite groups. Sel. Math.
             Sov. 2, 311–330 (1982)
    [VeG] Vershik, A.M., Gordon, E.I.: Groups that are locally embeddable in the class
             of ﬁnite groups. St. Petersburg Math. J. 9, 49–67 (1998)
428                                                                           References

   [Wag] Wagon, S.: The Banach-Tarski paradox. Encyclopedia of Mathematics and its
          Applications, vol. 24. Cambridge University Press, Cambridge (1985)
   [Weil] Weil, A.: Sur les Espaces à Structure Uniforme et sur la Topologie Générale.
          Hermann, Paris (1938)
  [Weiss] Weiss, B.: Soﬁc groups and dynamical systems (Ergodic theory and harmonic
          analysis, Mumbai, 1999). Sankhya Ser. A 62, 350–359 (2000)
  [Woe1] Woess, W.: Random walks on inﬁnite graphs and groups – a survey on selected
          topics. Bull. Lond. Math. Soc. 26, 1–60 (1994)
  [Woe2] Woess, W.: Random Walks on Inﬁnite Graphs and Groups. Cambridge Tracts
          in Mathematics 138. Cambridge University Press, Cambridge (2000)
    [Wol] Wolf, J.A.: Growth of ﬁnitely generated solvable groups and curvature of Rie-
          mannian manifolds. J. Diﬀer. Geom. 2, 421–446 (1968)
 [Wolfr1] Wolfram, S.: Statistical mechanics of cellular automata. Rev. Mod. Phys. 55,
          601–644 (1983)
 [Wolfr2] Wolfram, S.: Universality and complexity in cellular automata. Physica D 10,
          1–35 (1984)
 [Wolfr3] Wolfram, S.: A New Kind of Science. Wolfram Media, Inc., Champaign, IL
          (2002)
List of Symbols




Symbol                 Deﬁnition                                       Page
                       the empty word                                     367
                      the dominance relation in the set of growth
                       functions γ : N → [0, +∞)                          162
∼                      the equivalence relation in the set of growth
                       functions γ : N → [0, +∞)                          162
T p→p                the p -norm of a linear map
                       T : p (E) → p (E)                                194
0R , 0                 the zero element of the ring R                     291
1G                     the identity element of the group G                  2
1R , 1                 the unity element of the ring R                    291
γSG , γS               the growth function of the group G relative
                       to the ﬁnite symmetric generating subset
                       S⊂G                                                160
ΔG
 S , ΔS                the discrete laplacian on the group G
                       associated with the subset S ⊂ G                     9
    (2)
ΔS                     the restriction of ΔS to the Hilbert space
                       2 (G)                                             201
∂E (Ω)                 the E-boundary of the subset Ω ⊂ G                 116
ιS (G)                 the isoperimetric constant of the group G
                       with respect to the ﬁnite symmetric
                       generating subset S ⊂ G                            191
λG
 S , λS                the growth rate of the group G with respect
                       to the ﬁnite symmetric generating subset
                       S⊂G                                                169
λ(e)                   the label of the edge e ∈ E in a labeled
                       graph G = (Q, E)                                   153
λ(π)                   the label of the path π in a labeled graph
                       G = (Q, E)                                    154, 223
π−                     the initial vertex of the path π in an
                       S-labeled graph                                    154
T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,    429
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1, © Springer-Verlag Berlin Heidelberg 2010
430                                                             List of Symbols

Symbol                  Deﬁnition                                       Page
π+                      the terminal vertex of the path π in an
                        S-labeled graph                                    154
σ(T )                   the real spectrum of T ∈ L(X)                      406
ψq,r                    the S-labeled graph isomorphism from
                        BS (r) onto B(q, r) such that ψq,r (1G ) = q       265
Ω −E                    the E-interior of the subset Ω ⊂ G                 115
Ω +E                    the E-closure of the subset Ω ⊂ G                  115
A∗                      the monoid consisting of all words on the
                        alphabet A                                         367
AG                      the set of all conﬁgurations x : G → A               2
B(q, n)                 the ball of radius n in an S-labeled graph
                        Q = (Q, E) centered at the vertex q ∈ Q            265
BSG (g, n), BS (g, n)   the ball of radius n in G centered at the
                        element g ∈ G with respect to the word
                        metric                                             153
BSG (n), BS (n)         the ball of radius n in G centered at the
                        identity element 1G ∈ G with respect to the
                        word metric                                        153
CA(G; A)                the monoid consisting of all cellular
                        automata τ : AG → AG                                13
CA(G, H; A)             the submonoid of CA(G; A) consisting of all
                        cellular automata τ : AG → AG admitting a
                        memory set S such that S ⊂ H                        16
(C i (G))i≥0            the lower central series of the group G             93
CS (G)                  the Cayley graph of the group G with
                        respect to the ﬁnite symmetric generating
                        subset S ⊂ G                                       156
dF                      the normalized Hamming distance on
                        Sym(F )                                            251
dG
 S , dS                 the word metric on G with respect to the
                        ﬁnite symmetric generating subset S ⊂ G            152
dQ                      the graph metric in the edge-symmetric
                        S-labeled graph Q                                  155
D(G)                    the derived subgroup of the group G                 92
(Di (G))i≥0             the derived series of the group G                   92
entF (X)                the entropy of the subset X ⊂ AG with
                        respect to the right Følner net F                  125
F (X)                   the free group based on the set X                  371
Fn                      the free group of rank n                           372
Fix(α)                  the set of ﬁxed points of the permutation α        251
Fix(H)                  the set of conﬁgurations x ∈ AG ﬁxed by H            4
G = X; R              the presentation of the group G given by the
                        generating subset X and the set of
                        relators R                                         375
List of Symbols                                                      431

Symbol            Deﬁnition                                         Page
gx                the conﬁguration deﬁned by
                  gx(h) = x(g −1 h)                                    2
G = (X, Y, E)     the bipartite graph with left (resp. right)
                  vertex set X (resp. Y ) and set of edges E         391
HR                the Heisenberg group with coeﬃcients in the
                  ring R                                              94
ICA(G; A)         the group consisting of all invertible cellular
                  automata τ : AG → AG                                24
IdX               the identity map on the set X                        2
(w)              the length of the word w ∈ A∗                       35
p (E)            the Banach space of all p-summable
                  functions x : E → R                                193
∞ (E)            the Banach space of all bounded functions
                  x: E → R                                            78
G
 S (g), S (g)    the word-length of the element g ∈ G with
                  respect to the ﬁnite symmetric generating
                  subset S ⊂ G                                       152
LCA(G; V )        the algebra of all linear cellular automata
                  τ: VG →VG                                          287
LCA(G, H; V )     the subalgebra of LCA(G; V ) consisting of
                  all linear cellular automata τ : V G → V G
                  admitting a memory set S such that S ⊂ H           289
L(X)              the language associated with the subshift X         35
Ln (X)            the set of admissible words of length n of the
                  subshift X                                          35
L(X)              the space of all continous endomorphisms of
                  the Banach space X                                 406
 (p)
MS                the p -Markov operator associated with the
                  ﬁnite subset S ⊂ G                                 195
Matd (R)          the ring consisting of all d × d matrices with
                  entries in the ring R                              305
mdimF (X)         the mean dimension of the vector subspace
                  X ⊂ V G with respect to the right Følner
                  net F                                              308
M(E)              the set of all means on the set E                   79
PM(E)             the set of all ﬁnitely additive probability
                  measures on the set E                               79
N (Γ )            the space of all normal subgroups of the
                  group Γ or, equivalently, the space of all
                  Γ -marked groups                                    61
NL (B) ⊂ X        the left-neighborhood of the subset B ⊂ Y
                  in the bipartite graph (X, Y, E)                   392
NL (y) ⊂ X        the left-neighborhood of the vertex y ∈ Y in
                  the bipartite graph (X, Y, E)                      391
432                                                   List of Symbols

Symbol       Deﬁnition                                        Page
NR (A) ⊂ Y   the right-neighborhood of the subset A ⊂ X
             in the bipartite graph (X, Y, E)                    392
NR (x) ⊂ Y   the right-neighborhood of the vertex x ∈ X
             in the bipartite graph (X, Y, E)                    391
P(E)         the set of all subsets of the set E                  77
per(B)       the period of the matrix B                          227
per(G)       the period of the labeled graph G                   227
per(X)       the period of the irreducible soﬁc subshift X       227
pern (X)     the number of nZ-periodic conﬁgurations in
             the subshift X                                      227
Q(r)         the set of all vertices of the S-labeled graph
             Q = (Q, E) for which there exists an
             S-labeled graph isomorphism
             ψq,r : BS (r) → B(q, r) satisfying
             ψq,r (1G ) = q                                      265
Q = (Q, E)   the S-labeled graph with vertex set Q and
             edge set E ⊂ Q × S × Q                              153
R[G]         the group ring of the group G with
             coeﬃcients in the ring R                            292
Rop          the opposite ring of the ring R                     293
Sym(X)       the symmetric group of the set X                    359
Sym0 (X)     the subgroup of Sym(X) consisting of all
             permutations with ﬁnite support                     360
Sym+
   0 (X)     the alternating group on X                          364
Symn         the symmetric group of degree n                     366
Sym+
   n         the alternating group of degree n                   366
Sym(X, )    the subgroup of Sym(X) that preserve the
             partial order  of the set X                   179, 333
U (R)        the multiplicative group consisting of all
             invertible elements in the ring R,                  292
V [G]        the vector subspace of V G consisting of all
             conﬁgurations x : V → G with ﬁnite support          288
x|Ω          the restriction of the conﬁguration x ∈ AG
             to the subset Ω ⊂ G                                   3
X∗           the topological dual of the real normed
             space X                                             384
X(A)         the subshift of ﬁnite type deﬁned by the set
             of admissible patterns A                             32
Xf           the set of all conﬁgurations in the subshift
             X whose G-orbit is ﬁnite                             71
XP           the subshift deﬁned by the set of forbidden
             patterns P                                           32
XG           the subshift deﬁned by the labeled graph G          223
Z(G)         the center of the group G                            94
Index




Δ-irreducible subshift, 34                 back-tracking, 156
                                           Baire theorem, 403
action                                     Banach-Alaoglu theorem, 385
   continuous —, 3                         base
   equivariantly approximable —, 279          — of a uniform structure, 353
   expansive —, 65                            free —, 368
   faithful —, 50                          based free group, 367
   topologically mixing —, 29              bi-invariant metric, 251
   topologically transitive —, 32          bi-orderable group, 341
   uniformly continuous —, 64              bipartite
additive cellular automaton, 335              — graph, 391
adjacency matrix of a labeled graph, 227      — subgraph, 391
admissible pattern, 32                        ﬁnite — graph, 392
admissible word, 35                           locally ﬁnite — graph, 392
aﬃne                                       Boolean ring, 340
   — group, 93                             boundary, 116
   — map, 387                              Burnside problem, 214
algebra, 286
   — homomorphism, 289                     Cantor-Bernstein theorem, 398
   — isomorphism, 290                      Cayley graph, 156
almost                                     cellular automaton, 6
   — -homomorphism, 234, 254                  additive —, 335
   — equal conﬁgurations, 112                 induced —, 17
   — perfect group, 55                        invertible —, 24
   — periodic conﬁguration, 72                linear —, 284, 335
alphabet, 2                                   reversible —, 24
alternating group, 364                     characteristic map, 79
   — of rank n, 366                        closed path, 155
amenable                                   closure, 115
   — group, 87                             cluster point of a net, 345
   elementary — group, 215, 338            color, 2
Artinian module, 69                        commensurable groups, 171
automaton                                  commutative-transitive group, 279
   additive cellular —, 335                commutator
   cellular —, 6                              — of two group elements, 92
   linear cellular —, 284                     — subgroup, 92
automorphism group, 45                        simple —, 176

T. Ceccherini-Silberstein, M. Coornaert, Cellular Automata and Groups,         433
Springer Monographs in Mathematics,
DOI 10.1007/978-3-642-14034-1, © Springer-Verlag Berlin Heidelberg 2010
434                                                                                Index

compact topological space, 347               entourage, 352
completion                                   entropy
  proamenable —, 108                           topological —, 142
  pronilpotent —, 108                        equipotent sets, 372
  prosolvable —, 108                         equivalence of growth functions, 162
complexity of a paradoxical decomposition,   equivariant map, 5
      106                                    equivariantly approximable action, 279
composition of paths, 154                    even subshift, 35
concatenation, 367                           expansive action, 65
conﬁguration, 2                              expansivity
  H-periodic —, 3                              constant, 65
  almost periodic —, 72                        entourage, 65
  Garden of Eden —, 111                      exponential growth, 164
  language of a —, 73
  Toeplitz —, 74                             Følner
conjugate elements, 362                         — conditions, 96
connected labeled graph, 155                    — theorem, 99
Connes embedding conjecture, 277                left — net, 96
context-free subshift, 225                      left — sequence, 96
convergent net, 344                             right — net, 96
convex subset, 383                              right — sequence, 96
convolution product, 291                     faithful action, 50
convolutional encoders, 335                  Fibonacci sequence, 219
Curtis-Hedlund theorem, 20                   ﬁeld, 284
cycle, 361                                   ﬁlter, 409
                                                — generated, 409
                                                convergent —, 412
Day’s problem, 105
                                                Fréchet —, 409
Dedekind ﬁnite ring, 336
                                                limit of a —, 412
degree
                                                principal —, 409
  — of a graph, 155
                                                residual —, 409
  — of a symmetric group, 366
                                                ultra—, 410
  — of a vertex, 155
                                             ﬁnite intersection property, 347
  — of an alternating group, 366
                                             ﬁnitely
derived
                                                — additive probability measure, 77
  — series, 92
                                                — generated group, 152, 375
  — subgroup, 92
                                                — presented group, 376
directed set, 343
                                                bi-invariant — additive probability
directly ﬁnite ring, 327
                                                    measure, 85
discrete uniform structure, 352
                                                left-invariant — additive probability
divisible group, 38
                                                    measure, 85
dominance of growth functions, 162
                                                right-invariant — additive probability
                                                    measure, 85
edge                                         forbidden
   — -symmetric labeled graph, 155              — pattern, 32
   — of a bipartite graph, 391                  — word, 35
   inverse —, 155                            Fréchet ﬁlter, 409
   of a labeled graph, 153                   free
elementary                                      — base, 368
   — amenable group, 215, 338                   — base subset, 368
   — reduction, 370                             — group, 368
empty                                           — group of rank k, 372
   — path, 154                                  — ultraﬁlter, 410
   — word, 367                                  based — group, 367
Index                                                                                 435

   rank of a — group, 373                     LEF —, 247
fully residually free group, 279              linear —, 51
                                              locally P —, 58
Garden of Eden                                locally indicable —, 337
  — conﬁguration, 111                         marked —, 61
  — pattern, 112                              metabelian —, 92
  — theorem, 114, 128                         nilpotent —, 93
  — theorem for linear cellular automata,     orderable —, 331
      312                                     periodic —, 29, 105
generating subset, 151                        polycyclic —, 106, 108
generator of a presentation, 375              presentation of a —, 375
golden mean subshift, 35                      proﬁnite —, 41
graph                                         residually C —, 238
  — metric, 155                               residually P —, 62, 131
  bipartite —, 391                            residually amenable —, 132
  Cayley —, 156                               residually ﬁnite —, 37
  degree of a regular labeled —, 155          simple —, 44
  ﬁnite labeled —, 154                        soﬁc —, 254
  labeled —, 153                              solvable —, 93
  loop in a labeled —, 154                    surjunctive —, 57
  regular labeled —, 155                      symmetric —, 359
  tree, 156                                   symmetric — of rank n, 366
Grigorchuk group, 179                         unique-product —, 331
  abelianization of the —, 222                virtually P —, 41
group                                       growth
  — algebra, 294                              — function, 160, 162
  — of p-adic integers, 41                    — rate, 169
  — of intermediate growth, 190               — type of a group, 163
  — ring, 292                                 equivalence class of — functions, 163
  aﬃne —, 93                                  equivalence of — functions, 162
  almost perfect —, 55                        exponential —, 164
  alternating —, 364                          intermediate —, 190
  alternating — of rank n, 366                polynomial —, 164
  amenable —, 87
                                              subexponential —, 164
  automorphism —, 45
  bi-orderable —, 341
  Cayley graph of a —, 156                  Hall
  commutative-transitive —, 279               — k-harem conditions, 399
  divisible —, 38                             — condition, 394
  elementary amenable —, 215, 338             — harem theorem, 399
  ﬁnitely generated —, 152, 375               — marriage theorem, 399
  ﬁnitely presented —, 376                  Hamming metric, 252
  free —, 368                               Hausdorﬀ metric, 357
  free — of rank k, 372                     Hausdorﬀ-Bourbaki
  fully residually free —, 279                — topology, 356
  Grigorchuk —, 179                           uniform structure, 356
  Heisenberg —, 94                          Heisenberg group, 94
  Hopﬁan —, 44                              homomorphism
  hyperlinear —, 277                          almost- —, 234, 254
  Kaloujnine —, 221                           labeled graph —, 154
  Klein bottle —, 341                       Hopﬁan
  L-surjunctive —, 324                        — group, 44
  lamplighter —, 108                          — module, 339
  LEA —, 247                                hyperlinear group, 277
436                                                                      Index

ICC-property, 338                      — ﬁnitely additive probability measure,
idempotent, 331                           85
   proper —, 331                       — metric, 251
induced                             length
   — cellular automaton, 17            — of a cycle, 361
   — labeled subgraph, 154             — of a word, 35, 152
inductive                           letter, 2
   — limit, 379                     limit
   — system of groups, 379             — along an ultraﬁlter, 413
initial                                — of a ﬁlter, 412
   — topology, 346                     — point of a net, 344
   — uniform structure, 355            inductive —, 379
interior, 115                          projective —, 380
intermediate growth, 190            linear
inverse                                — cellular automaton, 284, 335
   — edge, 155                         — group, 51
   — path, 155                      Lipschitz-equivalence, 162
invertible cellular automaton, 24   local deﬁning map, 6
irreducible                         locally
   — matrix, 227                       — P group, 58
   — subshift, 32                      — convex topological vector space, 383
isomorphism                            — embeddable, 235
   labeled graph —, 154                — ﬁnite bipartite graph, 392
isoperimetric constant, 191            — ﬁnite labeled graph, 155
                                       — indicable group, 337
                                    loop, 154
Kaloujnine group, 221
                                    lower central series, 93
  abelianization of the —, 222
Kesten-Day theorem, 201
                                    majority action, 10
Klein bottle group, 341
                                    marked group, 61
Klein Ping-Pong theorem, 376
                                    Markov operator, 195
                                    Markov-Kakutani theorem, 387
L-surjunctive group, 324            matching, 393
labeled graph, 153                    left-perfect —, 393
   — homomorphism, 154                perfect —, 393
   — isomorphism, 154                 right-perfect—, 393
   adjacency matrix of a —, 227     mean, 78
   connected —, 155                   — dimension, 308
   edge-symmetric —, 155              bi-invariant —, 86
   ﬁnite —, 154                       left-invariant —, 86
   locally ﬁnite —, 155               right-invariant —, 86
   path in a —, 154                 memory set, 6
   subgraph, 154                      minimal —, 15
   subshift deﬁned by a —, 223      metabelian group, 92
labelling map, 153                  metric
lamplighter group, 108                bi-invariant —, 251
language                              graph —, 155
   — of a conﬁguration, 73            Hamming —, 252
   — of a subshift over Z, 35         word —, 153
Laplacian, 10                       metrizable uniform structure, 352
lattice, 95                         Milnor problem, 215
LEA-group, 247                      minimal
LEF-group, 247                        — memory set, 15
left-invariant                        — set, 72
Index                                                                  437

 — subshift, 72                 principal
module                            — ﬁlter, 409
 Artinian —, 69                   — ultraﬁlter, 410
 Hopﬁan —, 339                  proamenable completion, 108
 Noetherian —, 339              prodiscrete
 projective —, 339                — topology, 3, 346
monoid, 13                        — uniform structure, 22, 355
Moore neighborhood, 166         product
Morse subshift, 74                — topology, 346
 entropy of the —, 144            — uniform structure, 355
                                proﬁnite
neighbor, 155                     — completion, 55
net, 343                          — group, 41
nilpotency degree, 93             — kernel, 39
nilpotent group, 93               — topology, 53
Noetherian                      projective
   — module, 339                  — limit, 380
   — ring, 340                    — module, 339
non-principal ultraﬁlter, 410     — system of groups, 380
normal closure, 375             pronilpotent completion, 108
                                proper
Open mapping theorem, 404         — idempotent, 331
operator norm, 384                — path, 156
opposite ring, 293              prosolvable completion, 108
orderable group, 331
                                quasi-isometric
Ore ring, 340
                                  — embedding, 204
                                  — groups, 206
paradoxical decomposition
                                quasi-isometry, 204
  left —, 98
  right —, 98                   rank of a free group, 373
partially ordered set, 343      reduced
path                               — form, 374
  — in a labeled graph, 154        — product, 244
  closed —, 155                    — word, 373
  closed simple —, 156          regular labeled graph, 155
  composition, 154              relator of a presentation, 375
  empty —, 154                  residual
  inverse —, 155                   — ﬁlter, 409
  label of a —, 154                — set, 409
  proper —, 156                    — subgroup, 39
  simple —, 156                 residually
pattern, 2                         — C group, 238
  admissible —, 32                 — P group, 62, 131
  forbidden —, 32                  — amenable group, 132
periodic group, 29, 105            — ﬁnite group, 37
permutation, 359                restriction, 17
  support of a —, 360           reversible cellular automaton, 24
polycyclic group, 106, 108      right-invariant
polynomial, 164                    — ﬁnitely additive probability measure,
pre-injective map, 112                85
presentation                       — metric, 251
  — of a group, 375             ring
  generator of a —, 375            Boolean —, 340
  relator of a —, 375              Dedekind ﬁnite —, 336
438                                                                       Index

  directly ﬁnite —, 327               support
  group —, 292                          — of a conﬁguration, 288
  Noetherian —, 340                     — of a pattern, 2
  opposite —, 293                       — of a permutation, 360
  Ore —, 340                          surjunctive
  stably ﬁnite —, 328                   — group, 57
  unit-regular—, 340                    —subshift, 71
  von Neumann ﬁnite —, 336            symbol, 2
                                      symmetric
set                                     — group, 359
   directed —, 343                      — subset, 152
   partially ordered —, 343           syndetic subset, 72
shift, 2
simple                                Tarski
   — group, 44                           — alternative, 99
   — path, 156                           — number of a group, 106
   closed — path, 156                 Tarski-Følner theorem, 99
soﬁc                                  theorem
   — subshift, 225                       Baire —, 403
   — group, 254                          Banach-Alaoglu —, 385
solvable group, 93                       Cantor-Bernstein —, 398
spectrum                                 Curtis-Hedlund —, 20
   real —, 406                           Garden of Eden —, 114, 128
stably ﬁnite ring, 328                   Garden of Eden — for linear cellular
state, 2                                     automata, 312
strong topology, 82, 384                 Gromov-Weiss —, 272
strongly irreducible subshift, 34        Hall harem —, 399
subalgebra, 287                          Hall marriage —, 399
subexponential growth, 164               Kesten-Day —, 201
subgraph                                 Klein Ping-Pong —, 376
   induced labeled —, 154                Markov-Kakutani —, 387
   labeled —, 154                        open mapping —, 404
submonoid, 17                            Tarski-Følner —, 99
subnet, 344                              Tychonoﬀ —, 348
subsemigroup, 322                     Thue-Morse sequence, 73
subshift, 31                          tiling, 122
   N -power —, 228                    Toeplitz
   N th higher block —, 227              — conﬁguration, 74
   Δ-irreducible —, 34                   — subshift, 74
   — deﬁned by a labeled graph, 223   topological
   — of ﬁnite type, 32                   — dual, 384
   context-free —, 225                   — entropy, 142
   even —, 35                            — manifold, 69
   golden mean —, 35                     — vector space, 383
   irreducible —, 32                  topologically mixing
   language of a — over Z, 35            — action, 29
   minimal —, 72                         — subshift, 33
   Morse —, 74, 144                   topologically transitive action, 32
   soﬁc —, 225                        topology
   strongly irreducible —, 34            Hausdorﬀ-Bourbaki —, 356
   surjunctive —, 71                     initial —, 346
   Toeplitz —, 74                        prodiscrete —, 3, 346
   topologically mixing —, 33            product —, 346
subword, 35                              proﬁnite —, 53
Index                                                                          439

   strong —, 384                              valence of a vertex, 155
   weak-∗ —, 384                              vertex
total ordering, 331                              — of a bipartite graph, 391
totally disconnected topological space, 346      — of a labeled graph, 153
transposition, 361                               degree of a —, 155
tree, 156                                        neighbor, 155
trivial uniform structure, 352                   valence of a —, 155
Tychonoﬀ theorem, 348                         virtually P group, 41
                                              von Neumann
ultraﬁlter, 410                                  — conjecture, 105
  free —, 410
                                                 — ﬁnite ring, 336
  limit along an — , 413
                                                 — neighborhood, 165
  non-principal —, 410
  principal —, 410
ultraproduct, 244                             weak-∗ topology, 384
uniform                                       word, 367
  — convexity, 407                              — length, 152
  — embedding, 355                              — metric, 153
  — isomorphism, 355                            admissible —, 35
  — structure, 351                              empty —, 367
  Hausdorﬀ-Bourbaki — structure, 356            forbidden —, 35
  induced — structure, 353                      length of a —, 35
  prodiscrete — structure, 22, 355              reduced —, 373
uniformly continuous                            subword of a —, 35
  — action, 64                                wreath product, 52
  — map, 353
unique
  — -product group, 331                       zero-divisor, 330
  — rank property, 340                          — conjecture, 337
unit-regular ring, 340                          left —, 330
universe, 2                                     right —, 330
